var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function i(t){t.forEach(e)}function s(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(t,e){t.appendChild(e)}function o(t){t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function l(t){return document.createTextNode(t)}function h(){return l(" ")}function u(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function d(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}let p;function f(t){p=t}function m(t){(function(){if(!p)throw new Error("Function called outside component initialization");return p})().$$.on_mount.push(t)}const g=[],v=[],b=[],_=[],y=Promise.resolve();let w=!1;function x(t){b.push(t)}let k=!1;const T=new Set;function S(){if(!k){k=!0;do{for(let t=0;t<g.length;t+=1){const e=g[t];f(e),C(e.$$)}for(f(null),g.length=0;v.length;)v.pop()();for(let t=0;t<b.length;t+=1){const e=b[t];T.has(e)||(T.add(e),e())}b.length=0}while(g.length);for(;_.length;)_.pop()();w=!1,k=!1,T.clear()}}function C(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(x)}}const A=new Set;function E(t,e){-1===t.$$.dirty[0]&&(g.push(t),w||(w=!0,y.then(S)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function M(r,a,c,l,h,u,d=[-1]){const m=p;f(r);const g=a.props||{},v=r.$$={fragment:null,ctx:null,props:u,update:t,not_equal:h,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(m?m.$$.context:[]),callbacks:n(),dirty:d,skip_bound:!1};let b=!1;if(v.ctx=c?c(r,g,((t,e,...n)=>{const i=n.length?n[0]:e;return v.ctx&&h(v.ctx[t],v.ctx[t]=i)&&(!v.skip_bound&&v.bound[t]&&v.bound[t](i),b&&E(r,t)),e})):[],v.update(),b=!0,i(v.before_update),v.fragment=!!l&&l(v.ctx),a.target){if(a.hydrate){const t=function(t){return Array.from(t.childNodes)}(a.target);v.fragment&&v.fragment.l(t),t.forEach(o)}else v.fragment&&v.fragment.c();a.intro&&((_=r.$$.fragment)&&_.i&&(A.delete(_),_.i(y))),function(t,n,r){const{fragment:a,on_mount:o,on_destroy:c,after_update:l}=t.$$;a&&a.m(n,r),x((()=>{const n=o.map(e).filter(s);c?c.push(...n):i(n),t.$$.on_mount=[]})),l.forEach(x)}(r,a.target,a.anchor),S()}var _,y;f(m)}const N="14.7.58";var I="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function O(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&n.path)}},n.exports),n.exports}var P=function(t){if(Array.isArray(t))return t};var D=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,s=!1,r=void 0;try{for(var a,o=t[Symbol.iterator]();!(i=(a=o.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){s=!0,r=t}finally{try{i||null==o.return||o.return()}finally{if(s)throw r}}return n}};var B=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i};var R=function(t,e){if(t){if("string"==typeof t)return B(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(t,e):void 0}};var L=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var V=function(t,e){return P(t)||D(t,e)||R(t,e)||L()};var H=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};function F(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var q=function(t,e,n){return e&&F(t.prototype,e),n&&F(t,n),t},z=O((function(t,e){!function(t,e,n,i){function s(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=s(e),a=s(n),o=s(i),c=function(t,e,n){return{endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}},l=function(t,e,n){return{endTime:e,insertTime:n,type:"linearRampToValue",value:t}},h=function(t,e){return{startTime:e,type:"setValue",value:t}},u=function(t,e,n){return{duration:n,startTime:e,type:"setValueCurve",values:t}},d=function(t,e,n){var i=n.startTime,s=n.target,r=n.timeConstant;return s+(e-s)*Math.exp((i-t)/r)},p=function(t){return"exponentialRampToValue"===t.type},f=function(t){return"linearRampToValue"===t.type},m=function(t){return p(t)||f(t)},g=function(t){return"setValue"===t.type},v=function(t){return"setValueCurve"===t.type},b=function t(e,n,i,s){var r=e[n];return void 0===r?s:m(r)||g(r)?r.value:v(r)?r.values[r.values.length-1]:d(i,t(e,n-1,r.startTime,s),r)},_=function(t,e,n,i,s){return void 0===n?[i.insertTime,s]:m(n)?[n.endTime,n.value]:g(n)?[n.startTime,n.value]:v(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,b(t,e-1,n.startTime,s)]},y=function(t){return"cancelAndHold"===t.type},w=function(t){return"cancelScheduledValues"===t.type},x=function(t){return y(t)||w(t)?t.cancelTime:p(t)||f(t)?t.endTime:t.startTime},k=function(t,e,n,i){var s=i.endTime,r=i.value;return n===r?r:0<n&&0<r||n<0&&r<0?n*Math.pow(r/n,(t-e)/(s-e)):0},T=function(t,e,n,i){return n+(t-e)/(i.endTime-e)*(i.value-n)},S=function(t,e){var n=Math.floor(e),i=Math.ceil(e);return n===i?t[n]:(1-(e-n))*t[n]+(1-(i-e))*t[i]},C=function(t,e){var n=e.duration,i=e.startTime,s=e.values,r=(t-i)/n*(s.length-1);return S(s,r)},A=function(t){return"setTarget"===t.type},E=function(){function t(e){a.default(this,t),this._automationEvents=[],this._currenTime=0,this._defaultValue=e}return o.default(t,[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=x(t);if(y(t)||w(t)){var n=this._automationEvents.findIndex((function(n){return w(t)&&v(n)?n.startTime+n.duration>=e:x(n)>=e})),i=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),y(t)){var s=this._automationEvents[this._automationEvents.length-1];if(void 0!==i&&m(i)){if(A(s))throw new Error("The internal list is malformed.");var r=v(s)?s.startTime+s.duration:x(s),a=v(s)?s.values[s.values.length-1]:s.value,o=p(i)?k(e,r,a,i):T(e,r,a,i),d=p(i)?c(o,e,this._currenTime):l(o,e,this._currenTime);this._automationEvents.push(d)}void 0!==s&&A(s)&&this._automationEvents.push(h(this.getValue(e),e)),void 0!==s&&v(s)&&s.startTime+s.duration>e&&(this._automationEvents[this._automationEvents.length-1]=u(new Float32Array([6,7]),s.startTime,e-s.startTime))}}else{var g=this._automationEvents.findIndex((function(t){return x(t)>e})),b=-1===g?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[g-1];if(void 0!==b&&v(b)&&x(b)+b.duration>e)return!1;var _=p(t)?c(t.value,t.endTime,this._currenTime):f(t)?l(t.value,e,this._currenTime):t;if(-1===g)this._automationEvents.push(_);else{if(v(t)&&e+t.duration>x(this._automationEvents[g]))return!1;this._automationEvents.splice(g,0,_)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return x(e)>t}));if(e>1){var n=this._automationEvents.slice(e-1),i=n[0];A(i)&&n.unshift(h(b(this._automationEvents,e-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var e=this._automationEvents[this._automationEvents.length-1],n=this._automationEvents.findIndex((function(e){return x(e)>t})),i=this._automationEvents[n],s=x(e)<=t?e:this._automationEvents[n-1];if(void 0!==s&&A(s)&&(void 0===i||!m(i)||i.insertTime>t))return d(t,b(this._automationEvents,n-2,s.startTime,this._defaultValue),s);if(void 0!==s&&g(s)&&(void 0===i||!m(i)))return s.value;if(void 0!==s&&v(s)&&(void 0===i||!m(i)||s.startTime+s.duration>t))return t<s.startTime+s.duration?C(t,s):s.values[s.values.length-1];if(void 0!==s&&m(s)&&(void 0===i||!m(i)))return s.value;if(void 0!==i&&p(i)){var a=_(this._automationEvents,n-1,s,i,this._defaultValue),o=r.default(a,2),c=o[0],l=o[1];return k(t,c,l,i)}if(void 0!==i&&f(i)){var h=_(this._automationEvents,n-1,s,i,this._defaultValue),u=r.default(h,2),y=u[0],w=u[1];return T(t,y,w,i)}return this._defaultValue}}]),t}(),M=function(t){return{cancelTime:t,type:"cancelAndHold"}},N=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},I=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},O=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},P=function(t,e,n){return{startTime:e,target:t,timeConstant:n,type:"setTarget"}};t.AutomationEventList=E,t.createCancelAndHoldAutomationEvent=M,t.createCancelScheduledValuesAutomationEvent=N,t.createExponentialRampToValueAutomationEvent=I,t.createLinearRampToValueAutomationEvent=O,t.createSetTargetAutomationEvent=P,t.createSetValueAutomationEvent=h,t.createSetValueCurveAutomationEvent=u,Object.defineProperty(t,"__esModule",{value:!0})}(e,V,H,q)}));const G=new WeakSet,j=new WeakMap,W=new WeakMap,Y=new WeakMap,U=new WeakMap,X=new WeakMap,$=new WeakMap,Z=new WeakMap,K=new WeakMap,Q=new WeakMap,J={construct:()=>J},tt=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,et=(t,e)=>{const n=[];let i=t.replace(/^[\s]+/,""),s=i.match(tt);for(;null!==s;){const t=s[1].slice(1,-1),r=s[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());n.push(r),i=i.slice(s[0].length).replace(/^[\s]+/,""),s=i.match(tt)}return[n.join(";"),i]},nt=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},it=t=>{if(!(t=>{try{new new Proxy(t,J)}catch{return!1}return!0})(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},st=(t,e)=>{const n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},rt=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[i]=n;return t.delete(i),i},at=(t,e,n,i)=>{const s=st(t,e),r=rt(s,(t=>t[0]===n&&t[1]===i));return 0===s.size&&t.delete(e),r},ot=t=>st($,t),ct=t=>{if(G.has(t))throw new Error("The AudioNode is already stored.");G.add(t),ot(t).forEach((t=>t(!0)))},lt=t=>"port"in t,ht=t=>{if(!G.has(t))throw new Error("The AudioNode is not stored.");G.delete(t),ot(t).forEach((t=>t(!1)))},ut=(t,e)=>{!lt(t)&&e.every((t=>0===t.size))&&ht(t)},dt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},pt=(t,e)=>t.context===e,ft=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},mt=()=>new DOMException("","IndexSizeError"),gt=t=>{var e;t.getChannelData=(e=t.getChannelData,n=>{try{return e.call(t,n)}catch(t){if(12===t.code)throw mt();throw t}})},vt={numberOfChannels:1},bt=-34028234663852886e22,_t=-bt,yt=t=>G.has(t),wt={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},xt=t=>st(j,t),kt=t=>st(Y,t),Tt=(t,e)=>{const{activeInputs:n}=xt(t);n.forEach((n=>n.forEach((([n])=>{e.includes(t)||Tt(n,[...e,t])}))));const i=(t=>"playbackRate"in t)(t)?[t.playbackRate]:lt(t)?Array.from(t.parameters.values()):(t=>"frequency"in t&&"gain"in t)(t)?[t.Q,t.detune,t.frequency,t.gain]:(t=>"offset"in t)(t)?[t.offset]:(t=>!("frequency"in t)&&"gain"in t)(t)?[t.gain]:(t=>"detune"in t&&"frequency"in t)(t)?[t.detune,t.frequency]:(t=>"pan"in t)(t)?[t.pan]:[];for(const t of i){const n=kt(t);void 0!==n&&n.activeInputs.forEach((([t])=>Tt(t,e)))}yt(t)&&ht(t)},St=t=>{Tt(t.destination,[])},Ct=t=>"context"in t,At=t=>Ct(t[0]),Et=(t,e,n,i)=>{for(const e of t)if(n(e)){if(i)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},Mt=(t,e,[n,i],s)=>{Et(t,[e,n,i],(t=>t[0]===e&&t[1]===n),s)},Nt=(t,[e,n,i],s)=>{const r=t.get(e);void 0===r?t.set(e,new Set([[n,i]])):Et(r,[n,i],(t=>t[0]===n),s)},It=t=>"inputs"in t,Ot=(t,e,n,i)=>{if(It(e)){const s=e.inputs[i];return t.connect(s,n,0),[s,n,0]}return t.connect(e,n,i),[e,n,i]},Pt=(t,e,n)=>{for(const i of t)if(i[0]===e&&i[1]===n)return t.delete(i),i;return null},Dt=(t,e)=>{if(!ot(t).delete(e))throw new Error("Missing the expected event listener.")},Bt=(t,e,n)=>{const i=st(t,e),s=rt(i,(t=>t[0]===n));return 0===i.size&&t.delete(e),s},Rt=(t,e,n,i)=>{It(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i)},Lt=t=>st(W,t),Vt=t=>st(U,t),Ht=t=>Z.has(t),Ft=t=>!G.has(t),qt=t=>new Promise((e=>{const n=t.createScriptProcessor(256,1,1),i=t.createGain(),s=t.createBuffer(1,2,44100),r=s.getChannelData(0);r[0]=1,r[1]=1;const a=t.createBufferSource();a.buffer=s,a.loop=!0,a.connect(n).connect(t.destination),a.connect(i),a.disconnect(i),n.onaudioprocess=i=>{const s=i.inputBuffer.getChannelData(0);Array.prototype.some.call(s,(t=>1===t))?e(!0):e(!1),a.stop(),n.onaudioprocess=null,a.disconnect(n),n.disconnect(t.destination)},a.start()})),zt=(t,e)=>{const n=new Map;for(const e of t)for(const t of e){const e=n.get(t);n.set(t,void 0===e?1:e+1)}n.forEach(((t,n)=>e(n,t)))},Gt=t=>"context"in t,jt=t=>{const e=new Map;t.connect=(t=>(n,i=0,s=0)=>{const r=Gt(n)?t(n,i,s):t(n,i),a=e.get(n);return void 0===a?e.set(n,[{input:s,output:i}]):a.every((t=>t.input!==s||t.output!==i))&&a.push({input:s,output:i}),r})(t.connect.bind(t)),t.disconnect=(n=>(i,s,r)=>{if(n.apply(t),void 0===i)e.clear();else if("number"==typeof i)for(const[t,n]of e){const s=n.filter((t=>t.output!==i));0===s.length?e.delete(t):e.set(t,s)}else if(e.has(i))if(void 0===s)e.delete(i);else{const t=e.get(i);if(void 0!==t){const n=t.filter((t=>t.output!==s&&(t.input!==r||void 0===r)));0===n.length?e.delete(i):e.set(i,n)}}for(const[n,i]of e)i.forEach((e=>{Gt(n)?t.connect(n,e.output,e.input):t.connect(n,e.output)}))})(t.disconnect)},Wt=(t,e,n,i)=>{const{activeInputs:s,passiveInputs:r}=kt(e),{outputs:a}=xt(t),o=ot(t),c=a=>{const o=Lt(t),c=Vt(e);if(a){const e=Bt(r,t,n);Mt(s,t,e,!1),i||Ht(t)||o.connect(c,n)}else{const e=((t,e,n)=>rt(t,(t=>t[0]===e&&t[1]===n)))(s,t,n);Nt(r,e,!1),i||Ht(t)||o.disconnect(c,n)}};return!!Et(a,[e,n],(t=>t[0]===e&&t[1]===n),!0)&&(o.add(c),yt(t)?Mt(s,t,[n,c],!0):Nt(r,[t,n,c],!0),!0)},Yt=(t,e,n,i,s)=>{const[r,a]=((t,e,n,i)=>{const{activeInputs:s,passiveInputs:r}=xt(e),a=Pt(s[i],t,n);if(null===a)return[at(r,t,n,i)[2],!1];return[a[2],!0]})(t,n,i,s);if(null!==r&&(Dt(t,r),!a||e||Ht(t)||Rt(Lt(t),Lt(n),i,s)),yt(n)){const{activeInputs:t}=xt(n);ut(n,t)}},Ut=(t,e,n,i)=>{const[s,r]=((t,e,n)=>{const{activeInputs:i,passiveInputs:s}=kt(e),r=Pt(i,t,n);if(null===r)return[Bt(s,t,n)[1],!1];return[r[2],!0]})(t,n,i);null!==s&&(Dt(t,s),!r||e||Ht(t)||Lt(t).disconnect(Vt(n),i))};class Xt{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach(((n,i)=>t.call(e,n,i,this)))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const $t={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function Zt(t,e,n,i,s){if("function"==typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,s);else{const r=t.getChannelData(i);if(0===e[n].byteLength)e[n]=r.slice(s,s+128);else{const t=new Float32Array(r.buffer,s*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(t)}}}const Kt=(t,e,n,i,s)=>{"function"==typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],i,s):0!==e[n].byteLength&&t.getChannelData(i).set(e[n],s)},Qt=(t,e)=>{const n=[];for(let i=0;i<t;i+=1){const t=[],s="number"==typeof e?e:e[i];for(let e=0;e<s;e+=1)t.push(new Float32Array(128));n.push(t)}return n},Jt=async(t,e,n,i,s,r,a)=>{const o=null===e?128*Math.ceil(t.context.length/128):e.length,c=i.channelCount*i.numberOfInputs,l=s.reduce(((t,e)=>t+e),0),h=0===l?null:n.createBuffer(l,o,n.sampleRate);if(void 0===r)throw new Error("Missing the processor constructor.");const u=xt(t),d=await((t,e)=>{const n=st(Q,t),i=Lt(e);return st(n,i)})(n,t),p=Qt(i.numberOfInputs,i.channelCount),f=Qt(i.numberOfOutputs,s),m=Array.from(t.parameters.keys()).reduce(((t,e)=>({...t,[e]:new Float32Array(128)})),{});for(let l=0;l<o;l+=128){if(i.numberOfInputs>0&&null!==e)for(let t=0;t<i.numberOfInputs;t+=1)for(let n=0;n<i.channelCount;n+=1)Zt(e,p[t],n,n,l);void 0!==r.parameterDescriptors&&null!==e&&r.parameterDescriptors.forEach((({name:t},n)=>{Zt(e,m,t,c+n,l)}));for(let t=0;t<i.numberOfInputs;t+=1)for(let e=0;e<s[t];e+=1)0===f[t][e].byteLength&&(f[t][e]=new Float32Array(128));try{const t=p.map(((t,e)=>0===u.activeInputs[e].size?[]:t)),e=a(l/n.sampleRate,n.sampleRate,(()=>d.process(t,f,m)));if(null!==h)for(let t=0,e=0;t<i.numberOfOutputs;t+=1){for(let n=0;n<s[t];n+=1)Kt(h,f[t],n,e+n,l);e+=s[t]}if(!e)break}catch(e){t.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}));break}}return h},te={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},ee={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},ne={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},ie={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},se={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},re={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},ae=(t,e,n)=>{const i=e[n];if(void 0===i)throw t();return i},oe={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},ce={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},le=()=>new DOMException("","InvalidStateError"),he=()=>new DOMException("","InvalidAccessError"),ue={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},de=(t,e,n,i,s,r,a,o,c,l,h)=>{const u=l.length;let d=o;for(let o=0;o<u;o+=1){let u=n[0]*l[o];for(let e=1;e<s;e+=1){const i=d-e&c-1;u+=n[e]*r[i],u-=t[e]*a[i]}for(let t=s;t<i;t+=1)u+=n[t]*r[d-t&c-1];for(let n=s;n<e;n+=1)u-=t[n]*a[d-n&c-1];r[d]=l[o],a[d]=u,d=d+1&c-1,h[o]=u}return d},pe={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},fe=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,(()=>{}));return void 0!==n&&(n.catch((()=>{})),!0)}catch{}return!1},me=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n]&&(t[n]=i)},ge=(t,e)=>{me(t,e,"channelCount"),me(t,e,"channelCountMode"),me(t,e,"channelInterpretation")},ve=t=>"function"==typeof t.getFloatTimeDomainData,be=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n].value&&(t[n].value=i)},_e=t=>{var e;t.start=(e=t.start,(n=0,i=0,s)=>{if("number"==typeof s&&s<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,i,s)})},ye=t=>{var e;t.stop=(e=t.stop,(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})},we=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),xe=async(t,e)=>new t(await(t=>new Promise(((e,n)=>{const{port1:i,port2:s}=new MessageChannel;i.onmessage=({data:t})=>{i.close(),s.close(),e(t)},i.onmessageerror=({data:t})=>{i.close(),s.close(),n(t)},s.postMessage(t)})))(e)),ke=(t,e)=>{const n=t.createBiquadFilter();return ge(n,e),be(n,e,"Q"),be(n,e,"detune"),be(n,e,"frequency"),be(n,e,"gain"),me(n,e,"type"),n},Te=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return ge(n,e),(t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw le()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw le()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw le()}})})(n),n},Se=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Ce=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return ge(n,e),be(n,e,"delayTime"),n},Ae=(t,e)=>{const n=t.createGain();return ge(n,e),be(n,e,"gain"),n};function Ee(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function Me(t,e){let n=[0,0];for(let r=t.length-1;r>=0;r-=1)s=e,n=[(i=n)[0]*s[0]-i[1]*s[1],i[0]*s[1]+i[1]*s[0]],n[0]+=t[r];var i,s;return n}const Ne=(t,e,n,i)=>t.createScriptProcessor(e,n,i),Ie=()=>new DOMException("","NotSupportedError"),Oe={numberOfChannels:1},Pe={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},De={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Be={disableNormalization:!1},Re={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Le={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Ve=t=>{if(null===t)return!1;const e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},He=(t,e,n,i)=>{let s=Object.getPrototypeOf(t);for(;!s.hasOwnProperty(e);)s=Object.getPrototypeOf(s);const{get:r,set:a}=Object.getOwnPropertyDescriptor(s,e);Object.defineProperty(t,e,{get:n(r),set:i(a)})},Fe=t=>{const e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},qe=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},ze=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},Ge=(t,e)=>{const n=e.createGain();t.connect(n);const i=(e=>()=>{e.call(t,n),t.removeEventListener("ended",i)})(t.disconnect);t.addEventListener("ended",i),Se(t,n),t.stop=(e=>{let i=!1;return(s=0)=>{if(i)try{e.call(t,s)}catch{n.gain.setValueAtTime(0,s)}else e.call(t,s),i=!0}})(t.stop)},je=(t,e)=>n=>{const i={value:t};return Object.defineProperties(n,{currentTarget:i,target:i}),"function"==typeof e?e.call(t,n):e.handleEvent.call(t,n)},We=(t=>(e,n,[i,s,r],a)=>{t(e[s],[n,i,r],(t=>t[0]===n&&t[1]===i),a)})(Et),Ye=(t=>(e,n,[i,s,r],a)=>{const o=e.get(i);void 0===o?e.set(i,new Set([[s,n,r]])):t(o,[s,n,r],(t=>t[0]===s&&t[1]===n),a)})(Et),Ue=(t=>(e,n,i,s)=>t(e[s],(t=>t[0]===n&&t[1]===i)))(rt),Xe=new WeakMap,$e=(t=>e=>{var n;return null!==(n=t.get(e))&&void 0!==n?n:0})(Xe),Ze=(Ke=new Map,Qe=new WeakMap,(t,e)=>{const n=Qe.get(t);if(void 0!==n)return n;const i=Ke.get(t);if(void 0!==i)return i;try{const n=e();return n instanceof Promise?(Ke.set(t,n),n.catch((()=>!1)).then((e=>(Ke.delete(t),Qe.set(t,e),e)))):(Qe.set(t,n),n)}catch{return Qe.set(t,!1),!1}});var Ke,Qe;const Je="undefined"==typeof window?null:window,tn=((t,e)=>(n,i)=>{const s=n.createAnalyser();if(ge(s,i),!(i.maxDecibels>i.minDecibels))throw e();return me(s,i,"fftSize"),me(s,i,"maxDecibels"),me(s,i,"minDecibels"),me(s,i,"smoothingTimeConstant"),t(ve,(()=>ve(s)))||(t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const i=Math.max(n.length,t.fftSize);for(let t=0;t<i;t+=1)e[t]=.0078125*(n[t]-128);return e}})(s),s})(Ze,mt),en=(t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer})(xt),nn=((t,e,n)=>async(i,s,r,a)=>{const o=t(i),c=[...a,i];await Promise.all(o.activeInputs.map(((t,a)=>Array.from(t).filter((([t])=>!c.includes(t))).map((async([t,o])=>{const l=e(t),h=await l.render(t,s,c),u=i.context.destination;n(t)||i===u&&n(i)||h.connect(r,o,a)})))).reduce(((t,e)=>[...t,...e]),[]))})(xt,en,Ht),sn=((t,e,n)=>()=>{const i=new WeakMap;return{render(s,r,a){const o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r,a)=>{let o=e(s);if(!pt(o,r)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,fftSize:o.fftSize,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant};o=t(r,e)}return i.set(r,o),await n(s,r,o,a),o})(s,r,a)}}})(tn,Lt,nn),rn=(an=X,t=>{const e=an.get(t);if(void 0===e)throw le();return e});var an;const on=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(Je),cn=(t=>e=>null!==t&&e instanceof t)(on),ln=new WeakMap,hn=(t=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(e,n,i){if(null!==n){let s=this._listeners.get(n);void 0===s&&(s=t(this,n),"function"==typeof n&&this._listeners.set(n,s)),this._nativeEventTarget.addEventListener(e,s,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,n){const i=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===i?null:i,n)}})(je),un=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(Je),dn=(t=>e=>null!==t&&e instanceof t)(un),pn=(t=>e=>null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode)(Je),fn=(t=>e=>null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam)(Je),mn=((t,e,n,i,s,r,a,o,c,l,h,u,d,p,f)=>class extends l{constructor(e,i,s,r){super(s),this._context=e,this._nativeAudioNode=s;const a=h(e);u(a)&&!0!==n(qt,(()=>qt(a)))&&jt(s),W.set(this,s),$.set(this,new Set),"closed"!==e.state&&i&&ct(this),t(this,r,s)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t,n=0,o=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw s();const l=h(this._context),u=f(l);if(d(t)||p(t))throw r();if(Ct(t)){const s=Lt(t);try{const e=Ot(this._nativeAudioNode,s,n,o),i=Ft(this);(u||i)&&this._nativeAudioNode.disconnect(...e),"closed"!==this.context.state&&!i&&Ft(t)&&ct(t)}catch(t){if(12===t.code)throw r();throw t}if(e(this,t,n,o,u)){const e=c([this],t);zt(e,i(u))}return t}const m=Vt(t);if("playbackRate"===m.name)throw a();try{this._nativeAudioNode.connect(m,n),(u||Ft(this))&&this._nativeAudioNode.disconnect(m,n)}catch(t){if(12===t.code)throw r();throw t}if(Wt(this,t,n,u)){const e=c([this],t);zt(e,i(u))}}disconnect(t,e,n){let i;const a=h(this._context),l=f(a);if(void 0===t)i=((t,e)=>{const n=xt(t),i=[];for(const s of n.outputs)At(s)?Yt(t,e,...s):Ut(t,e,...s),i.push(s[0]);return n.outputs.clear(),i})(this,l);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw s();i=((t,e,n)=>{const i=xt(t),s=[];for(const r of i.outputs)r[1]===n&&(At(r)?Yt(t,e,...r):Ut(t,e,...r),s.push(r[0]),i.outputs.delete(r));return s})(this,l,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw s();if(Ct(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw s();if(i=((t,e,n,i,s)=>{const r=xt(t);return Array.from(r.outputs).filter((t=>!(t[0]!==n||void 0!==i&&t[1]!==i||void 0!==s&&t[2]!==s))).map((n=>(At(n)?Yt(t,e,...n):Ut(t,e,...n),r.outputs.delete(n),n[0])))})(this,l,t,e,n),0===i.length)throw r()}for(const t of i){const e=c([this],t);zt(e,o)}}})((gn=j,(t,e,n)=>{const i=[];for(let t=0;t<n.numberOfInputs;t+=1)i.push(new Set);gn.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),((t,e,n,i,s,r,a,o,c,l,h,u,d)=>(p,f,m,g,v)=>{const{activeInputs:b,passiveInputs:_}=r(f),{outputs:y}=r(p),w=o(p),x=r=>{const o=c(f),l=c(p);if(r){const e=at(_,p,m,g);t(b,p,e,!1),v||u(p)||n(l,o,m,g),d(f)&&ct(f)}else{const t=i(b,p,m,g);e(_,g,t,!1),v||u(p)||s(l,o,m,g);const n=a(f);0===n?h(f)&&ut(f,b):setTimeout((()=>{h(f)&&ut(f,b)}),1e3*n)}};return!!l(y,[f,m,g],(t=>t[0]===f&&t[1]===m&&t[2]===g),!0)&&(w.add(x),h(p)?t(b,p,[m,g,x],!0):e(_,g,[p,m,x],!0),!0)})(We,Ye,Ot,Ue,Rt,xt,$e,ot,Lt,Et,yt,Ht,Ft),Ze,((t,e,n,i,s,r)=>a=>(o,c)=>{const l=t.get(o);if(void 0===l){if(!a&&r(o)){const t=i(o),{outputs:r}=n(o);for(const n of r)if(At(n)){const s=i(n[0]);e(t,s,n[1],n[2])}else{const e=s(n[0]);t.disconnect(e,n[1])}}t.set(o,c)}else t.set(o,l+c)})(Z,Rt,xt,Lt,Vt,yt),mt,he,Ie,((t,e,n,i,s,r,a,o)=>(c,l)=>{const h=e.get(c);if(void 0===h)throw new Error("Missing the expected cycle count.");const u=r(c.context),d=o(u);if(h===l){if(e.delete(c),!d&&a(c)){const e=i(c),{outputs:r}=n(c);for(const n of r)if(At(n)){const s=i(n[0]);t(e,s,n[1],n[2])}else{const t=s(n[0]);e.connect(t,n[1])}}}else e.set(c,h-l)})(Ot,Z,xt,Lt,Vt,rn,yt,cn),((t,e,n)=>function i(s,r){const a=Ct(r)?r:n(t,r);if((t=>"delayTime"in t)(a))return[];if(s[0]===a)return[s];if(s.includes(a))return[];const{outputs:o}=e(a);return Array.from(o).map((t=>i([...s,a],t[0]))).reduce(((t,e)=>t.concat(e)),[])})(ln,xt,st),hn,rn,dn,pn,fn,cn);var gn;const vn=((t,e,n,i,s,r)=>class extends t{constructor(t,n){const a=s(t),o={...dt,...n},c=i(a,o);super(t,!1,c,r(a)?e():null),this._nativeAnalyserNode=c}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){const e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){const e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}})(mn,sn,mt,tn,rn,cn),bn=new WeakSet,_n=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(Je),yn=(wn=new Uint32Array(1),t=>(wn[0]=t,wn[0]));var wn;const xn=((t,e)=>n=>{n.copyFromChannel=(i,s,r=0)=>{const a=t(r),o=t(s);if(o>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(o),h=i.length;for(let t=a<0?-a:0;t+a<c&&t<h;t+=1)i[t]=l[t+a]},n.copyToChannel=(i,s,r=0)=>{const a=t(r),o=t(s);if(o>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(o),h=i.length;for(let t=a<0?-a:0;t+a<c&&t<h;t+=1)l[t+a]=i[t]}})(yn,mt),kn=(t=>e=>{e.copyFromChannel=(n=>(i,s,r=0)=>{const a=t(r),o=t(s);if(a<e.length)return n.call(e,i,o,a)})(e.copyFromChannel),e.copyToChannel=(n=>(i,s,r=0)=>{const a=t(r),o=t(s);if(a<e.length)return n.call(e,i,o,a)})(e.copyToChannel)})(yn),Tn=((t,e,n,i,s,r,a,o)=>{let c=null;return class l{constructor(l){if(null===s)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:h,numberOfChannels:u,sampleRate:d}={...vt,...l};null===c&&(c=new s(1,1,44100));const p=null!==i&&e(r,r)?new i({length:h,numberOfChannels:u,sampleRate:d}):c.createBuffer(u,h,d);if(0===p.numberOfChannels)throw n();return"function"!=typeof p.copyFromChannel?(a(p),gt(p)):e(ft,(()=>ft(p)))||o(p),t.add(p),p}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===l.prototype||t.has(e)}}})(bn,Ze,Ie,_n,on,(t=>()=>{if(null===t)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0})(_n),xn,kn),Sn=(t=>(e,n)=>{const i=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(i).connect(e.destination);const s=()=>{n.removeEventListener("ended",s),n.disconnect(i),i.disconnect()};n.addEventListener("ended",s)})(Ae),Cn=((t,e,n)=>async(i,s,r,a)=>{const o=e(i);await Promise.all(Array.from(o.activeInputs).map((async([e,i])=>{const o=t(e),c=await o.render(e,s,a);n(e)||c.connect(r,i)})))})(en,kt,Ht),An=(t=>(e,n,i,s)=>t(n,e,i,s))(Cn),En=((t,e,n,i,s,r,a,o,c,l,h)=>(u,d)=>{const p=u.createBufferSource();return ge(p,d),be(p,d,"playbackRate"),me(p,d,"buffer"),me(p,d,"loop"),me(p,d,"loopEnd"),me(p,d,"loopStart"),e(n,(()=>n(u)))||(t=>{t.start=(e=>{let n=!1;return(i=0,s=0,r)=>{if(n)throw le();e.call(t,i,s,r),n=!0}})(t.start)})(p),e(i,(()=>i(u)))||c(p),e(s,(()=>s(u)))||l(p,u),e(r,(()=>r(u)))||_e(p),e(a,(()=>a(u)))||h(p,u),e(o,(()=>o(u)))||ye(p),t(u,p),p})(Sn,Ze,(t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1}),(t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0}),(t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0}),Fe,qe,ze,(t=>{var e;t.start=(e=t.start,(n=0,i=0,s)=>{const r=t.buffer,a=null===r?i:Math.min(r.duration,i);null!==r&&a>r.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,a,s)})}),(t=>(e,n)=>{const i=n.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=i),t(e,"buffer",(t=>()=>{const n=t.call(e);return n===i?null:n}),(t=>n=>t.call(e,null===n?i:n)))})(He),Ge),Mn=((t,e)=>(n,i,s,r)=>(t(i).replay(s),e(i,n,s,r)))((t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer})(kt),Cn),Nn=((t,e,n,i,s)=>()=>{const r=new WeakMap;let a=null,o=null;return{set start(t){a=t},set stop(t){o=t},render(c,l,h){const u=r.get(l);return void 0!==u?Promise.resolve(u):(async(c,l,h)=>{let u=n(c);const d=pt(u,l);if(!d){const t={buffer:u.buffer,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,loop:u.loop,loopEnd:u.loopEnd,loopStart:u.loopStart,playbackRate:u.playbackRate.value};u=e(l,t),null!==a&&u.start(...a),null!==o&&u.stop(o)}return r.set(l,u),d?await t(l,c.playbackRate,u.playbackRate,h):await i(l,c.playbackRate,u.playbackRate,h),await s(c,l,u,h),u})(c,l,h)}}})(An,En,Lt,Mn,nn),In=((t,e,n,i,s,r,a,o,c,l,h,u)=>(d,p,f,m=null,g=null)=>{const v=new z.AutomationEventList(f.defaultValue),b=p?i(v):null,_={get defaultValue(){return f.defaultValue},get maxValue(){return null===m?f.maxValue:m},get minValue(){return null===g?f.minValue:g},get value(){return f.value},set value(t){f.value=t,_.setValueAtTime(t,d.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof f.cancelAndHoldAtTime)null===b&&v.flush(d.context.currentTime),v.add(s(t)),f.cancelAndHoldAtTime(t);else{const e=Array.from(v).pop();null===b&&v.flush(d.context.currentTime),v.add(s(t));const n=Array.from(v).pop();f.cancelScheduledValues(t),e!==n&&void 0!==n&&("exponentialRampToValue"===n.type?f.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?f.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?f.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&f.setValueCurveAtTime(n.values,n.startTime,n.duration))}return _},cancelScheduledValues:t=>(null===b&&v.flush(d.context.currentTime),v.add(r(t)),f.cancelScheduledValues(t),_),exponentialRampToValueAtTime(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;return null===b&&v.flush(d.context.currentTime),v.add(a(t,e)),f.exponentialRampToValueAtTime(t,e),_},linearRampToValueAtTime:(t,e)=>(null===b&&v.flush(d.context.currentTime),v.add(o(t,e)),f.linearRampToValueAtTime(t,e),_),setTargetAtTime:(t,e,n)=>(null===b&&v.flush(d.context.currentTime),v.add(c(t,e,n)),f.setTargetAtTime(t,e,n),_),setValueAtTime:(t,e)=>(null===b&&v.flush(d.context.currentTime),v.add(l(t,e)),f.setValueAtTime(t,e),_),setValueCurveAtTime(t,e,n){const i=t instanceof Float32Array?t:new Float32Array(t);if(null!==u&&"webkitAudioContext"===u.name){const t=e+n,s=d.context.sampleRate,r=Math.ceil(e*s),a=Math.floor(t*s),o=a-r,c=new Float32Array(o);for(let t=0;t<o;t+=1){const a=(i.length-1)/n*((r+t)/s-e),o=Math.floor(a),l=Math.ceil(a);c[t]=o===l?i[o]:(1-(a-o))*i[o]+(1-(l-a))*i[l]}null===b&&v.flush(d.context.currentTime),v.add(h(c,e,n)),f.setValueCurveAtTime(c,e,n);const l=a/s;l<t&&_.setValueAtTime(c[c.length-1],l),_.setValueAtTime(i[i.length-1],t)}else null===b&&v.flush(d.context.currentTime),v.add(h(i,e,n)),f.setValueCurveAtTime(i,e,n);return _}};return n.set(_,f),e.set(_,d),t(_,b),_})((On=Y,(t,e)=>{On.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),ln,U,(t=>({replay(e){for(const n of t)if("exponentialRampToValue"===n.type){const{endTime:t,value:i}=n;e.exponentialRampToValueAtTime(i,t)}else if("linearRampToValue"===n.type){const{endTime:t,value:i}=n;e.linearRampToValueAtTime(i,t)}else if("setTarget"===n.type){const{startTime:t,target:i,timeConstant:s}=n;e.setTargetAtTime(i,t,s)}else if("setValue"===n.type){const{startTime:t,value:i}=n;e.setValueAtTime(i,t)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:t,startTime:i,values:s}=n;e.setValueCurveAtTime(s,i,t)}}}})),z.createCancelAndHoldAutomationEvent,z.createCancelScheduledValuesAutomationEvent,z.createExponentialRampToValueAutomationEvent,z.createLinearRampToValueAutomationEvent,z.createSetTargetAutomationEvent,z.createSetValueAutomationEvent,z.createSetValueCurveAutomationEvent,un);var On;const Pn=((t,e,n,i,s,r,a,o)=>class extends t{constructor(t,i){const o=r(t),c={...wt,...i},l=s(o,c),h=a(o),u=h?e():null;super(t,!1,l,u),this._audioBufferSourceNodeRenderer=u,this._isBufferNullified=!1,this._isBufferSet=null!==c.buffer,this._nativeAudioBufferSourceNode=l,this._onended=null,this._playbackRate=n(this,h,l.playbackRate,_t,bt)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw i();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get onended(){return this._onended}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeAudioBufferSourceNode.onended=e;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===e?t:n}get playbackRate(){return this._playbackRate}start(t=0,e=0,n){if(this._nativeAudioBufferSourceNode.start(t,e,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[t,e]:[t,e,n]),"closed"!==this.context.state){ct(this);const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),yt(this)&&ht(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}})(mn,Nn,In,le,En,rn,cn,je),Dn=((t,e,n,i,s,r,a,o)=>class extends t{constructor(t,n){const i=r(t),c=a(i),l=s(i,n,c);super(t,!1,l,c?e(o):null),this._isNodeOfNativeOfflineAudioContext=c,this._nativeAudioDestinationNode=l}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(mn,(t=>{let e=null;return{render:(n,i,s)=>(null===e&&(e=(async(e,n,i)=>{const s=n.destination;return await t(e,n,s,i),s})(n,i,s)),e)}}),mt,le,((t,e)=>(n,i,s)=>{const r=n.destination;if(r.channelCount!==i)try{r.channelCount=i}catch{}s&&"explicit"!==r.channelCountMode&&(r.channelCountMode="explicit"),0===r.maxChannelCount&&Object.defineProperty(r,"maxChannelCount",{value:i});const a=t(n,{channelCount:i,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,gain:1});return e(a,"channelCount",(t=>()=>t.call(a)),(t=>e=>{t.call(a,e);try{r.channelCount=e}catch(t){if(e>r.maxChannelCount)throw t}})),e(a,"channelCountMode",(t=>()=>t.call(a)),(t=>e=>{t.call(a,e),r.channelCountMode=e})),e(a,"channelInterpretation",(t=>()=>t.call(a)),(t=>e=>{t.call(a,e),r.channelInterpretation=e})),Object.defineProperty(a,"maxChannelCount",{get:()=>r.maxChannelCount}),a.connect(r),a})(Ae,He),rn,cn,nn),Bn=((t,e,n,i,s)=>()=>{const r=new WeakMap;return{render(a,o,c){const l=r.get(o);return void 0!==l?Promise.resolve(l):(async(a,o,c)=>{let l=n(a);const h=pt(l,o);if(!h){const t={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(o,t)}return r.set(o,l),h?(await t(o,a.Q,l.Q,c),await t(o,a.detune,l.detune,c),await t(o,a.frequency,l.frequency,c),await t(o,a.gain,l.gain,c)):(await i(o,a.Q,l.Q,c),await i(o,a.detune,l.detune,c),await i(o,a.frequency,l.frequency,c),await i(o,a.gain,l.gain,c)),await s(a,o,l,c),l})(a,o,c)}}})(An,ke,Lt,Mn,nn),Rn=(t=>(e,n)=>t.set(e,n))(Xe),Ln=((t,e,n,i,s,r,a,o)=>class extends t{constructor(t,i){const c=r(t),l={...te,...i},h=s(c,l),u=a(c);super(t,!1,h,u?n():null),this._Q=e(this,u,h.Q,_t,bt),this._detune=e(this,u,h.detune,1200*Math.log2(_t),-1200*Math.log2(_t)),this._frequency=e(this,u,h.frequency,t.sampleRate/2,0),this._gain=e(this,u,h.gain,40*Math.log10(_t),bt),this._nativeBiquadFilterNode=h,o(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,n){if(this._nativeBiquadFilterNode.getFrequencyResponse(t,e,n),t.length!==e.length||e.length!==n.length)throw i()}})(mn,In,Bn,he,ke,rn,cn,Rn),Vn=((t,e)=>(n,i,s)=>{const r=new Set;return n.connect=(s=>(a,o=0,c=0)=>{const l=0===r.size;if(e(a))return s.call(n,a,o,c),t(r,[a,o,c],(t=>t[0]===a&&t[1]===o&&t[2]===c),!0),l&&i(),a;s.call(n,a,o),t(r,[a,o],(t=>t[0]===a&&t[1]===o),!0),l&&i()})(n.connect),n.disconnect=(t=>(i,a,o)=>{const c=r.size>0;if(void 0===i)t.apply(n),r.clear();else if("number"==typeof i){t.call(n,i);for(const t of r)t[1]===i&&r.delete(t)}else{e(i)?t.call(n,i,a,o):t.call(n,i,a);for(const t of r)t[0]!==i||void 0!==a&&t[1]!==a||void 0!==o&&t[2]!==o||r.delete(t)}const l=0===r.size;c&&l&&s()})(n.disconnect),n})(Et,pn),Hn=((t,e)=>(n,i)=>{const s=n.createChannelMerger(i.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(n,s),ge(s,i),s})(un,((t,e)=>(n,i)=>{i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const s=n.createBufferSource();e(i,(()=>{const t=i.numberOfInputs;for(let e=0;e<t;e+=1)s.connect(i,0,e)}),(()=>s.disconnect(i)))})(le,Vn)),Fn=((t,e,n,i,s)=>class extends t{constructor(t,r){const a=i(t),o={...ee,...r};super(t,!1,n(a,o),s(a)?e():null)}})(mn,((t,e,n)=>()=>{const i=new WeakMap;return{render(s,r,a){const o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r,a)=>{let o=e(s);if(!pt(o,r)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs};o=t(r,e)}return i.set(r,o),await n(s,r,o,a),o})(s,r,a)}}})(Hn,Lt,nn),Hn,rn,cn),qn=((t,e,n,i,s,r)=>class extends t{constructor(t,a){const o=i(t),c=r({...ne,...a});super(t,!1,n(o,c),s(o)?e():null)}})(mn,((t,e,n)=>()=>{const i=new WeakMap;return{render(s,r,a){const o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r,a)=>{let o=e(s);if(!pt(o,r)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfOutputs:o.numberOfOutputs};o=t(r,e)}return i.set(r,o),await n(s,r,o,a),o})(s,r,a)}}})(Te,Lt,nn),Te,rn,cn,(t=>({...t,channelCount:t.numberOfOutputs}))),zn=((t,e,n,i)=>(s,{offset:r,...a})=>{const o=s.createBuffer(1,2,44100),c=e(s,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(s,{...a,gain:r}),h=o.getChannelData(0);h[0]=1,h[1]=1,c.buffer=o,c.loop=!0;const u={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(t){l.channelCount=t},get channelCountMode(){return l.channelCountMode},set channelCountMode(t){l.channelCountMode=t},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(t){c.onended=t},addEventListener:(...t)=>c.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>c.dispatchEvent(t[0]),removeEventListener:(...t)=>c.removeEventListener(t[0],t[1],t[2]),start(t=0){c.start.call(c,t)},stop(t=0){c.stop.call(c,t)}};return t(s,c),i(Se(u,l),(()=>c.connect(l)),(()=>c.disconnect(l)))})(Sn,En,Ae,Vn),Gn=((t,e,n,i,s)=>(r,a)=>{if(void 0===r.createConstantSource)return n(r,a);const o=r.createConstantSource();return ge(o,a),be(o,a,"offset"),e(i,(()=>i(r)))||_e(o),e(s,(()=>s(r)))||ye(o),t(r,o),o})(Sn,Ze,zn,Fe,ze),jn=((t,e,n,i,s,r,a)=>class extends t{constructor(t,a){const o=s(t),c={...ie,...a},l=i(o,c),h=r(o),u=h?n():null;super(t,!1,l,u),this._constantSourceNodeRenderer=u,this._nativeConstantSourceNode=l,this._offset=e(this,h,l.offset,_t,bt),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){const e="function"==typeof t?a(this,t):null;this._nativeConstantSourceNode.onended=e;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===e?t:n}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){ct(this);const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),yt(this)&&ht(this)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}})(mn,In,((t,e,n,i,s)=>()=>{const r=new WeakMap;let a=null,o=null;return{set start(t){a=t},set stop(t){o=t},render(c,l,h){const u=r.get(l);return void 0!==u?Promise.resolve(u):(async(c,l,h)=>{let u=n(c);const d=pt(u,l);if(!d){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,offset:u.offset.value};u=e(l,t),null!==a&&u.start(a),null!==o&&u.stop(o)}return r.set(l,u),d?await t(l,c.offset,u.offset,h):await i(l,c.offset,u.offset,h),await s(c,l,u,h),u})(c,l,h)}}})(An,Gn,Lt,Mn,nn),Gn,rn,cn,je),Wn=((t,e)=>(n,i)=>{const s=n.createConvolver();if(ge(s,i),i.disableNormalization===s.normalize&&(s.normalize=!i.disableNormalization),me(s,i,"buffer"),i.channelCount>2)throw t();if(e(s,"channelCount",(t=>()=>t.call(s)),(e=>n=>{if(n>2)throw t();return e.call(s,n)})),"max"===i.channelCountMode)throw t();return e(s,"channelCountMode",(t=>()=>t.call(s)),(e=>n=>{if("max"===n)throw t();return e.call(s,n)})),s})(Ie,He),Yn=((t,e,n,i,s,r)=>class extends t{constructor(t,a){const o=i(t),c={...se,...a},l=n(o,c);super(t,!1,l,s(o)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=l,null!==c.buffer&&r(this,c.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,44100),this._isBufferNullified=!0,r(this,0)}else this._isBufferNullified=!1,r(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}})(mn,((t,e,n)=>()=>{const i=new WeakMap;return{render(s,r,a){const o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r,a)=>{let o=e(s);if(!pt(o,r)){const e={buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,disableNormalization:!o.normalize};o=t(r,e)}return i.set(r,o),It(o)?await n(s,r,o.inputs[0],a):await n(s,r,o,a),o})(s,r,a)}}})(Wn,Lt,nn),Wn,rn,cn,Rn),Un=((t,e,n,i,s,r,a)=>class extends t{constructor(t,o){const c=s(t),l={...re,...o},h=i(c,l),u=r(c);super(t,!1,h,u?n(l.maxDelayTime):null),this._delayTime=e(this,u,h.delayTime),a(this,l.maxDelayTime)}get delayTime(){return this._delayTime}})(mn,In,((t,e,n,i,s)=>r=>{const a=new WeakMap;return{render(o,c,l){const h=a.get(c);return void 0!==h?Promise.resolve(h):(async(o,c,l)=>{let h=n(o);const u=pt(h,c);if(!u){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,delayTime:h.delayTime.value,maxDelayTime:r};h=e(c,t)}return a.set(c,h),u?await t(c,o.delayTime,h.delayTime,l):await i(c,o.delayTime,h.delayTime,l),await s(o,c,h,l),h})(o,c,l)}}})(An,Ce,Lt,Mn,nn),Ce,rn,cn,Rn),Xn=(t=>(e,n)=>{const i=e.createDynamicsCompressor();if(ge(i,n),n.channelCount>2)throw t();if("max"===n.channelCountMode)throw t();return be(i,n,"attack"),be(i,n,"knee"),be(i,n,"ratio"),be(i,n,"release"),be(i,n,"threshold"),i})(Ie),$n=((t,e,n,i,s,r,a,o)=>class extends t{constructor(t,s){const c=r(t),l={...oe,...s},h=i(c,l),u=a(c);super(t,!1,h,u?n():null),this._attack=e(this,u,h.attack),this._knee=e(this,u,h.knee),this._nativeDynamicsCompressorNode=h,this._ratio=e(this,u,h.ratio),this._release=e(this,u,h.release),this._threshold=e(this,u,h.threshold),o(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,s()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,s()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(mn,In,((t,e,n,i,s)=>()=>{const r=new WeakMap;return{render(a,o,c){const l=r.get(o);return void 0!==l?Promise.resolve(l):(async(a,o,c)=>{let l=n(a);const h=pt(l,o);if(!h){const t={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(o,t)}return r.set(o,l),h?(await t(o,a.attack,l.attack,c),await t(o,a.knee,l.knee,c),await t(o,a.ratio,l.ratio,c),await t(o,a.release,l.release,c),await t(o,a.threshold,l.threshold,c)):(await i(o,a.attack,l.attack,c),await i(o,a.knee,l.knee,c),await i(o,a.ratio,l.ratio,c),await i(o,a.release,l.release,c),await i(o,a.threshold,l.threshold,c)),await s(a,o,l,c),l})(a,o,c)}}})(An,Xn,Lt,Mn,nn),Xn,Ie,rn,cn,Rn),Zn=((t,e,n,i,s,r)=>class extends t{constructor(t,a){const o=s(t),c={...ce,...a},l=i(o,c),h=r(o);super(t,!1,l,h?n():null),this._gain=e(this,h,l.gain,_t,bt)}get gain(){return this._gain}})(mn,In,((t,e,n,i,s)=>()=>{const r=new WeakMap;return{render(a,o,c){const l=r.get(o);return void 0!==l?Promise.resolve(l):(async(a,o,c)=>{let l=n(a);const h=pt(l,o);if(!h){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(o,t)}return r.set(o,l),h?await t(o,a.gain,l.gain,c):await i(o,a.gain,l.gain,c),await s(a,o,l,c),l})(a,o,c)}}})(An,Ae,Lt,Mn,nn),Ae,rn,cn),Kn=((t,e,n,i)=>(s,r,{channelCount:a,channelCountMode:o,channelInterpretation:c,feedback:l,feedforward:h})=>{const u=we(r,s.sampleRate),d=l instanceof Float64Array?l:new Float64Array(l),p=h instanceof Float64Array?h:new Float64Array(h),f=d.length,m=p.length,g=Math.min(f,m);if(0===f||f>20)throw i();if(0===d[0])throw e();if(0===m||m>20)throw i();if(0===p[0])throw e();if(1!==d[0]){for(let t=0;t<m;t+=1)p[t]/=d[0];for(let t=1;t<f;t+=1)d[t]/=d[0]}const v=n(s,u,a,a);v.channelCount=a,v.channelCountMode=o,v.channelInterpretation=c;const b=[],_=[],y=[];for(let t=0;t<a;t+=1){b.push(0);const t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),_.push(t),y.push(e)}v.onaudioprocess=t=>{const e=t.inputBuffer,n=t.outputBuffer,i=e.numberOfChannels;for(let t=0;t<i;t+=1){const i=e.getChannelData(t),s=n.getChannelData(t);b[t]=de(d,f,p,m,g,_[t],y[t],b[t],32,i,s)}};const w=s.sampleRate/2;return Se({get bufferSize(){return u},get channelCount(){return v.channelCount},set channelCount(t){v.channelCount=t},get channelCountMode(){return v.channelCountMode},set channelCountMode(t){v.channelCountMode=t},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(t){v.channelInterpretation=t},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},addEventListener:(...t)=>v.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>v.dispatchEvent(t[0]),getFrequencyResponse(e,n,i){if(e.length!==n.length||n.length!==i.length)throw t();const s=e.length;for(let t=0;t<s;t+=1){const s=-Math.PI*(e[t]/w),r=[Math.cos(s),Math.sin(s)],a=Ee(Me(p,r),Me(d,r));n[t]=Math.sqrt(a[0]*a[0]+a[1]*a[1]),i[t]=Math.atan2(a[1],a[0])}},removeEventListener:(...t)=>v.removeEventListener(t[0],t[1],t[2])},v)})(he,le,Ne,Ie),Qn=((t,e,n,i)=>s=>t(fe,(()=>fe(s)))?Promise.resolve(t(i,i)).then((t=>{if(!t){const t=n(s,512,0,1);s.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>s.currentTime,t.connect(s.destination)}return s.startRendering()})):new Promise((t=>{const n=e(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});s.oncomplete=e=>{n.disconnect(),t(e.renderedBuffer)},n.connect(s.destination),s.startRendering()})))(Ze,Ae,Ne,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);const n=new e(1,1,44100),i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((t=>{n.oncomplete=()=>{i.disconnect(),t(0!==n.currentTime)},n.startRendering()}))})(Ae,on)),Jn=((t,e,n,i,s)=>(r,a)=>{const o=new WeakMap;let c=null;const l=async(l,h,u)=>{let d=null,p=e(l);const f=pt(p,h);if(void 0===h.createIIRFilter?d=t(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):f||(p=h.createIIRFilter(a,r)),o.set(h,null===d?p:d),null!==d){if(null===c){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new n(l.context.destination.channelCount,l.context.length,h.sampleRate);c=(async()=>{await i(l,t,t.destination,u);return((t,e,n,i)=>{const s=n instanceof Float64Array?n:new Float64Array(n),r=i instanceof Float64Array?i:new Float64Array(i),a=s.length,o=r.length,c=Math.min(a,o);if(1!==s[0]){for(let t=0;t<a;t+=1)r[t]/=s[0];for(let t=1;t<o;t+=1)s[t]/=s[0]}const l=new Float32Array(32),h=new Float32Array(32),u=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),d=t.numberOfChannels;for(let e=0;e<d;e+=1){const n=t.getChannelData(e),i=u.getChannelData(e);l.fill(0),h.fill(0),de(s,a,r,o,c,l,h,0,32,n,i)}return u})(await s(t),h,r,a)})()}const t=await c;return d.buffer=t,d.start(0),d}return await i(l,h,p,u),p};return{render(t,e,n){const i=o.get(e);return void 0!==i?Promise.resolve(i):l(t,e,n)}}})(En,Lt,on,nn,Qn),ti=((t,e,n,i,s,r)=>class extends t{constructor(t,a){const o=i(t),c=s(o),l={...ue,...a},h=e(o,c?null:t.baseLatency,l);super(t,!1,h,c?n(l.feedback,l.feedforward):null),(t=>{var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,(n,i,s)=>{if(n.length!==i.length||i.length!==s.length)throw he();return e.call(t,n,i,s)})})(h),this._nativeIIRFilterNode=h,r(this,1)}getFrequencyResponse(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n)}})(mn,(t=>(e,n,i)=>{if(void 0===e.createIIRFilter)return t(e,n,i);const s=e.createIIRFilter(i.feedforward,i.feedback);return ge(s,i),s})(Kn),Jn,rn,cn,Rn),ei=((t,e,n,i,s)=>(r,a)=>{const o=a.listener,{forwardX:c,forwardY:l,forwardZ:h,positionX:u,positionY:d,positionZ:p,upX:f,upY:m,upZ:g}=void 0===o.forwardX?(()=>{const c=e(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),l=s(a),h=i(a,256,9,0),u=(e,i)=>{const s=n(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i});return s.connect(c,0,e),s.start(),Object.defineProperty(s.offset,"defaultValue",{get:()=>i}),t({context:r},l,s.offset,_t,bt)};let d=[0,0,-1,0,1,0],p=[0,0,0];return h.onaudioprocess=({inputBuffer:t})=>{const e=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0],t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];e.some(((t,e)=>t!==d[e]))&&(o.setOrientation(...e),d=e);const n=[t.getChannelData(6)[0],t.getChannelData(7)[0],t.getChannelData(8)[0]];n.some(((t,e)=>t!==p[e]))&&(o.setPosition(...n),p=n)},c.connect(h),{forwardX:u(0,0),forwardY:u(1,0),forwardZ:u(2,-1),positionX:u(6,0),positionY:u(7,0),positionZ:u(8,0),upX:u(3,0),upY:u(4,1),upZ:u(5,0)}})():o;return{get forwardX(){return c},get forwardY(){return l},get forwardZ(){return h},get positionX(){return u},get positionY(){return d},get positionZ(){return p},get upX(){return f},get upY(){return m},get upZ(){return g}}})(In,Hn,Gn,Ne,cn),ni=new WeakMap,ii=((t,e,n,i,s,r)=>class extends n{constructor(n,r){super(n),this._nativeContext=n,X.set(this,n),i(n)&&s.set(n,new Set),this._destination=new t(this,r),this._listener=e(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){const e="function"==typeof t?r(this,t):null;this._nativeContext.onstatechange=e;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===e?t:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(Dn,ei,hn,cn,ni,je),si=((t,e,n,i,s,r)=>(a,o)=>{const c=a.createOscillator();return ge(c,o),be(c,o,"detune"),be(c,o,"frequency"),void 0!==o.periodicWave?c.setPeriodicWave(o.periodicWave):me(c,o,"type"),e(n,(()=>n(a)))||_e(c),e(i,(()=>i(a)))||r(c,a),e(s,(()=>s(a)))||ye(c),t(a,c),c})(Sn,Ze,Fe,qe,ze,Ge),ri=((t,e,n,i,s)=>()=>{const r=new WeakMap;let a=null,o=null,c=null;return{set periodicWave(t){a=t},set start(t){o=t},set stop(t){c=t},render(l,h,u){const d=r.get(h);return void 0!==d?Promise.resolve(d):(async(l,h,u)=>{let d=n(l);const p=pt(d,h);if(!p){const t={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,periodicWave:null===a?void 0:a,type:d.type};d=e(h,t),null!==o&&d.start(o),null!==c&&d.stop(c)}return r.set(h,d),p?(await t(h,l.detune,d.detune,u),await t(h,l.frequency,d.frequency,u)):(await i(h,l.detune,d.detune,u),await i(h,l.frequency,d.frequency,u)),await s(l,h,d,u),d})(l,h,u)}}})(An,si,Lt,Mn,nn),ai=((t,e,n,i,s,r,a)=>class extends t{constructor(t,a){const o=s(t),c={...Pe,...a},l=n(o,c),h=r(o),u=h?i():null,d=t.sampleRate/2;super(t,!1,l,u),this._detune=e(this,h,l.detune,153600,-153600),this._frequency=e(this,h,l.frequency,d,-d),this._nativeOscillatorNode=l,this._onended=null,this._oscillatorNodeRenderer=u,null!==this._oscillatorNodeRenderer&&void 0!==c.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=c.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){const e="function"==typeof t?a(this,t):null;this._nativeOscillatorNode.onended=e;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===e?t:n}get type(){return this._nativeOscillatorNode.type}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){ct(this);const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),yt(this)&&ht(this)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}})(mn,In,si,ri,rn,cn,je),oi=(t=>(e,n)=>{const i=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),s=e.createBuffer(1,2,44100);return i.buffer=s,i.loop=!0,i.connect(n),i.start(),()=>{i.stop(),i.disconnect(n)}})(En),ci=((t,e,n,i,s)=>(r,{curve:a,oversample:o,...c})=>{const l=r.createWaveShaper(),h=r.createWaveShaper();ge(l,c),ge(h,c);const u=n(r,{...c,gain:1}),d=n(r,{...c,gain:-1}),p=n(r,{...c,gain:1}),f=n(r,{...c,gain:-1});let m=null,g=!1,v=null;const b={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(t){u.channelCount=t,d.channelCount=t,l.channelCount=t,p.channelCount=t,h.channelCount=t,f.channelCount=t},get channelCountMode(){return l.channelCountMode},set channelCountMode(t){u.channelCountMode=t,d.channelCountMode=t,l.channelCountMode=t,p.channelCountMode=t,h.channelCountMode=t,f.channelCountMode=t},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(t){u.channelInterpretation=t,d.channelInterpretation=t,l.channelInterpretation=t,p.channelInterpretation=t,h.channelInterpretation=t,f.channelInterpretation=t},get context(){return l.context},get curve(){return v},set curve(n){if(null!==n&&n.length<2)throw e();if(null===n)l.curve=n,h.curve=n;else{const t=n.length,e=new Float32Array(t+2-t%2),i=new Float32Array(t+2-t%2);e[0]=n[0],i[0]=-n[t-1];const s=Math.ceil((t+1)/2),r=(t+1)/2-1;for(let a=1;a<s;a+=1){const o=a/s*r,c=Math.floor(o),l=Math.ceil(o);e[a]=c===l?n[c]:(1-(o-c))*n[c]+(1-(l-o))*n[l],i[a]=c===l?-n[t-1-c]:-(1-(o-c))*n[t-1-c]-(1-(l-o))*n[t-1-l]}e[s]=t%2==1?n[s-1]:(n[s-2]+n[s-1])/2,l.curve=e,h.curve=i}v=n,g&&(i(v)&&null===m?m=t(r,u):null!==m&&(m(),m=null))},get inputs(){return[u]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(t){l.oversample=t,h.oversample=t},addEventListener:(...t)=>u.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>u.dispatchEvent(t[0]),removeEventListener:(...t)=>u.removeEventListener(t[0],t[1],t[2])};null!==a&&(b.curve=a instanceof Float32Array?a:new Float32Array(a)),o!==b.oversample&&(b.oversample=o);return s(Se(b,p),(()=>{u.connect(l).connect(p),u.connect(d).connect(h).connect(f).connect(p),g=!0,i(v)&&(m=t(r,u))}),(()=>{u.disconnect(l),l.disconnect(p),u.disconnect(d),d.disconnect(h),h.disconnect(f),f.disconnect(p),g=!1,null!==m&&(m(),m=null)}))})(oi,le,Ae,Ve,Vn),li=((t,e,n,i,s,r,a)=>(o,c)=>{const l=o.createWaveShaper();if(null!==r&&"webkitAudioContext"===r.name)return n(o,c);ge(l,c);const h=null===c.curve||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(null!==h&&h.length<2)throw e();me(l,{curve:h},"curve"),me(l,c,"oversample");let u=null,d=!1;a(l,"curve",(t=>()=>t.call(l)),(e=>n=>(e.call(l,n),d&&(i(n)&&null===u?u=t(o,l):i(n)||null===u||(u(),u=null)),n)));return s(l,(()=>{d=!0,i(l.curve)&&(u=t(o,l))}),(()=>{d=!1,null!==u&&(u(),u=null)}))})(oi,le,ci,Ve,Vn,un,He),hi=(t=>(e,n)=>{const i=e.createPanner();return void 0===i.orientationX?t(e,n):(ge(i,n),be(i,n,"orientationX"),be(i,n,"orientationY"),be(i,n,"orientationZ"),be(i,n,"positionX"),be(i,n,"positionY"),be(i,n,"positionZ"),me(i,n,"coneInnerAngle"),me(i,n,"coneOuterAngle"),me(i,n,"coneOuterGain"),me(i,n,"distanceModel"),me(i,n,"maxDistance"),me(i,n,"panningModel"),me(i,n,"refDistance"),me(i,n,"rolloffFactor"),i)})(((t,e,n,i,s,r,a,o,c)=>(l,{coneInnerAngle:h,coneOuterAngle:u,coneOuterGain:d,distanceModel:p,maxDistance:f,orientationX:m,orientationY:g,orientationZ:v,panningModel:b,positionX:_,positionY:y,positionZ:w,refDistance:x,rolloffFactor:k,...T})=>{const S=l.createPanner();if(T.channelCount>2)throw a();if("max"===T.channelCountMode)throw a();ge(S,T);const C={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},A=n(l,{...C,channelInterpretation:"speakers",numberOfInputs:6}),E=i(l,{...T,gain:1}),M=i(l,{...C,gain:1}),N=i(l,{...C,gain:0}),I=i(l,{...C,gain:0}),O=i(l,{...C,gain:0}),P=i(l,{...C,gain:0}),D=i(l,{...C,gain:0}),B=s(l,256,6,1),R=r(l,{...C,curve:new Float32Array([1,1]),oversample:"none"});let L=[m,g,v],V=[_,y,w];B.onaudioprocess=({inputBuffer:t})=>{const e=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0]];e.some(((t,e)=>t!==L[e]))&&(S.setOrientation(...e),L=e);const n=[t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];n.some(((t,e)=>t!==V[e]))&&(S.setPosition(...n),V=n)},Object.defineProperty(N.gain,"defaultValue",{get:()=>0}),Object.defineProperty(I.gain,"defaultValue",{get:()=>0}),Object.defineProperty(O.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(D.gain,"defaultValue",{get:()=>0});const H={get bufferSize(){},get channelCount(){return S.channelCount},set channelCount(t){if(t>2)throw a();E.channelCount=t,S.channelCount=t},get channelCountMode(){return S.channelCountMode},set channelCountMode(t){if("max"===t)throw a();E.channelCountMode=t,S.channelCountMode=t},get channelInterpretation(){return S.channelInterpretation},set channelInterpretation(t){E.channelInterpretation=t,S.channelInterpretation=t},get coneInnerAngle(){return S.coneInnerAngle},set coneInnerAngle(t){S.coneInnerAngle=t},get coneOuterAngle(){return S.coneOuterAngle},set coneOuterAngle(t){S.coneOuterAngle=t},get coneOuterGain(){return S.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();S.coneOuterGain=t},get context(){return S.context},get distanceModel(){return S.distanceModel},set distanceModel(t){S.distanceModel=t},get inputs(){return[E]},get maxDistance(){return S.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;S.maxDistance=t},get numberOfInputs(){return S.numberOfInputs},get numberOfOutputs(){return S.numberOfOutputs},get orientationX(){return M.gain},get orientationY(){return N.gain},get orientationZ(){return I.gain},get panningModel(){return S.panningModel},set panningModel(t){S.panningModel=t},get positionX(){return O.gain},get positionY(){return P.gain},get positionZ(){return D.gain},get refDistance(){return S.refDistance},set refDistance(t){if(t<0)throw new RangeError;S.refDistance=t},get rolloffFactor(){return S.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;S.rolloffFactor=t},addEventListener:(...t)=>E.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>E.dispatchEvent(t[0]),removeEventListener:(...t)=>E.removeEventListener(t[0],t[1],t[2])};h!==H.coneInnerAngle&&(H.coneInnerAngle=h),u!==H.coneOuterAngle&&(H.coneOuterAngle=u),d!==H.coneOuterGain&&(H.coneOuterGain=d),p!==H.distanceModel&&(H.distanceModel=p),f!==H.maxDistance&&(H.maxDistance=f),m!==H.orientationX.value&&(H.orientationX.value=m),g!==H.orientationY.value&&(H.orientationY.value=g),v!==H.orientationZ.value&&(H.orientationZ.value=v),b!==H.panningModel&&(H.panningModel=b),_!==H.positionX.value&&(H.positionX.value=_),y!==H.positionY.value&&(H.positionY.value=y),w!==H.positionZ.value&&(H.positionZ.value=w),x!==H.refDistance&&(H.refDistance=x),k!==H.rolloffFactor&&(H.rolloffFactor=k),1===L[0]&&0===L[1]&&0===L[2]||S.setOrientation(...L),0===V[0]&&0===V[1]&&0===V[2]||S.setPosition(...V);return c(Se(H,S),(()=>{E.connect(S),t(E,R,0,0),R.connect(M).connect(A,0,0),R.connect(N).connect(A,0,1),R.connect(I).connect(A,0,2),R.connect(O).connect(A,0,3),R.connect(P).connect(A,0,4),R.connect(D).connect(A,0,5),A.connect(B).connect(l.destination)}),(()=>{E.disconnect(S),o(E,R,0,0),R.disconnect(M),M.disconnect(A),R.disconnect(N),N.disconnect(A),R.disconnect(I),I.disconnect(A),R.disconnect(O),O.disconnect(A),R.disconnect(P),P.disconnect(A),R.disconnect(D),D.disconnect(A),A.disconnect(B),B.disconnect(l.destination)}))})(Ot,le,Hn,Ae,Ne,li,Ie,Rt,Vn)),ui=((t,e,n,i,s,r,a,o,c,l)=>()=>{const h=new WeakMap;let u=null;return{render(d,p,f){const m=h.get(p);return void 0!==m?Promise.resolve(m):(async(d,p,f)=>{let m=null,g=r(d);const v={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation},b={...v,coneInnerAngle:g.coneInnerAngle,coneOuterAngle:g.coneOuterAngle,coneOuterGain:g.coneOuterGain,distanceModel:g.distanceModel,maxDistance:g.maxDistance,panningModel:g.panningModel,refDistance:g.refDistance,rolloffFactor:g.rolloffFactor},_=pt(g,p);if("bufferSize"in g)m=i(p,{...v,gain:1});else if(!_){const t={...b,orientationX:g.orientationX.value,orientationY:g.orientationY.value,orientationZ:g.orientationZ.value,positionX:g.positionX.value,positionY:g.positionY.value,positionZ:g.positionZ.value};g=s(p,t)}if(h.set(p,null===m?g:m),null!==m){if(null===u){if(null===a)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new a(6,d.context.length,p.sampleRate),i=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});i.connect(t.destination),u=(async()=>{const e=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map((async(e,i)=>{const s=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===i?1:0});return await o(t,e,s.offset,f),s})));for(let t=0;t<6;t+=1)e[t].connect(i,0,t),e[t].start(0);return l(t)})()}const t=await u,r=i(p,{...v,gain:1});await c(d,p,r,f);const h=[];for(let e=0;e<t.numberOfChannels;e+=1)h.push(t.getChannelData(e));let g=[h[0][0],h[1][0],h[2][0]],_=[h[3][0],h[4][0],h[5][0]],y=i(p,{...v,gain:1}),w=s(p,{...b,orientationX:g[0],orientationY:g[1],orientationZ:g[2],positionX:_[0],positionY:_[1],positionZ:_[2]});r.connect(y).connect(w.inputs[0]),w.connect(m);for(let e=128;e<t.length;e+=128){const t=[h[0][e],h[1][e],h[2][e]],n=[h[3][e],h[4][e],h[5][e]];if(t.some(((t,e)=>t!==g[e]))||n.some(((t,e)=>t!==_[e]))){g=t,_=n;const a=e/p.sampleRate;y.gain.setValueAtTime(0,a),y=i(p,{...v,gain:0}),w=s(p,{...b,orientationX:g[0],orientationY:g[1],orientationZ:g[2],positionX:_[0],positionY:_[1],positionZ:_[2]}),y.gain.setValueAtTime(1,a),r.connect(y).connect(w.inputs[0]),w.connect(m)}}return m}return _?(await t(p,d.orientationX,g.orientationX,f),await t(p,d.orientationY,g.orientationY,f),await t(p,d.orientationZ,g.orientationZ,f),await t(p,d.positionX,g.positionX,f),await t(p,d.positionY,g.positionY,f),await t(p,d.positionZ,g.positionZ,f)):(await o(p,d.orientationX,g.orientationX,f),await o(p,d.orientationY,g.orientationY,f),await o(p,d.orientationZ,g.orientationZ,f),await o(p,d.positionX,g.positionX,f),await o(p,d.positionY,g.positionY,f),await o(p,d.positionZ,g.positionZ,f)),It(g)?await c(d,p,g.inputs[0],f):await c(d,p,g,f),g})(d,p,f)}}})(An,Hn,Gn,Ae,hi,Lt,on,Mn,nn,Qn),di=((t,e,n,i,s,r,a)=>class extends t{constructor(t,o){const c=s(t),l={...De,...o},h=n(c,l),u=r(c);super(t,!1,h,u?i():null),this._nativePannerNode=h,this._orientationX=e(this,u,h.orientationX,_t,bt),this._orientationY=e(this,u,h.orientationY,_t,bt),this._orientationZ=e(this,u,h.orientationZ,_t,bt),this._positionX=e(this,u,h.positionX,_t,bt),this._positionY=e(this,u,h.positionY,_t,bt),this._positionZ=e(this,u,h.positionZ,_t,bt),a(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}})(mn,In,hi,ui,rn,cn,Rn),pi=((t,e,n,i)=>class s{constructor(s,r){const a=e(s),o=i({...Be,...r}),c=t(a,o);return n.add(c),c}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===s.prototype||n.has(t)}})((t=>(e,{disableNormalization:n,imag:i,real:s})=>{const r=i instanceof Float32Array?i:new Float32Array(i),a=s instanceof Float32Array?s:new Float32Array(s),o=e.createPeriodicWave(a,r,{disableNormalization:n});if(Array.from(i).length<2)throw t();return o})(mt),rn,new WeakSet,(t=>{const{imag:e,real:n}=t;return void 0===e?void 0===n?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,(()=>0)),real:n}:void 0===n?{...t,imag:e,real:Array.from(e,(()=>0))}:{...t,imag:e,real:n}})),fi=((t,e)=>(n,i)=>{const s=i.channelCountMode;if("clamped-max"===s)throw e();if(void 0===n.createStereoPanner)return t(n,i);const r=n.createStereoPanner();return ge(r,i),be(r,i,"pan"),Object.defineProperty(r,"channelCountMode",{get:()=>s,set:t=>{if(t!==s)throw e()}}),r})(((t,e,n,i,s,r)=>{const a=16385,o=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},h={...l,oversample:"none"},u=(t,r,u,d,p)=>{if(1===r)return((t,e,s,r)=>{const u=new Float32Array(a),d=new Float32Array(a);for(let t=0;t<a;t+=1){const e=t/16384*c;u[t]=Math.cos(e),d[t]=Math.sin(e)}const p=n(t,{...l,gain:0}),f=i(t,{...h,curve:u}),m=i(t,{...h,curve:o}),g=n(t,{...l,gain:0}),v=i(t,{...h,curve:d});return{connectGraph(){e.connect(p),e.connect(m.inputs[0]),e.connect(g),m.connect(s),s.connect(f.inputs[0]),s.connect(v.inputs[0]),f.connect(p.gain),v.connect(g.gain),p.connect(r,0,0),g.connect(r,0,1)},disconnectGraph(){e.disconnect(p),e.disconnect(m.inputs[0]),e.disconnect(g),m.disconnect(s),s.disconnect(f.inputs[0]),s.disconnect(v.inputs[0]),f.disconnect(p.gain),v.disconnect(g.gain),p.disconnect(r,0,0),g.disconnect(r,0,1)}}})(t,u,d,p);if(2===r)return((t,s,r,u)=>{const d=new Float32Array(a),p=new Float32Array(a),f=new Float32Array(a),m=new Float32Array(a),g=Math.floor(8192.5);for(let t=0;t<a;t+=1)if(t>g){const e=(t-g)/(16384-g)*c;d[t]=Math.cos(e),p[t]=Math.sin(e),f[t]=0,m[t]=1}else{const e=t/(16384-g)*c;d[t]=1,p[t]=0,f[t]=Math.cos(e),m[t]=Math.sin(e)}const v=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),b=n(t,{...l,gain:0}),_=i(t,{...h,curve:d}),y=n(t,{...l,gain:0}),w=i(t,{...h,curve:p}),x=i(t,{...h,curve:o}),k=n(t,{...l,gain:0}),T=i(t,{...h,curve:f}),S=n(t,{...l,gain:0}),C=i(t,{...h,curve:m});return{connectGraph(){s.connect(v),s.connect(x.inputs[0]),v.connect(b,0),v.connect(y,0),v.connect(k,1),v.connect(S,1),x.connect(r),r.connect(_.inputs[0]),r.connect(w.inputs[0]),r.connect(T.inputs[0]),r.connect(C.inputs[0]),_.connect(b.gain),w.connect(y.gain),T.connect(k.gain),C.connect(S.gain),b.connect(u,0,0),k.connect(u,0,0),y.connect(u,0,1),S.connect(u,0,1)},disconnectGraph(){s.disconnect(v),s.disconnect(x.inputs[0]),v.disconnect(b,0),v.disconnect(y,0),v.disconnect(k,1),v.disconnect(S,1),x.disconnect(r),r.disconnect(_.inputs[0]),r.disconnect(w.inputs[0]),r.disconnect(T.inputs[0]),r.disconnect(C.inputs[0]),_.disconnect(b.gain),w.disconnect(y.gain),T.disconnect(k.gain),C.disconnect(S.gain),b.disconnect(u,0,0),k.disconnect(u,0,0),y.disconnect(u,0,1),S.disconnect(u,0,1)}}})(t,u,d,p);throw s()};return(e,{channelCount:i,channelCountMode:a,pan:o,...c})=>{if("max"===a)throw s();const l=t(e,{...c,channelCount:1,channelCountMode:a,numberOfInputs:2}),h=n(e,{...c,channelCount:i,channelCountMode:a,gain:1}),d=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:o});let{connectGraph:p,disconnectGraph:f}=u(e,i,h,d,l);Object.defineProperty(d.gain,"defaultValue",{get:()=>0}),Object.defineProperty(d.gain,"minValue",{get:()=>-1});const m={get bufferSize(){},get channelCount(){return h.channelCount},set channelCount(t){h.channelCount!==t&&(g&&f(),({connectGraph:p,disconnectGraph:f}=u(e,t,h,d,l)),g&&p()),h.channelCount=t},get channelCountMode(){return h.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw s();h.channelCountMode=t},get channelInterpretation(){return h.channelInterpretation},set channelInterpretation(t){h.channelInterpretation=t},get context(){return h.context},get inputs(){return[h]},get numberOfInputs(){return h.numberOfInputs},get numberOfOutputs(){return h.numberOfOutputs},get pan(){return d.gain},addEventListener:(...t)=>h.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>h.dispatchEvent(t[0]),removeEventListener:(...t)=>h.removeEventListener(t[0],t[1],t[2])};let g=!1;return r(Se(m,l),(()=>{p(),g=!0}),(()=>{f(),g=!1}))}})(Hn,Te,Ae,li,Ie,Vn),Ie),mi=((t,e,n,i,s)=>()=>{const r=new WeakMap;return{render(a,o,c){const l=r.get(o);return void 0!==l?Promise.resolve(l):(async(a,o,c)=>{let l=n(a);const h=pt(l,o);if(!h){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(o,t)}return r.set(o,l),h?await t(o,a.pan,l.pan,c):await i(o,a.pan,l.pan,c),It(l)?await s(a,o,l.inputs[0],c):await s(a,o,l,c),l})(a,o,c)}}})(An,fi,Lt,Mn,nn),gi=((t,e,n,i,s,r)=>class extends t{constructor(t,a){const o=s(t),c={...Re,...a},l=n(o,c),h=r(o);super(t,!1,l,h?i():null),this._pan=e(this,h,l.pan)}get pan(){return this._pan}})(mn,In,fi,mi,rn,cn),vi=((t,e,n)=>()=>{const i=new WeakMap;return{render(s,r,a){const o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r,a)=>{let o=e(s);if(!pt(o,r)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,curve:o.curve,oversample:o.oversample};o=t(r,e)}return i.set(r,o),It(o)?await n(s,r,o.inputs[0],a):await n(s,r,o,a),o})(s,r,a)}}})(li,Lt,nn),bi=((t,e,n,i,s,r,a)=>class extends t{constructor(t,e){const o=s(t),c={...Le,...e},l=n(o,c);super(t,!0,l,r(o)?i():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=l,a(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}})(mn,le,li,vi,rn,cn,Rn),_i=(t=>null!==t&&t.isSecureContext)(Je),yi=(t=>(e,n,i)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*n)},currentTime:{configurable:!0,get:()=>e}});try{return i()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}})(Je),wi=new WeakMap,xi=((t,e)=>n=>{let i=t.get(n);if(void 0!==i)return i;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,8e3),t.set(n,i),i})(wi,on),ki=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(Je),Ti=_i?((t,e,n,i,s,r,a,o,c,l,h,u)=>(d,p,f={credentials:"omit"})=>{const m=r(d),g=new URL(p,u.location.href).toString();if(void 0!==m.audioWorklet)return Promise.all([s(p),Promise.resolve(t(h,h))]).then((([t,e])=>{const[n,i]=et(t,g),s=e?i:i.replace(/\s+extends\s+AudioWorkletProcessor\s*{/," extends (class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}){"),r=new Blob([`${n};(registerProcessor=>{${s}\n})((n,p)=>registerProcessor(n,class extends p{${e?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${e?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}))`],{type:"application/javascript; charset=utf-8"}),c=URL.createObjectURL(r);return m.audioWorklet.addModule(c,f).then((()=>{if(o(m))return;return a(m).audioWorklet.addModule(c,f)})).finally((()=>URL.revokeObjectURL(c)))}));const v=l.get(d);if(void 0!==v&&v.has(p))return Promise.resolve();const b=c.get(d);if(void 0!==b){const t=b.get(p);if(void 0!==t)return t}const _=s(p).then((t=>{const[e,i]=et(t,g);return n(`${e};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${i}\n})})(window,'_AWGS')`)})).then((()=>{const t=u._AWGS.pop();if(void 0===t)throw new SyntaxError;i(m.currentTime,m.sampleRate,(()=>t(class{},void 0,((t,n)=>{if(""===t.trim())throw e();const i=K.get(m);if(void 0!==i){if(i.has(t))throw e();it(n),nt(n.parameterDescriptors),i.set(t,n)}else it(n),nt(n.parameterDescriptors),K.set(m,new Map([[t,n]]))}),m.sampleRate,void 0,void 0)))}));return void 0===b?c.set(d,new Map([[p,_]])):b.set(p,_),_.then((()=>{const t=l.get(d);void 0===t?l.set(d,new Set([p])):t.add(p)})).finally((()=>{const t=c.get(d);void 0!==t&&t.delete(p)})),_})(Ze,Ie,(t=>e=>new Promise(((n,i)=>{if(null===t)return void i(new SyntaxError);const s=t.document.head;if(null===s)i(new SyntaxError);else{const r=t.document.createElement("script"),a=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(a),c=t.onerror,l=()=>{t.onerror=c,URL.revokeObjectURL(o)};t.onerror=(e,n,s,r,a)=>n===o||n===t.location.href&&1===s&&1===r?(l(),i(a),!1):null!==c?c(e,n,s,r,a):void 0,r.onerror=()=>{l(),i(new SyntaxError)},r.onload=()=>{l(),n()},r.src=o,r.type="module",s.appendChild(r)}})))(Je),yi,(t=>async e=>{try{const t=await fetch(e);if(t.ok)return t.text()}catch{}throw t()})((()=>new DOMException("","AbortError"))),rn,xi,cn,new WeakMap,new WeakMap,((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new e(1,128,8e3),s=URL.createObjectURL(n);let r=!1,a=!1;try{await i.audioWorklet.addModule(s);const e=new t(i,"a",{numberOfOutputs:0}),n=i.createOscillator();e.port.onmessage=()=>r=!0,e.onprocessorerror=()=>a=!0,n.connect(e),await i.startRendering()}catch{}finally{URL.revokeObjectURL(s)}return r&&!a})(ki,on),Je):void 0,Si=((t,e)=>n=>t(n)||e(n))(dn,cn),Ci=((t,e,n,i,s,r,a,o,c,l,h,u,d,p,f,m,g,v,b,_)=>class extends f{constructor(e,n){super(e,n),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,n)=>t(this,e,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new s(this)}createBuffer(t,e,i){return new n({length:e,numberOfChannels:t,sampleRate:i})}createBufferSource(){return new i(this)}createChannelMerger(t=6){return new r(this,{numberOfInputs:t})}createChannelSplitter(t=6){return new a(this,{numberOfOutputs:t})}createConstantSource(){return new o(this)}createConvolver(){return new c(this)}createDelay(t=1){return new h(this,{maxDelayTime:t})}createDynamicsCompressor(){return new u(this)}createGain(){return new d(this)}createIIRFilter(t,e){return new p(this,{feedback:e,feedforward:t})}createOscillator(){return new m(this)}createPanner(){return new g(this)}createPeriodicWave(t,e,n={disableNormalization:!1}){return new v(this,{...n,imag:e,real:t})}createStereoPanner(){return new b(this)}createWaveShaper(){return new _(this)}decodeAudioData(t,e,n){return l(this._nativeContext,t).then((t=>("function"==typeof e&&e(t),t))).catch((t=>{throw"function"==typeof n&&n(t),t}))}})(Ti,vn,Tn,Pn,Ln,Fn,qn,jn,Yn,((t,e,n,i,s,r,a,o,c,l,h)=>(u,d)=>{const p=a(u)?u:r(u);if(s.has(d)){const t=n();return Promise.reject(t)}try{s.add(d)}catch{}return e(c,(()=>c(p)))?p.decodeAudioData(d).then((n=>(e(o,(()=>o(n)))||h(n),t.add(n),n))):new Promise(((e,n)=>{const s=()=>{try{(t=>{const{port1:e}=new MessageChannel;e.postMessage(t,[t])})(d)}catch{}},r=t=>{n(t),s()};try{p.decodeAudioData(d,(n=>{"function"!=typeof n.copyFromChannel&&(l(n),gt(n)),t.add(n),s(),e(n)}),(t=>{r(null===t?i():t)}))}catch(t){r(t)}}))})(bn,Ze,(()=>new DOMException("","DataCloneError")),(()=>new DOMException("","EncodingError")),new WeakSet,rn,Si,ft,fe,xn,kn),Un,$n,Zn,ti,ii,ai,di,pi,gi,bi),Ai=((t,e,n,i)=>class extends t{constructor(t,s){const r=n(t),a=e(r,s);if(i(r))throw TypeError();super(t,!0,a,null),this._nativeMediaElementAudioSourceNode=a}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(mn,((t,e)=>t.createMediaElementSource(e.mediaElement)),rn,cn),Ei=((t,e,n,i)=>class extends t{constructor(t,s){const r=n(t);if(i(r))throw new TypeError;const a={...pe,...s},o=e(r,a);super(t,!1,o,null),this._nativeMediaStreamAudioDestinationNode=o}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(mn,((t,e)=>{const n=t.createMediaStreamDestination();return ge(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n}),rn,cn),Mi=((t,e,n,i)=>class extends t{constructor(t,s){const r=n(t),a=e(r,s);if(i(r))throw new TypeError;super(t,!0,a,null),this._nativeMediaStreamAudioSourceNode=a}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(mn,((t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort(((t,e)=>t.id<e.id?-1:t.id>e.id?1:0));const i=n.slice(0,1),s=t.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(s,"mediaStream",{value:e}),s}),rn,cn),Ni=((t,e,n)=>class extends t{constructor(t,i){const s=n(t);super(t,!0,e(s,i),null)}})(mn,((t,e)=>(n,{mediaStreamTrack:i})=>{if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(i);const s=new MediaStream([i]),r=n.createMediaStreamSource(s);if("audio"!==i.kind)throw t();if(e(n))throw new TypeError;return r})(le,cn),rn),Ii=((t,e,n,i,s,r,a,o,c)=>class extends t{constructor(t={}){if(null===c)throw new Error("Missing the native AudioContext constructor.");const e=new c(t);if(null===e)throw i();if(!(t=>void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t))(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw n();super(e,2);const{latencyHint:s}=t,{sampleRate:r}=e;if(this._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===s?512/r:"interactive"===s||void 0===s?256/r:"playback"===s?1024/r:128*Math.max(2,Math.min(128,Math.round(s*r/128)))/r,this._nativeAudioContext=e,"webkitAudioContext"===c.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),St(this)})))}createMediaElementSource(t){return new s(this,{mediaElement:t})}createMediaStreamDestination(){return new r(this)}createMediaStreamSource(t){return new a(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new o(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise(((t,e)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",n)})):this._nativeAudioContext.resume().catch((t=>{if(void 0===t||15===t.code)throw e();throw t}))}suspend(){return this._nativeAudioContext.suspend().catch((t=>{if(void 0===t)throw e();throw t}))}})(Ci,le,Ie,(()=>new DOMException("","UnknownError")),Ai,Ei,Mi,Ni,un),Oi=(t=>e=>{const n=t.get(e);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n})(ni),Pi=(t=>(e,n)=>{t(e).add(n)})(Oi),Di=(t=>(e,n,i=0,s=0)=>{const r=e[i];if(void 0===r)throw t();return Gt(n)?r.connect(n,0,s):r.connect(n,0)})(mt),Bi=(t=>(e,n)=>{t(e).delete(n)})(Oi),Ri=(t=>(e,n,i,s=0)=>void 0===n?e.forEach((t=>t.disconnect())):"number"==typeof n?ae(t,e,n).disconnect():Gt(n)?void 0===i?e.forEach((t=>t.disconnect(n))):void 0===s?ae(t,e,i).disconnect(n,0):ae(t,e,i).disconnect(n,0,s):void 0===i?e.forEach((t=>t.disconnect(n))):ae(t,e,i).disconnect(n,0))(mt),Li=new WeakMap,Vi=((t,e)=>n=>e(t,n))(Li,st),Hi=((t,e,n,i,s,r,a,o,c,l,h,u,d)=>(p,f,m,g)=>{if(0===g.numberOfInputs&&0===g.numberOfOutputs)throw c();const v=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(v.some((t=>t<1)))throw c();if(v.length!==g.numberOfOutputs)throw e();if("explicit"!==g.channelCountMode)throw c();const b=g.channelCount*g.numberOfInputs,_=v.reduce(((t,e)=>t+e),0),y=void 0===m.parameterDescriptors?0:m.parameterDescriptors.length;if(b+y>6||_>6)throw c();const w=new MessageChannel,x=[],k=[];for(let t=0;t<g.numberOfInputs;t+=1)x.push(a(p,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),k.push(s(p,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const T=[];if(void 0!==m.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:n,name:i}of m.parameterDescriptors){const s=r(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==g.parameterData[i]?g.parameterData[i]:void 0===t?0:t});Object.defineProperties(s.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?_t:e},minValue:{get:()=>void 0===n?bt:n}}),T.push(s)}const S=i(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,b+y)}),C=we(f,p.sampleRate),A=o(p,C,b+y,Math.max(1,_)),E=s(p,{channelCount:Math.max(1,_),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,_)}),M=[];for(let t=0;t<g.numberOfOutputs;t+=1)M.push(i(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[t]}));for(let t=0;t<g.numberOfInputs;t+=1){x[t].connect(k[t]);for(let e=0;e<g.channelCount;e+=1)k[t].connect(S,e,t*g.channelCount+e)}const N=new Xt(void 0===m.parameterDescriptors?[]:m.parameterDescriptors.map((({name:t},e)=>{const n=T[e];return n.connect(S,0,b+e),n.start(0),[t,n.offset]})));S.connect(A);let I=g.channelInterpretation,O=null;const P=0===g.numberOfOutputs?[A]:M,D={get bufferSize(){return C},get channelCount(){return g.channelCount},set channelCount(t){throw n()},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){throw n()},get channelInterpretation(){return I},set channelInterpretation(t){for(const e of x)e.channelInterpretation=t;I=t},get context(){return A.context},get inputs(){return x},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},get onprocessorerror(){return O},set onprocessorerror(t){"function"==typeof O&&D.removeEventListener("processorerror",O),O="function"==typeof t?t:null,"function"==typeof O&&D.addEventListener("processorerror",O)},get parameters(){return N},get port(){return w.port2},addEventListener:(...t)=>A.addEventListener(t[0],t[1],t[2]),connect:t.bind(null,P),disconnect:l.bind(null,P),dispatchEvent:(...t)=>A.dispatchEvent(t[0]),removeEventListener:(...t)=>A.removeEventListener(t[0],t[1],t[2])},B=new Map;var R,L;w.port1.addEventListener=(R=w.port1.addEventListener,(...t)=>{if("message"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=B.get(t[1]);void 0!==n?t[1]=n:(t[1]=t=>{h(p.currentTime,p.sampleRate,(()=>e(t)))},B.set(e,t[1]))}}return R.call(w.port1,t[0],t[1],t[2])}),w.port1.removeEventListener=(L=w.port1.removeEventListener,(...t)=>{if("message"===t[0]){const e=B.get(t[1]);void 0!==e&&(B.delete(t[1]),t[1]=e)}return L.call(w.port1,t[0],t[1],t[2])});let V=null;Object.defineProperty(w.port1,"onmessage",{get:()=>V,set:t=>{"function"==typeof V&&w.port1.removeEventListener("message",V),V="function"==typeof t?t:null,"function"==typeof V&&(w.port1.addEventListener("message",V),w.port1.start())}}),m.prototype.port=w.port1;let H=null;((t,e,n,i)=>{let s=Q.get(t);void 0===s&&(s=new WeakMap,Q.set(t,s));const r=xe(n,i);return s.set(e,r),r})(p,D,m,g).then((t=>H=t));const F=Qt(g.numberOfInputs,g.channelCount),q=Qt(g.numberOfOutputs,v),z=void 0===m.parameterDescriptors?[]:m.parameterDescriptors.reduce(((t,{name:e})=>({...t,[e]:new Float32Array(128)})),{});let G=!0;const j=()=>{g.numberOfOutputs>0&&A.disconnect(E);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const n=M[t];for(let i=0;i<v[t];i+=1)E.disconnect(n,e+i,i);e+=v[t]}},W=new Map;A.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==H){const n=u(D);for(let i=0;i<C;i+=128){for(let e=0;e<g.numberOfInputs;e+=1)for(let n=0;n<g.channelCount;n+=1)Zt(t,F[e],n,n,i);void 0!==m.parameterDescriptors&&m.parameterDescriptors.forEach((({name:e},n)=>{Zt(t,z,e,b+n,i)}));for(let t=0;t<g.numberOfInputs;t+=1)for(let e=0;e<v[t];e+=1)0===q[t][e].byteLength&&(q[t][e]=new Float32Array(128));try{const t=F.map(((t,e)=>{if(n[e].size>0)return W.set(e,C/128),t;const i=W.get(e);return void 0===i?[]:(t.every((t=>t.every((t=>0===t))))&&(1===i?W.delete(e):W.set(e,i-1)),t)})),s=h(p.currentTime+i/p.sampleRate,p.sampleRate,(()=>H.process(t,q,z)));G=s;for(let t=0,n=0;t<g.numberOfOutputs;t+=1){for(let s=0;s<v[t];s+=1)Kt(e,q[t],s,n+s,i);n+=v[t]}}catch(t){G=!1,D.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!G){for(let t=0;t<g.numberOfInputs;t+=1){x[t].disconnect(k[t]);for(let e=0;e<g.channelCount;e+=1)k[i].disconnect(S,e,t*g.channelCount+e)}if(void 0!==m.parameterDescriptors){const t=m.parameterDescriptors.length;for(let e=0;e<t;e+=1){const t=T[e];t.disconnect(S,0,b+e),t.stop()}}S.disconnect(A),A.onaudioprocess=null,Y?j():$();break}}}};let Y=!1;const U=a(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),X=()=>A.connect(U).connect(p.destination),$=()=>{A.disconnect(U),U.disconnect()};return X(),d(D,(()=>{if(G){$(),g.numberOfOutputs>0&&A.connect(E);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const n=M[t];for(let i=0;i<v[t];i+=1)E.connect(n,e+i,i);e+=v[t]}}Y=!0}),(()=>{G&&(X(),j()),Y=!1}))})(Di,mt,le,Hn,Te,Gn,Ae,Ne,Ie,Ri,yi,Vi,Vn),Fi=((t,e,n,i,s)=>(r,a,o,c,l,h)=>{if(null!==o)try{const e=new o(r,c,h),i=new Map;let a=null;if(Object.defineProperties(e,{channelCount:{get:()=>h.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>a,set:t=>{"function"==typeof a&&e.removeEventListener("processorerror",a),a="function"==typeof t?t:null,"function"==typeof a&&e.addEventListener("processorerror",a)}}}),e.addEventListener=(d=e.addEventListener,(...t)=>{if("processorerror"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=i.get(t[1]);void 0!==n?t[1]=n:(t[1]=n=>{"error"===n.type?(Object.defineProperties(n,{type:{value:"processorerror"}}),e(n)):e(new ErrorEvent(t[0],{...n}))},i.set(e,t[1]))}}return d.call(e,"error",t[1],t[2]),d.call(e,...t)}),e.removeEventListener=(u=e.removeEventListener,(...t)=>{if("processorerror"===t[0]){const e=i.get(t[1]);void 0!==e&&(i.delete(t[1]),t[1]=e)}return u.call(e,"error",t[1],t[2]),u.call(e,t[0],t[1],t[2])}),0!==h.numberOfOutputs){const t=n(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(t).connect(r.destination);return s(e,(()=>t.disconnect()),(()=>t.connect(r.destination)))}return e}catch(t){if(11===t.code)throw i();throw t}var u,d;if(void 0===l)throw i();return(t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}})(h),e(r,a,l,h)})(le,Hi,Ae,Ie,Vn),qi=((t,e,n,i,s,r,a,o,c,l,h,u,d,p,f,m)=>(g,v,b)=>{const _=new WeakMap;let y=null;return{render(w,x,k){o(x,w);const T=_.get(x);return void 0!==T?Promise.resolve(T):(async(o,w,x)=>{let k=h(o),T=null;const S=pt(k,w),C=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(null===u){const t=C.reduce(((t,e)=>t+e),0),n=s(w,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),r=[];for(let t=0;t<o.numberOfOutputs;t+=1)r.push(i(w,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:C[t]}));const l=a(w,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1});l.connect=e.bind(null,r),l.disconnect=c.bind(null,r),T=[n,r,l]}else S||(k=new u(w,g));if(_.set(w,null===T?k:T[2]),null!==T){if(null===y){if(void 0===b)throw new Error("Missing the processor constructor.");if(null===d)throw new Error("Missing the native OfflineAudioContext constructor.");const t=o.channelCount*o.numberOfInputs,e=void 0===b.parameterDescriptors?0:b.parameterDescriptors.length,n=t+e,c=async()=>{const c=new d(n,128*Math.ceil(o.context.length/128),w.sampleRate),l=[],h=[];for(let t=0;t<v.numberOfInputs;t+=1)l.push(a(c,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),h.push(s(c,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const u=await Promise.all(Array.from(o.parameters.values()).map((async t=>{const e=r(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await p(c,t,e.offset,x),e}))),g=i(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<v.numberOfInputs;t+=1){l[t].connect(h[t]);for(let e=0;e<v.channelCount;e+=1)h[t].connect(g,e,t*v.channelCount+e)}for(const[e,n]of u.entries())n.connect(g,0,t+e),n.start(0);return g.connect(c.destination),await Promise.all(l.map((t=>f(o,c,t,x)))),m(c)};y=Jt(o,0===n?null:await c(),w,v,C,b,l)}const t=await y,e=n(w,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[c,h,u]=T;null!==t&&(e.buffer=t,e.start(0)),e.connect(c);for(let t=0,e=0;t<o.numberOfOutputs;t+=1){const n=h[t];for(let i=0;i<C[t];i+=1)c.connect(n,e+i,i);e+=C[t]}return u}if(S)for(const[e,n]of o.parameters.entries())await t(w,n,k.parameters.get(e),x);else for(const[t,e]of o.parameters.entries())await p(w,e,k.parameters.get(t),x);return await f(o,w,k,x),k})(w,x,k)}}})(An,Di,En,Hn,Te,Gn,Ae,Bi,Ri,yi,Lt,ki,on,Mn,nn,Qn),zi=(t=>e=>t.get(e))(wi),Gi=(t=>(e,n)=>{t.set(e,n)})(Li),ji=_i?((t,e,n,i,s,r,a,o,c,l,h,u,d)=>class extends e{constructor(e,d,p){var f;const m=o(e),g=c(m),v=h({...$t,...p}),b=K.get(m),_=null==b?void 0:b.get(d),y=g||"closed"!==m.state?m:null!==(f=a(m))&&void 0!==f?f:m,w=s(y,g?null:e.baseLatency,l,d,_,v);super(e,!0,w,g?i(d,v,_):null);const x=[];w.parameters.forEach(((t,e)=>{const i=n(this,g,t);x.push([e,i])})),this._nativeAudioWorkletNode=w,this._onprocessorerror=null,this._parameters=new Xt(x),g&&t(m,this);const{activeInputs:k}=r(this);u(w,k)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){const e="function"==typeof t?d(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(Pi,mn,In,qi,Fi,xt,zi,rn,cn,ki,(t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},(()=>1))})),Gi,je):void 0,Wi=((t,e)=>(n,i,s)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,s)}catch(e){if("SyntaxError"===e.name)throw t();throw e}})(Ie,on),Yi=((t,e,n,i,s,r,a,o)=>{const c=[];return(l,h)=>n(l).render(l,h,c).then((()=>Promise.all(Array.from(i(h)).map((t=>n(t).render(t,h,c)))))).then((()=>s(h))).then((n=>("function"!=typeof n.copyFromChannel?(a(n),gt(n)):e(r,(()=>r(n)))||o(n),t.add(n),n)))})(bn,Ze,en,Oi,Qn,ft,xn,kn),Ui=((t,e,n,i,s)=>class extends t{constructor(t,n,s){let r;if("number"==typeof t&&void 0!==n&&void 0!==s)r={length:n,numberOfChannels:t,sampleRate:s};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");r=t}const{length:a,numberOfChannels:o,sampleRate:c}={...Oe,...r},l=i(o,a,c);e(fe,(()=>fe(l)))||l.addEventListener("statechange",(()=>{let t=0;const e=n=>{"running"===this._state&&(t>0?(l.removeEventListener("statechange",e),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):t+=1)};return e})()),super(l,o),this._length=a,this._nativeOfflineAudioContext=l,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",s(this.destination,this._nativeOfflineAudioContext).finally((()=>{this._state=null,St(this)})))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout((()=>this._waitForThePromiseToSettle(t)))}})(Ci,Ze,le,Wi,Yi),Xi=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n)})(X,dn),$i=((t,e)=>n=>t.has(n)||e(n))(W,pn),Zi=((t,e)=>n=>t.has(n)||e(n))(U,fn),Ki=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n)})(X,cn);function Qi(t,e){if(!t)throw new Error(e)}function Ji(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function ts(t){t.isOffline||"running"===t.state||ns('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let es=console;function ns(...t){es.warn(...t)}function is(t){return void 0===t}function ss(t){return!is(t)}function rs(t){return"number"==typeof t}function as(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function os(t){return Array.isArray(t)}function cs(t){return"string"==typeof t}function ls(t){return cs(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}const hs="object"==typeof self?self:null,us=hs&&(hs.hasOwnProperty("AudioContext")||hs.hasOwnProperty("webkitAudioContext"));
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
function ds(t,e,n,i){var s,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var o=t.length-1;o>=0;o--)(s=t[o])&&(a=(r<3?s(a):r>3?s(e,n,a):s(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a}function ps(t,e,n,i){return new(n||(n=Promise))((function(s,r){function a(t){try{c(i.next(t))}catch(t){r(t)}}function o(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}c((i=i.apply(t,e||[])).next())}))}class fs{constructor(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock()}_createWorker(){const t=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout((()=>{this._createTimeout(),this._callback()}),1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function ms(t){return Zi(t)}function gs(t){return $i(t)}function vs(t){return Ki(t)}function bs(t){return Xi(t)}function _s(t){return t instanceof AudioBuffer}function ys(t,e){return"value"===t||ms(e)||gs(e)||_s(e)}function ws(t,...e){if(!e.length)return t;const n=e.shift();if(as(t)&&as(n))for(const e in n)ys(e,n[e])?t[e]=n[e]:as(n[e])?(t[e]||Object.assign(t,{[e]:{}}),ws(t[e],n[e])):Object.assign(t,{[e]:n[e]});return ws(t,...e)}function xs(t,e,n=[],i){const s={},r=Array.from(e);if(as(r[0])&&i&&!Reflect.has(r[0],i)){Object.keys(r[0]).some((e=>Reflect.has(t,e)))||(ws(s,{[i]:r[0]}),n.splice(n.indexOf(i),1),r.shift())}if(1===r.length&&as(r[0]))ws(s,r[0]);else for(let t=0;t<n.length;t++)ss(r[t])&&(s[n[t]]=r[t]);return ws(t,s)}function ks(t,e){return is(t)?e:t}function Ts(t,e){return e.forEach((e=>{Reflect.has(t,e)&&delete t[e]})),t}
/**
     * Tone.js
     * @author Yotam Mann
     * @license http://opensource.org/licenses/MIT MIT License
     * @copyright 2014-2019 Yotam Mann
     */class Ss{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||hs&&this.toString()===hs.TONE_DEBUG_CLASS)&&function(...t){es.log(...t)}(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Ss.version=N;const Cs=1e-6;function As(t,e){return t>e+Cs}function Es(t,e){return As(t,e)||Ns(t,e)}function Ms(t,e){return t+Cs<e}function Ns(t,e){return Math.abs(t-e)<Cs}class Is extends Ss{constructor(){super(),this.name="Timeline",this._timeline=[];const t=xs(Is.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(Qi(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];Qi(Es(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}get(t,e="time"){const n=this._search(t,e);return-1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const n=this._search(t);return n-1>=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(Ns(this._timeline[e].time,t)){for(let n=e;n>=0&&Ns(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&Es(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(0===this._timeline.length)return-1;let n=0;const i=this._timeline.length;let s=i;if(i>0&&this._timeline[i-1][e]<=t)return i-1;for(;n<s;){let i=Math.floor(n+(s-n)/2);const r=this._timeline[i],a=this._timeline[i+1];if(Ns(r[e],t)){for(let n=i;n<this._timeline.length;n++){if(!Ns(this._timeline[n][e],t))break;i=n}return i}if(Ms(r[e],t)&&As(a[e],t))return i;As(r[e],t)?s=i:n=i+1}return-1}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const n=this._search(t);return-1!==n&&this._iterate(e,0,n),this}forEachAfter(t,e){const n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let i=this._search(t),s=this._search(e);return-1!==i&&-1!==s?(this._timeline[i].time!==t&&(i+=1),this._timeline[s].time===e&&(s-=1),this._iterate(n,i,s)):-1===i&&this._iterate(n,0,s),this}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){const n=this._search(t);if(-1!==n&&Ns(this._timeline[n].time,t)){let i=n;for(let e=n;e>=0&&Ns(this._timeline[e].time,t);e--)i=e;this._iterate((t=>{e(t)}),i,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const Os=[];function Ps(t){Os.push(t)}const Ds=[];function Bs(t){Ds.push(t)}class Rs extends Ss{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach((t=>{is(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)})),this}once(t,e){const n=(...i)=>{e(...i),this.off(t,n)};return this.on(t,n),this}off(t,e){return t.split(/\W+/).forEach((n=>{if(is(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(is(e))this._events[t]=[];else{const n=this._events[t];for(let t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1)}})),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const n=this._events[t].slice(0);for(let t=0,i=n.length;t<i;t++)n[t].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach((e=>{const n=Object.getOwnPropertyDescriptor(Rs.prototype,e);Object.defineProperty(t.prototype,e,n)}))}dispose(){return super.dispose(),this._events=void 0,this}}class Ls extends Rs{constructor(){super(...arguments),this.isOffline=!1}}class Vs extends Ls{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new Is,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const t=xs(Vs.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=function(t){return new Ii(t)}({latencyHint:t.latencyHint}),this._ticker=new fs(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,Os.forEach((e=>e(t))),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){Qi(bs(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamSource(t)}createMediaStreamDestination(){Qi(bs(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){Qi(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){Qi(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){Qi(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){Qi(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return function(t,e,n){return Qi(ss(ji),"This node only works in a secure context (https or localhost)"),new ji(t,e,n)}(this.rawContext,t,e)}addAudioWorkletModule(t,e){return ps(this,void 0,void 0,(function*(){Qi(ss(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)}))}workletsAreReady(){return ps(this,void 0,void 0,(function*(){const t=[];this._workletModules.forEach((e=>t.push(e))),yield Promise.all(t)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,cs(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return"suspended"===this._context.state&&bs(this._context)?this._context.resume():Promise.resolve()}close(){return ps(this,void 0,void 0,(function*(){var t;bs(this._context)&&(yield this._context.close()),this._initialized&&(t=this,Ds.forEach((e=>e(t))))}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let e=0;e<n.length;e++)n[e]=t;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=e,i.loop=!0,i.start(0),this._constants.set(t,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((t=>this._constants[t].disconnect())),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach((e=>{e.id===t&&this._timeouts.remove(e)})),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const n=++this._timeoutIds,i=()=>{const s=this.now();this._timeouts.add({callback:()=>{t(),i()},id:n,time:s+e})};return i(),n}}function Hs(t,e){os(e)?e.forEach((e=>Hs(t,e))):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function Fs(t,e){os(e)?e.forEach((e=>Fs(t,e))):Object.defineProperty(t,e,{writable:!0})}const qs=()=>{};class zs extends Ss{constructor(){super(),this.name="ToneAudioBuffer",this.onload=qs;const t=xs(zs.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&_s(t.url)||t.url instanceof zs?this.set(t.url):cs(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:qs,onload:qs,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Ys().sampleRate}set(t){return t instanceof zs?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return ps(this,void 0,void 0,(function*(){const e=zs.load(t).then((t=>{this.set(t),this.onload(this)}));zs.downloads.push(e);try{yield e}finally{const t=zs.downloads.indexOf(e);zs.downloads.splice(t,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=os(t)&&t[0].length>0,n=e?t.length:1,i=e?t[0].length:t.length,s=Ys(),r=s.createBuffer(n,i,s.sampleRate),a=e||1!==n?t:[t];for(let t=0;t<n;t++)r.copyToChannel(a[t],t);return this._buffer=r,this}toMono(t){if(rs(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let n=0;n<e;n++){const e=this.toArray(n);for(let n=0;n<e.length;n++)t[n]+=e[n]}t=t.map((t=>t/e)),this.fromArray(t)}return this}toArray(t){if(rs(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){const n=Math.floor(t*this.sampleRate),i=Math.floor(e*this.sampleRate);Qi(n<i,"The start time must be less than the end time");const s=i-n,r=Ys().createBuffer(this.numberOfChannels,s,this.sampleRate);for(let t=0;t<this.numberOfChannels;t++)r.copyToChannel(this.getChannelData(t).subarray(n,i),t);return new zs(r)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new zs).fromArray(t)}static fromUrl(t){return ps(this,void 0,void 0,(function*(){const e=new zs;return yield e.load(t)}))}static load(t){return ps(this,void 0,void 0,(function*(){const e=t.match(/\[(.+\|?)+\]$/);if(e){const n=e[1].split("|");let i=n[0];for(const t of n)if(zs.supportsType(t)){i=t;break}t=t.replace(e[0],i)}const n=""===zs.baseUrl||zs.baseUrl.endsWith("/")?zs.baseUrl:zs.baseUrl+"/",i=yield fetch(n+t);if(!i.ok)throw new Error(`could not load url: ${t}`);const s=yield i.arrayBuffer();return yield Ys().decodeAudioData(s)}))}static supportsType(t){const e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}static loaded(){return ps(this,void 0,void 0,(function*(){for(yield Promise.resolve();zs.downloads.length;)yield zs.downloads[0]}))}}zs.baseUrl="",zs.downloads=[];class Gs extends Vs{constructor(){var t,e,n;super({clockSource:"offline",context:vs(arguments[0])?arguments[0]:(t=arguments[0],e=arguments[1]*arguments[2],n=arguments[2],new Ui(t,e,n)),lookAhead:0,updateInterval:vs(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=vs(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return ps(this,void 0,void 0,(function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const n=Math.floor(this.sampleRate/128);t&&e%n==0&&(yield new Promise((t=>setTimeout(t,1))))}}))}render(t=!0){return ps(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new zs(e)}))}close(){return Promise.resolve()}}const js=new class extends Ls{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,n){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return ps(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};let Ws=js;function Ys(){return Ws===js&&us&&function(t){Ws=bs(t)?new Vs(t):vs(t)?new Gs(t):t}(new Vs),Ws}if(hs&&!hs.TONE_SILENCE_LOGGING){const t=` * Tone.js ${"v"}14.7.58 * `;console.log(`%c${t}`,"background: #000; color: #fff")}function Us(t){return Math.pow(2,t/12)}let Xs=440;function $s(t){return Math.round(Zs(t))}function Zs(t){return 69+12*Math.log2(t/Xs)}function Ks(t){return Xs*Math.pow(2,(t-69)/12)}class Qs extends Ss{constructor(t,e,n){super(),this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const n=parseInt(t,10),i="."===e?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/n)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let i=0;return t&&"0"!==t&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i+=this._beatsToUnits(parseFloat(n)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof Qs&&this.fromType(this._val),is(this._val))return this._noArg();if(cs(this._val)&&is(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(as(this._val)){let t=0;for(const e in this._val)if(ss(this._val[e])){const n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n}return t}if(ss(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return cs(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class Js extends Qs{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new Js(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const n=new this.constructor(this.context,t).valueOf(),i=this.valueOf();return i+(Math.round(i/n)*n-i)*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let t=1;t<9;t++){const n=Math.pow(2,t);e.push(n+"n."),e.push(n+"n"),e.push(n+"t")}e.push("0");let n=e[0],i=new Js(this.context,e[0]).toSeconds();return e.forEach((e=>{const s=new Js(this.context,e).toSeconds();Math.abs(s-t)<Math.abs(i-t)&&(n=e,i=s)})),n}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const n=Math.floor(e/this._getTimeSignature());let i=e%1*4;e=Math.floor(e)%this._getTimeSignature();const s=i.toString();s.length>3&&(i=parseFloat(parseFloat(s).toFixed(3)));return[n,e,i].join(":")}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return $s(this.toFrequency())}_now(){return this.context.now()}}class tr extends Js{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return Xs}static set A4(t){!function(t){Xs=t}(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:tr.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const n=er[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?n:tr.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let i=1;return t&&"0"!==t&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i*=this._beatsToUnits(parseFloat(n)/4)),i}}})}transpose(t){return new tr(this.context,this.valueOf()*Us(t))}harmonize(t){return t.map((t=>this.transpose(t)))}toMidi(){return $s(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/tr.A4);let n=Math.round(12*e)+57;const i=Math.floor(n/12);i<0&&(n+=-12*i);return nr[n%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return Ks(t)}static ftom(t){return $s(t)}}const er={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},nr=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class ir extends Js{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class sr extends Ss{constructor(){super();const t=xs(sr.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:Ys()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new Js(this.context,t).toSeconds()}toFrequency(t){return new tr(this.context,t).toFrequency()}toTicks(t){return new ir(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach((n=>{is(t[n])&&delete e[n]})),e}get(){const t=function(t){return t.constructor.getDefaults()}(this);return Object.keys(t).forEach((e=>{if(Reflect.has(this,e)){const n=this[e];ss(n)&&ss(n.value)&&ss(n.setValueAtTime)?t[e]=n.value:n instanceof sr?t[e]=n._getPartialProperties(t[e]):os(n)||rs(n)||cs(n)||"boolean"==typeof n?t[e]=n:delete t[e]}})),t}set(t){return Object.keys(t).forEach((e=>{Reflect.has(this,e)&&ss(this[e])&&(this[e]&&ss(this[e].value)&&ss(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof sr?this[e].set(t[e]):this[e]=t[e])})),this}}class rr extends Is{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,n){return Ji(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){for(let n=this._search(e);n>=0;n--){const e=this._timeline[n];if(e.state===t)return e}}getNextState(t,e){const n=this._search(e);if(-1!==n)for(let e=n;e<this._timeline.length;e++){const n=this._timeline[e];if(n.state===t)return n}}}class ar extends sr{constructor(){super(xs(ar.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=xs(ar.getDefaults(),arguments,["param","units","convert"]);for(Qi(ss(t.param)&&(ms(t.param)||t.param instanceof ar),"param must be an AudioParam");!ms(t.param);)t.param=t.param._param;this._swappable=!!ss(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new Is(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,ss(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(sr.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return ss(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return ss(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return ss(this.maxValue)&&ss(this.minValue)&&Ji(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?(e=t,Math.pow(10,e/20)):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t;var e}_toType(t){return this.convert&&"decibels"===this.units?(e=t,Math.log(e)/Math.LN10*20):t;var e}setValueAtTime(t,e){const n=this.toSeconds(e),i=this._fromType(t);return Qi(isFinite(i)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),i=this._events.get(e);let s=this._initialValue;if(null===i)s=this._initialValue;else if("setTargetAtTime"!==i.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)s=i.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let t=i.value;if("setTargetAtTime"===i.type){const e=this._events.getBefore(i.time);t=null===e?this._initialValue:e.value}s="linearRampToValueAtTime"===n.type?this._linearInterpolate(i.time,t,n.time,n.value,e):this._exponentialInterpolate(i.time,t,n.time,n.value,e)}else s=i.value;else{const t=this._events.getBefore(i.time);let n;n=null===t?this._initialValue:t.value,"setTargetAtTime"===i.type&&(s=this._exponentialApproach(i.time,n,i.value,i.constant,e))}return this._toType(s)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const n=this._fromType(t),i=this.toSeconds(e);return Qi(isFinite(n)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:i,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,i),this._param.linearRampToValueAtTime(n,i),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=Math.max(this._minOutput,n),this._assertRange(n);const i=this.toSeconds(e);return Qi(isFinite(n)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,i),this._param.exponentialRampToValueAtTime(n,i),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);const i=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,i),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){const i=this._fromType(t);Qi(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const s=this.toSeconds(e);return this._assertRange(i),Qi(isFinite(i)&&isFinite(s),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:s,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",t,s,n),this._param.setTargetAtTime(i,s,n),this}setValueCurveAtTime(t,e,n,i=1){n=this.toSeconds(n),e=this.toSeconds(e);const s=this._fromType(t[0])*i;this.setValueAtTime(this._toType(s),e);const r=n/(t.length-1);for(let n=1;n<t.length;n++){const s=this._fromType(t[n])*i;this.linearRampToValueAtTime(this._toType(s),e+n*r)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return Qi(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));Qi(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);const i=this._events.get(e),s=this._events.getAfter(e);return i&&Ns(i.time,e)?s?(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):s&&(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time),"linearRampToValueAtTime"===s.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===s.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t,e=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const n=this._events.get(e);if(n&&"setTargetAtTime"===n.type){const i=this._events.getAfter(n.time),s=i?i.time:e+2,r=(s-e)/10;for(let n=e;n<s;n+=r)t.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,(e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)})),this}setParam(t){Qi(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,i,s){return n+(e-n)*Math.exp(-(s-t)/i)}_linearInterpolate(t,e,n,i,s){return e+(s-t)/(n-t)*(i-e)}_exponentialInterpolate(t,e,n,i,s){return e*Math.pow(i/e,(s-t)/(n-t))}}class or extends sr{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return ss(this.input)?ms(this.input)||this.input instanceof ar?1:this.input.numberOfInputs:0}get numberOfOutputs(){return ss(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return ss(t)&&(t instanceof or||gs(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach((e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation}))}_getChannelProperties(){const t=this._getInternalNodes();Qi(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,n=0){return lr(this,t,e,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return ns("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,n=0){return function(t,e,n=0,i=0){if(ss(e))for(;e instanceof or;)e=e.input;for(;!gs(t);)ss(t.output)&&(t=t.output);ms(e)?t.disconnect(e,n):gs(e)?t.disconnect(e,n,i):t.disconnect()}(this,t,e,n),this}chain(...t){return cr(this,...t),this}fan(...t){return t.forEach((t=>this.connect(t))),this}dispose(){return super.dispose(),ss(this.input)&&(this.input instanceof or?this.input.dispose():gs(this.input)&&this.input.disconnect()),ss(this.output)&&(this.output instanceof or?this.output.dispose():gs(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function cr(...t){const e=t.shift();t.reduce(((t,e)=>(t instanceof or?t.connect(e):gs(t)&&lr(t,e),e)),e)}function lr(t,e,n=0,i=0){for(Qi(ss(t),"Cannot connect from undefined node"),Qi(ss(e),"Cannot connect to undefined node"),(e instanceof or||gs(e))&&Qi(e.numberOfInputs>0,"Cannot connect to node with no inputs"),Qi(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof or||e instanceof ar;)ss(e.input)&&(e=e.input);for(;t instanceof or;)ss(t.output)&&(t=t.output);ms(e)?t.connect(e,n):t.connect(e,n,i)}class hr extends or{constructor(){super(xs(hr.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=xs(hr.getDefaults(),arguments,["gain","units"]);this.gain=new ar({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),Hs(this,"gain")}static getDefaults(){return Object.assign(or.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class ur extends or{constructor(t){super(t),this.onended=qs,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new hr({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(or.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:qs})}_startGain(t,e=1){Qi(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){Qi(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()}),this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==qs&&(this.onended(this),this.onended=qs,!this.context.isOffline)){const t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),Qi(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class dr extends ur{constructor(){super(xs(dr.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=xs(dr.getDefaults(),arguments,["offset"]);lr(this._source,this._gainNode),this.offset=new ar({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(ur.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class pr extends or{constructor(){super(xs(pr.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=xs(pr.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new dr({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(or.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,n=0){return fr(this,t,e,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,i){return this._param.setValueCurveAtTime(t,e,n,i),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function fr(t,e,n,i){(e instanceof ar||ms(e)||e instanceof pr&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof pr&&(e.overridden=!0)),lr(t,e,n,i)}class mr extends ar{constructor(){super(xs(mr.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new Is(1/0),this._multiplier=1;const t=xs(mr.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(ar.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);const i=this._fromType(t),s=this._events.get(e),r=Math.round(Math.max(1/n,1));for(let t=0;t<=r;t++){const r=n*t+e,a=this._exponentialApproach(s.time,s.value,i,n,r);this.linearRampToValueAtTime(this._toType(a),r)}return this}setValueAtTime(t,e){const n=this.toSeconds(e);super.setValueAtTime(t,e);const i=this._events.get(n),s=this._events.previousEvent(i),r=this._getTicksUntilEvent(s,n);return i.ticks=Math.max(r,0),this}linearRampToValueAtTime(t,e){const n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const i=this._events.get(n),s=this._events.previousEvent(i),r=this._getTicksUntilEvent(s,n);return i.ticks=Math.max(r,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const n=this._fromType(t),i=this._events.get(e),s=Math.round(Math.max(10*(e-i.time),1)),r=(e-i.time)/s;for(let t=0;t<=s;t++){const s=r*t+i.time,a=this._exponentialInterpolate(i.time,i.value,e,n,s);this.linearRampToValueAtTime(this._toType(a),s)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(is(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}const n=this._fromType(this.getValueAtTime(t.time));let i=this._fromType(this.getValueAtTime(e));const s=this._events.get(e);return s&&s.time===e&&"setValueAtTime"===s.type&&(i=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+i)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(e);return this.getTimeOfTick(i+t)-n}getTimeOfTick(t){const e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){const i=this._fromType(this.getValueAtTime(e.time)),s=(this._fromType(this.getValueAtTime(n.time))-i)/(n.time-e.time),r=Math.sqrt(Math.pow(i,2)-2*s*(e.ticks-t)),a=(-i+r)/s,o=(-i-r)/s;return(a>0?a:o)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const n=this.toSeconds(e),i=this.toSeconds(t),s=this.getTicksAtTime(n);return this.getTicksAtTime(n+i)-s}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class gr extends pr{constructor(){super(xs(gr.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=xs(gr.getDefaults(),arguments,["value"]);this.input=this._param=new mr({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(pr.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class vr extends sr{constructor(){super(xs(vr.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new rr,this._tickOffset=new Is;const t=xs(vr.getDefaults(),arguments,["frequency"]);this.frequency=new gr({context:this.context,units:t.units,value:t.frequency}),Hs(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},sr.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),ss(e)&&this.setTicksAtTime(e,n)),this}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),n=this._state.getLastState("stopped",e),i={state:"paused",time:e};this._state.add(i);let s=n,r=0;return this._state.forEachBetween(n.time,e+this.sampleTime,(t=>{let e=s.time;const n=this._tickOffset.get(t.time);n&&n.time>=s.time&&(r=n.ticks,e=n.time),"started"===s.state&&"started"!==t.state&&(r+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),s=t})),this._state.remove(i),r}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let i=e,s=0;return this._state.forEachBetween(e.time,t+this.sampleTime,(t=>{let e=i.time;const n=this._tickOffset.get(t.time);n&&n.time>=i.time&&(s=n.seconds,e=n.time),"started"===i.state&&"started"!==t.state&&(s+=t.time-e),i=t})),this._state.remove(n),s}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const n=this._tickOffset.get(e),i=this._state.get(e),s=Math.max(n.time,i.time),r=this.frequency.getTicksAtTime(s)+t-n.ticks;return this.frequency.getTimeOfTick(r)}forEachTickBetween(t,e,n){let i=this._state.get(t);this._state.forEachBetween(t,e,(e=>{i&&"started"===i.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(i.time,t),e.time-this.sampleTime,n),i=e}));let s=null;if(i&&"started"===i.state){const r=Math.max(i.time,t),a=this.frequency.getTicksAtTime(r),o=a-this.frequency.getTicksAtTime(i.time);let c=Math.ceil(o)-o;c=Ns(c,1)?0:c;let l=this.frequency.getTimeOfTick(a+c);for(;l<e;){try{n(l,Math.round(this.getTicksAtTime(l)))}catch(t){s=t;break}l+=this.frequency.getDurationOfTicks(1,l)}}if(s)throw s;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class br extends sr{constructor(){super(xs(br.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=qs,this._lastUpdate=0,this._state=new rr("stopped"),this._boundLoop=this._loop.bind(this);const t=xs(br.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new vr({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Hs(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(sr.getDefaults(),{callback:qs,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){ts(this.context);const n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+t,n)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,(t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}})),this._tickSource.forEachTickBetween(t,e,((t,e)=>{this.callback(t,e)})))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Rs.mixin(br);class _r extends Ss{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=xs(_r.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach((e=>{this._loadingCount++;const n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)}))}static getDefaults(){return{baseUrl:"",onerror:qs,onload:qs,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return Qi(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every((([t,e])=>e.loaded))}add(t,e,n=qs,i=qs){return cs(e)?this._buffers.set(t.toString(),new zs(this.baseUrl+e,n,i)):this._buffers.set(t.toString(),new zs(e,n,i)),this}dispose(){return super.dispose(),this._buffers.forEach((t=>t.dispose())),this._buffers.clear(),this}}class yr extends tr{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(t){return $s(super._frequencyToUnits(t))}_ticksToUnits(t){return $s(super._ticksToUnits(t))}_beatsToUnits(t){return $s(super._beatsToUnits(t))}_secondsToUnits(t){return $s(super._secondsToUnits(t))}toMidi(){return this.valueOf()}toFrequency(){return Ks(this.toMidi())}transpose(t){return new yr(this.context,this.toMidi()+t)}}class wr extends ir{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class xr extends sr{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Is,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}Ps((t=>{t.draw=new xr({context:t})})),Bs((t=>{t.draw.dispose()}));class kr extends Ss{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){Qi(ss(t.time),"Events must have a time property"),Qi(ss(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new Tr(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const n of e)if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,(t=>this.remove(t))),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,n=null;if(t.getBalance()>0)if(null===t.left.right)e=t.left,e.right=t.right,n=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)e=t.right,e.left=t.left,n=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n&&this._rebalance(n)}t.dispose()}_rotateLeft(t){const e=t.parent,n=t.isLeftChild(),i=t.right;i&&(t.right=i.left,i.left=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rotateRight(t){const e=t.parent,n=t.isLeftChild(),i=t.left;i&&(t.left=i.right,i.right=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let n=1;n<e.length;n++)e[n].low>t.low&&(t=e[n]);return t.event}}return null}forEach(t){if(null!==this._root){const e=[];this._root.traverse((t=>e.push(t))),e.forEach((e=>{e.event&&t(e.event)}))}return this}forEachAtTime(t,e){if(null!==this._root){const n=[];this._root.search(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}forEachFrom(t,e){if(null!==this._root){const n=[];this._root.searchAfter(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse((t=>t.dispose())),this._root=null,this}}class Tr{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Sr extends or{constructor(){super(xs(Sr.getDefaults(),arguments,["volume"])),this.name="Volume";const t=xs(Sr.getDefaults(),arguments,["volume"]);this.input=this.output=new hr({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,Hs(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(or.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Cr extends or{constructor(){super(xs(Cr.getDefaults(),arguments)),this.name="Destination",this.input=new Sr({context:this.context}),this.output=new hr({context:this.context}),this.volume=this.input.volume;const t=xs(Cr.getDefaults(),arguments);cr(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(or.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),cr(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}Ps((t=>{t.destination=new Cr({context:t})})),Bs((t=>{t.destination.dispose()}));class Ar extends Ss{constructor(t){super(),this.name="TimelineValue",this._timeline=new Is({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class Er{constructor(t,e){this.id=Er._eventId++;const n=Object.assign(Er.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:qs,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}Er._eventId=0;class Mr extends Er{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(Mr.getDefaults(),e);this.duration=new wr(t.context,n.duration).valueOf(),this._interval=new wr(t.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Er.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new wr(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new wr(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new wr(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class Nr extends sr{constructor(){super(xs(Nr.getDefaults(),arguments)),this.name="Transport",this._loop=new Ar(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Is,this._repeatedEvents=new kr,this._syncedSignals=[],this._swingAmount=0;const t=xs(Nr.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new br({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),Hs(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(sr.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){const n=e%(2*this._swingTicks)/(2*this._swingTicks),i=Math.sin(n*Math.PI)*this._swingAmount;t+=new wr(this.context,2*this._swingTicks/3).toSeconds()*i}this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._timeline.forEachAtTime(e,(e=>e.invoke(t)))}schedule(t,e){const n=new Er(this,{callback:t,time:new ir(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n,i=1/0){const s=new Mr(this,{callback:t,duration:new Js(this.context,i).toTicks(),interval:new Js(this.context,e).toTicks(),time:new ir(this.context,n).toTicks()});return this._addEvent(s,this._repeatedEvents)}scheduleOnce(t,e){const n=new Er(this,{callback:t,once:!0,time:new ir(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,(t=>this.clear(t.id))),this._repeatedEvents.forEachFrom(e,(t=>this.clear(t.id))),this}_bindClockEvents(){this._clock.on("start",((t,e)=>{e=new wr(this.context,e).toSeconds(),this.emit("start",t,e)})),this._clock.on("stop",(t=>{this.emit("stop",t)})),this._clock.on("pause",(t=>{this.emit("pause",t)}))}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let n;return ss(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){os(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new Js(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new Js(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new wr(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new wr(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(e),i=this._clock.getTimeOfTick(Math.ceil(n));this.emit("stop",i),this._clock.setTicksAtTime(t,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e)}}syncSignal(t,e){if(!e){const n=this.now();if(0!==t.getValueAtTime(n)){const i=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/i}else e=0}const n=new hr(e);return this.bpm.connect(n),n.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:n,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),Fs(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Rs.mixin(Nr),Ps((t=>{t.transport=new Nr({context:t})})),Bs((t=>{t.transport.dispose()}));class Ir extends or{constructor(t){super(t),this.input=void 0,this._state=new rr("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=qs,this._syncedStop=qs,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Sr({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,Hs(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(or.getDefaults(),{mute:!1,onstop:qs,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let i=is(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(i=this._clampToCurrentTime(i),this._synced||"started"!==this._state.getValueAtTime(i))if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const t=this._state.get(i);t&&(t.offset=this.toSeconds(ks(e,0)),t.duration=n?this.toSeconds(n):void 0);const s=this.context.transport.schedule((t=>{this._start(t,e,n)}),i);this._scheduled.push(s),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else ts(this.context),this._start(i,e,n);else Qi(As(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,e,n);return this}stop(t){let e=is(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||ss(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const n=this._state.get(e);if(n&&"started"===n.state&&n.time!==e){const i=e-this.toSeconds(n.time);let s;n.duration&&(s=this.toSeconds(n.duration)-i),this._start(t,this.toSeconds(n.offset)+i,s)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((t=>this.context.transport.clear(t))),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=qs,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class Or extends ur{constructor(){super(xs(Or.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=xs(Or.getDefaults(),arguments,["url","onload"]);lr(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new ar({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new zs(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(ur.getDefaults(),{url:new zs,loop:!1,loopEnd:0,loopStart:0,onload:qs,onerror:qs,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n,i=1){Qi(this.buffer.loaded,"buffer is either not set or not loaded");const s=this.toSeconds(t);this._startGain(s,i),e=this.loop?ks(e,this.loopStart):ks(e,0);let r=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),n=t-e;Es(r,t)&&(r=(r-e)%n+e),Ns(r,this.buffer.duration)&&(r=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,Ms(r,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(s,r)),ss(n)){let t=this.toSeconds(n);t=Math.max(t,0),this.stop(s+t)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function Pr(t,e){return ps(this,void 0,void 0,(function*(){const n=e/t.context.sampleRate,i=new Gs(1,n,t.context.sampleRate);new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:i})).toDestination().start(0);return(yield i.render()).getChannelData(0)}))}class Dr extends ur{constructor(){super(xs(Dr.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=xs(Dr.getDefaults(),arguments,["frequency","type"]);lr(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new ar({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new ar({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),Hs(this,["frequency","detune"])}static getDefaults(){return Object.assign(ur.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class Br extends Ir{constructor(){super(xs(Br.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=xs(Br.getDefaults(),arguments,["frequency","type"]);this.frequency=new pr({context:this.context,units:"frequency",value:t.frequency}),Hs(this,"frequency"),this.detune=new pr({context:this.context,units:"cents",value:t.detune}),Hs(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(Ir.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),n=new Dr({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){return Br._periodicWaveCache.find((t=>{return t.phase===this._phase&&(e=t.partials,n=this._partials,e.length===n.length&&e.every(((t,e)=>n[e]===t)));var e,n}))}{const t=Br._periodicWaveCache.find((t=>t.type===this._type&&t.phase===this._phase));return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(ss(e)){const{partials:t,wave:n}=e;this._wave=n,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[e,n]=this._getRealImaginary(t,this._phase),i=this.context.createPeriodicWave(e,n);this._wave=i,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),Br._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),Br._periodicWaveCache.length>100&&Br._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){Ji(t,0);let e=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach(((t,n)=>e[n]=t)),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let n=2048;const i=new Float32Array(n),s=new Float32Array(n);let r=1;if("custom"===t){if(r=this._partials.length+1,this._partialCount=this._partials.length,n=r,0===this._partials.length)return[i,s]}else{const e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(r=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],r=Math.max(r,2),n=r):this._partialCount=0,this._partials=[]}for(let a=1;a<n;++a){const n=2/(a*Math.PI);let o;switch(t){case"sine":o=a<=r?1:0,this._partials[a-1]=o;break;case"square":o=1&a?2*n:0,this._partials[a-1]=o;break;case"sawtooth":o=n*(1&a?1:-1),this._partials[a-1]=o;break;case"triangle":o=1&a?n*n*2*(a-1>>1&1?-1:1):0,this._partials[a-1]=o;break;case"custom":o=this._partials[a-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==o?(i[a]=-o*Math.sin(e*a),s[a]=o*Math.cos(e*a)):(i[a]=0,s[a]=0)}return[i,s]}_inverseFFT(t,e,n){let i=0;const s=t.length;for(let r=0;r<s;r++)i+=t[r]*Math.cos(r*n)+e[r]*Math.sin(r*n);return i}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let n=0;const i=2*Math.PI;for(let s=0;s<32;s++)n=Math.max(this._inverseFFT(t,e,s/32*i),n);return s=-this._inverseFFT(t,e,this._phase)/n,r=-1,a=1,Math.max(Math.min(s,a),r);var s,r,a}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return ps(this,void 0,void 0,(function*(){return Pr(this,t)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}Br._periodicWaveCache=[];class Rr extends or{constructor(){super(Object.assign(xs(Rr.getDefaults(),arguments,["context"])))}connect(t,e=0,n=0){return fr(this,t,e,n),this}}class Lr extends Rr{constructor(){super(Object.assign(xs(Lr.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=xs(Lr.getDefaults(),arguments,["mapping","length"]);os(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):"function"==typeof t.mapping&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(pr.getDefaults(),{length:1024})}setMap(t,e=1024){const n=new Float32Array(e);for(let i=0,s=e;i<s;i++){const e=i/(s-1)*2-1;n[i]=t(e,i)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){Qi(["none","2x","4x"].some((e=>e.includes(t))),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class Vr extends Rr{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new Lr({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Hr extends pr{constructor(){super(Object.assign(xs(Hr.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=xs(Hr.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new hr({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(pr.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class Fr extends Ir{constructor(){super(xs(Fr.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new Vr({context:this.context}),this._modulationNode=new hr({context:this.context});const t=xs(Fr.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Br({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Br({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new Hr({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Hs(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Br.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return ps(this,void 0,void 0,(function*(){return Pr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class qr extends Ir{constructor(){super(xs(qr.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new hr({context:this.context,gain:0});const t=xs(qr.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Br({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new pr({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new Br({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new Hr({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new Hr({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Hs(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Br.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return ps(this,void 0,void 0,(function*(){return Pr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class zr extends Ir{constructor(){super(xs(zr.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new hr({context:this.context,gain:0}),this._thresh=new Lr({context:this.context,mapping:t=>t<=0?-1:1});const t=xs(zr.getDefaults(),arguments,["frequency","width"]);this.width=new pr({context:this.context,units:"audioRange",value:t.width}),this._triangle=new Br({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Hs(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Ir.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return ps(this,void 0,void 0,(function*(){return Pr(this,t)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class Gr extends Ir{constructor(){super(xs(Gr.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=xs(Gr.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new pr({context:this.context,units:"frequency",value:t.frequency}),this.detune=new pr({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,Hs(this,["frequency","detune"])}static getDefaults(){return Object.assign(Br.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach((e=>e.start(t)))}_stop(t){t=this.toSeconds(t),this._forEach((e=>e.stop(t)))}_restart(t){this._forEach((e=>e.restart(t)))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach((e=>e.type=t))}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,n=t/(this._oscillators.length-1);this._forEach(((t,i)=>t.detune.value=e+n*i))}}get count(){return this._oscillators.length}set count(t){if(Ji(t,1),this._oscillators.length!==t){this._forEach((t=>t.dispose())),this._oscillators=[];for(let e=0;e<t;e++){const n=new Br({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):qs});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,"started"===this.state&&this._forEach((t=>t.start()))}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach(((t,e)=>t.phase=this._phase+e/this.count*360))}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach((e=>e.baseType=t)),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach((e=>e.partials=t)))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach((e=>e.partialCount=t)),this._type=this._oscillators[0].type}asArray(t=1024){return ps(this,void 0,void 0,(function*(){return Pr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach((t=>t.dispose())),this}}class jr extends Ir{constructor(){super(xs(jr.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Hr({context:this.context,value:2});const t=xs(jr.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new zr({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Br({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Hs(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Ir.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return ps(this,void 0,void 0,(function*(){return Pr(this,t)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const Wr={am:Fr,fat:Gr,fm:qr,oscillator:Br,pulse:zr,pwm:jr};class Yr extends Ir{constructor(){super(xs(Yr.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=xs(Yr.getDefaults(),arguments,["frequency","type"]);this.frequency=new pr({context:this.context,units:"frequency",value:t.frequency}),this.detune=new pr({context:this.context,units:"cents",value:t.detune}),Hs(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(Br.getDefaults(),qr.getDefaults(),Fr.getDefaults(),Gr.getDefaults(),zr.getDefaults(),jr.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some((t=>this._sourceType===t))&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=Wr[t],n=this.now();if(this._oscillator){const t=this._oscillator;t.stop(n),this.context.setTimeout((()=>t.dispose()),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof Wr[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&rs(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&rs(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&cs(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(t=1024){return ps(this,void 0,void 0,(function*(){return Pr(this,t)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function Ur(t,e=1/0){const n=new WeakMap;return function(i,s){Reflect.defineProperty(i,s,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){Ji(i,t,e),n.set(this,i)}})}}function Xr(t,e=1/0){const n=new WeakMap;return function(i,s){Reflect.defineProperty(i,s,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){Ji(this.toSeconds(i),t,e),n.set(this,i)}})}}class $r extends Ir{constructor(){super(xs($r.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const t=xs($r.getDefaults(),arguments,["url","onload"]);this._buffer=new zs({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Ir.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:qs,onerror:qs,playbackRate:1,reverse:!1})}load(t){return ps(this,void 0,void 0,(function*(){return yield this._buffer.load(t),this._onload(),this}))}_onload(t=qs){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){e=this._loop?ks(e,this._loopStart):ks(e,0);let i=this.toSeconds(e);this._synced&&(i*=this._playbackRate);const s=n;n=ks(n,Math.max(this._buffer.duration-i,0));let r=this.toSeconds(n);r/=this._playbackRate,t=this.toSeconds(t);const a=new Or({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+r),this._state.setStateAtTime("stopped",t+r,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&is(s)?a.start(t,i):a.start(t,i,r-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach((t=>t.stop(e)))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}seek(t,e){const n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){const e=this.toSeconds(t);this._stop(n),this._start(n,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&Ji(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopStart=t}))}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&Ji(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopEnd=t}))}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach((e=>{e.loop=t})),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach((t=>t.cancelStop()))),this._activeSources.forEach((n=>{n.playbackRate.setValueAtTime(t,e)}))}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach((t=>t.dispose())),this._activeSources.clear(),this._buffer.dispose(),this}}ds([Xr(0)],$r.prototype,"fadeIn",void 0),ds([Xr(0)],$r.prototype,"fadeOut",void 0);class Zr extends or{constructor(){super(xs(Zr.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new pr({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=xs(Zr.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(or.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(cs(t))return t;{let n;for(n in Kr)if(Kr[n][e]===t)return n;return t}}_setCurve(t,e,n){if(cs(n)&&Reflect.has(Kr,n)){const i=Kr[n];as(i)?"_decayCurve"!==t&&(this[t]=i[e]):this[t]=i}else{if(!os(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){Qi(["linear","exponential"].some((e=>e===t)),`Invalid envelope curve: ${t}`),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack);const i=this.toSeconds(this.decay),s=this.getValueAtTime(t);if(s>0){n=(1-s)/(1/n)}if(n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,n,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let i=this._attackCurve;for(let t=1;t<i.length;t++)if(i[t-1]<=s&&s<=i[t]){i=this._attackCurve.slice(t),i[0]=s;break}this._sig.setValueCurveAtTime(i,t,n,e)}if(i&&this.sustain<1){const s=e*this.sustain,r=t+n;this.log("decay",r),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(s,i+r):this._sig.exponentialApproachValueAtTime(s,r,i)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(Qi(os(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,n=0){return fr(this,t,e,n),this}asArray(t=1024){return ps(this,void 0,void 0,(function*(){const e=t/this.context.sampleRate,n=new Gs(1,e,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),s=i+this.toSeconds(this.release),r=.1*s,a=s+r,o=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/a,decay:e*this.toSeconds(this.decay)/a,release:e*this.toSeconds(this.release)/a,context:n}));o._sig.toDestination(),o.triggerAttackRelease(e*(i+r)/a,0);return(yield n.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}ds([Xr(0)],Zr.prototype,"attack",void 0),ds([Xr(0)],Zr.prototype,"decay",void 0),ds([Ur(0,1)],Zr.prototype,"sustain",void 0),ds([Xr(0)],Zr.prototype,"release",void 0);const Kr=(()=>{const t=128;let e,n;const i=[];for(e=0;e<t;e++)i[e]=Math.sin(e/127*(Math.PI/2));const s=[];for(e=0;e<127;e++){n=e/127;const t=Math.sin(n*(2*Math.PI)*6.4-Math.PI/2)+1;s[e]=t/10+.83*n}s[127]=1;const r=[];for(e=0;e<t;e++)r[e]=Math.ceil(e/127*5)/5;const a=[];for(e=0;e<t;e++)n=e/127,a[e]=.5*(1-Math.cos(Math.PI*n));const o=[];for(e=0;e<t;e++){n=e/127;const t=4*Math.pow(n,3)+.2,i=Math.cos(t*Math.PI*2*n);o[e]=Math.abs(i*(1-n))}function c(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=1-t[n];return e}return{bounce:{In:c(o),Out:o},cosine:{In:i,Out:(l=i,l.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:s,Out:c(s)},sine:{In:a,Out:c(a)},step:{In:r,Out:c(r)}};var l})();class Qr extends or{constructor(){super(xs(Qr.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=xs(Qr.getDefaults(),arguments);this._volume=this.output=new Sr({context:this.context,volume:t.volume}),this.volume=this._volume.volume,Hs(this,"volume")}static getDefaults(){return Object.assign(or.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const n=this["_original_"+t]=this[t];this[t]=(...t)=>{const i=t[e],s=this.context.transport.schedule((i=>{t[e]=i,n.apply(this,t)}),i);this._scheduledEvents.push(s)}}unsync(){return this._scheduledEvents.forEach((t=>this.context.transport.clear(t))),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,n,i){const s=this.toSeconds(n),r=this.toSeconds(e);return this.triggerAttack(t,s,i),this.triggerRelease(s+r),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Jr extends Qr{constructor(){super(xs(Jr.getDefaults(),arguments));const t=xs(Jr.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Qr.getDefaults(),{detune:0,onsilence:qs,portamento:0})}triggerAttack(t,e,n=1){this.log("triggerAttack",t,e,n);const i=this.toSeconds(e);return this._triggerEnvelopeAttack(i,n),this.setNote(t,i),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const n=this.toSeconds(e),i=t instanceof tr?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,t,n)}else this.frequency.setValueAtTime(i,n);return this}}ds([Xr(0)],Jr.prototype,"portamento",void 0);class ta extends Zr{constructor(){super(xs(ta.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new hr({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class ea extends Jr{constructor(){super(xs(ea.getDefaults(),arguments)),this.name="Synth";const t=xs(ea.getDefaults(),arguments);this.oscillator=new Yr(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new ta(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),Hs(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Jr.getDefaults(),{envelope:Object.assign(Ts(Zr.getDefaults(),Object.keys(or.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Ts(Yr.getDefaults(),[...Object.keys(Ir.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class na extends ea{constructor(){super(xs(na.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=xs(na.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,Hs(this,["oscillator","envelope"])}static getDefaults(){return ws(Jr.getDefaults(),ea.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const n=this.toSeconds(e),i=this.toFrequency(t instanceof tr?t.toFrequency():t),s=i*this.octaves;return this.oscillator.frequency.setValueAtTime(s,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}ds([Ur(0)],na.prototype,"octaves",void 0),ds([Xr(0)],na.prototype,"pitchDecay",void 0);const ia=new Set;function sa(t){ia.add(t)}function ra(t,e){const n=`registerProcessor("${t}", ${e})`;ia.add(n)}sa('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');sa("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");sa("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");ra("feedback-comb-filter",'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class aa extends Qr{constructor(){super(xs(aa.getDefaults(),arguments,["voice","options"])),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0;const t=xs(aa.getDefaults(),arguments,["voice","options"]);Qi(!rs(t.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const e=t.voice.getDefaults();this.options=Object.assign(e,t.options),this.voice=t.voice,this.maxPolyphony=t.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const n=this._voices.indexOf(this._dummyVoice);this._voices.splice(n,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(Qr.getDefaults(),{maxPolyphony:32,options:{},voice:ea})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(t){this._availableVoices.push(t);const e=this._activeVoices.findIndex((e=>e.voice===t));this._activeVoices.splice(e,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return t.connect(this.output),this._voices.push(t),t}ns("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),this.context.isOffline||t.dispose()}}_triggerAttack(t,e,n){t.forEach((t=>{const i=new yr(this.context,t).toMidi(),s=this._getNextAvailableVoice();s&&(s.triggerAttack(t,e,n),this._activeVoices.push({midi:i,voice:s,released:!1}),this.log("triggerAttack",t,e))}))}_triggerRelease(t,e){t.forEach((t=>{const n=new yr(this.context,t).toMidi(),i=this._activeVoices.find((({midi:t,released:e})=>t===n&&!e));i&&(i.voice.triggerRelease(e),i.released=!0,this.log("triggerRelease",t,e))}))}_scheduleEvent(t,e,n,i){Qi(!this.disposed,"Synth was already disposed"),n<=this.now()?"attack"===t?this._triggerAttack(e,n,i):this._triggerRelease(e,n):this.context.setTimeout((()=>{this._scheduleEvent(t,e,n,i)}),n-this.now())}triggerAttack(t,e,n){Array.isArray(t)||(t=[t]);const i=this.toSeconds(e);return this._scheduleEvent("attack",t,i,n),this}triggerRelease(t,e){Array.isArray(t)||(t=[t]);const n=this.toSeconds(e);return this._scheduleEvent("release",t,n),this}triggerAttackRelease(t,e,n,i){const s=this.toSeconds(n);if(this.triggerAttack(t,s,i),os(e)){Qi(os(t),"If the duration is an array, the notes must also be an array"),t=t;for(let n=0;n<t.length;n++){const i=e[Math.min(n,e.length-1)],r=this.toSeconds(i);Qi(r>0,"The duration must be greater than 0"),this.triggerRelease(t[n],s+r)}}else{const n=this.toSeconds(e);Qi(n>0,"The duration must be greater than 0"),this.triggerRelease(t,s+n)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}set(t){const e=Ts(t,["onsilence","context"]);return this.options=ws(this.options,e),this._voices.forEach((t=>t.set(e))),this._dummyVoice.set(e),this}get(){return this._dummyVoice.get()}releaseAll(t){const e=this.toSeconds(t);return this._activeVoices.forEach((({voice:t})=>{t.triggerRelease(e)})),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach((t=>t.dispose())),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class oa extends Qr{constructor(){super(xs(oa.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const t=xs(oa.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach((n=>{const i=parseInt(n,10);if(Qi(ls(n)||rs(i)&&isFinite(i),`url key is neither a note or midi pitch: ${n}`),ls(n)){const i=new tr(this.context,n).toMidi();e[i]=t.urls[n]}else rs(i)&&isFinite(i)&&(e[i]=t.urls[i])})),this._buffers=new _r({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Qr.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:qs,onerror:qs,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,n=1){return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach((t=>{const i=Zs(new tr(this.context,t).toFrequency()),s=Math.round(i),r=i-s,a=this._findClosest(s),o=s-a,c=this._buffers.get(o),l=Us(a+r),h=new Or({url:c,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:l}).connect(this.output);h.start(e,0,c.duration/l,n),os(this._activeSources.get(s))||this._activeSources.set(s,[]),this._activeSources.get(s).push(h),h.onended=()=>{if(this._activeSources&&this._activeSources.has(s)){const t=this._activeSources.get(s),e=t.indexOf(h);-1!==e&&t.splice(e,1)}}})),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach((t=>{const n=new tr(this.context,t).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const t=this._activeSources.get(n);e=this.toSeconds(e),t.forEach((t=>{t.stop(e)})),this._activeSources.set(n,[])}})),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach((t=>{for(;t.length;){t.shift().stop(e)}})),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,n,i=1){const s=this.toSeconds(n);return this.triggerAttack(t,s,i),os(e)?(Qi(os(t),"notes must be an array when duration is array"),t.forEach(((t,n)=>{const i=e[Math.min(n,e.length-1)];this.triggerRelease(t,s+this.toSeconds(i))}))):this.triggerRelease(t,s+this.toSeconds(e)),this}add(t,e,n){if(Qi(ls(t)||isFinite(t),`note must be a pitch or midi: ${t}`),ls(t)){const i=new tr(this.context,t).toMidi();this._buffers.add(i,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach((t=>{t.forEach((t=>t.dispose()))})),this._activeSources.clear(),this}}ds([Xr(0)],oa.prototype,"attack",void 0),ds([Xr(0)],oa.prototype,"release",void 0);ra("bit-crusher","\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class ca extends or{constructor(){super(...arguments),this.name="Listener",this.positionX=new ar({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new ar({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new ar({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new ar({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new ar({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new ar({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new ar({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new ar({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new ar({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(or.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}Ps((t=>{t.listener=new ca({context:t})})),Bs((t=>{t.listener.dispose()}));Ys().transport,Ys().destination,Ys().destination,Ys().listener,Ys().draw,Ys();var la={FONTEM:360,FONTSIZE:30};la.STEP=93*la.FONTSIZE/720,la.SPACE=10,la.TOPNOTE=15,la.STAVEHEIGHT=100,la.INDENT=50;var ha=la,ua={clone:function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},cloneArray:function(t){for(var e=[],n=0;n<t.length;n++)e.push(ua.clone(t[n]));return e},cloneHashOfHash:function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=ua.clone(t[n]));return e},cloneHashOfArrayOfHash:function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=ua.cloneArray(t[n]));return e},gsub:function(t,e,n){return t.split(e).join(n)},strip:function(t){return t.replace(/^\s+/,"").replace(/\s+$/,"")},startsWith:function(t,e){return 0===t.indexOf(e)},endsWith:function(t,e){var n=t.length-e.length;return n>=0&&t.lastIndexOf(e)===n},each:function(t,e,n){for(var i=0,s=t.length;i<s;i++)e.apply(n,[t[i],i])},last:function(t){return 0===t.length?null:t[t.length-1]},compact:function(t){for(var e=[],n=0;n<t.length;n++)t[n]&&e.push(t[n]);return e},detect:function(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}};[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){null!==this.parentNode&&this.parentNode.removeChild(this)}})}));var da=ua;function pa(t,e){for(var n=[],i=null,s=0;s<t.length;s++){var r=t[s];r.top!==i&&(n.push({milliseconds:r.milliseconds-e,top:r.top,bottom:r.top+r.height}),i=r.top)}return n}var fa,ma,ga=function(t,e){var n=this;if(e||(e={}),n.qpm=e.qpm?parseInt(e.qpm,10):null,!n.qpm){var i=t.metaText?t.metaText.tempo:null;n.qpm=t.getBpm(i)}n.extraMeasuresAtBeginning=e.extraMeasuresAtBeginning?parseInt(e.extraMeasuresAtBeginning,10):0,n.beatCallback=e.beatCallback,n.eventCallback=e.eventCallback,n.lineEndCallback=e.lineEndCallback,n.lineEndAnticipation=e.lineEndAnticipation?parseInt(e.lineEndAnticipation,10):0,n.beatSubdivisions=e.beatSubdivisions?parseInt(e.beatSubdivisions,10):1,n.replaceTarget=function(t){t.setTiming(n.qpm,n.extraMeasuresAtBeginning),0===t.noteTimings.length&&t.setTiming(0,0),n.lineEndCallback&&(n.lineEndTimings=pa(t.noteTimings,n.lineEndAnticipation)),n.noteTimings=t.noteTimings},n.replaceTarget(t),0!==n.noteTimings.length&&(n.noteTimings=t.noteTimings,n.millisecondsPerBeat=1e3/(n.qpm/60)/n.beatSubdivisions,n.lastMoment=n.noteTimings[n.noteTimings.length-1].milliseconds,n.totalBeats=Math.round(n.lastMoment/n.millisecondsPerBeat),n.startTime=null,n.currentBeat=0,n.currentEvent=0,n.isPaused=!1,n.isRunning=!1,n.pausedTime=null,n.justUnpaused=!1,n.newSeekPercent=0,n.justSeeked=!1,n.doTiming=function(t){if(n.startTime){if(n.justUnpaused){var e=t-n.pausedTime;n.startTime+=e}}else n.startTime=t;if(n.justUnpaused=!1,n.justSeeked&&(!function(t){var e=(t-n.startTime)/n.lastMoment-n.newSeekPercent,i=n.lastMoment*e;n.startTime=n.startTime+i;var s=t-n.startTime;s+=50;var r=n.currentBeat;for(n.currentBeat=Math.floor(s/n.millisecondsPerBeat),n.beatCallback&&r!==n.currentBeat&&n.beatCallback(n.currentBeat/n.beatSubdivisions,n.totalBeats/n.beatSubdivisions,n.lastMoment),n.currentEvent=0;n.noteTimings.length>n.currentEvent&&n.noteTimings[n.currentEvent].milliseconds<s;)n.currentEvent++;n.eventCallback&&n.currentEvent>0&&"event"===n.noteTimings[n.currentEvent-1].type&&n.eventCallback(n.noteTimings[n.currentEvent-1])}(t),n.justSeeked=!1),n.isPaused)n.pausedTime=t;else if(n.isRunning){var i=t-n.startTime;for(i+=50;n.noteTimings.length>n.currentEvent&&n.noteTimings[n.currentEvent].milliseconds<i;)n.eventCallback&&"event"===n.noteTimings[n.currentEvent].type&&n.eventCallback(n.noteTimings[n.currentEvent]),n.currentEvent++;i<n.lastMoment?(requestAnimationFrame(n.doTiming),n.currentBeat*n.millisecondsPerBeat<i&&(n.beatCallback&&n.beatCallback(n.currentBeat/n.beatSubdivisions,n.totalBeats/n.beatSubdivisions,n.lastMoment),n.currentBeat++)):n.currentBeat<=n.totalBeats&&n.beatCallback&&(n.beatCallback(n.currentBeat/n.beatSubdivisions,n.totalBeats/n.beatSubdivisions,n.lastMoment),n.currentBeat++,requestAnimationFrame(n.doTiming)),n.lineEndCallback&&n.lineEndTimings.length&&n.lineEndTimings[0].milliseconds<=i&&(n.lineEndCallback(n.lineEndTimings[0]),n.lineEndTimings.shift()),i>=n.lastMoment&&n.eventCallback&&n.eventCallback(null)}},n.start=function(){n.isRunning=!0,n.isPaused&&(n.isPaused=!1,n.justUnpaused=!0),requestAnimationFrame(n.doTiming)},n.pause=function(){n.isPaused=!0,n.isRunning=!1},n.reset=function(){n.currentBeat=0,n.currentEvent=0,n.startTime=null,n.pausedTime=null,n.lineEndCallback&&(n.lineEndTimings=pa(n.noteTimings,n.lineEndAnticipation))},n.stop=function(){n.pause(),n.reset()},n.setProgress=function(t){t<0&&(t=0),t>1&&(t=1),n.newSeekPercent=t,n.justSeeked=!0,requestAnimationFrame(n.doTiming)})},va={};va.startAnimation=function(t,e,n){function i(t){for(var e=0;e<t.length;e++){var n=t[e];n.classList.contains("abcjs-bar")||(n.style.display="none")}}var s;function r(e){n.hideCurrentMeasure?function(e){i(t.querySelectorAll(e))}(e):n.hideFinishedMeasures&&function(e){s&&i(t.querySelectorAll(s)),s=e}(e)}fa&&(fa.stop(),fa=void 0),n.showCursor&&((ma=t.querySelector(".abcjs-cursor"))||((ma=document.createElement("DIV")).className="abcjs-cursor cursor",ma.style.position="absolute",t.appendChild(ma),t.style.position="relative")),(fa=new ga(e,{qpm:n.bpm,eventCallback:function(t){if(t){if(t.measureStart){var e=function(t){return".abcjs-l"+t.line+".abcjs-m"+t.measureNumber}(t);e&&r(e)}ma&&(ma.style.left=t.left+"px",ma.style.top=t.top+"px",ma.style.width=t.width+"px",ma.style.height=t.height+"px")}else fa.stop(),fa=void 0}})).start()},va.pauseAnimation=function(t){fa&&(t?fa.pause():fa.start())},va.stopAnimation=function(){fa&&(fa.stop(),fa=void 0)};var ba=va,_a={};!function(){var t,e,n,i;_a.initialize=function(s,r,a,o){t=s,e=r,i=o,(n=a).annotationfont={face:"Helvetica",size:12,weight:"normal",style:"normal",decoration:"none"},n.gchordfont={face:"Helvetica",size:12,weight:"normal",style:"normal",decoration:"none"},n.historyfont={face:'"Times New Roman"',size:16,weight:"normal",style:"normal",decoration:"none"},n.infofont={face:'"Times New Roman"',size:14,weight:"normal",style:"italic",decoration:"none"},n.measurefont={face:'"Times New Roman"',size:14,weight:"normal",style:"italic",decoration:"none"},n.partsfont={face:'"Times New Roman"',size:15,weight:"normal",style:"normal",decoration:"none"},n.repeatfont={face:'"Times New Roman"',size:13,weight:"normal",style:"normal",decoration:"none"},n.textfont={face:'"Times New Roman"',size:16,weight:"normal",style:"normal",decoration:"none"},n.tripletfont={face:"Times",size:11,weight:"normal",style:"italic",decoration:"none"},n.vocalfont={face:'"Times New Roman"',size:13,weight:"bold",style:"normal",decoration:"none"},n.wordsfont={face:'"Times New Roman"',size:16,weight:"normal",style:"normal",decoration:"none"},i.formatting.composerfont={face:'"Times New Roman"',size:14,weight:"normal",style:"italic",decoration:"none"},i.formatting.subtitlefont={face:'"Times New Roman"',size:16,weight:"normal",style:"normal",decoration:"none"},i.formatting.tempofont={face:'"Times New Roman"',size:15,weight:"bold",style:"normal",decoration:"none"},i.formatting.titlefont={face:'"Times New Roman"',size:20,weight:"normal",style:"normal",decoration:"none"},i.formatting.footerfont={face:'"Times New Roman"',size:12,weight:"normal",style:"normal",decoration:"none"},i.formatting.headerfont={face:'"Times New Roman"',size:12,weight:"normal",style:"normal",decoration:"none"},i.formatting.voicefont={face:'"Times New Roman"',size:13,weight:"bold",style:"normal",decoration:"none"},i.formatting.annotationfont=n.annotationfont,i.formatting.gchordfont=n.gchordfont,i.formatting.historyfont=n.historyfont,i.formatting.infofont=n.infofont,i.formatting.measurefont=n.measurefont,i.formatting.partsfont=n.partsfont,i.formatting.repeatfont=n.repeatfont,i.formatting.textfont=n.textfont,i.formatting.tripletfont=n.tripletfont,i.formatting.vocalfont=n.vocalfont,i.formatting.wordsfont=n.wordsfont};var s={gchordfont:!0,measurefont:!0,partsfont:!0},r=function(t,n,i,r,a){function o(){var o=parseInt(t[0].token);return t.shift(),n?0===t.length?{face:n.face,weight:n.weight,style:n.style,decoration:n.decoration,size:o}:1===t.length&&"box"===t[0].token&&s[a]?{face:n.face,weight:n.weight,style:n.style,decoration:n.decoration,size:o,box:!0}:(e("Extra parameters in font definition.",i,r),{face:n.face,weight:n.weight,style:n.style,decoration:n.decoration,size:o}):(e("Can't set just the size of the font since there is no default value.",i,r),{face:'"Times New Roman"',weight:"normal",style:"normal",decoration:"none",size:o})}if("*"===t[0].token){if(t.shift(),"number"===t[0].type)return o();e("Expected font size number after *.",i,r)}if("number"===t[0].type)return o();for(var c,l=[],h="normal",u="normal",d="none",p=!1,f="face",m=!1;t.length;){var g=t.shift(),v=g.token.toLowerCase();switch(f){case"face":m||"utf"!==v&&"number"!==g.type&&"bold"!==v&&"italic"!==v&&"underline"!==v&&"box"!==v?l.length>0&&"-"===g.token?(m=!0,l[l.length-1]=l[l.length-1]+g.token):m?(m=!1,l[l.length-1]=l[l.length-1]+g.token):l.push(g.token):"number"===g.type?(c?e("Font size specified twice in font definition.",i,r):c=g.token,f="modifier"):"bold"===v?h="bold":"italic"===v?u="italic":"underline"===v?d="underline":"box"===v?(s[a]?p=!0:e('This font style doesn\'t support "box"',i,r),f="finished"):"utf"===v?(g=t.shift(),f="size"):e("Unknown parameter "+g.token+" in font definition.",i,r);break;case"size":"number"===g.type?c?e("Font size specified twice in font definition.",i,r):c=g.token:e("Expected font size in font definition.",i,r),f="modifier";break;case"modifier":"bold"===v?h="bold":"italic"===v?u="italic":"underline"===v?d="underline":"box"===v?(s[a]?p=!0:e('This font style doesn\'t support "box"',i,r),f="finished"):e("Unknown parameter "+g.token+" in font definition.",i,r);break;case"finished":e('Extra characters found after "box" in font definition.',i,r)}}void 0===c?n?c=n.size:(e("Must specify the size of the font since there is no default value.",i,r),c=12):c=parseFloat(c);var b=function(t){switch(t){case"Arial-Italic":return{face:"Arial",weight:"normal",style:"italic",decoration:"none"};case"Arial-Bold":return{face:"Arial",weight:"bold",style:"normal",decoration:"none"};case"Bookman-Demi":return{face:"Bookman,serif",weight:"bold",style:"normal",decoration:"none"};case"Bookman-DemiItalic":return{face:"Bookman,serif",weight:"bold",style:"italic",decoration:"none"};case"Bookman-Light":return{face:"Bookman,serif",weight:"normal",style:"normal",decoration:"none"};case"Bookman-LightItalic":return{face:"Bookman,serif",weight:"normal",style:"italic",decoration:"none"};case"Courier":return{face:'"Courier New"',weight:"normal",style:"normal",decoration:"none"};case"Courier-Oblique":return{face:'"Courier New"',weight:"normal",style:"italic",decoration:"none"};case"Courier-Bold":return{face:'"Courier New"',weight:"bold",style:"normal",decoration:"none"};case"Courier-BoldOblique":return{face:'"Courier New"',weight:"bold",style:"italic",decoration:"none"};case"AvantGarde-Book":return{face:"AvantGarde,Arial",weight:"normal",style:"normal",decoration:"none"};case"AvantGarde-BookOblique":return{face:"AvantGarde,Arial",weight:"normal",style:"italic",decoration:"none"};case"AvantGarde-Demi":case"Avant-Garde-Demi":return{face:"AvantGarde,Arial",weight:"bold",style:"normal",decoration:"none"};case"AvantGarde-DemiOblique":return{face:"AvantGarde,Arial",weight:"bold",style:"italic",decoration:"none"};case"Helvetica-Oblique":return{face:"Helvetica",weight:"normal",style:"italic",decoration:"none"};case"Helvetica-Bold":return{face:"Helvetica",weight:"bold",style:"normal",decoration:"none"};case"Helvetica-BoldOblique":return{face:"Helvetica",weight:"bold",style:"italic",decoration:"none"};case"Helvetica-Narrow":return{face:'"Helvetica Narrow",Helvetica',weight:"normal",style:"normal",decoration:"none"};case"Helvetica-Narrow-Oblique":return{face:'"Helvetica Narrow",Helvetica',weight:"normal",style:"italic",decoration:"none"};case"Helvetica-Narrow-Bold":return{face:'"Helvetica Narrow",Helvetica',weight:"bold",style:"normal",decoration:"none"};case"Helvetica-Narrow-BoldOblique":return{face:'"Helvetica Narrow",Helvetica',weight:"bold",style:"italic",decoration:"none"};case"Palatino-Roman":return{face:"Palatino",weight:"normal",style:"normal",decoration:"none"};case"Palatino-Italic":return{face:"Palatino",weight:"normal",style:"italic",decoration:"none"};case"Palatino-Bold":return{face:"Palatino",weight:"bold",style:"normal",decoration:"none"};case"Palatino-BoldItalic":return{face:"Palatino",weight:"bold",style:"italic",decoration:"none"};case"NewCenturySchlbk-Roman":return{face:'"New Century",serif',weight:"normal",style:"normal",decoration:"none"};case"NewCenturySchlbk-Italic":return{face:'"New Century",serif',weight:"normal",style:"italic",decoration:"none"};case"NewCenturySchlbk-Bold":return{face:'"New Century",serif',weight:"bold",style:"normal",decoration:"none"};case"NewCenturySchlbk-BoldItalic":return{face:'"New Century",serif',weight:"bold",style:"italic",decoration:"none"};case"Times":case"Times-Roman":case"Times-Narrow":case"Times-Courier":case"Times-New-Roman":return{face:'"Times New Roman"',weight:"normal",style:"normal",decoration:"none"};case"Times-Italic":case"Times-Italics":return{face:'"Times New Roman"',weight:"normal",style:"italic",decoration:"none"};case"Times-Bold":return{face:'"Times New Roman"',weight:"bold",style:"normal",decoration:"none"};case"Times-BoldItalic":return{face:'"Times New Roman"',weight:"bold",style:"italic",decoration:"none"};case"ZapfChancery-MediumItalic":return{face:'"Zapf Chancery",cursive,serif',weight:"normal",style:"normal",decoration:"none"};default:return null}}(l=l.join(" ")),_={};return b?(_.face=b.face,_.weight=b.weight,_.style=b.style,_.decoration=b.decoration,_.size=c,p&&(_.box=!0),_):(_.face=l,_.weight=h,_.style=u,_.decoration=d,_.size=c,p&&(_.box=!0),_)},a=function(t,e,s){return 0===e.length?'Directive "'+t+'" requires a font as a parameter.':(n[t]=r(e,n[t],s,0,t),n.is_in_header&&(i.formatting[t]=n[t]),null)},o=function(t,e){var n="";da.each(e,(function(t){n+=t.token}));var s=parseFloat(n);if(isNaN(s)||0===s)return'Directive "'+t+'" requires a number as a parameter.';i.formatting.scale=s},c=function(t,e,i,s,r){if(1!==i.length||"number"!==i[0].type)return'Directive "'+e+'" requires a number as a parameter.';var a=i[0].intt;return void 0!==s&&a<s?'Directive "'+e+'" requires a number greater than or equal to '+s+" as a parameter.":void 0!==r&&a>r?'Directive "'+e+'" requires a number less than or equal to '+r+" as a parameter.":(n[t]=a,null)},l=function(t,e,i){if(1===i.length&&("true"===i[0].token||"false"===i[0].token))return n[t]="true"===i[0].token,null;var s=c(t,e,i,0,1);return null!==s?s:(n[t]=1===n[t],null)},h=function(t,e,i,s){if(1!==i.length)return'Directive "'+e+'" requires one of [ '+s.join(", ")+" ] as a parameter.";for(var r=i[0].token,a=!1,o=0;!a&&o<s.length;o++)s[o]===r&&(a=!0);return a?(n[t]=r,null):'Directive "'+e+'" requires one of [ '+s.join(", ")+" ] as a parameter."},u=["nobarlines","barlines","beataccents","nobeataccents","droneon","droneoff","drumon","drumoff","fermatafixed","fermataproportional","gchordon","gchordoff","controlcombo","temperamentnormal","noportamento"],d=["gchord","ptstress","beatstring"],p=["bassvol","chordvol","c","channel","beatmod","deltaloudness","drumbars","gracedivider","makechordchannels","randomchordattack","chordattack","stressmodel","transpose","rtranspose","vol","volinc"],f=["program"],m=["ratio","snt","bendvelocity","pitchbend","control","temperamentlinear"],g=["beat"],v=["drone"],b=["portamento"],_=["expand","grace","trim"],y=["drum","chordname"];_a.parseFontChangeLine=function(t){var e=t.split("$");if(e.length>1&&n.setfont){for(var i=[{text:e[0]}],s=1;s<e.length;s++)"0"===e[s].charAt(0)?i.push({text:e[s].substring(1)}):"1"===e[s].charAt(0)&&n.setfont[1]?i.push({font:n.setfont[1],text:e[s].substring(1)}):"2"===e[s].charAt(0)&&n.setfont[2]?i.push({font:n.setfont[2],text:e[s].substring(1)}):"3"===e[s].charAt(0)&&n.setfont[3]?i.push({font:n.setfont[3],text:e[s].substring(1)}):"4"===e[s].charAt(0)&&n.setfont[4]?i.push({font:n.setfont[4],text:e[s].substring(1)}):i[i.length-1].text+="$"+e[s];if(i.length>1)return i}return t};var w=["auto","above","below","hidden"];_a.addDirective=function(s){var x=t.tokenize(s,0,s.length);if(0===x.length||"alpha"!==x[0].type)return null;var k=s.substring(s.indexOf(x[0].token)+x[0].token.length);k=t.stripComment(k);var T=x.shift().token.toLowerCase(),S="";switch(T){case"bagpipes":i.formatting.bagpipes=!0;break;case"flatbeams":i.formatting.flatbeams=!0;break;case"landscape":n.landscape=!0;break;case"papersize":n.papersize=k;break;case"slurgraces":i.formatting.slurgraces=!0;break;case"stretchlast":i.formatting.stretchlast=!0;break;case"titlecaps":n.titlecaps=!0;break;case"titleleft":i.formatting.titleleft=!0;break;case"measurebox":i.formatting.measurebox=!0;break;case"vocal":return h("vocalPosition",T,x,w);case"dynamic":return h("dynamicPosition",T,x,w);case"gchord":return h("chordPosition",T,x,w);case"ornament":return h("ornamentPosition",T,x,w);case"volume":return h("volumePosition",T,x,w);case"botmargin":case"botspace":case"composerspace":case"indent":case"leftmargin":case"linesep":case"musicspace":case"partsspace":case"pageheight":case"pagewidth":case"rightmargin":case"staffsep":case"staffwidth":case"subtitlespace":case"sysstaffsep":case"systemsep":case"textspace":case"titlespace":case"topmargin":case"topspace":case"vocalspace":case"wordsspace":return function(e,n){var s=t.getMeasurement(n);return 0===s.used||0!==n.length?'Directive "'+e+'" requires a measurement as a parameter.':(i.formatting[e]=s.value,null)}(T,x);case"voicescale":if(1!==x.length||"number"!==x[0].type)return"voicescale requires one float as a parameter";var C=x.shift();return n.currentVoice&&(n.currentVoice.scale=C.floatt,i.changeVoiceScale(n.currentVoice.scale)),null;case"vskip":var A=function(e,n){var i=t.getMeasurement(n);return 0===i.used||0!==n.length?{error:'Directive "'+e+'" requires a measurement as a parameter.'}:i.value}(T,x);return A.error?A.error:(i.addSpacing(A),null);case"scale":o(T,x);break;case"sep":if(0===x.length)i.addSeparator();else{var E=t.getMeasurement(x);if(0===E.used)return'Directive "'+T+'" requires 3 numbers: space above, space below, length of line';var M=E.value;if(0===(E=t.getMeasurement(x)).used)return'Directive "'+T+'" requires 3 numbers: space above, space below, length of line';var N=E.value;if(0===(E=t.getMeasurement(x)).used||0!==x.length)return'Directive "'+T+'" requires 3 numbers: space above, space below, length of line';var I=E.value;i.addSeparator(M,N,I)}break;case"barsperstaff":if(null!==(S=c("barsperstaff",T,x)))return S;break;case"staffnonote":if(1!==x.length)return"Directive staffnonote requires one parameter: 0 or 1";if("0"===x[0].token)n.staffnonote=!0;else{if("1"!==x[0].token)return"Directive staffnonote requires one parameter: 0 or 1 (received "+x[0].token+")";n.staffnonote=!1}break;case"printtempo":if(null!==(S=l("printTempo",T,x)))return S;break;case"partsbox":if(null!==(S=l("partsBox",T,x)))return S;n.partsfont.box=n.partsBox;break;case"freegchord":if(null!==(S=l("freegchord",T,x)))return S;break;case"measurenb":case"barnumbers":if(null!==(S=c("barNumbers",T,x)))return S;break;case"setbarnb":if(1!==x.length||"number"!==x[0].type)return"Directive setbarnb requires a number as a parameter.";n.currBarNumber=i.setBarNumberImmediate(x[0].intt);break;case"begintext":n.inTextBlock=!0;break;case"continueall":n.continueall=!0;break;case"beginps":n.inPsBlock=!0,e("Postscript ignored",s,0);break;case"deco":k.length>0&&n.ignoredDecorations.push(k.substring(0,k.indexOf(" "))),e("Decoration redefinition ignored",s,0);break;case"text":var O=t.translateString(k);i.addText(_a.parseFontChangeLine(O));break;case"center":var P=t.translateString(k);i.addCentered(_a.parseFontChangeLine(P));break;case"font":break;case"setfont":var D=t.tokenize(k,0,k.length);if(D.length>=4&&"-"===D[0].token&&"number"===D[1].type){var B=parseInt(D[1].token);B>=1&&B<=4&&(n.setfont||(n.setfont=[]),D.shift(),D.shift(),n.setfont[B]=r(D,n.setfont[B],s,0,"setfont"))}break;case"gchordfont":case"partsfont":case"tripletfont":case"vocalfont":case"textfont":case"annotationfont":case"historyfont":case"infofont":case"measurefont":case"repeatfont":case"wordsfont":return a(T,x,s);case"composerfont":case"subtitlefont":case"tempofont":case"titlefont":case"voicefont":case"footerfont":case"headerfont":return function(t,e,n){return 0===e.length?'Directive "'+t+'" requires a font as a parameter.':(i.formatting[t]=r(e,i.formatting[t],n,0,t),null)}(T,x,s);case"barlabelfont":case"barnumberfont":case"barnumfont":return a("measurefont",x,s);case"staves":case"score":n.score_is_present=!0;for(var R,L=function(t,e,i,s,r){(e||0===n.staves.length)&&n.staves.push({index:n.staves.length,numVoices:0});var a=da.last(n.staves);void 0!==i&&(a.bracket=i),void 0!==s&&(a.brace=s),r&&(a.connectBarLines="end"),void 0===n.voices[t]&&(n.voices[t]={staffNum:a.index,index:a.numVoices},a.numVoices++)},V=!1,H=!1,F=!1,q=!1,z=!1,G=!1,j=!1,W=function(){if(j=!0,R){var t="start";R.staffNum>0&&("start"!==n.staves[R.staffNum-1].connectBarLines&&"continue"!==n.staves[R.staffNum-1].connectBarLines||(t="continue")),n.staves[R.staffNum].connectBarLines=t}};x.length;){var Y=x.shift();switch(Y.token){case"(":V?e("Can't nest parenthesis in %%score",s,Y.start):(V=!0,q=!0);break;case")":!V||q?e("Unexpected close parenthesis in %%score",s,Y.start):V=!1;break;case"[":H?e("Can't nest brackets in %%score",s,Y.start):(H=!0,z=!0);break;case"]":!H||z?e("Unexpected close bracket in %%score",s,Y.start):(H=!1,n.staves[R.staffNum].bracket="end");break;case"{":F?e("Can't nest braces in %%score",s,Y.start):(F=!0,G=!0);break;case"}":!F||G?e("Unexpected close brace in %%score",s,Y.start):(F=!1,n.staves[R.staffNum].brace="end");break;case"|":W();break;default:for(var U="";("alpha"===Y.type||"number"===Y.type)&&(U+=Y.token,Y.continueId);)Y=x.shift();L(U,!V||q,z?"start":H?"continue":void 0,G?"start":F?"continue":void 0,j),q=!1,z=!1,G=!1,j=!1,R=n.voices[U],"staves"===T&&W()}}break;case"newpage":var X=t.getInt(k);i.addNewPage(0===X.digits?-1:X.value);break;case"abc":var $=k.split(" ");switch($[0]){case"-copyright":case"-creator":case"-edited-by":case"-version":case"-charset":var Z=$.shift();i.addMetaText(T+Z,$.join(" "));break;default:return"Unknown directive: "+T+$[0]}break;case"header":case"footer":var K=t.getMeat(k,0,k.length);'"'===(K=k.substring(K.start,K.end)).charAt(0)&&'"'===K.charAt(K.length-1)&&(K=K.substring(1,K.length-1));var Q=K.split("\t"),J={};J=1===Q.length?{left:"",center:Q[0],right:""}:2===Q.length?{left:Q[0],center:Q[1],right:""}:{left:Q[0],center:Q[1],right:Q[2]},Q.length>3&&e("Too many tabs in "+T+": "+Q.length+" found.",k,0),i.addMetaTextObj(T,J);break;case"midi":var tt=t.tokenize(k,0,k.length,!0);tt.length>0&&"="===tt[0].token&&tt.shift(),0===tt.length?e("Expected midi command",k,0):function(t,n,i){var s=t.shift().token,r=[];if(u.indexOf(s)>=0)0!==t.length&&e("Unexpected parameter in MIDI "+s,i,0);else if(d.indexOf(s)>=0)1!==t.length?e("Expected one parameter in MIDI "+s,i,0):r.push(t[0].token);else if(p.indexOf(s)>=0)1!==t.length?e("Expected one parameter in MIDI "+s,i,0):"number"!==t[0].type?e("Expected one integer parameter in MIDI "+s,i,0):r.push(t[0].intt);else if(f.indexOf(s)>=0)1!==t.length&&2!==t.length?e("Expected one or two parameters in MIDI "+s,i,0):"number"!==t[0].type||2===t.length&&"number"!==t[1].type?e("Expected integer parameter in MIDI "+s,i,0):(r.push(t[0].intt),2===t.length&&r.push(t[1].intt));else if(m.indexOf(s)>=0)2!==t.length?e("Expected two parameters in MIDI "+s,i,0):"number"!==t[0].type||"number"!==t[1].type?e("Expected two integer parameters in MIDI "+s,i,0):(r.push(t[0].intt),r.push(t[1].intt));else if(b.indexOf(s)>=0)2!==t.length?e("Expected two parameters in MIDI "+s,i,0):"alpha"!==t[0].type||"number"!==t[1].type?e("Expected one string and one integer parameters in MIDI "+s,i,0):(r.push(t[0].token),r.push(t[1].intt));else if("drummap"===s)2===t.length&&"alpha"===t[0].type&&"number"===t[1].type?(n.formatting||(n.formatting={}),n.formatting.midi||(n.formatting.midi={}),n.formatting.midi.drummap||(n.formatting.midi.drummap={}),n.formatting.midi.drummap[t[0].token]=t[1].intt,r=n.formatting.midi.drummap):3===t.length&&"punct"===t[0].type&&"alpha"===t[1].type&&"number"===t[2].type?(n.formatting||(n.formatting={}),n.formatting.midi||(n.formatting.midi={}),n.formatting.midi.drummap||(n.formatting.midi.drummap={}),n.formatting.midi.drummap[t[0].token+t[1].token]=t[2].intt,r=n.formatting.midi.drummap):e("Expected one note name and one integer parameter in MIDI "+s,i,0);else if(_.indexOf(s)>=0)3!==t.length||"number"!==t[0].type||"/"!==t[1].token||"number"!==t[2].type?e("Expected fraction parameter in MIDI "+s,i,0):(r.push(t[0].intt),r.push(t[2].intt));else if(g.indexOf(s)>=0)4!==t.length?e("Expected four parameters in MIDI "+s,i,0):"number"!==t[0].type||"number"!==t[1].type||"number"!==t[2].type||"number"!==t[3].type?e("Expected four integer parameters in MIDI "+s,i,0):(r.push(t[0].intt),r.push(t[1].intt),r.push(t[2].intt),r.push(t[3].intt));else if(v.indexOf(s)>=0)5!==t.length?e("Expected five parameters in MIDI "+s,i,0):"number"!==t[0].type||"number"!==t[1].type||"number"!==t[2].type||"number"!==t[3].type||"number"!==t[4].type?e("Expected five integer parameters in MIDI "+s,i,0):(r.push(t[0].intt),r.push(t[1].intt),r.push(t[2].intt),r.push(t[3].intt),r.push(t[4].intt));else if(f.indexOf(s)>=0)1!==t.length||4!==t.length?e("Expected one or two parameters in MIDI "+s,i,0):"number"!==t[0].type?e("Expected integer parameter in MIDI "+s,i,0):4===t.length?("octave"!==t[1].token&&e("Expected octave parameter in MIDI "+s,i,0),"="!==t[2].token&&e("Expected octave parameter in MIDI "+s,i,0),"number"!==t[3].type&&e("Expected integer parameter for octave in MIDI "+s,i,0)):(r.push(t[0].intt),4===t.length&&r.push(t[3].intt));else if(y.indexOf(s)>=0)if(t.length<2)e("Expected string parameter and at least one integer parameter in MIDI "+s,i,0);else if("alpha"!==t[0].type)e("Expected string parameter and at least one integer parameter in MIDI "+s,i,0);else{var a=t.shift();for(r.push(a.token);t.length>0;)"number"!==(a=t.shift()).type&&e("Expected integer parameter in MIDI "+s,i,0),r.push(a.intt)}n.hasBeginMusic()?n.appendElement("midi",-1,-1,{cmd:s,params:r}):(void 0===n.formatting.midi&&(n.formatting.midi={}),n.formatting.midi[s]=r)}(tt,i,k);break;case"map":case"percmap":case"playtempo":case"auquality":case"continuous":case"nobarcheck":i.formatting[T]=k;break;default:return"Unknown directive: "+T}return null},_a.globalFormatting=function(i){for(var s in i)if(i.hasOwnProperty(s)){var r,c=""+i[s],h=t.tokenize(c,0,c.length);switch(s){case"titlefont":case"gchordfont":case"composerfont":case"footerfont":case"headerfont":case"historyfont":case"infofont":case"measurefont":case"partsfont":case"repeatfont":case"subtitlefont":case"tempofont":case"textfont":case"voicefont":case"tripletfont":case"vocalfont":case"wordsfont":case"annotationfont":a(s,h,c);break;case"scale":o(s,h);break;case"partsbox":null!==(r=l("partsBox",s,h))&&e(r),n.partsfont.box=n.partsBox;break;case"freegchord":null!==(r=l("freegchord",s,h))&&e(r);default:e("Formatting directive unrecognized: ",s,0)}}}}();var ya=_a,wa={},xa={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11},ka=["C","Db","D","Eb","E","F","F#","G","Ab","A","Bb","B"],Ta=["C","C#","D","D#","E","F","F#","G","G#","A","Bb","B"];wa.keySignature=function(t,e,n,i,s,r){r||(r=0),t.localTransposeVerticalMovement=0,t.localTransposePreferFlats=!1;var a=e[n];if(!a)return t.key;if(t.localTranspose=(t.globalTranspose?t.globalTranspose:0)+r,!t.localTranspose)return{accidentals:a,root:i,acc:s};if(t.globalTransposeOrigKeySig=a,t.localTranspose%12==0)return t.localTransposeVerticalMovement=t.localTranspose/12*7,{accidentals:a,root:i,acc:s};var o=n[0];"b"===n[1]||"#"===n[1]?(o+=n[1],n=n.substr(2)):n=n.substr(1);for(var c=xa[o]+t.localTranspose;c<0;)c+=12;c>11&&(c%=12);var l="m"===n[0]?Ta[c]:ka[c],h=l+n,u=e[h];u.length>0&&"flat"===u[0].acc&&(t.localTransposePreferFlats=!0);var d=h.charCodeAt(0)-o.charCodeAt(0);return t.localTranspose>0?d<0?d+=7:0===d&&("#"!==o[1]&&"b"!==h[1]||(d+=7)):t.localTranspose<0&&(d>0?d-=7:0===d&&("b"!==o[1]&&"#"!==h[1]||(d-=7))),t.localTranspose>0?t.localTransposeVerticalMovement=d+7*Math.floor(t.localTranspose/12):t.localTransposeVerticalMovement=d+7*Math.ceil(t.localTranspose/12),{accidentals:u,root:l[0],acc:l.length>1?l[1]:""}};var Sa=["C","C♯","D","D♯","E","F","F♯","G","G♯","A","A♯","B"],Ca=["C","D♭","D","E♭","E","F","G♭","G","A♭","A","B♭","B"],Aa=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],Ea=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"];wa.chordName=function(t,e){if(t.localTranspose&&t.localTranspose%12!=0){for(var n=t.localTranspose;n<0;)n+=12;n>11&&(n%=12);for(var i=(e=(e=(e=(e=(e=(e=(e=(e=t.freegchord?(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/Cb/g,"`~11`")).replace(/Db/g,"`~1`")).replace(/Eb/g,"`~3`")).replace(/Fb/g,"`~4`")).replace(/Gb/g,"`~6`")).replace(/Ab/g,"`~8`")).replace(/Bb/g,"`~10`")).replace(/C#/g,"`~1`")).replace(/D#/g,"`~3`")).replace(/E#/g,"`~5`")).replace(/F#/g,"`~6`")).replace(/G#/g,"`~8`")).replace(/A#/g,"`~10`")).replace(/B#/g,"`~0`"):(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/C♭/g,"`~11`")).replace(/D♭/g,"`~1`")).replace(/E♭/g,"`~3`")).replace(/F♭/g,"`~4`")).replace(/G♭/g,"`~6`")).replace(/A♭/g,"`~8`")).replace(/B♭/g,"`~10`")).replace(/C♯/g,"`~1`")).replace(/D♯/g,"`~3`")).replace(/E♯/g,"`~5`")).replace(/F♯/g,"`~6`")).replace(/G♯/g,"`~8`")).replace(/A♯/g,"`~10`")).replace(/B♯/g,"`~0`")).replace(/C/g,"`~0`")).replace(/D/g,"`~2`")).replace(/E/g,"`~4`")).replace(/F/g,"`~5`")).replace(/G/g,"`~7`")).replace(/A/g,"`~9`")).replace(/B/g,"`~11`")).split("`"),s=0;s<i.length;s++)if("~"===i[s][0]){var r=parseInt(i[s].substr(1),10);(r+=n)>11&&(r-=12),t.freegchord?i[s]=t.localTransposePreferFlats?Ea[r]:Aa[r]:i[s]=t.localTransposePreferFlats?Ca[r]:Sa[r]}e=i.join("")}return e};var Ma=["c","d","e","f","g","a","b"];var Na={dblflat:-2,flat:-1,natural:0,sharp:1,dblsharp:2},Ia={"-2":"dblflat","-1":"flat",0:"natural",1:"sharp",2:"dblsharp"};wa.note=function(t,e){if(t.localTranspose){var n=e.pitch;if(e.pitch=e.pitch+t.localTransposeVerticalMovement,e.accidental){var i=function(t,e,n,i,s){for(var r=Ma[(t+49)%7],a=0,o=0;o<i.length;o++)i[o].note.toLowerCase()===r&&(a=Na[i[o].acc]);for(var c=Na[n]-a,l=Ma[(e+49)%7],h=0,u=0;u<s.accidentals.length;u++)s.accidentals[u].note.toLowerCase()===l&&(h=Na[s.accidentals[u].acc]);var d=c+h;return d<-2&&(e--,d+="c"===l||"f"===l?1:2),d>2&&(e++,d-="b"===l||"e"===l?1:2),[e,d]}(n,e.pitch,e.accidental,t.globalTransposeOrigKeySig,t.targetKey);e.pitch=i[0],e.accidental=Ia[i[1]]}}};var Oa=wa,Pa={};!function(){var t,e,n,i;Pa.initialize=function(s,r,a,o){t=s,e=r,n=a,i=o},Pa.standardKey=function(t,e,i,s){var r={acc:"sharp",note:"f"},a={acc:"sharp",note:"c"},o={acc:"sharp",note:"g"},c={acc:"sharp",note:"d"},l={acc:"sharp",note:"A"},h={acc:"sharp",note:"e"},u={acc:"sharp",note:"B"},d={acc:"flat",note:"B"},p={acc:"flat",note:"e"},f={acc:"flat",note:"A"},m={acc:"flat",note:"d"},g={acc:"flat",note:"G"},v={acc:"flat",note:"c"},b={acc:"flat",note:"F"},_={"C#":[r,a,o,c,l,h,u],"A#m":[r,a,o,c,l,h,u],"G#Mix":[r,a,o,c,l,h,u],"D#Dor":[r,a,o,c,l,h,u],"E#Phr":[r,a,o,c,l,h,u],"F#Lyd":[r,a,o,c,l,h,u],"B#Loc":[r,a,o,c,l,h,u],"F#":[r,a,o,c,l,h],"D#m":[r,a,o,c,l,h],"C#Mix":[r,a,o,c,l,h],"G#Dor":[r,a,o,c,l,h],"A#Phr":[r,a,o,c,l,h],BLyd:[r,a,o,c,l,h],"E#Loc":[r,a,o,c,l,h],B:[r,a,o,c,l],"G#m":[r,a,o,c,l],"F#Mix":[r,a,o,c,l],"C#Dor":[r,a,o,c,l],"D#Phr":[r,a,o,c,l],ELyd:[r,a,o,c,l],"A#Loc":[r,a,o,c,l],E:[r,a,o,c],"C#m":[r,a,o,c],BMix:[r,a,o,c],"F#Dor":[r,a,o,c],"G#Phr":[r,a,o,c],ALyd:[r,a,o,c],"D#Loc":[r,a,o,c],A:[r,a,o],"F#m":[r,a,o],EMix:[r,a,o],BDor:[r,a,o],"C#Phr":[r,a,o],DLyd:[r,a,o],"G#Loc":[r,a,o],D:[r,a],Bm:[r,a],AMix:[r,a],EDor:[r,a],"F#Phr":[r,a],GLyd:[r,a],"C#Loc":[r,a],G:[r],Em:[r],DMix:[r],ADor:[r],BPhr:[r],CLyd:[r],"F#Loc":[r],C:[],Am:[],GMix:[],DDor:[],EPhr:[],FLyd:[],BLoc:[],F:[d],Dm:[d],CMix:[d],GDor:[d],APhr:[d],BbLyd:[d],ELoc:[d],Bb:[d,p],Gm:[d,p],FMix:[d,p],CDor:[d,p],DPhr:[d,p],EbLyd:[d,p],ALoc:[d,p],Eb:[d,p,f],Cm:[d,p,f],BbMix:[d,p,f],FDor:[d,p,f],GPhr:[d,p,f],AbLyd:[d,p,f],DLoc:[d,p,f],Ab:[d,p,f,m],Fm:[d,p,f,m],EbMix:[d,p,f,m],BbDor:[d,p,f,m],CPhr:[d,p,f,m],DbLyd:[d,p,f,m],GLoc:[d,p,f,m],Db:[d,p,f,m,g],Bbm:[d,p,f,m,g],AbMix:[d,p,f,m,g],EbDor:[d,p,f,m,g],FPhr:[d,p,f,m,g],GbLyd:[d,p,f,m,g],CLoc:[d,p,f,m,g],Gb:[d,p,f,m,g,v],Ebm:[d,p,f,m,g,v],DbMix:[d,p,f,m,g,v],AbDor:[d,p,f,m,g,v],BbPhr:[d,p,f,m,g,v],CbLyd:[d,p,f,m,g,v],FLoc:[d,p,f,m,g,v],Cb:[d,p,f,m,g,v,b],Abm:[d,p,f,m,g,v,b],GbMix:[d,p,f,m,g,v,b],DbDor:[d,p,f,m,g,v,b],EbPhr:[d,p,f,m,g,v,b],FbLyd:[d,p,f,m,g,v,b],BbLoc:[d,p,f,m,g,v,b],"A#":[d,p],"B#":[],"D#":[d,p,f],"E#":[d],"G#":[d,p,f,m],Gbm:[r,a,o,c,l,h,u]};return Oa.keySignature(n,_,t,e,i,s)};var s={treble:{clef:"treble",pitch:4,mid:0},"treble+8":{clef:"treble+8",pitch:4,mid:0},"treble-8":{clef:"treble-8",pitch:4,mid:0},"treble^8":{clef:"treble+8",pitch:4,mid:0},treble_8:{clef:"treble-8",pitch:4,mid:0},treble1:{clef:"treble",pitch:2,mid:2},treble2:{clef:"treble",pitch:4,mid:0},treble3:{clef:"treble",pitch:6,mid:-2},treble4:{clef:"treble",pitch:8,mid:-4},treble5:{clef:"treble",pitch:10,mid:-6},perc:{clef:"perc",pitch:6,mid:0},none:{clef:"none",mid:0},bass:{clef:"bass",pitch:8,mid:-12},"bass+8":{clef:"bass+8",pitch:8,mid:-12},"bass-8":{clef:"bass-8",pitch:8,mid:-12},"bass^8":{clef:"bass+8",pitch:8,mid:-12},bass_8:{clef:"bass-8",pitch:8,mid:-12},"bass+16":{clef:"bass",pitch:8,mid:-12},"bass-16":{clef:"bass",pitch:8,mid:-12},"bass^16":{clef:"bass",pitch:8,mid:-12},bass_16:{clef:"bass",pitch:8,mid:-12},bass1:{clef:"bass",pitch:2,mid:-6},bass2:{clef:"bass",pitch:4,mid:-8},bass3:{clef:"bass",pitch:6,mid:-10},bass4:{clef:"bass",pitch:8,mid:-12},bass5:{clef:"bass",pitch:10,mid:-14},tenor:{clef:"alto",pitch:8,mid:-8},tenor1:{clef:"alto",pitch:2,mid:-2},tenor2:{clef:"alto",pitch:4,mid:-4},tenor3:{clef:"alto",pitch:6,mid:-6},tenor4:{clef:"alto",pitch:8,mid:-8},tenor5:{clef:"alto",pitch:10,mid:-10},alto:{clef:"alto",pitch:6,mid:-6},alto1:{clef:"alto",pitch:2,mid:-2},alto2:{clef:"alto",pitch:4,mid:-4},alto3:{clef:"alto",pitch:6,mid:-6},alto4:{clef:"alto",pitch:8,mid:-8},alto5:{clef:"alto",pitch:10,mid:-10},"alto+8":{clef:"alto+8",pitch:6,mid:-6},"alto-8":{clef:"alto-8",pitch:6,mid:-6},"alto^8":{clef:"alto+8",pitch:6,mid:-6},alto_8:{clef:"alto-8",pitch:6,mid:-6}},r=function(t,e){var n=s[t];return(n?n.mid:0)+e};Pa.fixClef=function(t){var e=s[t.type];e&&(t.clefPos=e.pitch,t.type=e.clef)},Pa.deepCopyKey=function(t){var e={accidentals:[],root:t.root,acc:t.acc,mode:t.mode};return da.each(t.accidentals,(function(t){e.accidentals.push(da.clone(t))})),e};var a={A:5,B:6,C:0,D:1,E:2,F:3,G:4,a:12,b:13,c:7,d:8,e:9,f:10,g:11};Pa.addPosToKey=function(t,e){var n=t.verticalPos;da.each(e.accidentals,(function(t){var e=a[t.note];e-=n,t.verticalPos=e})),e.impliedNaturals&&da.each(e.impliedNaturals,(function(t){var e=a[t.note];e-=n,t.verticalPos=e})),n<-10?(da.each(e.accidentals,(function(t){t.verticalPos-=7,(t.verticalPos>=11||10===t.verticalPos&&"flat"===t.acc)&&(t.verticalPos-=7),"A"===t.note&&"sharp"===t.acc&&(t.verticalPos-=7),"G"!==t.note&&"F"!==t.note||"flat"!==t.acc||(t.verticalPos-=7)})),e.impliedNaturals&&da.each(e.impliedNaturals,(function(t){t.verticalPos-=7,(t.verticalPos>=11||10===t.verticalPos&&"flat"===t.acc)&&(t.verticalPos-=7),"A"===t.note&&"sharp"===t.acc&&(t.verticalPos-=7),"G"!==t.note&&"F"!==t.note||"flat"!==t.acc||(t.verticalPos-=7)}))):n<-4?(da.each(e.accidentals,(function(t){t.verticalPos-=7,-8!==n||"f"!==t.note&&"g"!==t.note||"sharp"!==t.acc||(t.verticalPos-=7)})),e.impliedNaturals&&da.each(e.impliedNaturals,(function(t){t.verticalPos-=7,-8!==n||"f"!==t.note&&"g"!==t.note||"sharp"!==t.acc||(t.verticalPos-=7)}))):n>=7&&(da.each(e.accidentals,(function(t){t.verticalPos+=7})),e.impliedNaturals&&da.each(e.impliedNaturals,(function(t){t.verticalPos+=7})))},Pa.fixKey=function(t,e){var n=da.clone(e);return Pa.addPosToKey(t,n),n};var o=function(t){var e=0,n=t.charAt(e++);"^"!==n&&"_"!==n||(n=t.charAt(e++));var i=a[n];for(void 0===i&&(i=6);e<t.length;e++)if(","===t.charAt(e))i-=7;else{if("'"!==t.charAt(e))break;i+=7}return{mid:i-6,str:t.substring(e)}};Pa.parseKey=function(i){0===i.length&&(i="none");var s=t.tokenize(i,0,i.length),a={};switch(s[0].token){case"HP":ya.addDirective("bagpipes"),n.key={root:"HP",accidentals:[],acc:"",mode:""},a.foundKey=!0,s.shift();break;case"Hp":ya.addDirective("bagpipes"),n.key={root:"Hp",accidentals:[{acc:"natural",note:"g"},{acc:"sharp",note:"f"},{acc:"sharp",note:"c"}],acc:"",mode:""},a.foundKey=!0,s.shift();break;case"none":n.key={root:"none",accidentals:[],acc:"",mode:""},a.foundKey=!0,s.shift();break;default:var o=t.getKeyPitch(s[0].token);if(o.len>0){a.foundKey=!0;var c="",l="";s[0].token.length>1?s[0].token=s[0].token.substring(1):s.shift();var h=o.token;if(s.length>0){var u=t.getSharpFlat(s[0].token);if(u.len>0&&(s[0].token.length>1?s[0].token=s[0].token.substring(1):s.shift(),h+=u.token,c=u.token),s.length>0){var d=t.getMode(s[0].token);d.len>0&&(s.shift(),h+=d.token,l=d.token)}if(void 0===Pa.standardKey(h,o.token,c,0))return e("Unsupported key signature: "+h,i,0),a}var p=Pa.deepCopyKey(n.key),f=n.globalTranspose?-n.globalTranspose:0;if(n.key=Pa.deepCopyKey(Pa.standardKey(h,o.token,c,f)),n.key.mode=l,p){for(var m,g=0;g<n.key.accidentals.length;g++)for(m=0;m<p.accidentals.length;m++)p.accidentals[m].note&&n.key.accidentals[g].note.toLowerCase()===p.accidentals[m].note.toLowerCase()&&(p.accidentals[m].note=null);for(m=0;m<p.accidentals.length;m++)p.accidentals[m].note&&(n.key.impliedNaturals||(n.key.impliedNaturals=[]),n.key.impliedNaturals.push({acc:"natural",note:p.accidentals[m].note}))}}}if(0===s.length)return a;if("exp"===s[0].token&&s.shift(),0===s.length)return a;if("oct"===s[0].token&&s.shift(),0===s.length)return a;var v,b=t.getKeyAccidentals2(s);if(b.warn&&e(b.warn,i,0),b.accs){a.foundKey||(a.foundKey=!0,n.key={root:"none",acc:"",mode:"",accidentals:[]}),function(t){for(var e=0;e<t.length;e++)"b"===t[e].note?t[e].note="B":"a"===t[e].note?t[e].note="A":"F"===t[e].note?t[e].note="f":"E"===t[e].note?t[e].note="e":"D"===t[e].note?t[e].note="d":"C"===t[e].note?t[e].note="c":"G"===t[e].note&&"sharp"===t[e].acc?t[e].note="g":"g"===t[e].note&&"flat"===t[e].acc&&(t[e].note="G")}(b.accs);for(var _=0;_<b.accs.length;_++){for(var y=!1,w=0;w<n.key.accidentals.length&&!y;w++)n.key.accidentals[w].note===b.accs[_].note&&(y=!0,n.key.accidentals[w].acc!==b.accs[_].acc&&(n.key.accidentals[w].acc=b.accs[_].acc,n.key.explicitAccidentals||(n.key.explicitAccidentals=[]),n.key.explicitAccidentals.push(b.accs[_])));if(!y&&(n.key.explicitAccidentals||(n.key.explicitAccidentals=[]),n.key.explicitAccidentals.push(b.accs[_]),n.key.accidentals.push(b.accs[_]),n.key.impliedNaturals))for(var x=0;x<n.key.impliedNaturals.length;x++)n.key.impliedNaturals[x].note===b.accs[_].note&&n.key.impliedNaturals.splice(x,1)}}for(;s.length>0;)switch(s[0].token){case"m":case"middle":if(s.shift(),0===s.length)return e("Expected = after middle",i,0),a;if("="!==(v=s.shift()).token){e("Expected = after middle",i,v.start);break}if(0===s.length)return e("Expected parameter after middle=",i,0),a;var k=t.getPitchFromTokens(s);k.warn&&e(k.warn,i,0),k.position&&(n.clef.verticalPos=k.position-6);break;case"transpose":if(s.shift(),0===s.length)return e("Expected = after transpose",i,0),a;if("="!==(v=s.shift()).token){e("Expected = after transpose",i,v.start);break}if(0===s.length)return e("Expected parameter after transpose=",i,0),a;if("number"!==s[0].type){e("Expected number after transpose",i,s[0].start);break}n.clef.transpose=s[0].intt,s.shift();break;case"stafflines":if(s.shift(),0===s.length)return e("Expected = after stafflines",i,0),a;if("="!==(v=s.shift()).token){e("Expected = after stafflines",i,v.start);break}if(0===s.length)return e("Expected parameter after stafflines=",i,0),a;if("number"!==s[0].type){e("Expected number after stafflines",i,s[0].start);break}n.clef.stafflines=s[0].intt,s.shift();break;case"staffscale":if(s.shift(),0===s.length)return e("Expected = after staffscale",i,0),a;if("="!==(v=s.shift()).token){e("Expected = after staffscale",i,v.start);break}if(0===s.length)return e("Expected parameter after staffscale=",i,0),a;if("number"!==s[0].type){e("Expected number after staffscale",i,s[0].start);break}n.clef.staffscale=s[0].floatt,s.shift();break;case"style":if(s.shift(),0===s.length)return e("Expected = after style",i,0),a;if("="!==(v=s.shift()).token){e("Expected = after style",i,v.start);break}if(0===s.length)return e("Expected parameter after style=",i,0),a;switch(s[0].token){case"normal":case"harmonic":case"rhythm":case"x":n.style=s[0].token,s.shift();break;default:e("error parsing style element: "+s[0].token,i,s[0].start)}break;case"clef":if(s.shift(),0===s.length)return e("Expected = after clef",i,0),a;if("="!==(v=s.shift()).token){e("Expected = after clef",i,v.start);break}if(0===s.length)return e("Expected parameter after clef=",i,0),a;case"treble":case"bass":case"alto":case"tenor":case"perc":var T=s.shift();switch(T.token){case"treble":case"tenor":case"alto":case"bass":case"perc":case"none":break;case"C":T.token="alto";break;case"F":T.token="bass";break;case"G":T.token="treble";break;case"c":T.token="alto";break;case"f":T.token="bass";break;case"g":T.token="treble";break;default:e("Expected clef name. Found "+T.token,i,T.start)}s.length>0&&"number"===s[0].type&&(T.token+=s[0].token,s.shift()),s.length>1&&("-"===s[0].token||"+"===s[0].token||"^"===s[0].token||"_"===s[0].token)&&"8"===s[1].token&&(T.token+=s[0].token+s[1].token,s.shift(),s.shift()),n.clef={type:T.token,verticalPos:r(T.token,0)},n.currentVoice&&void 0!==n.currentVoice.transpose&&(n.clef.transpose=n.currentVoice.transpose),a.foundClef=!0;break;default:e("Unknown parameter: "+s[0].token,i,s[0].start),s.shift()}return a};Pa.parseVoice=function(s,a,c){var l=t.getMeat(s,a,c),h=l.start,u=l.end,d=t.getToken(s,h,u);if(0!==d.length){var p=!1;void 0===n.voices[d]&&(n.voices[d]={},p=!0,n.score_is_present&&e("Can't have an unknown V: id when the %score directive is present",s,h)),h+=d.length,h+=t.eatWhiteSpace(s,h);for(var f={startStaff:p},m=function(n){var i=t.getVoiceToken(s,h,u);void 0!==i.warn?e("Expected value for "+n+" in voice: "+i.warn,s,h):0===i.token.length&&'"'!==s.charAt(h)?e("Expected value for "+n+" in voice",s,h):f[n]=i.token,h+=i.len},g=function(i,r,a){var o=t.getVoiceToken(s,h,u);void 0!==o.warn?e("Expected value for "+r+" in voice: "+o.warn,s,h):0===o.token.length&&'"'!==s.charAt(h)?e("Expected value for "+r+" in voice",s,h):("number"===a&&(o.token=parseFloat(o.token)),n.voices[i][r]=o.token),h+=o.len},v=function(n,i){var r=t.getVoiceToken(s,h,u);if(void 0!==r.warn)e("Expected value for "+n+" in voice: "+r.warn,s,h);else{if(0!==r.token.length||'"'===s.charAt(h))return"number"===i&&(r.token=parseFloat(r.token)),r.token;e("Expected value for "+n+" in voice",s,h)}h+=r.len},b=function(i,r){var a=t.getVoiceToken(s,h,u);if(void 0!==a.warn)e("Expected one of (_B, _E, _b, _e) for "+r+" in voice: "+a.warn,s,h);else if(0===a.token.length&&'"'!==s.charAt(h))e("Expected one of (_B, _E, _b, _e) for "+r+" in voice",s,h);else{var o={_B:2,_E:9,_b:-10,_e:-3}[a.token];o?n.voices[i][r]=o:e("Expected one of (_B, _E, _b, _e) for "+r+" in voice",s,h)}h+=a.len};h<u;){var _=t.getVoiceToken(s,h,u);if(h+=_.len,_.warn)e("Error parsing voice: "+_.warn,s,h);else{var y=null;switch(_.token){case"clef":case"cl":m("clef");var w=0;void 0!==f.clef&&(f.clef=f.clef.replace(/[',]/g,""),-1!==f.clef.indexOf("+16")&&(w+=14,f.clef=f.clef.replace("+16","")),f.verticalPos=r(f.clef,w));break;case"treble":case"bass":case"tenor":case"alto":case"perc":case"none":case"treble'":case"bass'":case"tenor'":case"alto'":case"none'":case"treble''":case"bass''":case"tenor''":case"alto''":case"none''":case"treble,":case"bass,":case"tenor,":case"alto,":case"none,":case"treble,,":case"bass,,":case"tenor,,":case"alto,,":case"none,,":f.clef=_.token.replace(/[',]/g,""),f.verticalPos=r(f.clef,0),n.voices[d].clef=_.token;break;case"staves":case"stave":case"stv":m("staves");break;case"brace":case"brc":m("brace");break;case"bracket":case"brk":m("bracket");break;case"name":case"nm":m("name");break;case"subname":case"sname":case"snm":m("subname");break;case"merge":f.startStaff=!1;break;case"stem":case"stems":void 0!==(y=t.getVoiceToken(s,h,u)).warn?e("Expected value for stems in voice: "+y.warn,s,h):"up"===y.token||"down"===y.token?n.voices[d].stem=y.token:e("Expected up or down for voice stem",s,h),h+=y.len;break;case"up":case"down":n.voices[d].stem=_.token;break;case"middle":case"m":m("verticalPos"),f.verticalPos=o(f.verticalPos).mid;break;case"gchords":case"gch":n.voices[d].suppressChords=!0,"0"===(y=t.getVoiceToken(s,h,u)).token&&(h+=y.len);break;case"space":case"spc":m("spacing");break;case"scale":g(d,"scale","number");break;case"score":b(d,"scoreTranspose");break;case"transpose":g(d,"transpose","number");break;case"stafflines":g(d,"stafflines","number");break;case"staffscale":g(d,"staffscale","number");break;case"octave":g(d,"octave","number");break;case"volume":g(d,"volume","number");break;case"cue":var x=v("cue","string");n.voices[d].scale="on"===x?.6:1;break;case"style":void 0!==(y=t.getVoiceToken(s,h,u)).warn?e("Expected value for style in voice: "+y.warn,s,h):"normal"===y.token||"harmonic"===y.token||"rhythm"===y.token||"x"===y.token?n.voices[d].style=y.token:e("Expected one of [normal, harmonic, rhythm, x] for voice style",s,h),h+=y.len}}h+=t.eatWhiteSpace(s,h)}if((f.startStaff||0===n.staves.length)&&(n.staves.push({index:n.staves.length,meter:n.origMeter}),n.score_is_present||(n.staves[n.staves.length-1].numVoices=0)),void 0===n.voices[d].staffNum){n.voices[d].staffNum=n.staves.length-1;var k=0;for(var T in n.voices)n.voices.hasOwnProperty(T)&&n.voices[T].staffNum===n.voices[d].staffNum&&k++;n.voices[d].index=k-1}var S=n.staves[n.voices[d].staffNum];n.score_is_present||S.numVoices++,f.clef&&(S.clef={type:f.clef,verticalPos:f.verticalPos}),f.spacing&&(S.spacing_below_offset=f.spacing),f.verticalPos&&(S.verticalPos=f.verticalPos),f.name&&(S.name?S.name.push(f.name):S.name=[f.name]),f.subname&&(S.subname?S.subname.push(f.subname):S.subname=[f.subname]),function(t){n.currentVoice=n.voices[t],i.setCurrentVoice(n.currentVoice.staffNum,n.currentVoice.index)}(d)}else e("Expected a voice id",s,h)}}();var Da=Pa,Ba=function(t,e,n,i){this.reset=function(t,e,n,i){Da.initialize(t,e,n,i),ya.initialize(t,e,n,i)},this.reset(t,e,n,i),this.setTitle=function(e){if(n.hasMainTitle)i.addSubtitle(t.translateString(t.stripComment(e)));else{var s=t.translateString(t.theReverser(t.stripComment(e)));n.titlecaps&&(s=s.toUpperCase()),i.addMetaText("title",s),n.hasMainTitle=!0}},this.setMeter=function(i){if("C"===(i=t.stripComment(i)))return!0===n.havent_set_length&&(n.default_length=.125,n.havent_set_length=!1),{type:"common_time"};if("C|"===i)return!0===n.havent_set_length&&(n.default_length=.125,n.havent_set_length=!1),{type:"cut_time"};if("o"===i)return!0===n.havent_set_length&&(n.default_length=.125,n.havent_set_length=!1),{type:"tempus_perfectum"};if("c"===i)return!0===n.havent_set_length&&(n.default_length=.125,n.havent_set_length=!1),{type:"tempus_imperfectum"};if("o."===i)return!0===n.havent_set_length&&(n.default_length=.125,n.havent_set_length=!1),{type:"tempus_perfectum_prolatio"};if("c."===i)return!0===n.havent_set_length&&(n.default_length=.125,n.havent_set_length=!1),{type:"tempus_imperfectum_prolatio"};if(0===i.length||"none"===i.toLowerCase())return!0===n.havent_set_length&&(n.default_length=.125,n.havent_set_length=!1),null;var s=t.tokenize(i,0,i.length);try{var r=function(){var t=function(){var t={value:0,num:""},e=s.shift();for("("===e.token&&(e=s.shift());;){if("number"!==e.type)throw"Expected top number of meter";if(t.value+=parseInt(e.token),t.num+=e.token,0===s.length||"/"===s[0].token)return t;if(")"===(e=s.shift()).token){if(0===s.length||"/"===s[0].token)return t;throw"Unexpected paren in meter"}if("."!==e.token&&"+"!==e.token)throw"Expected top number of meter";if(t.num+=e.token,0===s.length)throw"Expected top number of meter";e=s.shift()}return t}();if(0===s.length)return t;var e=s.shift();if("/"!==e.token)throw"Expected slash in meter";if("number"!==(e=s.shift()).type)throw"Expected bottom number of meter";return t.den=e.token,t.value=t.value/parseInt(t.den),t};if(0===s.length)throw"Expected meter definition in M: line";for(var a={type:"specified",value:[]},o=0;;){var c=r();o+=c.value;var l={num:c.num};if(void 0!==c.den&&(l.den=c.den),a.value.push(l),0===s.length)break}return!0===n.havent_set_length&&(n.default_length=o<.75?.0625:.125,n.havent_set_length=!1),a}catch(t){e(t,i,0)}return null},this.calcTempo=function(t){var e=1/4;n.meter&&"specified"===n.meter.type?e=1/parseInt(n.meter.value[0].den):n.origMeter&&"specified"===n.origMeter.type&&(e=1/parseInt(n.origMeter.value[0].den));for(var i=0;i<t.duration;i++)t.duration[i]=e*t.duration[i];return t},this.resolveTempo=function(){n.tempo&&(this.calcTempo(n.tempo),i.metaText.tempo=n.tempo,delete n.tempo)},this.addUserDefinition=function(t,i,s){var r=t.indexOf("=",i);if(-1!==r){var a=da.strip(t.substring(i,r)),o=da.strip(t.substring(r+1));if(1===a.length){-1!=="HIJKLMNOPQRSTUVWXYhijklmnopqrstuvw~".indexOf(a)?0!==o.length?(void 0===n.macros&&(n.macros={}),n.macros[a]=o):e("Missing macro definition",t,i):e("Macro definitions must be H-Y, h-w, or tilde",t,i)}else e("Macro definitions can only be one character",t,i)}else e("Need an = in a macro definition",t,i)},this.setDefaultLength=function(t,e,i){var s=da.gsub(t.substring(e,i)," ","").split("/");if(2===s.length){var r=parseInt(s[0]),a=parseInt(s[1]);a>0&&(n.default_length=r/a,n.havent_set_length=!1)}else 1===s.length&&"1"===s[0]&&(n.default_length=1,n.havent_set_length=!1)};var s={larghissimo:20,adagissimo:24,sostenuto:28,grave:32,largo:40,lento:50,larghetto:60,adagio:68,adagietto:74,andante:80,andantino:88,"marcia moderato":84,"andante moderato":100,moderato:112,allegretto:116,"allegro moderato":120,allegro:126,animato:132,agitato:140,veloce:148,"mosso vivo":156,vivace:164,vivacissimo:172,allegrissimo:176,presto:184,prestissimo:210};this.setTempo=function(i,r,a){try{var o=t.tokenize(i,r,a);if(0===o.length)throw"Missing parameter in Q: field";var c={},l=!0,h=o.shift();if("quote"===h.type&&(c.preString=h.token,h=o.shift(),0===o.length))return s[c.preString.toLowerCase()]&&(c.bpm=s[c.preString.toLowerCase()],c.suppressBpm=!0),{type:"immediate",tempo:c};if("alpha"===h.type&&"C"===h.token){if(0===o.length)throw"Missing tempo after C in Q: field";if("punct"===(h=o.shift()).type&&"="===h.token){if(0===o.length)throw"Missing tempo after = in Q: field";if("number"!==(h=o.shift()).type)throw"Expected number after = in Q: field";c.duration=[1],c.bpm=parseInt(h.token)}else{if("number"!==h.type)throw"Expected number or equal after C in Q: field";if(c.duration=[parseInt(h.token)],0===o.length)throw"Missing = after duration in Q: field";if("punct"!==(h=o.shift()).type||"="!==h.token)throw"Expected = after duration in Q: field";if(0===o.length)throw"Missing tempo after = in Q: field";if("number"!==(h=o.shift()).type)throw"Expected number after = in Q: field";c.bpm=parseInt(h.token)}}else{if("number"!==h.type)throw"Unknown value in Q: field";var u=parseInt(h.token);if(0===o.length||"quote"===o[0].type)c.duration=[1],c.bpm=u;else{if(l=!1,"punct"!==(h=o.shift()).type&&"/"!==h.token)throw"Expected fraction in Q: field";if("number"!==(h=o.shift()).type)throw"Expected fraction in Q: field";var d=parseInt(h.token);for(c.duration=[u/d];o.length>0&&"="!==o[0].token&&"quote"!==o[0].type;){if("number"!==(h=o.shift()).type)throw"Expected fraction in Q: field";if(u=parseInt(h.token),"punct"!==(h=o.shift()).type&&"/"!==h.token)throw"Expected fraction in Q: field";if("number"!==(h=o.shift()).type)throw"Expected fraction in Q: field";d=parseInt(h.token),c.duration.push(u/d)}if("punct"!==(h=o.shift()).type&&"="!==h.token)throw"Expected = in Q: field";if("number"!==(h=o.shift()).type)throw"Expected tempo in Q: field";c.bpm=parseInt(h.token)}}if(0!==o.length&&("quote"===(h=o.shift()).type&&(c.postString=h.token,h=o.shift()),0!==o.length))throw"Unexpected string at end of Q: field";return!1===n.printTempo&&(c.suppress=!0),{type:l?"delaySet":"immediate",tempo:c}}catch(t){return e(t,i,r),{type:"none"}}},this.letter_to_inline_header=function(s,r){var a=t.eatWhiteSpace(s,r);if(r+=a,s.length>=r+5&&"["===s.charAt(r)&&":"===s.charAt(r+2)){var o=s.indexOf("]",r),c=n.iChar+r,l=n.iChar+o+1;switch(s.substring(r,r+3)){case"[I:":var h=ya.addDirective(s.substring(r+3,o));return h&&e(h,s,r),[o-r+1+a];case"[M:":var u=this.setMeter(s.substring(r+3,o));return i.hasBeginMusic()&&u?i.appendStartingElement("meter",c,l,u):n.meter=u,[o-r+1+a];case"[K:":var d=Da.parseKey(s.substring(r+3,o));return d.foundClef&&i.hasBeginMusic()&&i.appendStartingElement("clef",c,l,n.clef),d.foundKey&&i.hasBeginMusic()&&i.appendStartingElement("key",c,l,Da.fixKey(n.clef,n.key)),[o-r+1+a];case"[P:":return i.lines.length<=i.lineNum?n.partForNextLine={title:s.substring(r+3,o),startChar:c,endChar:l}:i.appendElement("part",c,l,{title:s.substring(r+3,o)}),[o-r+1+a];case"[L:":return this.setDefaultLength(s,r+3,o),[o-r+1+a];case"[Q:":if(o>0){var p=this.setTempo(s,r+3,o);return"delaySet"===p.type?i.appendElement("tempo",c,l,this.calcTempo(p.tempo)):"immediate"===p.type&&i.appendElement("tempo",c,l,p.tempo),[o-r+1+a,s.charAt(r+1),s.substring(r+3,o)]}break;case"[V:":if(o>0)return Da.parseVoice(s,r+3,o),[o-r+1+a,s.charAt(r+1),s.substring(r+3,o)]}}return[0]},this.letter_to_body_header=function(t,s){if(t.length>=s+3)switch(t.substring(s,s+2)){case"I:":var r=ya.addDirective(t.substring(s+2));return r&&e(r,t,s),[t.length];case"M:":var a=this.setMeter(t.substring(s+2));return i.hasBeginMusic()&&a&&i.appendStartingElement("meter",n.iChar+s,n.iChar+t.length,a),[t.length];case"K:":var o=Da.parseKey(t.substring(s+2));return o.foundClef&&i.hasBeginMusic()&&i.appendStartingElement("clef",n.iChar+s,n.iChar+t.length,n.clef),o.foundKey&&i.hasBeginMusic()&&i.appendStartingElement("key",n.iChar+s,n.iChar+t.length,Da.fixKey(n.clef,n.key)),[t.length];case"P:":return i.hasBeginMusic()&&i.appendElement("part",n.iChar+s,n.iChar+t.length,{title:t.substring(s+2)}),[t.length];case"L:":return this.setDefaultLength(t,s+2,t.length),[t.length];case"Q:":var c=t.indexOf("",s+2);-1===c&&(c=t.length);var l=this.setTempo(t,s+2,c);return"delaySet"===l.type?i.appendElement("tempo",n.iChar+s,n.iChar+t.length,this.calcTempo(l.tempo)):"immediate"===l.type&&i.appendElement("tempo",n.iChar+s,n.iChar+t.length,l.tempo),[c,t.charAt(s),da.strip(t.substring(s+2))];case"V:":return Da.parseVoice(t,s+2,t.length),[t.length,t.charAt(s),da.strip(t.substring(s+2))]}return[0]};var r={A:"author",B:"book",C:"composer",D:"discography",F:"url",G:"group",I:"instruction",N:"notes",O:"origin",R:"rhythm",S:"source",W:"unalignedWords",Z:"transcription"};this.parseHeader=function(s){if(da.startsWith(s,"%%")){var a=ya.addDirective(s.substring(2));return a&&e(a,s,2),{}}var o=s.indexOf("%");if(o>=0&&(s=s.substring(0,o)),0===(s=s.replace(/\s+$/,"")).length)return{};if(s.length>=2&&":"===s.charAt(1)){var c="";s.indexOf("")>=0&&"w"!==s.charAt(0)&&(c=s.substring(s.indexOf("")+1),s=s.substring(0,s.indexOf("")));var l=r[s.charAt(0)];if(void 0!==l)return"unalignedWords"===l?i.addMetaTextArray(l,ya.parseFontChangeLine(t.translateString(t.stripComment(s.substring(2))))):i.addMetaText(l,t.translateString(t.stripComment(s.substring(2)))),{};var h=n.iChar,u=h+s.length;switch(s.charAt(0)){case"H":i.addMetaText("history",t.translateString(t.stripComment(s.substring(2)))),n.is_in_history=!0;break;case"K":this.resolveTempo();var d=Da.parseKey(s.substring(2));!n.is_in_header&&i.hasBeginMusic()&&(d.foundClef&&i.appendStartingElement("clef",h,u,n.clef),d.foundKey&&i.appendStartingElement("key",h,u,Da.fixKey(n.clef,n.key))),n.is_in_header=!1;break;case"L":this.setDefaultLength(s,2,s.length);break;case"M":n.origMeter=n.meter=this.setMeter(s.substring(2));break;case"P":n.is_in_header?i.addMetaText("partOrder",t.translateString(t.stripComment(s.substring(2)))):n.partForNextLine={title:t.translateString(t.stripComment(s.substring(2))),startChar:h,endChar:u};break;case"Q":var p=this.setTempo(s,2,s.length);"delaySet"===p.type?n.tempo=p.tempo:"immediate"===p.type&&(i.metaText.tempo=p.tempo);break;case"T":this.setTitle(s.substring(2));break;case"U":this.addUserDefinition(s,2,s.length);break;case"V":if(Da.parseVoice(s,2,s.length),!n.is_in_header)return{newline:!0};break;case"s":return{symbols:!0};case"w":return{words:!0};case"X":break;case"E":case"m":e("Ignored header",s,0);break;default:return c.length&&(c=""+c),{regular:!0,str:s+c}}return c.length>0?{recurse:!0,str:c}:{}}return{regular:!0,str:s}}},Ra=function(){this.skipWhiteSpace=function(t){for(var e=0;e<t.length;e++)if(!this.isWhiteSpace(t.charAt(e)))return e;return t.length};var t=function(t,e){return e>=t.length};this.eatWhiteSpace=function(t,e){for(var n=e;n<t.length;n++)if(!this.isWhiteSpace(t.charAt(n)))return n-e;return n-e},this.getKeyPitch=function(e){var n=this.skipWhiteSpace(e);if(t(e,n))return{len:0};switch(e.charAt(n)){case"A":return{len:n+1,token:"A"};case"B":return{len:n+1,token:"B"};case"C":return{len:n+1,token:"C"};case"D":return{len:n+1,token:"D"};case"E":return{len:n+1,token:"E"};case"F":return{len:n+1,token:"F"};case"G":return{len:n+1,token:"G"}}return{len:0}},this.getSharpFlat=function(t){if("bass"===t)return{len:0};switch(t.charAt(0)){case"#":return{len:1,token:"#"};case"b":return{len:1,token:"b"}}return{len:0}},this.getMode=function(e){var n=function(t,e){for(;e<t.length&&(t.charAt(e)>="a"&&t.charAt(e)<="z"||t.charAt(e)>="A"&&t.charAt(e)<="Z");)e++;return e},i=this.skipWhiteSpace(e);if(t(e,i))return{len:0};var s=e.substring(i,i+3).toLowerCase();switch((s.length>1&&" "===s.charAt(1)||"^"===s.charAt(1)||"_"===s.charAt(1)||"="===s.charAt(1))&&(s=s.charAt(0)),s){case"mix":return{len:n(e,i),token:"Mix"};case"dor":return{len:n(e,i),token:"Dor"};case"phr":return{len:n(e,i),token:"Phr"};case"lyd":return{len:n(e,i),token:"Lyd"};case"loc":return{len:n(e,i),token:"Loc"};case"aeo":return{len:n(e,i),token:"m"};case"maj":case"ion":return{len:n(e,i),token:""};case"min":case"m":return{len:n(e,i),token:"m"}}return{len:0}},this.getClef=function(e,n){var i=e,s=this.skipWhiteSpace(e);if(t(e,s))return{len:0};var r=!1,a=e.substring(s);if(da.startsWith(a,"clef=")&&(r=!0,a=a.substring(5),s+=5),0===a.length&&r)return{len:s+5,warn:"No clef specified: "+i};var o=this.skipWhiteSpace(a);if(t(a,o))return{len:0};o>0&&(s+=o,a=a.substring(o));var c=null;if(da.startsWith(a,"treble"))c="treble";else if(da.startsWith(a,"bass3"))c="bass3";else if(da.startsWith(a,"bass"))c="bass";else if(da.startsWith(a,"tenor"))c="tenor";else if(da.startsWith(a,"alto2"))c="alto2";else if(da.startsWith(a,"alto1"))c="alto1";else if(da.startsWith(a,"alto"))c="alto";else if(!n&&r&&da.startsWith(a,"none"))c="none";else if(da.startsWith(a,"perc"))c="perc";else if(!n&&r&&da.startsWith(a,"C"))c="tenor";else if(!n&&r&&da.startsWith(a,"F"))c="bass";else{if(n||!r||!da.startsWith(a,"G"))return{len:s+5,warn:"Unknown clef specified: "+i};c="treble"}return a=a.substring(c.length),(o=this.isMatch(a,"+8"))>0?c+="+8":(o=this.isMatch(a,"-8"))>0&&(c+="-8"),{len:s+c.length,token:c,explicit:r}},this.getBarLine=function(t,e){switch(t.charAt(e)){case"]":switch(++e,t.charAt(e)){case"|":return{len:2,token:"bar_thick_thin"};case"[":return++e,t.charAt(e)>="1"&&t.charAt(e)<="9"||'"'===t.charAt(e)?{len:2,token:"bar_invisible"}:{len:1,warn:"Unknown bar symbol"};default:return{len:1,token:"bar_invisible"}}case":":switch(++e,t.charAt(e)){case":":return{len:2,token:"bar_dbl_repeat"};case"|":switch(++e,t.charAt(e)){case"]":switch(++e,t.charAt(e)){case"|":return++e,":"===t.charAt(e)?{len:5,token:"bar_dbl_repeat"}:{len:3,token:"bar_right_repeat"};default:return{len:3,token:"bar_right_repeat"}}case"|":return++e,":"===t.charAt(e)?{len:4,token:"bar_dbl_repeat"}:{len:3,token:"bar_right_repeat"};default:return{len:2,token:"bar_right_repeat"}}default:return{len:1,warn:"Unknown bar symbol"}}case"[":if(++e,"|"!==t.charAt(e))return t.charAt(e)>="1"&&t.charAt(e)<="9"||'"'===t.charAt(e)?{len:1,token:"bar_invisible"}:{len:0};switch(++e,t.charAt(e)){case":":return{len:3,token:"bar_left_repeat"};case"]":return{len:3,token:"bar_invisible"};default:return{len:2,token:"bar_thick_thin"}}case"|":switch(++e,t.charAt(e)){case"]":return{len:2,token:"bar_thin_thick"};case"|":return++e,":"===t.charAt(e)?{len:3,token:"bar_left_repeat"}:{len:2,token:"bar_thin_thin"};case":":for(var n=0;":"===t.charAt(e+n);)n++;return{len:1+n,token:"bar_left_repeat"};default:return{len:1,token:"bar_thin"}}}return{len:0}},this.getTokenOf=function(t,e){for(var n=0;n<t.length;n++)if(e.indexOf(t.charAt(n))<0)return{len:n,token:t.substring(0,n)};return{len:n,token:t}},this.getToken=function(t,e,n){for(var i=e;i<n&&!this.isWhiteSpace(t.charAt(i));)i++;return t.substring(e,i)},this.isMatch=function(e,n){var i=this.skipWhiteSpace(e);return t(e,i)?0:da.startsWith(e.substring(i),n)?i+n.length:0},this.getPitchFromTokens=function(t){var e={};if(e.position={A:5,B:6,C:0,D:1,E:2,F:3,G:4,a:12,b:13,c:7,d:8,e:9,f:10,g:11}[t[0].token],void 0===e.position)return{warn:"Pitch expected. Found: "+t[0].token};for(t.shift();t.length;)switch(t[0].token){case",":e.position-=7,t.shift();break;case"'":e.position+=7,t.shift();break;default:return e}return e},this.getKeyAccidentals2=function(t){for(var e;t.length>0;){var n;if("^"===t[0].token){if(n="sharp",t.shift(),0===t.length)return{accs:e,warn:"Expected note name after "+n};switch(t[0].token){case"^":n="dblsharp",t.shift();break;case"/":n="quartersharp",t.shift()}}else if("="===t[0].token)n="natural",t.shift();else{if("_"!==t[0].token)return{accs:e};if(n="flat",t.shift(),0===t.length)return{accs:e,warn:"Expected note name after "+n};switch(t[0].token){case"_":n="dblflat",t.shift();break;case"/":n="quarterflat",t.shift()}}if(0===t.length)return{accs:e,warn:"Expected note name after "+n};switch(t[0].token.charAt(0)){case"a":case"b":case"c":case"d":case"e":case"f":case"g":case"A":case"B":case"C":case"D":case"E":case"F":case"G":void 0===e&&(e=[]),e.push({acc:n,note:t[0].token.charAt(0)}),1===t[0].token.length?t.shift():t[0].token=t[0].token.substring(1);break;default:return{accs:e,warn:"Expected note name after "+n+" Found: "+t[0].token}}}return{accs:e}},this.getKeyAccidental=function(e){var n={"^":"sharp","^^":"dblsharp","=":"natural",_:"flat",__:"dblflat","_/":"quarterflat","^/":"quartersharp"},i=this.skipWhiteSpace(e);if(t(e,i))return{len:0};var s=null;switch(e.charAt(i)){case"^":case"_":case"=":s=e.charAt(i);break;default:return{len:0}}if(i++,t(e,i))return{len:1,warn:"Expected note name after accidental"};switch(e.charAt(i)){case"a":case"b":case"c":case"d":case"e":case"f":case"g":case"A":case"B":case"C":case"D":case"E":case"F":case"G":return{len:i+1,token:{acc:n[s],note:e.charAt(i)}};case"^":case"_":case"/":if(s+=e.charAt(i),i++,t(e,i))return{len:2,warn:"Expected note name after accidental"};switch(e.charAt(i)){case"a":case"b":case"c":case"d":case"e":case"f":case"g":case"A":case"B":case"C":case"D":case"E":case"F":case"G":return{len:i+1,token:{acc:n[s],note:e.charAt(i)}};default:return{len:2,warn:"Expected note name after accidental"}}break;default:return{len:1,warn:"Expected note name after accidental"}}},this.isWhiteSpace=function(t){return" "===t||"\t"===t||""===t},this.getMeat=function(t,e,n){var i=t.indexOf("%",e);for(i>=0&&i<n&&(n=i);e<n&&(" "===t.charAt(e)||"\t"===t.charAt(e)||""===t.charAt(e));)e++;for(;e<n&&(" "===t.charAt(n-1)||"\t"===t.charAt(n-1)||""===t.charAt(n-1));)n--;return{start:e,end:n}};var e=function(t){return t>="A"&&t<="Z"||t>="a"&&t<="z"},n=function(t){return t>="0"&&t<="9"};this.tokenize=function(t,i,s,r){var a=this.getMeat(t,i,s);i=a.start,s=a.end;for(var o,c=[];i<s;){if('"'===t.charAt(i)){for(o=i+1;o<s&&'"'!==t.charAt(o);)o++;c.push({type:"quote",token:t.substring(i+1,o),start:i+1,end:o}),o++}else if(e(t.charAt(i))){if(o=i+1,r)for(;o<s&&!this.isWhiteSpace(t.charAt(o));)o++;else for(;o<s&&e(t.charAt(o));)o++;c.push({type:"alpha",token:t.substring(i,o),continueId:n(t.charAt(o)),start:i,end:o}),i=o+1}else if("."===t.charAt(i)&&n(t.charAt(o+1))){o=i+1;for(var l;o<s&&n(t.charAt(o));)o++;l=parseFloat(t.substring(i,o)),c.push({type:"number",token:t.substring(i,o),intt:null,floatt:l,continueId:e(t.charAt(o)),start:i,end:o}),i=o+1}else if(n(t.charAt(i))||"-"===t.charAt(i)&&n(t.charAt(o+1))){o=i+1;for(var h,u=null;o<s&&n(t.charAt(o));)o++;if("."===t.charAt(o)&&n(t.charAt(o+1)))for(o++;o<s&&n(t.charAt(o));)o++;else u=parseInt(t.substring(i,o));h=parseFloat(t.substring(i,o)),c.push({type:"number",token:t.substring(i,o),intt:u,floatt:h,continueId:e(t.charAt(o)),start:i,end:o}),i=o+1}else" "===t.charAt(i)||"\t"===t.charAt(i)||c.push({type:"punct",token:t.charAt(i),start:i,end:i+1}),o=i+1;i=o}return c},this.getVoiceToken=function(t,e,n){for(var i=e;i<n&&this.isWhiteSpace(t.charAt(i))||"="===t.charAt(i);)i++;if('"'===t.charAt(i)){var s=t.indexOf('"',i+1);return-1===s||s>=n?{len:1,err:"Missing close quote"}:{len:s-e+1,token:this.translateString(t.substring(i+1,s))}}for(var r=i;r<n&&!this.isWhiteSpace(t.charAt(r))&&"="!==t.charAt(r);)r++;return{len:r-e+1,token:t.substring(i,r)}};var i={"`a":"à","'a":"á","^a":"â","~a":"ã",'"a':"ä",oa:"å",aa:"å","=a":"ā",ua:"ă",";a":"ą","`e":"è","'e":"é","^e":"ê",'"e':"ë","=e":"ē",ue:"ĕ",";e":"ę",".e":"ė","`i":"ì","'i":"í","^i":"î",'"i':"ï","=i":"ī",ui:"ĭ",";i":"į","`o":"ò","'o":"ó","^o":"ô","~o":"õ",'"o':"ö","=o":"ō",uo:"ŏ","/o":"ø","`u":"ù","'u":"ú","^u":"û","~u":"ũ",'"u':"ü",ou:"ů","=u":"ū",uu:"ŭ",";u":"ų","`A":"À","'A":"Á","^A":"Â","~A":"Ã",'"A':"Ä",oA:"Å",AA:"Å","=A":"Ā",uA:"Ă",";A":"Ą","`E":"È","'E":"É","^E":"Ê",'"E':"Ë","=E":"Ē",uE:"Ĕ",";E":"Ę",".E":"Ė","`I":"Ì","'I":"Í","^I":"Î","~I":"Ĩ",'"I':"Ï","=I":"Ī",uI:"Ĭ",";I":"Į",".I":"İ","`O":"Ò","'O":"Ó","^O":"Ô","~O":"Õ",'"O':"Ö","=O":"Ō",uO:"Ŏ","/O":"Ø","`U":"Ù","'U":"Ú","^U":"Û","~U":"Ũ",'"U':"Ü",oU:"Ů","=U":"Ū",uU:"Ŭ",";U":"Ų",ae:"æ",AE:"Æ",oe:"œ",OE:"Œ",ss:"ß","'c":"ć","^c":"ĉ",uc:"č",cc:"ç",".c":"ċ",cC:"Ç","'C":"Ć","^C":"Ĉ",uC:"Č",".C":"Ċ","~N":"Ñ","~n":"ñ","=s":"š",vs:"š",DH:"Ð",dh:"ð",HO:"Ő",Ho:"ő",HU:"Ű",Hu:"ű","'Y":"Ý","'y":"ý","^Y":"Ŷ","^y":"ŷ",'"Y':"Ÿ",'"y':"ÿ",vS:"Š",vZ:"Ž",vz:"ž"},s={"#":"♯",b:"♭","=":"♮"},r={201:"♯",202:"♭",203:"♮",241:"¡",242:"¢",252:"a",262:"2",272:"o",302:"Â",312:"Ê",322:"Ò",332:"Ú",342:"â",352:"ê",362:"ò",372:"ú",243:"£",253:"«",263:"3",273:"»",303:"Ã",313:"Ë",323:"Ó",333:"Û",343:"ã",353:"ë",363:"ó",373:"û",244:"¤",254:"¬",264:"  ́",274:"1⁄4",304:"Ä",314:"Ì",324:"Ô",334:"Ü",344:"ä",354:"ì",364:"ô",374:"ü",245:"¥",255:"-",265:"μ",275:"1⁄2",305:"Å",315:"Í",325:"Õ",335:"Ý",345:"å",355:"í",365:"õ",375:"ý",246:"¦",256:"®",266:"¶",276:"3⁄4",306:"Æ",316:"Î",326:"Ö",336:"Þ",346:"æ",356:"î",366:"ö",376:"þ",247:"§",257:" ̄",267:"·",277:"¿",307:"Ç",317:"Ï",327:"×",337:"ß",347:"ç",357:"ï",367:"÷",377:"ÿ",250:" ̈",260:"°",270:" ̧",300:"À",310:"È",320:"Ð",330:"Ø",340:"à",350:"è",360:"ð",370:"ø",251:"©",261:"±",271:"1",301:"Á",311:"É",321:"Ñ",331:"Ù",341:"á",351:"é",361:"ñ",371:"ù"};this.translateString=function(t){var e=t.split("\\");if(1===e.length)return t;var n=null;return da.each(e,(function(t){if(null===n)n=t;else{var e=i[t.substring(0,2)];void 0!==e?n+=e+t.substring(2):void 0!==(e=r[t.substring(0,3)])?n+=e+t.substring(3):(e=s[t.substring(0,1)],n+=void 0!==e?e+t.substring(1):"\\"+t)}})),n},this.getNumber=function(t,e){for(var n=0;e<t.length;)switch(t.charAt(e)){case"0":n*=10,e++;break;case"1":n=10*n+1,e++;break;case"2":n=10*n+2,e++;break;case"3":n=10*n+3,e++;break;case"4":n=10*n+4,e++;break;case"5":n=10*n+5,e++;break;case"6":n=10*n+6,e++;break;case"7":n=10*n+7,e++;break;case"8":n=10*n+8,e++;break;case"9":n=10*n+9,e++;break;default:return{num:n,index:e}}return{num:n,index:e}},this.getFraction=function(t,e){var n=1,i=1;if("/"!==t.charAt(e)){var s=this.getNumber(t,e);n=s.num,e=s.index}if("/"===t.charAt(e)){if(e++,"/"===t.charAt(e)){for(var r=.5;"/"===t.charAt(e++);)r/=2;return{value:n*r,index:e-1}}var a=e,o=this.getNumber(t,e);0===o.num&&a===e&&(o.num=2),0!==o.num&&(i=o.num),e=o.index}return{value:n/i,index:e}},this.theReverser=function(t){return da.endsWith(t,", The")?"The "+t.substring(0,t.length-5):da.endsWith(t,", A")?"A "+t.substring(0,t.length-3):t},this.stripComment=function(t){var e=t.indexOf("%");return e>=0?da.strip(t.substring(0,e)):da.strip(t)},this.getInt=function(t){var e=parseInt(t);if(isNaN(e))return{digits:0};var n=""+e;return{value:e,digits:t.indexOf(n)+n.length}},this.getFloat=function(t){var e=parseFloat(t);if(isNaN(e))return{digits:0};var n=""+e;return{value:e,digits:t.indexOf(n)+n.length}},this.getMeasurement=function(t){if(0===t.length)return{used:0};var e=1,n="";if("-"===t[0].token)t.shift(),n="-",e++;else if("number"!==t[0].type)return{used:0};if(n+=t.shift().token,0===t.length)return{used:1,value:parseInt(n)};var i=t.shift();if("."===i.token){if(e++,0===t.length)return{used:e,value:parseInt(n)};if("number"===t[0].type&&(n=n+"."+(i=t.shift()).token,e++,0===t.length))return{used:e,value:parseFloat(n)};i=t.shift()}switch(i.token){case"pt":return{used:e+1,value:parseFloat(n)};case"cm":return{used:e+1,value:parseFloat(n)/2.54*72};case"in":return{used:e+1,value:72*parseFloat(n)};default:return t.unshift(i),{used:e,value:parseFloat(n)}}};var a=function(t){for(;-1!==t.indexOf("\\n");)t=t.replace("\\n","\n");return t};this.getBrackettedSubstring=function(t,e,n,i){for(var s=i||t.charAt(e),r=e+1;r<t.length&&t.charAt(r)!==s;)++r;return t.charAt(r)===s?[r-e+1,a(t.substring(e+1,r)),!0]:((r=e+n)>t.length-1&&(r=t.length-1),[r-e+1,a(t.substring(e+1,r)),!1])}};function La(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e}function Va(t,e,n,i,s,r,a,o,c,l,h){for(var u=l;u<t.length;u++){var d=t[u];n+=d,i+=d;var p=Math.abs(n-e[o]);if(Math.abs(p-r)<e[0]/10)if(p<r){var f=La(s),m=La(c);m.push(u-1),f.push(i-d),h.push({accumulator:n,lineAccumulator:d,lineWidths:f,lastVariance:Math.abs(n-e[o+1]),highestVariance:Math.max(a,r),currLine:o+1,lineBreaks:m,startIndex:u+1})}else p>r&&u<t.length-1&&(f=La(s),m=La(c),h.push({accumulator:n,lineAccumulator:i,lineWidths:f,lastVariance:p,highestVariance:Math.max(a,p),currLine:o,lineBreaks:m,startIndex:u+1}));p>r?(c.push(u-1),o++,a=Math.max(a,r),r=Math.abs(n-e[o]),s.push(i-d),i=d):r=p}s.push(i)}function Ha(t,e,n,i,s){var r=new s,a={lineBreaks:t,staffwidth:e};for(var o in i)i.hasOwnProperty(o)&&"wrap"!==o&&"staffwidth"!==o&&(a[o]=i[o]);return r.parse(n,a),{tune:r.getTune(),revisedParams:a}}var Fa={wrapLines:function(t,e){if(e&&0!==t.lines.length){for(var n=[],i=[],s=[],r=[],a=[],o="",c={},l=0,h=0;h<t.lines.length;h++){var u=t.lines[h];if(u.staff){for(var d=u.staff,p=0;p<d.length;p++){void 0===i[p]&&(i[p]=[],s[p]=[],r[p]=[],a[p]=[]);for(var f=d[p],m=f.voices,g=0;g<m.length;g++){void 0===i[p][g]&&(i[p][g]=!0,s[p][g]=0,r[p][g]=0,a[p][g]=0),l>0&&(s[p][g]+=l);for(var v=m[g],b=0;b<v.length;b++){if(i[p][g]){if(n[s[p][g]]||(n[s[p][g]]={staff:[]}),!n[s[p][g]].staff[p])for(var _ in n[s[p][g]].staff[p]={voices:[]},f)f.hasOwnProperty(_)&&("meter"===_?1!==n.length&&o===JSON.stringify(f[_])||(o=JSON.stringify(f[_]),n[s[p][g]].staff[p][_]=f[_]):"voices"!==_&&(n[s[p][g]].staff[p][_]=f[_]));a[p][g]&&(n[s[p][g]].staff[p].barNumber=a[p][g]),i[p][g]=!1}var y=v[b];if(!n[s[p][g]].staff[p].voices[g])for(var w in n[s[p][g]].staff[p].voices[g]=[],c)c.hasOwnProperty(w)&&n[s[p][g]].staff[p].voices[g].push(c[w]);n[s[p][g]].staff[p].voices[g].push(y),"stem"===y.el_type&&(c[y.el_type]=y),"bar"===y.el_type&&(r[p][g]++,e[r[p][g]]&&(i[p][g]=!0,s[p][g]++,a[p][g]=y.barNumber,delete y.barNumber))}}}l=0}else n.push(u),l++}t.lines=n}},calcLineWraps:function(t,e,n,i,s,r){if(i.staffwidth<e.left)return{explanation:"Staffwidth is narrower than the margin",tune:t,revisedParams:i};var a=i.scale?Math.max(i.scale,.1):1,o=i.wrap.minSpacing?Math.max(parseFloat(i.wrap.minSpacing),1):1,c=i.wrap.minSpacingLimit?Math.max(parseFloat(i.wrap.minSpacingLimit),1):o-.1,l=i.wrap.maxSpacing?Math.max(parseFloat(i.wrap.maxSpacing),1):void 0;i.wrap.lastLineLimit&&!l&&(l=Math.max(parseFloat(i.wrap.lastLineLimit),1)),i.wrap.targetHeight&&Math.max(parseInt(i.wrap.targetHeight,10),100);var h=i.wrap.preferredMeasuresPerLine?Math.max(parseInt(i.wrap.preferredMeasuresPerLine,10),1):void 0,u=(i.staffwidth-e.left)/o/a,d=(i.staffwidth-e.left)/l/a,p=(i.staffwidth-e.left)/c/a,f={widths:e,lineBreakPoint:u,minLineSize:d,attempts:[],staffWidth:i.staffwidth,minWidth:Math.round(p)},m=null;if(h){var g=function(t,e,n){for(var i=[],s=[],r=0,a=!1,o=0;o<t.length;o++)(r+=t[o])>e&&(a=!0),o%n==n-1&&(o!==t.length-1&&i.push(o),s.push(Math.round(r)),r=0);return{failed:a,totals:s,lineBreaks:i}}(e.measureWidths,u,h);f.attempts.push({type:"Fixed Measures Per Line",preferredMeasuresPerLine:h,lineBreaks:g.lineBreaks,failed:g.failed,totals:g.totals}),g.failed||(m=g.lineBreaks)}if(!m){var v=function(t,e){for(var n=[],i=[],s=0,r=0;r<t.length;r++){var a=t[r],o=s+a;o<e?s=o:e-s<o-e&&s>0?(n.push(r-1),i.push(Math.round(s-a)),s=a):r<t.length-1&&(n.push(r),i.push(Math.round(s)),s=0)}return i.push(Math.round(s)),{lineBreaks:n,totals:i}}(e.measureWidths,u);f.attempts.push({type:"Free Form",lineBreaks:v.lineBreaks,totals:v.totals}),m=v.lineBreaks,v=function(t,e,n,i){for(var s=Math.ceil(t.total/e)+1,r=Math.floor(t.total/s),a=[],o=0;o<s;o++)a.push(r*(o+1));var c=[];c.push({accumulator:0,lineAccumulator:0,lineWidths:[],lastVariance:999999,highestVariance:0,currLine:0,lineBreaks:[],startIndex:0});for(var l=0;l<c.length;)Va(t.measureWidths,a,c[l].accumulator,c[l].lineAccumulator,c[l].lineWidths,c[l].lastVariance,c[l].highestVariance,c[l].currLine,c[l].lineBreaks,c[l].startIndex,c),l++;for(o=0;o<c.length;o++){var h=c[o];h.variances=[],h.aveVariance=0;for(var u=0;u<h.lineWidths.length;u++){var d=h.lineWidths[u];h.variances.push(d-a[0]),h.aveVariance+=Math.abs(d-a[0])}h.aveVariance=h.aveVariance/h.lineWidths.length,i.attempts.push({type:"optimizeLineWidths",lineBreaks:h.lineBreaks,variances:h.variances,aveVariance:h.aveVariance,widths:t.measureWidths})}var p=9999999,f=-1;for(o=0;o<c.length;o++)(h=c[o]).aveVariance<p&&(p=h.aveVariance,f=o);return{failed:!1,lineBreaks:c[f].lineBreaks,variance:c[f].highestVariance}}(e,u,0,f),f.attempts.push({type:"Optimize",failed:v.failed,reason:v.reason,lineBreaks:v.lineBreaks,totals:v.totals}),v.failed||(m=v.lineBreaks)}var b=i.staffwidth,_=Ha(m,b,n,i,s),y=r.getMeasureWidths(_.tune),w=!0;return f.attempts.push({type:"heightCheck",height:y.height}),0===m.length&&d>e.total&&(b=e.total*l*a+e.left,f.attempts.push({type:"too sparse",newWidth:Math.round(b)}),w=!1),w||(_=Ha(m,b,n,i,s)),_.explanation=f,_}},qa=function(){this.getBeatLength=function(){for(var t=0;t<this.lines.length;t++)if(this.lines[t].staff)for(var e=0;e<this.lines[t].staff.length;e++)if(this.lines[t].staff[e].meter){var n=this.lines[t].staff[e].meter;if("specified"===n.type){if(n.value.length>0){var i=parseInt(n.value[0].num,10),s=parseInt(n.value[0].den,10);return 3===i&&8===s||6===i&&8===s?3/8:6===i&&4===s?3/4:9===i&&8===s||12===i&&8===s?3/8:1/s}return 1/4}return"cut_time"===n.type?.5:1/4}return 1/4},this.getPickupLength=function(){for(var t=0,e=this.getBarLength(),n=0;n<this.lines.length;n++)if(this.lines[n].staff)for(var i=0;i<this.lines[n].staff.length;i++)for(var s=0;s<this.lines[n].staff[i].voices.length;s++)for(var r=this.lines[n].staff[i].voices[s],a=1,o=0;o<r.length;o++){var c=r[o].rest&&"spacer"===r[o].rest.type;if(r[o].startTriplet&&(a=r[o].tripletMultiplier),r[o].duration&&!c&&(t+=r[o].duration*a),r[o].endTriplet&&(a=1),t>=e&&(t-=e),"bar"===r[o].el_type)return t}return t},this.getBarLength=function(){var t=this.getMeterFraction();return t.num/t.den},this.millisecondsPerMeasure=function(t){var e;if(t)e=t;else{var n=this.metaText?this.metaText.tempo:null;e=this.getBpm(n)}return e<=0&&(e=1),6e4*(this.getBeatsPerMeasure()/e)},this.getBeatsPerMeasure=function(){var t,e=this.getMeterFraction();return(t=8===e.den?e.num/3:e.num)<=0&&(t=1),t},this.reset=function(){this.version="1.0.1",this.media="screen",this.metaText={},this.formatting={},this.lines=[],this.staffNum=0,this.voiceNum=0,this.lineNum=0},this.resolveOverlays=function(){for(var t=!1,e=0;e<this.lines.length;e++){var n=this.lines[e];if(n.staff)for(var i=0;i<n.staff.length;i++){for(var s=n.staff[i],r=[],a=0;a<s.voices.length;a++){var o=s.voices[a];r.push({hasOverlay:!1,voice:[],snip:[]});for(var c=0,l=!1,h=-1,u=0;u<o.length;u++){var d=o[u];"overlay"!==d.el_type||l?"bar"===d.el_type?(l?(l=!1,r[a].snip.push({start:h,len:u-h}),r[a].voice.push(d)):(c>0&&r[a].voice.push({el_type:"note",duration:c,rest:{type:"invisible"},startChar:d.startChar,endChar:d.endChar}),r[a].voice.push(d)),c=0):"note"===d.el_type?l?r[a].voice.push(d):c+=d.duration:"scale"!==d.el_type&&"stem"!==d.el_type&&"overlay"!==d.el_type&&"style"!==d.el_type&&"transpose"!==d.el_type||r[a].voice.push(d):(t=!0,l=!0,h=u,r[a].hasOverlay=!0)}r[a].hasOverlay&&0===r[a].snip.length&&r[a].snip.push({start:h,len:o.length-h})}for(a=0;a<r.length;a++){var p=r[a];if(p.hasOverlay){s.voices.push(p.voice);for(var f=p.snip.length-1;f>=0;f--){var m=p.snip[f];s.voices[a].splice(m.start,m.len)}for(f=0;f<s.voices[s.voices.length-1].length;f++){s.voices[s.voices.length-1][f]=da.clone(s.voices[s.voices.length-1][f]);var g=s.voices[s.voices.length-1][f];"bar"===g.el_type&&g.startEnding&&delete g.startEnding,"bar"===g.el_type&&g.endEnding&&delete g.endEnding}}}}}return t},this.cleanUp=function(t,e,n,i,s){this.closeLine(),this.metaText.tempo&&this.metaText.tempo.bpm&&!this.metaText.tempo.duration&&(this.metaText.tempo.duration=[this.getBeatLength()]);var r,a,o,c=!1;for(r=0;r<this.lines.length;r++)if(void 0!==this.lines[r].staff){var l=!1;for(a=0;a<this.lines[r].staff.length;a++)if(void 0===this.lines[r].staff[a])c=!0,this.lines[r].staff[a]=null;else for(o=0;o<this.lines[r].staff[a].voices.length;o++)void 0===this.lines[r].staff[a].voices[o]?this.lines[r].staff[a].voices[o]=[]:this.containsNotes(this.lines[r].staff[a].voices[o])&&(l=!0);l||(this.lines[r]=null,c=!0)}if(c&&(this.lines=da.compact(this.lines),da.each(this.lines,(function(t){t.staff&&(t.staff=da.compact(t.staff))}))),n)for(;p(this.lines,n););if(i){for(c=!1,r=0;r<this.lines.length;r++)if(void 0!==this.lines[r].staff)for(a=0;a<this.lines[r].staff.length;a++){var h=!1;for(o=0;o<this.lines[r].staff[a].voices.length;o++)this.containsNotesStrict(this.lines[r].staff[a].voices[o])&&(h=!0);h||(c=!0,this.lines[r].staff[a]=null)}c&&da.each(this.lines,(function(t){t.staff&&(t.staff=da.compact(t.staff))}))}for(function(t){for(var e=!0,n=0;n<t.length;n++){var i=t[n];if(i.staff){for(var s=0;s<i.staff.length;s++){var r=i.staff[s];if(r.title){for(var a=!1,o=0;o<r.title.length;o++)r.title[o]?(r.title[o]=e?r.title[o].name:r.title[o].subname,r.title[o]?a=!0:r.title[o]=""):r.title[o]="";a||delete r.title}}e=!1}}}(this.lines),r=0;r<this.lines.length;r++)if(this.lines[r].staff)for(a=0;a<this.lines[r].staff.length;a++)delete this.lines[r].staff[a].workingClef;for(;this.resolveOverlays(););function u(t){for(var e,n=function(t,n,i){if(void 0===s[i]){for(e=0;e<s.length;e++)if(void 0!==s[e]){i=e;break}if(void 0===s[i]){var r=100*i+1;da.each(t.endSlur,(function(t){r===t&&--r})),s[i]=[r]}}for(var a,o=0;o<n;o++)a=s[i].pop(),t.endSlur.push(a);return 0===s[i].length&&delete s[i],a},i=function(t,e,n,i){t.startSlur=[],void 0===s[n]&&(s[n]=[]);for(var r=100*n+1,a=0;a<e;a++)i&&(da.each(i,(function(t){r===t&&++r})),da.each(i,(function(t){r===t&&++r})),da.each(i,(function(t){r===t&&++r}))),da.each(s[n],(function(t){r===t&&++r})),da.each(s[n],(function(t){r===t&&++r})),s[n].push(r),t.startSlur.push({label:r}),r++},r=0;r<t.length;r++){var a=t[r];if("note"===a.el_type){if(a.gracenotes)for(var o=0;o<a.gracenotes.length;o++){if(a.gracenotes[o].endSlur){var c=a.gracenotes[o].endSlur;a.gracenotes[o].endSlur=[];for(var l=0;l<c;l++)n(a.gracenotes[o],1,20)}a.gracenotes[o].startSlur&&(e=a.gracenotes[o].startSlur,i(a.gracenotes[o],e,20))}if(a.endSlur&&(e=a.endSlur,a.endSlur=[],n(a,e,0)),a.startSlur&&i(a,e=a.startSlur,0),a.pitches){for(var h=[],u=0;u<a.pitches.length;u++)if(a.pitches[u].endSlur){var d=a.pitches[u].endSlur;a.pitches[u].endSlur=[];for(var p=0;p<d;p++){var f=n(a.pitches[u],1,u+1);h.push(f)}}for(u=0;u<a.pitches.length;u++)a.pitches[u].startSlur&&(e=a.pitches[u].startSlur,i(a.pitches[u],e,u+1,h));a.gracenotes&&a.pitches[0].endSlur&&100===a.pitches[0].endSlur[0]&&a.pitches[0].startSlur&&(a.gracenotes[0].endSlur?a.gracenotes[0].endSlur.push(a.pitches[0].startSlur[0].label):a.gracenotes[0].endSlur=[a.pitches[0].startSlur[0].label],1===a.pitches[0].endSlur.length?delete a.pitches[0].endSlur:100===a.pitches[0].endSlur[0]?a.pitches[0].endSlur.shift():100===a.pitches[0].endSlur[a.pitches[0].endSlur.length-1]&&a.pitches[0].endSlur.pop(),1===s[1].length?delete s[1]:s[1].pop())}}}}function d(t){Da.fixClef(t)}function p(t,e){for(r=0;r<t.length;r++)if(void 0!==t[r].staff)for(a=0;a<t[r].staff.length;a++){var n=[];for(o=0;o<t[r].staff[a].voices.length;o++)for(var i=t[r].staff[a].voices[o],s=0,c=0;c<i.length;c++)if("bar"===i[c].el_type){if(++s>=e&&c<i.length-1){var l=f(t,r);if(!l){var h=JSON.parse(JSON.stringify(t[r]));t.push(da.clone(h)),l=t[t.length-1];for(var u=0;u<l.staff.length;u++)for(var d=0;d<l.staff[u].voices.length;d++)l.staff[u].voices[d]=[]}var p=c+1,m=t[r].staff[a].voices[o].slice(p);return t[r].staff[a].voices[o]=t[r].staff[a].voices[o].slice(0,p),l.staff[a].voices[o]=n.concat(m.concat(l.staff[a].voices[o])),!0}}else i[c].duration||n.push(i[c])}return!1}function f(t,e){for(e++;t.length>e;){if(t[e].staff)return t[e];e++}return null}for(this.lineNum=0;this.lineNum<this.lines.length;this.lineNum++){var m=this.lines[this.lineNum].staff;if(m)for(this.staffNum=0;this.staffNum<m.length;this.staffNum++)for(m[this.staffNum].clef&&d(m[this.staffNum].clef),this.voiceNum=0;this.voiceNum<m[this.staffNum].voices.length;this.voiceNum++){var g=m[this.staffNum].voices[this.voiceNum];u(g);for(var v=0;v<g.length;v++)"clef"===g[v].el_type&&d(g[v]);if(g.length>0&&g[g.length-1].barNumber){var b=f(this.lines,this.lineNum);b&&(b.staff[0].barNumber=g[g.length-1].barNumber),delete g[g.length-1].barNumber}}}return this.formatting.pagewidth||(this.formatting.pagewidth=t),this.formatting.pageheight||(this.formatting.pageheight=e),delete this.staffNum,delete this.voiceNum,delete this.lineNum,delete this.potentialStartBeam,delete this.potentialEndBeam,delete this.vskipPending,s},this.reset(),this.getLastNote=function(){if(this.lines[this.lineNum]&&this.lines[this.lineNum].staff&&this.lines[this.lineNum].staff[this.staffNum]&&this.lines[this.lineNum].staff[this.staffNum].voices[this.voiceNum])for(var t=this.lines[this.lineNum].staff[this.staffNum].voices[this.voiceNum].length-1;t>=0;t--){var e=this.lines[this.lineNum].staff[this.staffNum].voices[this.voiceNum][t];if("note"===e.el_type)return e}return null},this.addTieToLastNote=function(){var t=this.getLastNote();return!!(t&&t.pitches&&t.pitches.length>0)&&(t.pitches[0].startTie={},!0)},this.getDuration=function(t){return t.duration?t.duration:0},this.closeLine=function(){this.potentialStartBeam&&this.potentialEndBeam&&(this.potentialStartBeam.startBeam=!0,this.potentialEndBeam.endBeam=!0),delete this.potentialStartBeam,delete this.potentialEndBeam},this.appendElement=function(t,e,n,i){var s=this;i.el_type=t,null!==e&&(i.startChar=e),null!==n&&(i.endChar=n);var r=function(){void 0!==s.potentialStartBeam&&void 0!==s.potentialEndBeam&&(s.potentialStartBeam.startBeam=!0,s.potentialEndBeam.endBeam=!0),delete s.potentialStartBeam,delete s.potentialEndBeam};"note"===t?s.getDuration(i)>=.25||i.force_end_beam_last&&void 0!==s.potentialStartBeam?r():i.end_beam&&void 0!==s.potentialStartBeam?void 0===i.rest?(s.potentialStartBeam.startBeam=!0,i.endBeam=!0,delete s.potentialStartBeam,delete s.potentialEndBeam):r():void 0===i.rest&&(void 0===s.potentialStartBeam?i.end_beam||(s.potentialStartBeam=i,delete s.potentialEndBeam):s.potentialEndBeam=i):r();delete i.end_beam,delete i.force_end_beam_last,function(t){var e=s.lines[s.lineNum].staff[s.staffNum];if(e){if(void 0!==t.pitches){var n=e.workingClef.verticalPos;da.each(t.pitches,(function(t){t.verticalPos=t.pitch-n}))}if(void 0!==t.gracenotes){var i=e.workingClef.verticalPos;da.each(t.gracenotes,(function(t){t.verticalPos=t.pitch-i}))}e.voices[s.voiceNum].push(t)}}(i)},this.appendStartingElement=function(t,e,n,i){var s;this.closeLine(),"key"===t&&(s=i.impliedNaturals,delete i.impliedNaturals,delete i.explicitAccidentals);var r=da.clone(i);if(this.lines[this.lineNum].staff){this.lines[this.lineNum].staff.length<=this.staffNum&&(this.lines[this.lineNum].staff[this.staffNum]={},this.lines[this.lineNum].staff[this.staffNum].clef=da.clone(this.lines[this.lineNum].staff[0].clef),this.lines[this.lineNum].staff[this.staffNum].key=da.clone(this.lines[this.lineNum].staff[0].key),this.lines[this.lineNum].staff[0].meter&&(this.lines[this.lineNum].staff[this.staffNum].meter=da.clone(this.lines[this.lineNum].staff[0].meter)),this.lines[this.lineNum].staff[this.staffNum].workingClef=da.clone(this.lines[this.lineNum].staff[0].workingClef),this.lines[this.lineNum].staff[this.staffNum].voices=[[]]),"clef"===t&&(this.lines[this.lineNum].staff[this.staffNum].workingClef=r);for(var a=this.lines[this.lineNum].staff[this.staffNum].voices[this.voiceNum],o=0;o<a.length;o++){if("note"===a[o].el_type||"bar"===a[o].el_type)return r.el_type=t,r.startChar=e,r.endChar=n,s&&(r.accidentals=s.concat(r.accidentals)),void a.push(r);if(a[o].el_type===t)return r.el_type=t,r.startChar=e,r.endChar=n,s&&(r.accidentals=s.concat(r.accidentals)),void(a[o]=r)}this.lines[this.lineNum].staff[this.staffNum][t]=i}},this.getNumLines=function(){return this.lines.length},this.pushLine=function(t){this.vskipPending&&(t.vskip=this.vskipPending,delete this.vskipPending),this.lines.push(t)},this.addSubtitle=function(t){this.pushLine({subtitle:t})},this.addSpacing=function(t){this.vskipPending=t},this.addNewPage=function(t){this.pushLine({newpage:t})},this.addSeparator=function(t,e,n){this.pushLine({separator:{spaceAbove:t,spaceBelow:e,lineLength:n}})},this.addText=function(t){this.pushLine({text:t})},this.addCentered=function(t){this.pushLine({text:[{text:t,center:!0}]})},this.containsNotes=function(t){for(var e=0;e<t.length;e++)if("note"===t[e].el_type||"bar"===t[e].el_type)return!0;return!1},this.containsNotesStrict=function(t){for(var e=0;e<t.length;e++)if("note"===t[e].el_type&&void 0===t[e].rest)return!0;return!1},this.changeVoiceScale=function(t){this.appendElement("scale",null,null,{size:t})},this.startNewLine=function(t){var e=this;this.closeLine();var n=function(t){var n=e.lines[e.lineNum].staff[e.staffNum];if(n.voices[e.voiceNum]=[],n.title||(n.title=[]),n.title[e.voiceNum]={name:t.name,subname:t.subname},t.style&&e.appendElement("style",null,null,{head:t.style}),t.stem)e.appendElement("stem",null,null,{direction:t.stem});else if(e.voiceNum>0){if(void 0!==n.voices[0]){for(var i=!1,s=0;s<n.voices[0].length;s++)"stem"===n.voices[0].el_type&&(i=!0);if(!i){n.voices[0].splice(0,0,{el_type:"stem",direction:"up"})}}e.appendElement("stem",null,null,{direction:"down"})}t.scale&&e.appendElement("scale",null,null,{size:t.scale})},i=function(t){t.key&&t.key.impliedNaturals&&(t.key.accidentals=t.key.accidentals.concat(t.key.impliedNaturals),delete t.key.impliedNaturals),e.lines[e.lineNum].staff[e.staffNum]={voices:[],clef:t.clef,key:t.key,workingClef:t.clef},void 0!==t.stafflines&&(e.lines[e.lineNum].staff[e.staffNum].clef.stafflines=t.stafflines,e.lines[e.lineNum].staff[e.staffNum].workingClef.stafflines=t.stafflines),t.staffscale&&(e.lines[e.lineNum].staff[e.staffNum].staffscale=t.staffscale),t.tripletfont&&(e.lines[e.lineNum].staff[e.staffNum].tripletfont=t.tripletfont),t.vocalfont&&(e.lines[e.lineNum].staff[e.staffNum].vocalfont=t.vocalfont),t.bracket&&(e.lines[e.lineNum].staff[e.staffNum].bracket=t.bracket),t.brace&&(e.lines[e.lineNum].staff[e.staffNum].brace=t.brace),t.connectBarLines&&(e.lines[e.lineNum].staff[e.staffNum].connectBarLines=t.connectBarLines),t.barNumber&&(e.lines[e.lineNum].staff[e.staffNum].barNumber=t.barNumber),n(t),t.part&&e.appendElement("part",t.part.startChar,t.part.endChar,{title:t.part.title}),void 0!==t.meter&&(e.lines[e.lineNum].staff[e.staffNum].meter=t.meter)};if(void 0===this.lines[this.lineNum])!function(t){e.lines[e.lineNum]={staff:[]},i(t)}(t);else if(void 0===this.lines[this.lineNum].staff)this.lineNum++,this.startNewLine(t);else if(void 0===this.lines[this.lineNum].staff[this.staffNum])i(t);else if(void 0===this.lines[this.lineNum].staff[this.staffNum].voices[this.voiceNum])n(t);else{if(!this.containsNotes(this.lines[this.lineNum].staff[this.staffNum].voices[this.voiceNum]))return;this.lineNum++,this.startNewLine(t)}},this.setBarNumberImmediate=function(t){var e=this.getCurrentVoice();if(e&&e.length>0){var n=e[e.length-1];if("bar"!==n.el_type)return t-1;void 0!==n.barNumber&&(n.barNumber=t)}return t},this.hasBeginMusic=function(){for(var t=0;t<this.lines.length;t++)if(this.lines[t].staff)return!0;return!1},this.isFirstLine=function(t){for(var e=t-1;e>=0;e--)if(void 0!==this.lines[e].staff)return!1;return!0},this.getMeter=function(){for(var t=0;t<this.lines.length;t++){var e=this.lines[t];if(e.staff)for(var n=0;n<e.staff.length;n++){var i=e.staff[n].meter;if(i)return i}}return{type:"common_time"}},this.getMeterFraction=function(){var t=this.getMeter(),e=4,n=4;return t&&("specified"===t.type?(e=parseInt(t.value[0].num,10),n=parseInt(t.value[0].den,10)):"cut_time"===t.type?(e=2,n=2):"common_time"===t.type&&(e=4,n=4)),this.meter={num:e,den:n},this.meter},this.getKeySignature=function(){for(var t=0;t<this.lines.length;t++){var e=this.lines[t];if(e.staff)for(var n=0;n<e.staff.length;n++)if(e.staff[n].key)return e.staff[n].key}return{}},this.getCurrentVoice=function(){return void 0!==this.lines[this.lineNum]&&void 0!==this.lines[this.lineNum].staff[this.staffNum]&&void 0!==this.lines[this.lineNum].staff[this.staffNum].voices[this.voiceNum]?this.lines[this.lineNum].staff[this.staffNum].voices[this.voiceNum]:null},this.setCurrentVoice=function(t,e){this.staffNum=t,this.voiceNum=e;for(var n=0;n<this.lines.length;n++)if(this.lines[n].staff&&(void 0===this.lines[n].staff[t]||void 0===this.lines[n].staff[t].voices[e]||!this.containsNotes(this.lines[n].staff[t].voices[e])))return void(this.lineNum=n);this.lineNum=n},this.addMetaText=function(t,e){void 0===this.metaText[t]?this.metaText[t]=e:this.metaText[t]+="\n"+e},this.addMetaTextArray=function(t,e){void 0===this.metaText[t]?this.metaText[t]=[e]:this.metaText[t].push(e)},this.addMetaTextObj=function(t,e){this.metaText[t]=e},this.addElementToEvents=function(t,e,n,i,s,r,a,o,c,l){if(e.hint)return{isTiedState:void 0,duration:0};var h=e.durationClass?e.durationClass:e.duration;if(e.abcelem.rest&&"spacer"===e.abcelem.rest.type&&(h=0),h>0){for(var u=[],d=0;d<e.elemset.length;d++)null!==e.elemset[d]&&u.push(e.elemset[d]);var p=e.startTie;if(void 0!==c)t["event"+c].elements.push(u),l&&(t["event"+n]||(t["event"+n]={type:"event",milliseconds:n,line:r,measureNumber:a,top:i,height:s,left:null,width:0,elements:[],startChar:null,endChar:null,startCharArray:[],endCharArray:[]}),t["event"+n].measureStart=!0,l=!1),p||(c=void 0);else{if(t["event"+n]){if(t["event"+n].left?t["event"+n].left=Math.min(t["event"+n].left,e.x):t["event"+n].left=e.x,t["event"+n].elements.push(u),t["event"+n].startCharArray.push(e.abcelem.startChar),t["event"+n].endCharArray.push(e.abcelem.endChar),null===t["event"+n].startChar&&(t["event"+n].startChar=e.abcelem.startChar),null===t["event"+n].endChar&&(t["event"+n].endChar=e.abcelem.endChar),e.abcelem.midiPitches&&e.abcelem.midiPitches.length){t["event"+n].midiPitches||(t["event"+n].midiPitches=[]);for(d=0;d<e.abcelem.midiPitches.length;d++)t["event"+n].midiPitches.push(e.abcelem.midiPitches[d])}if(e.abcelem.midiGraceNotePitches&&e.abcelem.midiGraceNotePitches.length){t["event"+n].midiGraceNotePitches||(t["event"+n].midiGraceNotePitches=[]);for(var f=0;f<e.abcelem.midiGraceNotePitches.length;f++)t["event"+n].midiGraceNotePitches.push(e.abcelem.midiGraceNotePitches[f])}}else t["event"+n]={type:"event",milliseconds:n,line:r,measureNumber:a,top:i,height:s,left:e.x,width:e.w,elements:[u],startChar:e.abcelem.startChar,endChar:e.abcelem.endChar,startCharArray:[e.abcelem.startChar],endCharArray:[e.abcelem.endChar],midiPitches:e.abcelem.midiPitches?da.cloneArray(e.abcelem.midiPitches):[]},e.abcelem.midiGraceNotePitches&&(t["event"+n].midiGraceNotePitches=da.cloneArray(e.abcelem.midiGraceNotePitches));l&&(t["event"+n].measureStart=!0,l=!1),p&&(c=n)}}return{isTiedState:c,duration:h/o,nextIsBar:l||"bar"===e.type}},this.makeVoicesArray=function(){for(var t=[],e=0;e<this.engraver.staffgroups.length;e++)for(var n=this.engraver.staffgroups[e],i=n.staffs[0],s=i.absoluteY,r=s-i.top*ha.STEP,a=n.staffs[n.staffs.length-1],o=(s=a.absoluteY)-a.bottom*ha.STEP-r,c=n.voices,l=0;l<c.length;l++){var h=0,u=!1;t[l]||(t[l]=[]);for(var d=c[l].children,p=0;p<d.length;p++)t[l].push({top:r,height:o,line:e,measureNumber:h,elem:d[p]}),"bar"===d[p].type&&u&&h++,"note"!==d[p].type&&"rest"!==d[p].type||(u=!0)}return t},this.setupEvents=function(t,e,n){for(var i,s=[],r={},a=t,o=!0,c=this.makeVoicesArray(),l=0;l<c.length;l++)for(var h=a,u=Math.round(1e3*h),d=0,p=-1,f=c[l],m=0;m<f.length;m++){var g=f[m].elem;if("tempo"===g.abcelem.el_type){n=this.getBpm(g.abcelem);e=this.getBeatLength()*(n/60)}var v=this.addElementToEvents(r,g,u,f[m].top,f[m].height,f[m].line,f[m].measureNumber,e,i,o);if(i=v.isTiedState,o=v.nextIsBar,h+=v.duration,u=Math.round(1e3*h),"bar"===g.type){var b=g.abcelem.type,_="bar_right_repeat"===b||"bar_dbl_repeat"===b,y="1"===g.abcelem.startEnding,w="bar_left_repeat"===b||"bar_dbl_repeat"===b||"bar_right_repeat"===b;if(_){-1===p&&(p=m);for(var x=d;x<p;x++){var k=f[x].elem;i=(v=this.addElementToEvents(r,k,u,f[x].top,f[x].height,f[x].line,f[x].measureNumber,e,i,o)).isTiedState,o=v.nextIsBar,h+=v.duration,u=Math.round(1e3*h)}o=!0,p=-1}y&&(p=m),w&&(d=m)}}return function(t){for(var e,n,i,s,r=t.length-1;r>=0;r--){var a=t[r];"bar"===a.type?(a.top=i,a.nextTop=e,e=i,a.bottom=s,a.nextBottom=n,n=s):"event"===a.type&&(i=a.top,s=a.top+a.height)}}(s=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(t[n]);return e.sort((function(t,e){var n=t.milliseconds-e.milliseconds;return 0!==n?n:"bar"===t.type?-1:1}))}(r)),s.push({type:"end",milliseconds:u}),this.addUsefulCallbackInfo(s,n),s},this.addUsefulCallbackInfo=function(t,e){for(var n=this.millisecondsPerMeasure(e),i=0;i<t.length;i++){t[i].millisecondsPerMeasure=n}},this.getBpm=function(t){var e;if(t){e=t.bpm;var n=this.getBeatLength();e=e*(t.duration&&t.duration.length>0?t.duration[0]:n)/n}if(!e){e=180;var i=this.getMeterFraction();i&&8===i.den&&(e=120)}return e},this.setTiming=function(t,e){if(!t){var n=this.metaText?this.metaText.tempo:null;t=this.getBpm(n)}var i=this.getBeatLength(),s=t/60,r=this.getBarLength()/i*e/s;r&&(r-=this.getPickupLength()/i/s);var a=i*s;this.noteTimings=this.setupEvents(r,a,t)}},za=function(){var t=new qa,e=new Ra;function n(t,e,n){t.positioning||(t.positioning={}),t.positioning[e]=n}function i(t,e,n){t.fonts||(t.fonts={}),t.fonts[e]=n}this.getTune=function(){return{formatting:t.formatting,lines:t.lines,media:t.media,metaText:t.metaText,version:t.version,addElementToEvents:t.addElementToEvents,addUsefulCallbackInfo:t.addUsefulCallbackInfo,getBarLength:t.getBarLength,getBeatLength:t.getBeatLength,getBeatsPerMeasure:t.getBeatsPerMeasure,getBpm:t.getBpm,getMeter:t.getMeter,getMeterFraction:t.getMeterFraction,getPickupLength:t.getPickupLength,getKeySignature:t.getKeySignature,makeVoicesArray:t.makeVoicesArray,millisecondsPerMeasure:t.millisecondsPerMeasure,setupEvents:t.setupEvents,setTiming:t.setTiming}};var s={reset:function(){for(var t in this)this.hasOwnProperty(t)&&"function"!=typeof this[t]&&delete this[t];this.iChar=0,this.key={accidentals:[],root:"none",acc:"",mode:""},this.meter=null,this.origMeter=null,this.hasMainTitle=!1,this.default_length=.125,this.clef={type:"treble",verticalPos:0},this.next_note_duration=0,this.start_new_line=!0,this.is_in_header=!0,this.is_in_history=!1,this.partForNextLine={},this.havent_set_length=!0,this.voices={},this.staves=[],this.macros={},this.currBarNumber=1,this.barCounter={},this.inTextBlock=!1,this.inPsBlock=!1,this.ignoredDecorations=[],this.textBlock="",this.score_is_present=!1,this.inEnding=!1,this.inTie=[],this.inTieChord={},this.vocalPosition="auto",this.dynamicPosition="auto",this.chordPosition="auto",this.ornamentPosition="auto",this.volumePosition="auto",this.openSlurs=[],this.freegchord=!1},differentFont:function(t,e){return this[t].decoration!==e[t].decoration||(this[t].face!==e[t].face||(this[t].size!==e[t].size||(this[t].style!==e[t].style||this[t].weight!==e[t].weight)))},addFormattingOptions:function(t,e,s){"note"===s?("auto"!==this.vocalPosition&&n(t,"vocalPosition",this.vocalPosition),"auto"!==this.dynamicPosition&&n(t,"dynamicPosition",this.dynamicPosition),"auto"!==this.chordPosition&&n(t,"chordPosition",this.chordPosition),"auto"!==this.ornamentPosition&&n(t,"ornamentPosition",this.ornamentPosition),"auto"!==this.volumePosition&&n(t,"volumePosition",this.volumePosition),this.differentFont("annotationfont",e)&&i(t,"annotationfont",this.annotationfont),this.differentFont("gchordfont",e)&&i(t,"gchordfont",this.gchordfont),this.differentFont("vocalfont",e)&&i(t,"vocalfont",this.vocalfont),this.differentFont("tripletfont",e)&&i(t,"tripletfont",this.tripletfont)):"bar"===s&&("auto"!==this.dynamicPosition&&n(t,"dynamicPosition",this.dynamicPosition),"auto"!==this.chordPosition&&n(t,"chordPosition",this.chordPosition),"auto"!==this.ornamentPosition&&n(t,"ornamentPosition",this.ornamentPosition),"auto"!==this.volumePosition&&n(t,"volumePosition",this.volumePosition),this.differentFont("measurefont",e)&&i(t,"measurefont",this.measurefont),this.differentFont("repeatfont",e)&&i(t,"repeatfont",this.repeatfont))}},r=function(t){var e=da.gsub(t,""," ");return e=da.gsub(e,"&","&amp;"),e=da.gsub(e,"<","&lt;"),da.gsub(e,">","&gt;")},a=function(e,n,i){n||(n=" ");var a=n.charAt(i);" "===a&&(a="SPACE");var o,c=r(n.substring(0,i))+'<span style="text-decoration:underline;font-size:1.3em;font-weight:bold;">'+a+"</span>"+r(n.substring(i+1));!function(t){s.warnings||(s.warnings=[]),s.warnings.push(t)}("Music Line:"+t.getNumLines()+":"+(i+1)+": "+e+":  "+c),o={message:e,line:n,startChar:s.iChar+i,column:i},s.warningObjects||(s.warningObjects=[]),s.warningObjects.push(o)},o=new Ba(e,a,s,t);this.getWarnings=function(){return s.warnings},this.getWarningObjects=function(){return s.warningObjects};var c=function(t,n){if('"'===t.charAt(n)){var i=e.getBrackettedSubstring(t,n,5);if(i[2]||a("Missing the closing quote while parsing the chord symbol",t,n),i[0]>0&&i[1].length>0&&"^"===i[1].charAt(0))i[1]=i[1].substring(1),i[2]="above";else if(i[0]>0&&i[1].length>0&&"_"===i[1].charAt(0))i[1]=i[1].substring(1),i[2]="below";else if(i[0]>0&&i[1].length>0&&"<"===i[1].charAt(0))i[1]=i[1].substring(1),i[2]="left";else if(i[0]>0&&i[1].length>0&&">"===i[1].charAt(0))i[1]=i[1].substring(1),i[2]="right";else if(i[0]>0&&i[1].length>0&&"@"===i[1].charAt(0)){i[1]=i[1].substring(1);var r=e.getFloat(i[1]);0===r.digits&&a("Missing first position in absolutely positioned annotation.",t,n),i[1]=i[1].substring(r.digits),","!==i[1][0]&&a("Missing comma absolutely positioned annotation.",t,n),i[1]=i[1].substring(1);var o=e.getFloat(i[1]);0===o.digits&&a("Missing second position in absolutely positioned annotation.",t,n),i[1]=i[1].substring(o.digits);var c=e.skipWhiteSpace(i[1]);i[1]=i[1].substring(c),i[2]=null,i[3]={x:r.value,y:o.value}}else!0!==s.freegchord&&(i[1]=i[1].replace(/([ABCDEFG0-9])b/g,"$1♭"),i[1]=i[1].replace(/([ABCDEFG0-9])#/g,"$1♯")),i[2]="default",i[1]=Oa.chordName(s,i[1]);return i}return[0,""]},l=["trill","lowermordent","uppermordent","mordent","pralltriller","accent","fermata","invertedfermata","tenuto","0","1","2","3","4","5","+","wedge","open","thumb","snap","turn","roll","breath","shortphrase","mediumphrase","longphrase","segno","coda","D.S.","D.C.","fine","slide","^","marcato","upbow","downbow","/","//","///","////","trem1","trem2","trem3","trem4","turnx","invertedturn","invertedturnx","trill(","trill)","arpeggio","xstem","mark","umarcato","style=normal","style=harmonic","style=rhythm","style=x"],h=["p","pp","f","ff","mf","mp","ppp","pppp","fff","ffff","sfz"],u=["crescendo(","crescendo)","diminuendo(","diminuendo)"],d=[["<","accent"],[">","accent"],["tr","trill"],["plus","+"],["emphasis","accent"],["^","umarcato"],["marcato","umarcato"]],p=[["<(","crescendo("],["<)","crescendo)"],[">(","diminuendo("],[">)","diminuendo)"]],f=function(t,n){var i=s.macros[t.charAt(n)];if(void 0!==i)return"!"!==i.charAt(0)&&"+"!==i.charAt(0)||(i=i.substring(1)),"!"!==i.charAt(i.length-1)&&"+"!==i.charAt(i.length-1)||(i=i.substring(0,i.length-1)),da.detect(l,(function(t){return i===t}))?[1,i]:da.detect(h,(function(t){return i===t}))?("hidden"===s.volumePosition&&(i=""),[1,i]):da.detect(u,(function(t){return"hidden"===s.dynamicPosition&&(i=""),i===t}))?[1,i]:(da.detect(s.ignoredDecorations,(function(t){return i===t}))||a("Unknown macro: "+i,t,n),[1,""]);switch(t.charAt(n)){case".":return[1,"staccato"];case"u":return[1,"upbow"];case"v":return[1,"downbow"];case"~":return[1,"irishroll"];case"!":case"+":var r=e.getBrackettedSubstring(t,n,5);return r[1].length>0&&("^"===r[1].charAt(0)||"_"===r[1].charAt(0))&&(r[1]=r[1].substring(1)),da.detect(l,(function(t){return r[1]===t}))?r:da.detect(h,(function(t){return r[1]===t}))?("hidden"===s.volumePosition&&(r[1]=""),r):da.detect(u,(function(t){return r[1]===t}))?("hidden"===s.dynamicPosition&&(r[1]=""),r):da.detect(d,(function(t){return r[1]===t[0]&&(r[1]=t[1],!0)}))?r:da.detect(p,(function(t){return r[1]===t[0]&&(r[1]=t[1],!0)}))?("hidden"===s.dynamicPosition&&(r[1]=""),r):"!"!==t.charAt(n)||1!==r[0]&&"!"===t.charAt(n+r[0]-1)?(a("Unknown decoration: "+r[1],t,n),r[1]="",r):[1,null];case"H":return[1,"fermata"];case"J":return[1,"slide"];case"L":return[1,"accent"];case"M":return[1,"mordent"];case"O":return[1,"coda"];case"P":return[1,"pralltriller"];case"R":return[1,"roll"];case"S":return[1,"segno"];case"T":return[1,"trill"]}return[0,0]},m=function(t,n){for(var i=n;e.isWhiteSpace(t.charAt(n));)n++;return[n-i]},g=function(t,n){var i=e.getBarLine(t,n);if(0===i.len)return[0,""];if(i.warn)return a(i.warn,t,n),[i.len,""];for(var s=0;s<t.length&&" "===t.charAt(n+i.len+s);s++);var r=i.len;if("["===t.charAt(n+i.len+s)&&(i.len+=s+1),'"'===t.charAt(n+i.len)&&"["===t.charAt(n+i.len-1)){var o=e.getBrackettedSubstring(t,n+i.len,5);return[i.len+o[0],i.token,o[1]]}var c=e.getTokenOf(t.substring(n+i.len),"1234567890-,");return 0===c.len||"-"===c.token[0]?[r,i.token]:[i.len+c.len,i.token,c.token]},v={2:3,3:2,4:3,5:2,6:2,7:2,8:3,9:2},b=function(t,n){for(var i={},s=n;"("===t.charAt(n)||e.isWhiteSpace(t.charAt(n));)"("===t.charAt(n)&&(n+1<t.length&&t.charAt(n+1)>="2"&&t.charAt(n+1)<="9"?(void 0!==i.triplet?a("Can't nest triplets",t,n):(i.triplet=t.charAt(n+1)-"0",i.tripletQ=v[i.triplet],i.num_notes=i.triplet,n+2<t.length&&":"===t.charAt(n+2)&&(n+3<t.length&&":"===t.charAt(n+3)?n+4<t.length&&t.charAt(n+4)>="1"&&t.charAt(n+4)<="9"?(i.num_notes=t.charAt(n+4)-"0",n+=3):a("expected number after the two colons after the triplet to mark the duration",t,n):n+3<t.length&&t.charAt(n+3)>="1"&&t.charAt(n+3)<="9"?(i.tripletQ=t.charAt(n+3)-"0",n+4<t.length&&":"===t.charAt(n+4)?n+5<t.length&&t.charAt(n+5)>="1"&&t.charAt(n+5)<="9"&&(i.num_notes=t.charAt(n+5)-"0",n+=4):n+=2):a("expected number after the triplet to mark the duration",t,n))),n++):void 0===i.startSlur?i.startSlur=1:i.startSlur++),n++;return i.consumed=n-s,i},_=function(t,e){switch(t.charAt(e)){case">":return e<t.length-1&&">"===t.charAt(e+1)?[2,1.75,.25]:[1,1.5,.5];case"<":return e<t.length-1&&"<"===t.charAt(e+1)?[2,.25,1.75]:[1,.5,1.5]}return null},y=function(t){return void 0!==t.duration&&t.duration<.25&&(t.end_beam=!0),t},w={A:5,B:6,C:0,D:1,E:2,F:3,G:4,a:12,b:13,c:7,d:8,e:9,f:10,g:11},x={x:"invisible",y:"spacer",z:"rest",Z:"multimeasure"},k=function(n,i,r,a){for(var o=function(t){return"octave"===t||"duration"===t||"Zduration"===t||"broken_rhythm"===t||"end_slur"===t},c="startSlur",l=!1;;){switch(n.charAt(i)){case"(":if("startSlur"!==c)return o(c)?(r.endChar=i,r):null;void 0===r.startSlur?r.startSlur=1:r.startSlur++;break;case")":if(!o(c))return null;void 0===r.endSlur?r.endSlur=1:r.endSlur++;break;case"^":if("startSlur"===c)r.accidental="sharp",c="sharp2";else{if("sharp2"!==c)return o(c)?(r.endChar=i,r):null;r.accidental="dblsharp",c="pitch"}break;case"_":if("startSlur"===c)r.accidental="flat",c="flat2";else{if("flat2"!==c)return o(c)?(r.endChar=i,r):null;r.accidental="dblflat",c="pitch"}break;case"=":if("startSlur"!==c)return o(c)?(r.endChar=i,r):null;r.accidental="natural",c="pitch";break;case"A":case"B":case"C":case"D":case"E":case"F":case"G":case"a":case"b":case"c":case"d":case"e":case"f":case"g":if("startSlur"!==c&&"sharp2"!==c&&"flat2"!==c&&"pitch"!==c)return o(c)?(r.endChar=i,r):null;if(r.pitch=w[n.charAt(i)],Oa.note(s,r),c="octave",a&&0!==s.next_note_duration?(r.duration=s.default_length*s.next_note_duration,s.next_note_duration=0,l=!0):r.duration=s.default_length,s.clef&&"perc"===s.clef.type||s.currentVoice&&"perc"===s.currentVoice.clef){var h=n.charAt(i);if(r.accidental){h={dblflat:"__",flat:"_",natural:"=",sharp:"^",dblsharp:"^^"}[r.accidental]+h}t.formatting&&t.formatting.midi&&t.formatting.midi.drummap&&(r.midipitch=t.formatting.midi.drummap[h])}break;case",":if("octave"!==c)return o(c)?(r.endChar=i,r):null;r.pitch-=7;break;case"'":if("octave"!==c)return o(c)?(r.endChar=i,r):null;r.pitch+=7;break;case"x":case"y":case"z":case"Z":if("startSlur"!==c)return o(c)?(r.endChar=i,r):null;r.rest={type:x[n.charAt(i)]},delete r.accidental,delete r.startSlur,delete r.startTie,delete r.endSlur,delete r.endTie,delete r.end_beam,delete r.grace_notes,"multimeasure"===r.rest.type?(r.duration=1,c="Zduration"):(a&&0!==s.next_note_duration?(r.duration=s.default_length*s.next_note_duration,s.next_note_duration=0,l=!0):r.duration=s.default_length,c="duration");break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"0":case"/":if("octave"===c||"duration"===c){var u=e.getFraction(n,i);for(r.duration=r.duration*u.value,r.endChar=u.index;u.index<n.length&&(e.isWhiteSpace(n.charAt(u.index))||"-"===n.charAt(u.index));)"-"===n.charAt(u.index)?r.startTie={}:r=y(r),u.index++;i=u.index-1,c="broken_rhythm"}else if("sharp2"===c)r.accidental="quartersharp",c="pitch";else{if("flat2"!==c){if("Zduration"===c){var d=e.getNumber(n,i);return r.duration=d.num,r.endChar=d.index,r}return null}r.accidental="quarterflat",c="pitch"}break;case"-":if("startSlur"===c)t.addTieToLastNote(),r.endTie=!0;else{if("octave"!==c&&"duration"!==c&&"end_slur"!==c)return"broken_rhythm"===c?(r.endChar=i,r):null;if(r.startTie={},l||!a)return e.isWhiteSpace(n.charAt(i+1))&&y(r),r.endChar=i+1,r;c="broken_rhythm"}break;case" ":case"\t":if(!o(c))return null;r.end_beam=!0;do{"-"===n.charAt(i)&&(r.startTie={}),i++}while(i<n.length&&(e.isWhiteSpace(n.charAt(i))||"-"===n.charAt(i)));if(r.endChar=i,l||!a||"<"!==n.charAt(i)&&">"!==n.charAt(i))return r;i--,c="broken_rhythm";break;case">":case"<":if(!o(c))return null;if(!a)return r.endChar=i,r;var p=_(n,i);i+=p[0]-1,s.next_note_duration=p[2],r.duration=p[1]*r.duration,c="end_slur";break;default:return o(c)?(r.endChar=i,r):null}if(++i===n.length)return o(c)?(r.endChar=i,r):null}return null};function T(){var e={startChar:-1,endChar:-1};s.partForNextLine.title&&(e.part=s.partForNextLine),e.clef=s.currentVoice&&void 0!==s.staves[s.currentVoice.staffNum].clef?da.clone(s.staves[s.currentVoice.staffNum].clef):da.clone(s.clef);var n=s.currentVoice?s.currentVoice.scoreTranspose:0;if(e.key=Da.standardKey(s.key.root+s.key.acc+s.key.mode,s.key.root,s.key.acc,n),e.key.mode=s.key.mode,s.key.impliedNaturals&&(e.key.impliedNaturals=s.key.impliedNaturals),s.key.explicitAccidentals)for(var i=0;i<s.key.explicitAccidentals.length;i++){for(var r=!1,a=0;a<e.key.accidentals.length;a++)e.key.accidentals[a].note===s.key.explicitAccidentals[i].note&&(e.key.accidentals[a].acc=s.key.explicitAccidentals[i].acc,r=!0);r||e.key.accidentals.push(s.key.explicitAccidentals[i])}if(s.targetKey=e.key,e.key.explicitAccidentals&&delete e.key.explicitAccidentals,Da.addPosToKey(e.clef,e.key),null!==s.meter?(s.currentVoice?(da.each(s.staves,(function(t){t.meter=s.meter})),e.meter=s.staves[s.currentVoice.staffNum].meter,s.staves[s.currentVoice.staffNum].meter=null):e.meter=s.meter,s.meter=null):s.currentVoice&&s.staves[s.currentVoice.staffNum].meter&&(e.meter=s.staves[s.currentVoice.staffNum].meter,s.staves[s.currentVoice.staffNum].meter=null),s.currentVoice&&s.currentVoice.name&&(e.name=s.currentVoice.name),s.vocalfont&&(e.vocalfont=s.vocalfont),s.tripletfont&&(e.tripletfont=s.tripletfont),s.style&&(e.style=s.style),s.currentVoice){var o=s.staves[s.currentVoice.staffNum];o.brace&&(e.brace=o.brace),o.bracket&&(e.bracket=o.bracket),o.connectBarLines&&(e.connectBarLines=o.connectBarLines),o.name&&(e.name=o.name[s.currentVoice.index]),o.subname&&(e.subname=o.subname[s.currentVoice.index]),s.currentVoice.stem&&(e.stem=s.currentVoice.stem),s.currentVoice.stafflines&&(e.stafflines=s.currentVoice.stafflines),s.currentVoice.staffscale&&(e.staffscale=s.currentVoice.staffscale),s.currentVoice.scale&&(e.scale=s.currentVoice.scale),s.currentVoice.style&&(e.style=s.currentVoice.style),s.currentVoice.transpose&&(e.clef.transpose=s.currentVoice.transpose)}var c=void 0===s.currentVoice||0===s.currentVoice.staffNum&&0===s.currentVoice.index;0===s.barNumbers&&c&&1!==s.currBarNumber&&(e.barNumber=s.currBarNumber),t.startNewLine(e),s.key.impliedNaturals&&delete s.key.impliedNaturals,s.partForNextLine={}}var S=function(t,n){if("{"===t.charAt(n)){var i=e.getBrackettedSubstring(t,n,1,"}");i[2]||a("Missing the closing '}' while parsing grace note",t,n),")"===t[n+i[0]]&&(i[0]++,i[1]+=")");for(var r=[],o=0,c=!1;o<i[1].length;){var l=!1;"/"===i[1].charAt(o)&&(l=!0,o++);var h=k(i[1],o,{},!1);null!==h?(h.duration=h.duration/(8*s.default_length),l&&(h.acciaccatura=!0),r.push(h),c&&(h.endTie=!0,c=!1),h.startTie&&(c=!0),o=h.endChar,delete h.endChar):(" "===i[1].charAt(o)?r.length>0&&(r[r.length-1].end_beam=!0):a("Unknown character '"+i[1].charAt(o)+"' while parsing grace note",t,n),o++)}if(r.length)return[i[0],r]}return[0]};function C(t,e){if("&"===t.charAt(e)){for(var n=e;t.charAt(e)&&":"!==t.charAt(e)&&"|"!==t.charAt(e);)e++;return[e-n,t.substring(n+1,e)]}return[0]}function A(t){var e=t.origMeter;return e&&"specified"===e.type&&e.value&&0!==e.value.length?parseInt(e.value[0].num,10)/parseInt(e.value[0].den,10):1}var E=function(t,e,n){if(void 0===t.inTie[e])return!1;var i=t.currentVoice?t.currentVoice.index:0;return!(!t.inTie[e][i]||void 0===n.pitches&&"spacer"===n.rest.type)},M=function(t,e,n){var i=t.currentVoice?t.currentVoice.index:0;void 0===t.inTie[e]&&(t.inTie[e]=[]),t.inTie[e][i]=n},N=function(n){var i=o.parseHeader(n);i.regular&&function(n){o.resolveTempo(),s.is_in_header=!1;for(var i=0,r=s.iChar;e.isWhiteSpace(n.charAt(i))&&i<n.length;)i++;if(i!==n.length&&"%"!==n.charAt(i)){var l=s.start_new_line;void 0===s.continueall?s.start_new_line=!0:s.start_new_line=!1;var h=0,u=o.letter_to_body_header(n,i);u[0]>0&&(i+=u[0],"V"===u[1]&&(l=!0));for(var d={},p=0;i<n.length;){var v=i;if("%"===n.charAt(i))break;var w=o.letter_to_inline_header(n,i);if(w[0]>0)i+=w[0],"V"===w[1]&&(l=!0);else{var x;for(l&&(T(),l=!1);;)if((x=e.eatWhiteSpace(n,i))>0&&(i+=x),i>0&&""===n.charAt(i-1)&&(x=o.letter_to_body_header(n,i))[0]>0&&("V"===x[1]&&T(),i=x[0],s.start_new_line=!1),(x=m(n,i))[0]>0&&(i+=x[0]),(x=c(n,i))[0]>0){d.chord||(d.chord=[]);var N=e.translateString(x[1]);N=N.replace(/;/g,"\n");for(var I=!1,O=0;O<d.chord.length;O++)d.chord[O].position===x[2]&&(I=!0,d.chord[O].name+="\n"+N);!1===I&&(null===x[2]&&x[3]?d.chord.push({name:N,rel_position:x[3]}):d.chord.push({name:N,position:x[2]})),i+=x[0];var P=e.skipWhiteSpace(n.substring(i));P>0&&(d.force_end_beam_last=!0),i+=P}else if((x=-1==="ABCDEFGabcdefgxyzZ[]|^_{".indexOf(n.charAt(i))?f(n,i):[0])[0]>0)null===x[1]?i+1<n.length&&T():x[1].length>0&&(0===x[1].indexOf("style=")?d.style=x[1].substr(6):(void 0===d.decoration&&(d.decoration=[]),d.decoration.push(x[1]))),i+=x[0];else{if(!((x=S(n,i))[0]>0))break;d.gracenotes=x[1],i+=x[0]}if((x=g(n,i))[0]>0){p=0,void 0!==d.gracenotes&&(d.rest={type:"spacer"},d.duration=.125,s.addFormattingOptions(d,t.formatting,"note"),t.appendElement("note",r+i,r+i+x[0],d),s.measureNotEmpty=!0,d={});var D={type:x[1]};0===D.type.length?a("Unknown bar type",n,i):(s.inEnding&&"bar_thin"!==D.type&&(D.endEnding=!0,s.inEnding=!1),x[2]&&(D.startEnding=x[2],s.inEnding&&(D.endEnding=!0),s.inEnding=!0),void 0!==d.decoration&&(D.decoration=d.decoration),void 0!==d.chord&&(D.chord=d.chord),D.startEnding&&void 0===s.barFirstEndingNum?s.barFirstEndingNum=s.currBarNumber:D.startEnding&&D.endEnding&&s.barFirstEndingNum?s.currBarNumber=s.barFirstEndingNum:D.endEnding&&(s.barFirstEndingNum=void 0),"bar_invisible"!==D.type&&s.measureNotEmpty&&(void 0===s.currentVoice||0===s.currentVoice.staffNum&&0===s.currentVoice.index)&&(s.currBarNumber++,s.barNumbers&&s.currBarNumber%s.barNumbers==0&&(D.barNumber=s.currBarNumber)),s.addFormattingOptions(d,t.formatting,"bar"),t.appendElement("bar",r+i,r+i+x[0],D),s.measureNotEmpty=!1,d={}),i+=x[0],s.currentVoice&&(s.currentVoice.staffNum,s.currentVoice.index)}else if("&"===n[i])(x=C(n,i))[0]>0&&(t.appendElement("overlay",r,r+1,{}),i+=1,p++);else{if((x=b(n,i)).consumed>0&&(void 0!==x.startSlur&&(d.startSlur=x.startSlur),void 0!==x.triplet&&(h>0?a("Can't nest triplets",n,i):(d.startTriplet=x.triplet,d.tripletMultiplier=x.tripletQ/x.triplet,h=void 0===x.num_notes?x.triplet:x.num_notes)),i+=x.consumed),"["===n.charAt(i)){var B=i;i++;for(var R=null,L=!1,V=!1;!V;){var H=f(n,i);H[0]>0&&(i+=H[0]);var F=k(n,i,{},!1);if(null!==F)H[0]>0&&0!==H[1].indexOf("style=")&&(void 0===d.decoration&&(d.decoration=[]),d.decoration.push(H[1])),F.end_beam&&(d.end_beam=!0,delete F.end_beam),void 0===d.pitches?(d.duration=F.duration,d.pitches=[F]):d.pitches.push(F),delete F.duration,H[0]>0&&0===H[1].indexOf("style=")&&(d.pitches[d.pitches.length-1].style=H[1].substr(6)),s.inTieChord[d.pitches.length]&&(F.endTie=!0,s.inTieChord[d.pitches.length]=void 0),F.startTie&&(s.inTieChord[d.pitches.length]=!0),i=F.endChar,delete F.endChar;else if(" "===n.charAt(i))a("Spaces are not allowed in chords",n,i),i++;else{if(i<n.length&&"]"===n.charAt(i)){i++,0!==s.next_note_duration&&(d.duration=d.duration*s.next_note_duration,s.next_note_duration=0),E(s,p,d)&&(da.each(d.pitches,(function(t){t.endTie=!0})),M(s,p,!1)),h>0&&0==--h&&(d.endTriplet=!0);for(var q=!1;i<n.length&&!q;){switch(n.charAt(i)){case" ":case"\t":y(d);break;case")":void 0===d.endSlur?d.endSlur=1:d.endSlur++;break;case"-":da.each(d.pitches,(function(t){t.startTie={}})),M(s,p,!0);break;case">":case"<":var z=_(n,i);i+=z[0]-1,s.next_note_duration=z[2],R?R*=z[1]:R=z[1];break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"/":var G=e.getFraction(n,i);R=G.value,i=G.index," "===n.charAt(i)&&(L=!0),"-"===n.charAt(i)||")"===n.charAt(i)||" "===n.charAt(i)||"<"===n.charAt(i)||">"===n.charAt(i)?i--:q=!0;break;default:q=!0}q||i++}}else a("Expected ']' to end the chords",n,i);void 0!==d.pitches&&(null!==R&&(d.duration=d.duration*R,L&&y(d)),s.addFormattingOptions(d,t.formatting,"note"),t.appendElement("note",r+B,r+i,d),s.measureNotEmpty=!0,d={}),V=!0}}}else{var j={},W=k(n,i,j,!0);void 0!==j.endTie&&M(s,p,!0),null!==W&&(void 0!==W.pitch?(d.pitches=[{}],void 0!==W.accidental&&(d.pitches[0].accidental=W.accidental),d.pitches[0].pitch=W.pitch,W.midipitch&&(d.pitches[0].midipitch=W.midipitch),void 0!==W.endSlur&&(d.pitches[0].endSlur=W.endSlur),void 0!==W.endTie&&(d.pitches[0].endTie=W.endTie),void 0!==W.startSlur&&(d.pitches[0].startSlur=W.startSlur),void 0!==d.startSlur&&(d.pitches[0].startSlur=d.startSlur),void 0!==W.startTie&&(d.pitches[0].startTie=W.startTie),void 0!==d.startTie&&(d.pitches[0].startTie=d.startTie)):(d.rest=W.rest,void 0!==W.endSlur&&(d.endSlur=W.endSlur),void 0!==W.endTie&&(d.rest.endTie=W.endTie),void 0!==W.startSlur&&(d.startSlur=W.startSlur),void 0!==W.startTie&&(d.rest.startTie=W.startTie),void 0!==d.startTie&&(d.rest.startTie=d.startTie)),void 0!==W.chord&&(d.chord=W.chord),void 0!==W.duration&&(d.duration=W.duration),void 0!==W.decoration&&(d.decoration=W.decoration),void 0!==W.graceNotes&&(d.graceNotes=W.graceNotes),delete d.startSlur,E(s,p,d)&&(void 0!==d.pitches?d.pitches[0].endTie=!0:"spacer"!==d.rest.type&&(d.rest.endTie=!0),M(s,p,!1)),(W.startTie||d.startTie)&&M(s,p,!0),i=W.endChar,h>0&&0==--h&&(d.endTriplet=!0),W.end_beam&&y(d),d.rest&&"rest"===d.rest.type&&1===d.duration&&A(s)<=1&&(d.rest.type="whole",d.duration=A(s)),s.addFormattingOptions(d,t.formatting,"note"),t.appendElement("note",r+v,r+i,d),s.measureNotEmpty=!0,d={})}i===v&&(" "!==n.charAt(i)&&"`"!==n.charAt(i)&&a("Unknown character ignored",n,i),i++)}}}}}(i.str),i.newline&&T(),i.words&&function(t,n){if(t){"-"!==(n=da.strip(n)).charAt(n.length-1)&&(n+=" ");for(var i=[],s=0,r=!1,o=function(t){var a=da.strip(n.substring(s,t));if(s=t+1,a.length>0){r&&(a=da.gsub(a,"~"," "));var o=n.charAt(t);return"_"!==o&&"-"!==o&&(o=" "),i.push({syllable:e.translateString(a),divider:o}),r=!1,!0}return!1},c=0;c<n.length;c++)switch(n.charAt(c)){case" ":case"":o(c);break;case"-":!o(c)&&i.length>0&&(da.last(i).divider="-",i.push({skip:!0,to:"next"}));break;case"_":o(c),i.push({skip:!0,to:"slur"});break;case"*":o(c),i.push({skip:!0,to:"next"});break;case"|":o(c),i.push({skip:!0,to:"bar"});break;case"~":r=!0}da.each(t,(function(t){if(0!==i.length)if(i[0].skip){switch(i[0].to){case"next":case"slur":"note"===t.el_type&&null!==t.pitches&&i.shift();break;case"bar":"bar"===t.el_type&&i.shift()}"bar"!==t.el_type&&(void 0===t.lyric?t.lyric=[{syllable:"",divider:" "}]:t.lyric.push({syllable:"",divider:" "}))}else if("note"===t.el_type&&void 0===t.rest){var e=i.shift();e.syllable&&(e.syllable=e.syllable.replace(/ +/g," ")),void 0===t.lyric?t.lyric=[e]:t.lyric.push(e)}}))}else a("Can't add words before the first line of music",t,0)}(t.getCurrentVoice(),n.substring(2)),i.symbols&&function(t,n){if(t){"-"!==(n=da.strip(n)).charAt(n.length-1)&&(n+=" ");for(var i=[],s=0,r=!1,o=function(t){var a=da.strip(n.substring(s,t));if(s=t+1,a.length>0){r&&(a=da.gsub(a,"~"," "));var o=n.charAt(t);return"_"!==o&&"-"!==o&&(o=" "),i.push({syllable:e.translateString(a),divider:o}),r=!1,!0}return!1},c=0;c<n.length;c++)switch(n.charAt(c)){case" ":case"":o(c);break;case"-":!o(c)&&i.length>0&&(da.last(i).divider="-",i.push({skip:!0,to:"next"}));break;case"_":o(c),i.push({skip:!0,to:"slur"});break;case"*":o(c),i.push({skip:!0,to:"next"});break;case"|":o(c),i.push({skip:!0,to:"bar"});break;case"~":r=!0}da.each(t,(function(t){if(0!==i.length)if(i[0].skip)switch(i[0].to){case"next":case"slur":"note"===t.el_type&&null!==t.pitches&&i.shift();break;case"bar":"bar"===t.el_type&&i.shift()}else if("note"===t.el_type&&void 0===t.rest){var e=i.shift();void 0===t.lyric?t.lyric=[e]:t.lyric.push(e)}}))}else a("Can't add symbols before the first line of music",t,0)}(t.getCurrentVoice(),n.substring(2)),i.recurse&&N(i.str)};function I(t,e){t.push({el_type:"hint"});for(var n=0;n<e.length;n++){var i=e[n],s=da.clone(i);if(t.push(s),"bar"===i.el_type)return}}function O(t,e){for(var n=0;n<t.length;n++){var i=t[n],s=e[n];if(s)for(var r=0;r<s.voices.length;r++){var a=s.voices[r],o=i.voices[r];o&&I(o,a)}}}this.parse=function(n,i,r){if(i||(i={}),r||(r=0),t.reset(),i.print&&(t.media="print"),s.reset(),s.iChar=r,i.visualTranspose?(s.globalTranspose=parseInt(i.visualTranspose),0===s.globalTranspose&&(s.globalTranspose=void 0)):s.globalTranspose=void 0,i.lineBreaks){s.lineBreaks={};for(var c=0;c<i.lineBreaks.length;c++)s.lineBreaks[""+(i.lineBreaks[c]+1)]=!0}o.reset(e,a,s,t),n=da.gsub(n,"\r\n","\n"),n=da.gsub(n,"\r","\n");var l=(n=(n=(n+="\n").replace(/\n\\.*\n/g,"\n")).replace(/\\([ \t]*)(%.*)*\n/g,(function(t,e,n){return e+" "+(n?"                                                                                                                                                                                                     ".substring(0,n.length):"")}))).split("\n");0===da.last(l).length&&l.pop();try{i.format&&ya.globalFormatting(i.format),da.each(l,(function(n){if(i.header_only&&!1===s.is_in_header)throw"normal_abort";if(i.stop_on_warning&&s.warnings)throw"normal_abort";s.is_in_history?":"===n.charAt(1)?(s.is_in_history=!1,N(n)):t.addMetaText("history",e.translateString(e.stripComment(n))):s.inTextBlock?da.startsWith(n,"%%endtext")?(t.addText(s.textBlock),s.inTextBlock=!1):da.startsWith(n,"%%")?s.textBlock+=" "+n.substring(2):s.textBlock+=" "+n:s.inPsBlock?da.startsWith(n,"%%endps")?s.inPsBlock=!1:s.textBlock+=" "+n:N(n),s.iChar+=n.length+1}));var h=792,u=612;switch(s.papersize){case"legal":h=1008,u=612;break;case"A4":h=842.4,u=597.6}if(s.landscape){var d=h;h=u,u=d}s.openSlurs=t.cleanUp(u,h,s.barsperstaff,s.staffnonote,s.openSlurs)}catch(t){if("normal_abort"!==t)throw t}i.hint_measures&&function(){for(var e=0;e<t.lines.length;e++){var n=t.lines[e].staff;if(n){for(var i=e+1;i<t.lines.length&&void 0===t.lines[i].staff;)i++;i<t.lines.length&&O(n,t.lines[i].staff)}}}(),Fa.wrapLines(t,s.lineBreaks)}},Ga={};!function(){Ga.numberOfTunes=function(t){var e=t.split("\nX:").length;return 0===e&&(e=1),e};var t=Ga.TuneBook=function(t){for(var e=this,n="",i=(t=da.strip(t)).split("\nX:"),s=1;s<i.length;s++)i[s]="X:"+i[s];var r=0;if(e.tunes=[],da.each(i,(function(t){e.tunes.push({abc:t,startPos:r}),r+=t.length+1})),e.tunes.length>1&&!da.startsWith(e.tunes[0].abc,"X:")){var a=e.tunes.shift().abc.split("\n");da.each(a,(function(t){da.startsWith(t,"%%")&&(n+=t+"\n")}))}e.header=n,da.each(e.tunes,(function(t){var e=t.abc.indexOf("\n\n");e>0&&(t.abc=t.abc.substring(0,e)),t.pure=t.abc,t.abc=n+t.abc;var i=t.pure.split("T:");i.length>1?(i=i[1].split("\n"),t.title=i[0].replace(/^\s+|\s+$/g,"")):t.title="";var s=t.pure.substring(2,t.pure.indexOf("\n"));t.id=s.replace(/^\s+|\s+$/g,"")}))};t.prototype.getTuneById=function(t){for(var e=0;e<this.tunes.length;e++)if(this.tunes[e].id===""+t)return this.tunes[e];return null},t.prototype.getTuneByTitle=function(t){for(var e=0;e<this.tunes.length;e++)if(this.tunes[e].title===t)return this.tunes[e];return null},Ga.parseOnly=function(t,e){for(var n=Ga.numberOfTunes(t),i=[],s=0;s<n;s++)i.push(1);return Ga.renderEngine((function(){}),i,t,e)},Ga.renderEngine=function(e,n,i,s){var r=[];if(void 0!==n&&void 0!==i){var a;(!(a=n)||a.propertyIsEnumerable("length")||"object"!=typeof a||"number"!=typeof a.length)&&(n=[n]),void 0===s&&(s={});for(var o=s.startingTune?parseInt(s.startingTune,10):0,c=new t(i),l=new za,h=0;h<n.length;h++){var u=n[h];if("*"===u||"string"==typeof u&&(u=document.getElementById(u)),u)if(o>=0&&o<c.tunes.length){l.parse(c.tunes[o].abc,s,c.tunes[o].startPos-c.header.length);var d=l.getTune(),p=e(u,d,h,c.tunes[o].abc);r.push(p||d)}else u.hasOwnProperty("innerHTML")&&(u.innerHTML="");o++}return r}},Ga.extractMeasures=function(e){for(var n=[],i=new t(e),s=0;s<i.tunes.length;s++){for(var r=i.tunes[s],a=r.abc.split("K:"),o=a[1].split("\n"),c=a[0]+"K:"+o[0]+"\n",l=null,h=null,u=null,d=[],p=!1,f=Ga.parseOnly(r.abc)[0],m=f.getPickupLength()>0,g=0;g<f.lines.length;g++){var v=f.lines[g];if(v.staff)for(var b=0;b<1;b++)for(var _=v.staff[b],y=0;y<1;y++)for(var w=_.voices[y],x=0;x<w.length;x++){var k=w[x];if(null===u&&k.startChar>=0&&(u=k.startChar,h=void 0===k.chord?l:null),k.chord&&(l=k),"bar"===k.el_type){if(p){var T={abc:r.abc.substring(u,k.endChar)};(l=h&&h.chord&&h.chord.length>0?h.chord[0].name:null)&&(T.lastChord=l),k.startEnding&&(T.startEnding=k.startEnding),k.endEnding&&(T.endEnding=k.endEnding),d.push(T),u=null,p=!1}}else"note"===k.el_type&&(p=!0)}}n.push({header:c,measures:d,hasPickup:m})}return n}}();var ja=Ga,Wa=function(t,e,n,i,s,r){r||(r={}),this.tuneNumber=s,this.abcelem=t,this.duration=e,this.durationClass=r.durationClassOveride?r.durationClassOveride:this.duration,this.minspacing=n||0,this.x=0,this.children=[],this.heads=[],this.extra=[],this.extraw=0,this.w=0,this.right=[],this.invisible=!1,this.bottom=void 0,this.top=void 0,this.type=i,this.specialY={tempoHeightAbove:0,partHeightAbove:0,volumeHeightAbove:0,dynamicHeightAbove:0,endingHeightAbove:0,chordHeightAbove:0,lyricHeightAbove:0,lyricHeightBelow:0,chordHeightBelow:0,volumeHeightBelow:0,dynamicHeightBelow:0}};Wa.prototype.setUpperAndLowerElements=function(t){for(var e=0;e<this.children.length;e++){var n=this.children[e];for(var i in this.specialY)this.specialY.hasOwnProperty(i)&&n[i]&&(n.pitch=t[i],void 0===n.top&&(n.setUpperAndLowerElements(t),this.pushTop(n.top),this.pushBottom(n.bottom)))}},Wa.prototype.getMinWidth=function(){return this.w},Wa.prototype.getExtraWidth=function(){return-this.extraw},Wa.prototype.addExtra=function(t){t.dx<this.extraw&&(this.extraw=t.dx),this.extra[this.extra.length]=t,this.addChild(t)},Wa.prototype.addHead=function(t){t.dx<this.extraw&&(this.extraw=t.dx),this.heads[this.heads.length]=t,this.addRight(t)},Wa.prototype.addRight=function(t){t.dx+t.w>this.w&&(this.w=t.dx+t.w),this.right[this.right.length]=t,this.addChild(t)},Wa.prototype.addCentered=function(t){var e=t.w/2;-e<this.extraw&&(this.extraw=-e),this.extra[this.extra.length]=t,t.dx+e>this.w&&(this.w=t.dx+e),this.right[this.right.length]=t,this.addChild(t)},Wa.prototype.setLimit=function(t,e){e[t]&&(this.specialY[t]?this.specialY[t]=Math.max(this.specialY[t],e[t]):this.specialY[t]=e[t])},Wa.prototype.addChild=function(t){t.parent=this,this.children[this.children.length]=t,this.pushTop(t.top),this.pushBottom(t.bottom),this.setLimit("tempoHeightAbove",t),this.setLimit("partHeightAbove",t),this.setLimit("volumeHeightAbove",t),this.setLimit("dynamicHeightAbove",t),this.setLimit("endingHeightAbove",t),this.setLimit("chordHeightAbove",t),this.setLimit("lyricHeightAbove",t),this.setLimit("lyricHeightBelow",t),this.setLimit("chordHeightBelow",t),this.setLimit("volumeHeightBelow",t),this.setLimit("dynamicHeightBelow",t)},Wa.prototype.pushTop=function(t){void 0!==t&&(void 0===this.top?this.top=t:this.top=Math.max(t,this.top))},Wa.prototype.pushBottom=function(t){void 0!==t&&(void 0===this.bottom?this.bottom=t:this.bottom=Math.min(t,this.bottom))},Wa.prototype.setX=function(t){this.x=t;for(var e=0;e<this.children.length;e++)this.children[e].setX(t)},Wa.prototype.setHint=function(){this.hint=!0},Wa.prototype.draw=function(t,e){if(!this.invisible){this.elemset=[],t.beginGroup();for(var n=0;n<this.children.length;n++){var i=this.children[n].draw(t,e);i&&this.elemset.push(i)}var s=this.type;if(("note"===this.type||"rest"===this.type)&&(s=(s+=" d"+this.durationClass).replace(/\./g,"-"),this.abcelem.pitches))for(var r=0;r<this.abcelem.pitches.length;r++)s+=" p"+this.abcelem.pitches[r].pitch;var a=t.endGroup(s);a&&this.elemset.push(a),this.klass&&this.setClass("mark","","#00ff00"),this.hint&&this.setClass("abcjs-hint","",null);var o=t.printShadedBox(this.x,t.calcY(this.top),this.w,t.calcY(this.bottom)-t.calcY(this.top),"#000000",0),c=this,l=t.controller;o.addEventListener("mouseup",(function(){var t=[];if(c.elemset)for(var e=0;e<c.elemset.length;e++){var n=c.elemset[e];n&&t.push(n.getAttribute("class"))}l.notifySelect(c,c.tuneNumber,t)})),this.abcelem.abselem=this}},Wa.prototype.isIE=/*@cc_on!@*/!1,Wa.prototype.setClass=function(t,e,n){for(var i=0;i<this.elemset.length;i++){var s=this.elemset[i];s.setAttribute("fill",n);var r=s.getAttribute("class");r||(r=""),r=(r=r.replace(e,"")).replace(t,""),t.length>0&&(r.length>0&&" "!==r.charAt(r.length-1)&&(r+=" "),r+=t),s.setAttribute("class",r)}},Wa.prototype.highlight=function(t,e){void 0===t&&(t="abcjs-note_selected"),void 0===e&&(e="#ff0000"),this.setClass(t,"",e)},Wa.prototype.unhighlight=function(t,e){void 0===t&&(t="abcjs-note_selected"),void 0===e&&(e="#000000"),this.setClass("",t,e)};var Ya=Wa,Ua=function(t,e,n,i,s){switch(s=s||{},this.x=0,this.c=t,this.dx=e,this.w=n,this.pitch=i,this.scalex=s.scalex||1,this.scaley=s.scaley||1,this.type=s.type||"symbol",this.pitch2=s.pitch2,this.linewidth=s.linewidth,this.klass=s.klass,this.top=i,void 0!==this.pitch2&&this.pitch2>this.top&&(this.top=this.pitch2),this.bottom=i,void 0!==this.pitch2&&this.pitch2<this.bottom&&(this.bottom=this.pitch2),s.thickness&&(this.top+=s.thickness/2,this.bottom-=s.thickness/2),s.stemHeight&&(s.stemHeight>0?this.top+=s.stemHeight:this.bottom+=s.stemHeight),this.height=s.height?s.height:4,this.centerVertically=!1,this.type){case"debug":this.chordHeightAbove=this.height;break;case"lyric":s.position&&"below"===s.position?this.lyricHeightBelow=this.height:this.lyricHeightAbove=this.height;break;case"chord":s.position&&"below"===s.position?this.chordHeightBelow=this.height:this.chordHeightAbove=this.height;break;case"text":void 0===this.pitch?s.position&&"below"===s.position?this.chordHeightBelow=this.height:this.chordHeightAbove=this.height:this.centerVertically=!0;break;case"part":this.partHeightAbove=this.height}};Ua.prototype.setX=function(t){this.x=t+this.dx},Ua.prototype.setUpperAndLowerElements=function(t){switch(this.type){case"part":this.top=t.partHeightAbove+this.height,this.bottom=t.partHeightAbove;break;case"text":case"chord":this.chordHeightAbove?(this.top=t.chordHeightAbove,this.bottom=t.chordHeightAbove):(this.top=t.chordHeightBelow,this.bottom=t.chordHeightBelow);break;case"lyric":this.lyricHeightAbove?(this.top=t.lyricHeightAbove,this.bottom=t.lyricHeightAbove):(this.top=t.lyricHeightBelow,this.bottom=t.lyricHeightBelow);break;case"debug":this.top=t.chordHeightAbove,this.bottom=t.chordHeightAbove}void 0!==this.pitch&&void 0!==this.top||window.console.error("RelativeElement position not set.",this.type,this.pitch,this.top,t)},Ua.prototype.draw=function(t,e){void 0===this.pitch&&window.console.error(this.type+" Relative Element y-coordinate not set.");var n=t.calcY(this.pitch);switch(this.type){case"symbol":if(null===this.c)return null;var i="symbol";this.klass&&(i+=" "+this.klass),this.graphelem=t.printSymbol(this.x,this.pitch,this.c,this.scalex,this.scaley,t.addClasses(i));break;case"debug":this.graphelem=t.renderText(this.x,t.calcY(15),""+this.c,"debugfont","debug-msg","start");break;case"barNumber":this.graphelem=t.renderText(this.x,n,""+this.c,"measurefont","bar-number","middle");break;case"lyric":this.graphelem=t.renderText(this.x,n,this.c,"vocalfont","lyric","middle");break;case"chord":this.graphelem=t.renderText(this.x,n,this.c,"gchordfont","chord","middle");break;case"decoration":this.graphelem=t.renderText(this.x,n,this.c,"annotationfont","annotation","middle",!0);break;case"text":this.graphelem=t.renderText(this.x,n,this.c,"annotationfont","annotation","start",this.centerVertically);break;case"multimeasure-text":this.graphelem=t.renderText(this.x+this.w/2,n,this.c,"tempofont","rest","middle",!1);break;case"part":this.graphelem=t.renderText(this.x,n,this.c,"partsfont","part","start");break;case"bar":this.graphelem=t.printStem(this.x,this.linewidth,n,e||t.calcY(this.pitch2));break;case"stem":this.graphelem=t.printStem(this.x,this.linewidth,n,t.calcY(this.pitch2));break;case"ledger":this.graphelem=t.printStaveLine(this.x,this.x+this.w,this.pitch)}return 1!==this.scalex&&this.graphelem&&t.scaleExistingElem(this.graphelem,this.scalex,this.scaley,this.x,n),this.graphelem};var Xa,$a=Ua,Za=function(t){return void 0===t?0:Math.floor(Math.log(t)/Math.log(2))};!function(){(Xa=function(t,e,n){this.isflat=n,this.isgrace=e&&"grace"===e,this.forceup=this.isgrace||e&&"up"===e,this.forcedown=e&&"down"===e,this.elems=[],this.total=0,this.allrests=!0,this.stemHeight=t,this.beams=[]}).prototype.setHint=function(){this.hint=!0},Xa.prototype.add=function(t){var e=t.abcelem.averagepitch;void 0!==e&&(this.allrests=this.allrests&&t.abcelem.rest,t.beam=this,this.elems.push(t),this.total+=e,(void 0===this.min||t.abcelem.minpitch<this.min)&&(this.min=t.abcelem.minpitch),(void 0===this.max||t.abcelem.maxpitch>this.max)&&(this.max=t.abcelem.maxpitch))};function t(t,e,n,i){if(!t.children)return i;for(var s=0;s<t.children.length;s++){var r=t.children[s];e&&void 0!==r.top&&"flags.ugrace"===r.c?i=Math.max(i,r.top-n):e||void 0===r.bottom||"flags.ugrace"!==r.c||(i=Math.max(i,n-r.bottom+7))}return i}function e(t,e){return e?t/e:0}function n(t,e,n,i,s){return e+(i-e)/(n-t)*(s-t)}function i(t,e,n,i,s,r,a){var o="beam-elem";a&&(o+=" abcjs-hint");var c="M"+e+" "+(n=t.calcY(n))+" L"+i+" "+(s=t.calcY(s))+"L"+i+" "+(s+r)+" L"+e+" "+(n+r)+"z";t.printPath({path:c,stroke:"none",fill:"#000000",class:t.addClasses(o)})}Xa.prototype.calcDir=function(){return!!this.forceup||!this.forcedown&&e(this.total,this.elems.length)<6},Xa.prototype.layout=function(){if(0!==this.elems.length&&!this.allrests){this.stemsUp=this.calcDir();var i=function(t,e){var n=t?ha.STEP:-ha.STEP;e&&(n*=.4);return n}(this.stemsUp,this.isgrace),s=this.elems[0],r=this.elems[this.elems.length-1],a=0,o=this.stemsUp?s.abcelem.maxpitch:s.abcelem.minpitch;a=t(s,this.stemsUp,o,a),a=t(r,this.stemsUp,o,a),a=Math.max(this.stemHeight,a+3);var c=function(t,n,i,s,r,a,o,c,l,h){var u=e(t,n),d=i-2,p=i-2,f=Math.round(s?Math.max(u+d,l+p):Math.min(u-d,c-p)),m=function(t,e,n,i){if(i)return 0;var s=t-e,r=n/2;s>r&&(s=r);s<-r&&(s=-r);return s}(r,a,n,o),g=f+Math.floor(m/2),v=f+Math.floor(-m/2);h||(s&&f<6||!s&&f>6)&&(g=6,v=6);return[g,v]}(this.total,this.elems.length,a,this.stemsUp,s.abcelem.averagepitch,r.abcelem.averagepitch,this.isflat,this.min,this.max,this.isgrace),l=function(t,e,n){var i=e.heads[t?0:e.heads.length-1],s=n.heads[t?0:n.heads.length-1],r=i.x;t&&(r+=i.w-.6);var a=s.x;t&&(a+=s.w);return[r,a]}(this.stemsUp,s,r);this.beams.push({startX:l[0],endX:l[1],startY:c[0],endY:c[1],dy:i});for(var h=function(t,e,i,s,r){for(var a=[],o=[],c=0;c<t.length;c++){var l=t[c];if(!l.abcelem.rest){var h=l.heads[e?0:l.heads.length-1],u=h.x+(e?h.w:0),d=n(i.startX,i.startY,i.endX,i.endY,u),p=e?-1.5:1.5;s&&(p=2*p/3);var f=l.abcelem.duration;0===f&&(f=.25);for(var m=Za(f);m<-3;m++)o[-4-m]?o[-4-m].single=!1:o[-4-m]={x:u+(e?-.6:0),y:d+p*(-4-m+1),durlog:m,single:!0};for(var g=o.length-1;g>=0;g--)if(c===t.length-1||Za(t[c+1].abcelem.duration)>-g-4){var v=u,b=d+p*(g+1);o[g].single&&(v=0===c?u+5:u-5,b=n(i.startX,i.startY,i.endX,i.endY,v)+p*(g+1)),a.push({startX:o[g].x,endX:v,startY:o[g].y,endY:b,dy:r}),o=o.slice(0,g)}}}return a}(this.elems,this.stemsUp,this.beams[0],this.isgrace,i),u=0;u<h.length;u++)this.beams.push(h[u]);!function(t,e,i,s,r){for(var a=0;a<t.length;a++){var o=t[a];if(!o.abcelem.rest){var c=!o.addExtra,l=c?r:o,h=o.heads[e?0:o.heads.length-1],u=.2,d=h.pitch+(e?u:-u),p=e?h.w:0,f=h.x+p,m=n(i.startX,i.startY,i.endX,i.endY,f),g=e?-.6:.6;e||(m-=s/2/ha.STEP),c&&(p+=o.heads[0].dx),"noteheads.slash.quarter"===h.c&&(e?d+=1:d-=1);var v=new $a(null,p,0,d,{type:"stem",pitch2:m,linewidth:g});v.setX(l.x),l.addExtra(v)}}}(this.elems,this.stemsUp,this.beams[0],i,this.mainNote)}},Xa.prototype.isAbove=function(){return this.stemsUp},Xa.prototype.heightAtMidpoint=function(t,e){if(0===this.beams.length)return 0;var i=this.beams[0],s=t+(e-t)/2;return n(i.startX,i.startY,i.endX,i.endY,s)},Xa.prototype.yAtNote=function(t){var e=this.beams[0];return n(e.startX,e.startY,e.endX,e.endY,t.x)},Xa.prototype.xAtMidpoint=function(t,e){return t+(e-t)/2},Xa.prototype.draw=function(t){if(0!==this.beams.length){t.beginGroup();for(var e=0;e<this.beams.length;e++){var n=this.beams[e];i(t,n.startX,n.startY,n.endX,n.endY,n.dy,this.hint)}t.endGroup("beam-elem")}}}();var Ka=Xa,Qa=function(){this.length=1};Qa.prototype.increaseStavesIncluded=function(){this.length++},Qa.prototype.setLocation=function(t){this.x=t},Qa.prototype.getWidth=function(){return 10},Qa.prototype.layout=function(t,e,n){this.startY=e,this.endY=n},Qa.prototype.draw=function(t,e,n){this.layout(t,e,n),t.drawBrace(this.x,this.startY,this.endY)};var Ja=Qa,to={0:{d:[["M",4.83,-14.97],["c",.33,-.03,1.11,0,1.47,.06],["c",1.68,.36,2.97,1.59,3.78,3.6],["c",1.2,2.97,.81,6.96,-.9,9.27],["c",-.78,1.08,-1.71,1.71,-2.91,1.95],["c",-.45,.09,-1.32,.09,-1.77,0],["c",-.81,-.18,-1.47,-.51,-2.07,-1.02],["c",-2.34,-2.07,-3.15,-6.72,-1.74,-10.2],["c",.87,-2.16,2.28,-3.42,4.14,-3.66],["z"],["m",1.11,.87],["c",-.21,-.06,-.69,-.09,-.87,-.06],["c",-.54,.12,-.87,.42,-1.17,.99],["c",-.36,.66,-.51,1.56,-.6,3],["c",-.03,.75,-.03,4.59,0,5.31],["c",.09,1.5,.27,2.4,.6,3.06],["c",.24,.48,.57,.78,.96,.9],["c",.27,.09,.78,.09,1.05,0],["c",.39,-.12,.72,-.42,.96,-.9],["c",.33,-.66,.51,-1.56,.6,-3.06],["c",.03,-.72,.03,-4.56,0,-5.31],["c",-.09,-1.47,-.27,-2.37,-.6,-3.03],["c",-.24,-.48,-.54,-.78,-.93,-.9],["z"]],w:10.78,h:14.959},1:{d:[["M",3.3,-15.06],["c",.06,-.06,.21,-.03,.66,.15],["c",.81,.39,1.08,.39,1.83,.03],["c",.21,-.09,.39,-.15,.42,-.15],["c",.12,0,.21,.09,.27,.21],["c",.06,.12,.06,.33,.06,5.94],["c",0,3.93,0,5.85,.03,6.03],["c",.06,.36,.15,.69,.27,.96],["c",.36,.75,.93,1.17,1.68,1.26],["c",.3,.03,.39,.09,.39,.3],["c",0,.15,-.03,.18,-.09,.24],["c",-.06,.06,-.09,.06,-.48,.06],["c",-.42,0,-.69,-.03,-2.1,-.24],["c",-.9,-.15,-1.77,-.15,-2.67,0],["c",-1.41,.21,-1.68,.24,-2.1,.24],["c",-.39,0,-.42,0,-.48,-.06],["c",-.06,-.06,-.06,-.09,-.06,-.24],["c",0,-.21,.06,-.27,.36,-.3],["c",.75,-.09,1.32,-.51,1.68,-1.26],["c",.12,-.27,.21,-.6,.27,-.96],["c",.03,-.18,.03,-1.59,.03,-4.29],["c",0,-3.87,0,-4.05,-.06,-4.14],["c",-.09,-.15,-.18,-.24,-.39,-.24],["c",-.12,0,-.15,.03,-.21,.06],["c",-.03,.06,-.45,.99,-.96,2.13],["c",-.48,1.14,-.9,2.1,-.93,2.16],["c",-.06,.15,-.21,.24,-.33,.24],["c",-.24,0,-.42,-.18,-.42,-.39],["c",0,-.06,3.27,-7.62,3.33,-7.74],["z"]],w:8.94,h:15.058},2:{d:[["M",4.23,-14.97],["c",.57,-.06,1.68,0,2.34,.18],["c",.69,.18,1.5,.54,2.01,.9],["c",1.35,.96,1.95,2.25,1.77,3.81],["c",-.15,1.35,-.66,2.34,-1.68,3.15],["c",-.6,.48,-1.44,.93,-3.12,1.65],["c",-1.32,.57,-1.8,.81,-2.37,1.14],["c",-.57,.33,-.57,.33,-.24,.27],["c",.39,-.09,1.26,-.09,1.68,0],["c",.72,.15,1.41,.45,2.1,.9],["c",.99,.63,1.86,.87,2.55,.75],["c",.24,-.06,.42,-.15,.57,-.3],["c",.12,-.09,.3,-.42,.3,-.51],["c",0,-.09,.12,-.21,.24,-.24],["c",.18,-.03,.39,.12,.39,.3],["c",0,.12,-.15,.57,-.3,.87],["c",-.54,1.02,-1.56,1.74,-2.79,2.01],["c",-.42,.09,-1.23,.09,-1.62,.03],["c",-.81,-.18,-1.32,-.45,-2.01,-1.11],["c",-.45,-.45,-.63,-.57,-.96,-.69],["c",-.84,-.27,-1.89,.12,-2.25,.9],["c",-.12,.21,-.21,.54,-.21,.72],["c",0,.12,-.12,.21,-.27,.24],["c",-.15,0,-.27,-.03,-.33,-.15],["c",-.09,-.21,.09,-1.08,.33,-1.71],["c",.24,-.66,.66,-1.26,1.29,-1.89],["c",.45,-.45,.9,-.81,1.92,-1.56],["c",1.29,-.93,1.89,-1.44,2.34,-1.98],["c",.87,-1.05,1.26,-2.19,1.2,-3.63],["c",-.06,-1.29,-.39,-2.31,-.96,-2.91],["c",-.36,-.33,-.72,-.51,-1.17,-.54],["c",-.84,-.03,-1.53,.42,-1.59,1.05],["c",-.03,.33,.12,.6,.57,1.14],["c",.45,.54,.54,.87,.42,1.41],["c",-.15,.63,-.54,1.11,-1.08,1.38],["c",-.63,.33,-1.2,.33,-1.83,0],["c",-.24,-.12,-.33,-.18,-.54,-.39],["c",-.18,-.18,-.27,-.3,-.36,-.51],["c",-.24,-.45,-.27,-.84,-.21,-1.38],["c",.12,-.75,.45,-1.41,1.02,-1.98],["c",.72,-.72,1.74,-1.17,2.85,-1.32],["z"]],w:10.764,h:14.97},3:{d:[["M",3.78,-14.97],["c",.3,-.03,1.41,0,1.83,.06],["c",2.22,.3,3.51,1.32,3.72,2.91],["c",.03,.33,.03,1.26,-.03,1.65],["c",-.12,.84,-.48,1.47,-1.05,1.77],["c",-.27,.15,-.36,.24,-.45,.39],["c",-.09,.21,-.09,.36,0,.57],["c",.09,.15,.18,.24,.51,.39],["c",.75,.42,1.23,1.14,1.41,2.13],["c",.06,.42,.06,1.35,0,1.71],["c",-.18,.81,-.48,1.38,-1.02,1.95],["c",-.75,.72,-1.8,1.2,-3.18,1.38],["c",-.42,.06,-1.56,.06,-1.95,0],["c",-1.89,-.33,-3.18,-1.29,-3.51,-2.64],["c",-.03,-.12,-.03,-.33,-.03,-.6],["c",0,-.36,0,-.42,.06,-.63],["c",.12,-.3,.27,-.51,.51,-.75],["c",.24,-.24,.45,-.39,.75,-.51],["c",.21,-.06,.27,-.06,.6,-.06],["c",.33,0,.39,0,.6,.06],["c",.3,.12,.51,.27,.75,.51],["c",.36,.33,.57,.75,.6,1.2],["c",0,.21,0,.27,-.06,.42],["c",-.09,.18,-.12,.24,-.54,.54],["c",-.51,.36,-.63,.54,-.6,.87],["c",.06,.54,.54,.9,1.38,.99],["c",.36,.06,.72,.03,.96,-.06],["c",.81,-.27,1.29,-1.23,1.44,-2.79],["c",.03,-.45,.03,-1.95,-.03,-2.37],["c",-.09,-.75,-.33,-1.23,-.75,-1.44],["c",-.33,-.18,-.45,-.18,-1.98,-.18],["c",-1.35,0,-1.41,0,-1.5,-.06],["c",-.18,-.12,-.24,-.39,-.12,-.6],["c",.12,-.15,.15,-.15,1.68,-.15],["c",1.5,0,1.62,0,1.89,-.15],["c",.18,-.09,.42,-.36,.54,-.57],["c",.18,-.42,.27,-.9,.3,-1.95],["c",.03,-1.2,-.06,-1.8,-.36,-2.37],["c",-.24,-.48,-.63,-.81,-1.14,-.96],["c",-.3,-.06,-1.08,-.06,-1.38,.03],["c",-.6,.15,-.9,.42,-.96,.84],["c",-.03,.3,.06,.45,.63,.84],["c",.33,.24,.42,.39,.45,.63],["c",.03,.72,-.57,1.5,-1.32,1.65],["c",-1.05,.27,-2.1,-.57,-2.1,-1.65],["c",0,-.45,.15,-.96,.39,-1.38],["c",.12,-.21,.54,-.63,.81,-.81],["c",.57,-.42,1.38,-.69,2.25,-.81],["z"]],w:9.735,h:14.967},4:{d:[["M",8.64,-14.94],["c",.27,-.09,.42,-.12,.54,-.03],["c",.09,.06,.15,.21,.15,.3],["c",-.03,.06,-1.92,2.31,-4.23,5.04],["c",-2.31,2.73,-4.23,4.98,-4.26,5.01],["c",-.03,.06,.12,.06,2.55,.06],["l",2.61,0],["l",0,-2.37],["c",0,-2.19,.03,-2.37,.06,-2.46],["c",.03,-.06,.21,-.18,.57,-.42],["c",1.08,-.72,1.38,-1.08,1.86,-2.16],["c",.12,-.3,.24,-.54,.27,-.57],["c",.12,-.12,.39,-.06,.45,.12],["c",.06,.09,.06,.57,.06,3.96],["l",0,3.9],["l",1.08,0],["c",1.05,0,1.11,0,1.2,.06],["c",.24,.15,.24,.54,0,.69],["c",-.09,.06,-.15,.06,-1.2,.06],["l",-1.08,0],["l",0,.33],["c",0,.57,.09,1.11,.3,1.53],["c",.36,.75,.93,1.17,1.68,1.26],["c",.3,.03,.39,.09,.39,.3],["c",0,.15,-.03,.18,-.09,.24],["c",-.06,.06,-.09,.06,-.48,.06],["c",-.42,0,-.69,-.03,-2.1,-.24],["c",-.9,-.15,-1.77,-.15,-2.67,0],["c",-1.41,.21,-1.68,.24,-2.1,.24],["c",-.39,0,-.42,0,-.48,-.06],["c",-.06,-.06,-.06,-.09,-.06,-.24],["c",0,-.21,.06,-.27,.36,-.3],["c",.75,-.09,1.32,-.51,1.68,-1.26],["c",.21,-.42,.3,-.96,.3,-1.53],["l",0,-.33],["l",-2.7,0],["c",-2.91,0,-2.85,0,-3.09,-.15],["c",-.18,-.12,-.3,-.39,-.27,-.54],["c",.03,-.06,.18,-.24,.33,-.45],["c",.75,-.9,1.59,-2.07,2.13,-3.03],["c",.33,-.54,.84,-1.62,1.05,-2.16],["c",.57,-1.41,.84,-2.64,.9,-4.05],["c",.03,-.63,.06,-.72,.24,-.81],["l",.12,-.06],["l",.45,.12],["c",.66,.18,1.02,.24,1.47,.27],["c",.6,.03,1.23,-.09,2.01,-.33],["z"]],w:11.795,h:14.994},5:{d:[["M",1.02,-14.94],["c",.12,-.09,.03,-.09,1.08,.06],["c",2.49,.36,4.35,.36,6.96,-.06],["c",.57,-.09,.66,-.06,.81,.06],["c",.15,.18,.12,.24,-.15,.51],["c",-1.29,1.26,-3.24,2.04,-5.58,2.31],["c",-.6,.09,-1.2,.12,-1.71,.12],["c",-.39,0,-.45,0,-.57,.06],["c",-.09,.06,-.15,.12,-.21,.21],["l",-.06,.12],["l",0,1.65],["l",0,1.65],["l",.21,-.21],["c",.66,-.57,1.41,-.96,2.19,-1.14],["c",.33,-.06,1.41,-.06,1.95,0],["c",2.61,.36,4.02,1.74,4.26,4.14],["c",.03,.45,.03,1.08,-.03,1.44],["c",-.18,1.02,-.78,2.01,-1.59,2.7],["c",-.72,.57,-1.62,1.02,-2.49,1.2],["c",-1.38,.27,-3.03,.06,-4.2,-.54],["c",-1.08,-.54,-1.71,-1.32,-1.86,-2.28],["c",-.09,-.69,.09,-1.29,.57,-1.74],["c",.24,-.24,.45,-.39,.75,-.51],["c",.21,-.06,.27,-.06,.6,-.06],["c",.33,0,.39,0,.6,.06],["c",.3,.12,.51,.27,.75,.51],["c",.36,.33,.57,.75,.6,1.2],["c",0,.21,0,.27,-.06,.42],["c",-.09,.18,-.12,.24,-.54,.54],["c",-.18,.12,-.36,.3,-.42,.33],["c",-.36,.42,-.18,.99,.36,1.26],["c",.51,.27,1.47,.36,2.01,.27],["c",.93,-.21,1.47,-1.17,1.65,-2.91],["c",.06,-.45,.06,-1.89,0,-2.31],["c",-.15,-1.2,-.51,-2.1,-1.05,-2.55],["c",-.21,-.18,-.54,-.36,-.81,-.39],["c",-.3,-.06,-.84,-.03,-1.26,.06],["c",-.93,.18,-1.65,.6,-2.16,1.2],["c",-.15,.21,-.27,.3,-.39,.3],["c",-.15,0,-.3,-.09,-.36,-.18],["c",-.06,-.09,-.06,-.15,-.06,-3.66],["c",0,-3.39,0,-3.57,.06,-3.66],["c",.03,-.06,.09,-.15,.15,-.18],["z"]],w:10.212,h:14.997},6:{d:[["M",4.98,-14.97],["c",.36,-.03,1.2,0,1.59,.06],["c",.9,.15,1.68,.51,2.25,1.05],["c",.57,.51,.87,1.23,.84,1.98],["c",-.03,.51,-.21,.9,-.6,1.26],["c",-.24,.24,-.45,.39,-.75,.51],["c",-.21,.06,-.27,.06,-.6,.06],["c",-.33,0,-.39,0,-.6,-.06],["c",-.3,-.12,-.51,-.27,-.75,-.51],["c",-.39,-.36,-.57,-.78,-.57,-1.26],["c",0,-.27,0,-.3,.09,-.42],["c",.03,-.09,.18,-.21,.3,-.3],["c",.12,-.09,.3,-.21,.39,-.27],["c",.09,-.06,.21,-.18,.27,-.24],["c",.06,-.12,.09,-.15,.09,-.33],["c",0,-.18,-.03,-.24,-.09,-.36],["c",-.24,-.39,-.75,-.6,-1.38,-.57],["c",-.54,.03,-.9,.18,-1.23,.48],["c",-.81,.72,-1.08,2.16,-.96,5.37],["l",0,.63],["l",.3,-.12],["c",.78,-.27,1.29,-.33,2.1,-.27],["c",1.47,.12,2.49,.54,3.27,1.29],["c",.48,.51,.81,1.11,.96,1.89],["c",.06,.27,.06,.42,.06,.93],["c",0,.54,0,.69,-.06,.96],["c",-.15,.78,-.48,1.38,-.96,1.89],["c",-.54,.51,-1.17,.87,-1.98,1.08],["c",-1.14,.3,-2.4,.33,-3.24,.03],["c",-1.5,-.48,-2.64,-1.89,-3.27,-4.02],["c",-.36,-1.23,-.51,-2.82,-.42,-4.08],["c",.3,-3.66,2.28,-6.3,4.95,-6.66],["z"],["m",.66,7.41],["c",-.27,-.09,-.81,-.12,-1.08,-.06],["c",-.72,.18,-1.08,.69,-1.23,1.71],["c",-.06,.54,-.06,3,0,3.54],["c",.18,1.26,.72,1.77,1.8,1.74],["c",.39,-.03,.63,-.09,.9,-.27],["c",.66,-.42,.9,-1.32,.9,-3.24],["c",0,-2.22,-.36,-3.12,-1.29,-3.42],["z"]],w:9.956,h:14.982},7:{d:[["M",.21,-14.97],["c",.21,-.06,.45,0,.54,.15],["c",.06,.09,.06,.15,.06,.39],["c",0,.24,0,.33,.06,.42],["c",.06,.12,.21,.24,.27,.24],["c",.03,0,.12,-.12,.24,-.21],["c",.96,-1.2,2.58,-1.35,3.99,-.42],["c",.15,.12,.42,.3,.54,.45],["c",.48,.39,.81,.57,1.29,.6],["c",.69,.03,1.5,-.3,2.13,-.87],["c",.09,-.09,.27,-.3,.39,-.45],["c",.12,-.15,.24,-.27,.3,-.3],["c",.18,-.06,.39,.03,.51,.21],["c",.06,.18,.06,.24,-.27,.72],["c",-.18,.24,-.54,.78,-.78,1.17],["c",-2.37,3.54,-3.54,6.27,-3.87,9],["c",-.03,.33,-.03,.66,-.03,1.26],["c",0,.9,0,1.08,.15,1.89],["c",.06,.45,.06,.48,.03,.6],["c",-.06,.09,-.21,.21,-.3,.21],["c",-.03,0,-.27,-.06,-.54,-.15],["c",-.84,-.27,-1.11,-.3,-1.65,-.3],["c",-.57,0,-.84,.03,-1.56,.27],["c",-.6,.18,-.69,.21,-.81,.15],["c",-.12,-.06,-.21,-.18,-.21,-.3],["c",0,-.15,.6,-1.44,1.2,-2.61],["c",1.14,-2.22,2.73,-4.68,5.1,-8.01],["c",.21,-.27,.36,-.48,.33,-.48],["c",0,0,-.12,.06,-.27,.12],["c",-.54,.3,-.99,.39,-1.56,.39],["c",-.75,.03,-1.2,-.18,-1.83,-.75],["c",-.99,-.9,-1.83,-1.17,-2.31,-.72],["c",-.18,.15,-.36,.51,-.45,.84],["c",-.06,.24,-.06,.33,-.09,1.98],["c",0,1.62,-.03,1.74,-.06,1.8],["c",-.15,.24,-.54,.24,-.69,0],["c",-.06,-.09,-.06,-.15,-.06,-3.57],["c",0,-3.42,0,-3.48,.06,-3.57],["c",.03,-.06,.09,-.12,.15,-.15],["z"]],w:10.561,h:15.093},8:{d:[["M",4.98,-14.97],["c",.33,-.03,1.02,-.03,1.32,0],["c",1.32,.12,2.49,.6,3.21,1.32],["c",.39,.39,.66,.81,.78,1.29],["c",.09,.36,.09,1.08,0,1.44],["c",-.21,.84,-.66,1.59,-1.59,2.55],["l",-.3,.3],["l",.27,.18],["c",1.47,.93,2.31,2.31,2.25,3.75],["c",-.03,.75,-.24,1.35,-.63,1.95],["c",-.45,.66,-1.02,1.14,-1.83,1.53],["c",-1.8,.87,-4.2,.87,-6,.03],["c",-1.62,-.78,-2.52,-2.16,-2.46,-3.66],["c",.06,-.99,.54,-1.77,1.8,-2.97],["c",.54,-.51,.54,-.54,.48,-.57],["c",-.39,-.27,-.96,-.78,-1.2,-1.14],["c",-.75,-1.11,-.87,-2.4,-.3,-3.6],["c",.69,-1.35,2.25,-2.25,4.2,-2.4],["z"],["m",1.53,.69],["c",-.42,-.09,-1.11,-.12,-1.38,-.06],["c",-.3,.06,-.6,.18,-.81,.3],["c",-.21,.12,-.6,.51,-.72,.72],["c",-.51,.87,-.42,1.89,.21,2.52],["c",.21,.21,.36,.3,1.95,1.23],["c",.96,.54,1.74,.99,1.77,1.02],["c",.09,0,.63,-.6,.99,-1.11],["c",.21,-.36,.48,-.87,.57,-1.23],["c",.06,-.24,.06,-.36,.06,-.72],["c",0,-.45,-.03,-.66,-.15,-.99],["c",-.39,-.81,-1.29,-1.44,-2.49,-1.68],["z"],["m",-1.44,8.07],["l",-1.89,-1.08],["c",-.03,0,-.18,.15,-.39,.33],["c",-1.2,1.08,-1.65,1.95,-1.59,3],["c",.09,1.59,1.35,2.85,3.21,3.24],["c",.33,.06,.45,.06,.93,.06],["c",.63,0,.81,-.03,1.29,-.27],["c",.9,-.42,1.47,-1.41,1.41,-2.4],["c",-.06,-.66,-.39,-1.29,-.9,-1.65],["c",-.12,-.09,-1.05,-.63,-2.07,-1.23],["z"]],w:10.926,h:14.989},9:{d:[["M",4.23,-14.97],["c",.42,-.03,1.29,0,1.62,.06],["c",.51,.12,.93,.3,1.38,.57],["c",1.53,1.02,2.52,3.24,2.73,5.94],["c",.18,2.55,-.48,4.98,-1.83,6.57],["c",-1.05,1.26,-2.4,1.89,-3.93,1.83],["c",-1.23,-.06,-2.31,-.45,-3.03,-1.14],["c",-.57,-.51,-.87,-1.23,-.84,-1.98],["c",.03,-.51,.21,-.9,.6,-1.26],["c",.24,-.24,.45,-.39,.75,-.51],["c",.21,-.06,.27,-.06,.6,-.06],["c",.33,0,.39,0,.6,.06],["c",.3,.12,.51,.27,.75,.51],["c",.39,.36,.57,.78,.57,1.26],["c",0,.27,0,.3,-.09,.42],["c",-.03,.09,-.18,.21,-.3,.3],["c",-.12,.09,-.3,.21,-.39,.27],["c",-.09,.06,-.21,.18,-.27,.24],["c",-.06,.12,-.06,.15,-.06,.33],["c",0,.18,0,.24,.06,.36],["c",.24,.39,.75,.6,1.38,.57],["c",.54,-.03,.9,-.18,1.23,-.48],["c",.81,-.72,1.08,-2.16,.96,-5.37],["l",0,-.63],["l",-.3,.12],["c",-.78,.27,-1.29,.33,-2.1,.27],["c",-1.47,-.12,-2.49,-.54,-3.27,-1.29],["c",-.48,-.51,-.81,-1.11,-.96,-1.89],["c",-.06,-.27,-.06,-.42,-.06,-.96],["c",0,-.51,0,-.66,.06,-.93],["c",.15,-.78,.48,-1.38,.96,-1.89],["c",.15,-.12,.33,-.27,.42,-.36],["c",.69,-.51,1.62,-.81,2.76,-.93],["z"],["m",1.17,.66],["c",-.21,-.06,-.57,-.06,-.81,-.03],["c",-.78,.12,-1.26,.69,-1.41,1.74],["c",-.12,.63,-.15,1.95,-.09,2.79],["c",.12,1.71,.63,2.4,1.77,2.46],["c",1.08,.03,1.62,-.48,1.8,-1.74],["c",.06,-.54,.06,-3,0,-3.54],["c",-.15,-1.05,-.51,-1.53,-1.26,-1.68],["z"]],w:9.959,h:14.986},"rests.multimeasure":{d:[["M",0,-4],["l",0,16],["l",1,0],["l",0,-5],["l",40,0],["l",0,5],["l",1,0],["l",0,-16],["l",-1,0],["l",0,5],["l",-40,0],["l",0,-5],["z"]],w:42,h:18},"rests.whole":{d:[["M",.06,.03],["l",.09,-.06],["l",5.46,0],["l",5.49,0],["l",.09,.06],["l",.06,.09],["l",0,2.19],["l",0,2.19],["l",-.06,.09],["l",-.09,.06],["l",-5.49,0],["l",-5.46,0],["l",-.09,-.06],["l",-.06,-.09],["l",0,-2.19],["l",0,-2.19],["z"]],w:11.25,h:4.68},"rests.half":{d:[["M",.06,-4.62],["l",.09,-.06],["l",5.46,0],["l",5.49,0],["l",.09,.06],["l",.06,.09],["l",0,2.19],["l",0,2.19],["l",-.06,.09],["l",-.09,.06],["l",-5.49,0],["l",-5.46,0],["l",-.09,-.06],["l",-.06,-.09],["l",0,-2.19],["l",0,-2.19],["z"]],w:11.25,h:4.68},"rests.quarter":{d:[["M",1.89,-11.82],["c",.12,-.06,.24,-.06,.36,-.03],["c",.09,.06,4.74,5.58,4.86,5.82],["c",.21,.39,.15,.78,-.15,1.26],["c",-.24,.33,-.72,.81,-1.62,1.56],["c",-.45,.36,-.87,.75,-.96,.84],["c",-.93,.99,-1.14,2.49,-.6,3.63],["c",.18,.39,.27,.48,1.32,1.68],["c",1.92,2.25,1.83,2.16,1.83,2.34],["c",0,.18,-.18,.36,-.36,.39],["c",-.15,0,-.27,-.06,-.48,-.27],["c",-.75,-.75,-2.46,-1.29,-3.39,-1.08],["c",-.45,.09,-.69,.27,-.9,.69],["c",-.12,.3,-.21,.66,-.24,1.14],["c",-.03,.66,.09,1.35,.3,2.01],["c",.15,.42,.24,.66,.45,.96],["c",.18,.24,.18,.33,.03,.42],["c",-.12,.06,-.18,.03,-.45,-.3],["c",-1.08,-1.38,-2.07,-3.36,-2.4,-4.83],["c",-.27,-1.05,-.15,-1.77,.27,-2.07],["c",.21,-.12,.42,-.15,.87,-.15],["c",.87,.06,2.1,.39,3.3,.9],["l",.39,.18],["l",-1.65,-1.95],["c",-2.52,-2.97,-2.61,-3.09,-2.7,-3.27],["c",-.09,-.24,-.12,-.48,-.03,-.75],["c",.15,-.48,.57,-.96,1.83,-2.01],["c",.45,-.36,.84,-.72,.93,-.78],["c",.69,-.75,1.02,-1.8,.9,-2.79],["c",-.06,-.33,-.21,-.84,-.39,-1.11],["c",-.09,-.15,-.45,-.6,-.81,-1.05],["c",-.36,-.42,-.69,-.81,-.72,-.87],["c",-.09,-.18,0,-.42,.21,-.51],["z"]],w:7.888,h:21.435},"rests.8th":{d:[["M",1.68,-6.12],["c",.66,-.09,1.23,.09,1.68,.51],["c",.27,.3,.39,.54,.57,1.26],["c",.09,.33,.18,.66,.21,.72],["c",.12,.27,.33,.45,.6,.48],["c",.12,0,.18,0,.33,-.09],["c",.39,-.18,1.32,-1.29,1.68,-1.98],["c",.09,-.21,.24,-.3,.39,-.3],["c",.12,0,.27,.09,.33,.18],["c",.03,.06,-.27,1.11,-1.86,6.42],["c",-1.02,3.48,-1.89,6.39,-1.92,6.42],["c",0,.03,-.12,.12,-.24,.15],["c",-.18,.09,-.21,.09,-.45,.09],["c",-.24,0,-.3,0,-.48,-.06],["c",-.09,-.06,-.21,-.12,-.21,-.15],["c",-.06,-.03,.15,-.57,1.68,-4.92],["c",.96,-2.67,1.74,-4.89,1.71,-4.89],["l",-.51,.15],["c",-1.08,.36,-1.74,.48,-2.55,.48],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.33,-.45,.84,-.81,1.38,-.9],["z"]],w:7.534,h:13.883},"rests.16th":{d:[["M",3.33,-6.12],["c",.66,-.09,1.23,.09,1.68,.51],["c",.27,.3,.39,.54,.57,1.26],["c",.09,.33,.18,.66,.21,.72],["c",.15,.39,.57,.57,.87,.42],["c",.39,-.18,1.2,-1.23,1.62,-2.07],["c",.06,-.15,.24,-.24,.36,-.24],["c",.12,0,.27,.09,.33,.18],["c",.03,.06,-.45,1.86,-2.67,10.17],["c",-1.5,5.55,-2.73,10.14,-2.76,10.17],["c",-.03,.03,-.12,.12,-.24,.15],["c",-.18,.09,-.21,.09,-.45,.09],["c",-.24,0,-.3,0,-.48,-.06],["c",-.09,-.06,-.21,-.12,-.21,-.15],["c",-.06,-.03,.12,-.57,1.44,-4.92],["c",.81,-2.67,1.47,-4.86,1.47,-4.89],["c",-.03,0,-.27,.06,-.54,.15],["c",-1.08,.36,-1.77,.48,-2.58,.48],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.72,-1.05,2.22,-1.23,3.06,-.42],["c",.3,.33,.42,.6,.6,1.38],["c",.09,.45,.21,.78,.33,.9],["c",.09,.09,.27,.18,.45,.21],["c",.12,0,.18,0,.33,-.09],["c",.33,-.15,1.02,-.93,1.41,-1.59],["c",.12,-.21,.18,-.39,.39,-1.08],["c",.66,-2.1,1.17,-3.84,1.17,-3.87],["c",0,0,-.21,.06,-.42,.15],["c",-.51,.15,-1.2,.33,-1.68,.42],["c",-.33,.06,-.51,.06,-.96,.06],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.33,-.45,.84,-.81,1.38,-.9],["z"]],w:9.724,h:21.383},"rests.32nd":{d:[["M",4.23,-13.62],["c",.66,-.09,1.23,.09,1.68,.51],["c",.27,.3,.39,.54,.57,1.26],["c",.09,.33,.18,.66,.21,.72],["c",.12,.27,.33,.45,.6,.48],["c",.12,0,.18,0,.27,-.06],["c",.33,-.21,.99,-1.11,1.44,-1.98],["c",.09,-.24,.21,-.33,.39,-.33],["c",.12,0,.27,.09,.33,.18],["c",.03,.06,-.57,2.67,-3.21,13.89],["c",-1.8,7.62,-3.3,13.89,-3.3,13.92],["c",-.03,.06,-.12,.12,-.24,.18],["c",-.21,.09,-.24,.09,-.48,.09],["c",-.24,0,-.3,0,-.48,-.06],["c",-.09,-.06,-.21,-.12,-.21,-.15],["c",-.06,-.03,.09,-.57,1.23,-4.92],["c",.69,-2.67,1.26,-4.86,1.29,-4.89],["c",0,-.03,-.12,-.03,-.48,.12],["c",-1.17,.39,-2.22,.57,-3,.54],["c",-.42,-.03,-.75,-.12,-1.11,-.3],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.72,-1.05,2.22,-1.23,3.06,-.42],["c",.3,.33,.42,.6,.6,1.38],["c",.09,.45,.21,.78,.33,.9],["c",.12,.09,.3,.18,.48,.21],["c",.12,0,.18,0,.3,-.09],["c",.42,-.21,1.29,-1.29,1.56,-1.89],["c",.03,-.12,1.23,-4.59,1.23,-4.65],["c",0,-.03,-.18,.03,-.39,.12],["c",-.63,.18,-1.2,.36,-1.74,.45],["c",-.39,.06,-.54,.06,-1.02,.06],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.72,-1.05,2.22,-1.23,3.06,-.42],["c",.3,.33,.42,.6,.6,1.38],["c",.09,.45,.21,.78,.33,.9],["c",.18,.18,.51,.27,.72,.15],["c",.3,-.12,.69,-.57,1.08,-1.17],["c",.42,-.6,.39,-.51,1.05,-3.03],["c",.33,-1.26,.6,-2.31,.6,-2.34],["c",0,0,-.21,.03,-.45,.12],["c",-.57,.18,-1.14,.33,-1.62,.42],["c",-.33,.06,-.51,.06,-.96,.06],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.33,-.45,.84,-.81,1.38,-.9],["z"]],w:11.373,h:28.883},"rests.64th":{d:[["M",5.13,-13.62],["c",.66,-.09,1.23,.09,1.68,.51],["c",.27,.3,.39,.54,.57,1.26],["c",.15,.63,.21,.81,.33,.96],["c",.18,.21,.54,.3,.75,.18],["c",.24,-.12,.63,-.66,1.08,-1.56],["c",.33,-.66,.39,-.72,.6,-.72],["c",.12,0,.27,.09,.33,.18],["c",.03,.06,-.69,3.66,-3.54,17.64],["c",-1.95,9.66,-3.57,17.61,-3.57,17.64],["c",-.03,.06,-.12,.12,-.24,.18],["c",-.21,.09,-.24,.09,-.48,.09],["c",-.24,0,-.3,0,-.48,-.06],["c",-.09,-.06,-.21,-.12,-.21,-.15],["c",-.06,-.03,.06,-.57,1.05,-4.95],["c",.6,-2.7,1.08,-4.89,1.08,-4.92],["c",0,0,-.24,.06,-.51,.15],["c",-.66,.24,-1.2,.36,-1.77,.48],["c",-.42,.06,-.57,.06,-1.05,.06],["c",-.69,0,-.87,-.03,-1.35,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.72,-1.05,2.22,-1.23,3.06,-.42],["c",.3,.33,.42,.6,.6,1.38],["c",.09,.45,.21,.78,.33,.9],["c",.09,.09,.27,.18,.45,.21],["c",.21,.03,.39,-.09,.72,-.42],["c",.45,-.45,1.02,-1.26,1.17,-1.65],["c",.03,-.09,.27,-1.14,.54,-2.34],["c",.27,-1.2,.48,-2.19,.51,-2.22],["c",0,-.03,-.09,-.03,-.48,.12],["c",-1.17,.39,-2.22,.57,-3,.54],["c",-.42,-.03,-.75,-.12,-1.11,-.3],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.36,-.54,.96,-.87,1.65,-.93],["c",.54,-.03,1.02,.15,1.41,.54],["c",.27,.3,.39,.54,.57,1.26],["c",.09,.33,.18,.66,.21,.72],["c",.15,.39,.57,.57,.9,.42],["c",.36,-.18,1.2,-1.26,1.47,-1.89],["c",.03,-.09,.3,-1.2,.57,-2.43],["l",.51,-2.28],["l",-.54,.18],["c",-1.11,.36,-1.8,.48,-2.61,.48],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.36,-.54,.96,-.87,1.65,-.93],["c",.54,-.03,1.02,.15,1.41,.54],["c",.27,.3,.39,.54,.57,1.26],["c",.15,.63,.21,.81,.33,.96],["c",.21,.21,.54,.3,.75,.18],["c",.36,-.18,.93,-.93,1.29,-1.68],["c",.12,-.24,.18,-.48,.63,-2.55],["l",.51,-2.31],["c",0,-.03,-.18,.03,-.39,.12],["c",-1.14,.36,-2.1,.54,-2.82,.51],["c",-.42,-.03,-.75,-.12,-1.11,-.3],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.33,-.45,.84,-.81,1.38,-.9],["z"]],w:12.453,h:36.383},"rests.128th":{d:[["M",6.03,-21.12],["c",.66,-.09,1.23,.09,1.68,.51],["c",.27,.3,.39,.54,.57,1.26],["c",.09,.33,.18,.66,.21,.72],["c",.12,.27,.33,.45,.6,.48],["c",.21,0,.33,-.06,.54,-.36],["c",.15,-.21,.54,-.93,.78,-1.47],["c",.15,-.33,.18,-.39,.3,-.48],["c",.18,-.09,.45,0,.51,.15],["c",.03,.09,-7.11,42.75,-7.17,42.84],["c",-.03,.03,-.15,.09,-.24,.15],["c",-.18,.06,-.24,.06,-.45,.06],["c",-.24,0,-.3,0,-.48,-.06],["c",-.09,-.06,-.21,-.12,-.21,-.15],["c",-.06,-.03,.03,-.57,.84,-4.98],["c",.51,-2.7,.93,-4.92,.9,-4.92],["c",0,0,-.15,.06,-.36,.12],["c",-.78,.27,-1.62,.48,-2.31,.57],["c",-.15,.03,-.54,.03,-.81,.03],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.36,-.54,.96,-.87,1.65,-.93],["c",.54,-.03,1.02,.15,1.41,.54],["c",.27,.3,.39,.54,.57,1.26],["c",.09,.33,.18,.66,.21,.72],["c",.12,.27,.33,.45,.63,.48],["c",.12,0,.18,0,.3,-.09],["c",.42,-.21,1.14,-1.11,1.5,-1.83],["c",.12,-.27,.12,-.27,.54,-2.52],["c",.24,-1.23,.42,-2.25,.39,-2.25],["c",0,0,-.24,.06,-.51,.18],["c",-1.26,.39,-2.25,.57,-3.06,.54],["c",-.42,-.03,-.75,-.12,-1.11,-.3],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.36,-.54,.96,-.87,1.65,-.93],["c",.54,-.03,1.02,.15,1.41,.54],["c",.27,.3,.39,.54,.57,1.26],["c",.15,.63,.21,.81,.33,.96],["c",.18,.21,.51,.3,.75,.18],["c",.36,-.15,1.05,-.99,1.41,-1.77],["l",.15,-.3],["l",.42,-2.25],["c",.21,-1.26,.42,-2.28,.39,-2.28],["l",-.51,.15],["c",-1.11,.39,-1.89,.51,-2.7,.51],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.36,-.54,.96,-.87,1.65,-.93],["c",.54,-.03,1.02,.15,1.41,.54],["c",.27,.3,.39,.54,.57,1.26],["c",.15,.63,.21,.81,.33,.96],["c",.18,.18,.48,.27,.72,.21],["c",.33,-.12,1.14,-1.26,1.41,-1.95],["c",0,-.09,.21,-1.11,.45,-2.34],["c",.21,-1.2,.39,-2.22,.39,-2.28],["c",.03,-.03,0,-.03,-.45,.12],["c",-.57,.18,-1.2,.33,-1.71,.42],["c",-.3,.06,-.51,.06,-.93,.06],["c",-.66,0,-.84,-.03,-1.32,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.36,-.54,.96,-.87,1.65,-.93],["c",.54,-.03,1.02,.15,1.41,.54],["c",.27,.3,.39,.54,.57,1.26],["c",.09,.33,.18,.66,.21,.72],["c",.12,.27,.33,.45,.6,.48],["c",.18,0,.36,-.09,.57,-.33],["c",.33,-.36,.78,-1.14,.93,-1.56],["c",.03,-.12,.24,-1.2,.45,-2.4],["c",.24,-1.2,.42,-2.22,.42,-2.28],["c",.03,-.03,0,-.03,-.39,.09],["c",-1.05,.36,-1.8,.48,-2.58,.48],["c",-.63,0,-.84,-.03,-1.29,-.27],["c",-1.32,-.63,-1.77,-2.16,-1.02,-3.3],["c",.33,-.45,.84,-.81,1.38,-.9],["z"]],w:12.992,h:43.883},"accidentals.sharp":{d:[["M",5.73,-11.19],["c",.21,-.12,.54,-.03,.66,.24],["c",.06,.12,.06,.21,.06,2.31],["c",0,1.23,0,2.22,.03,2.22],["c",0,0,.27,-.12,.6,-.24],["c",.69,-.27,.78,-.3,.96,-.15],["c",.21,.15,.21,.18,.21,1.38],["c",0,1.02,0,1.11,-.06,1.2],["c",-.03,.06,-.09,.12,-.12,.15],["c",-.06,.03,-.42,.21,-.84,.36],["l",-.75,.33],["l",-.03,2.43],["c",0,1.32,0,2.43,.03,2.43],["c",0,0,.27,-.12,.6,-.24],["c",.69,-.27,.78,-.3,.96,-.15],["c",.21,.15,.21,.18,.21,1.38],["c",0,1.02,0,1.11,-.06,1.2],["c",-.03,.06,-.09,.12,-.12,.15],["c",-.06,.03,-.42,.21,-.84,.36],["l",-.75,.33],["l",-.03,2.52],["c",0,2.28,-.03,2.55,-.06,2.64],["c",-.21,.36,-.72,.36,-.93,0],["c",-.03,-.09,-.06,-.33,-.06,-2.43],["l",0,-2.31],["l",-1.29,.51],["l",-1.26,.51],["l",0,2.43],["c",0,2.58,0,2.52,-.15,2.67],["c",-.06,.09,-.27,.18,-.36,.18],["c",-.12,0,-.33,-.09,-.39,-.18],["c",-.15,-.15,-.15,-.09,-.15,-2.43],["c",0,-1.23,0,-2.22,-.03,-2.22],["c",0,0,-.27,.12,-.6,.24],["c",-.69,.27,-.78,.3,-.96,.15],["c",-.21,-.15,-.21,-.18,-.21,-1.38],["c",0,-1.02,0,-1.11,.06,-1.2],["c",.03,-.06,.09,-.12,.12,-.15],["c",.06,-.03,.42,-.21,.84,-.36],["l",.78,-.33],["l",0,-2.43],["c",0,-1.32,0,-2.43,-.03,-2.43],["c",0,0,-.27,.12,-.6,.24],["c",-.69,.27,-.78,.3,-.96,.15],["c",-.21,-.15,-.21,-.18,-.21,-1.38],["c",0,-1.02,0,-1.11,.06,-1.2],["c",.03,-.06,.09,-.12,.12,-.15],["c",.06,-.03,.42,-.21,.84,-.36],["l",.78,-.33],["l",0,-2.52],["c",0,-2.28,.03,-2.55,.06,-2.64],["c",.21,-.36,.72,-.36,.93,0],["c",.03,.09,.06,.33,.06,2.43],["l",.03,2.31],["l",1.26,-.51],["l",1.26,-.51],["l",0,-2.43],["c",0,-2.28,0,-2.43,.06,-2.55],["c",.06,-.12,.12,-.18,.27,-.24],["z"],["m",-.33,10.65],["l",0,-2.43],["l",-1.29,.51],["l",-1.26,.51],["l",0,2.46],["l",0,2.43],["l",.09,-.03],["c",.06,-.03,.63,-.27,1.29,-.51],["l",1.17,-.48],["l",0,-2.46],["z"]],w:8.25,h:22.462},"accidentals.halfsharp":{d:[["M",2.43,-10.05],["c",.21,-.12,.54,-.03,.66,.24],["c",.06,.12,.06,.21,.06,2.01],["c",0,1.05,0,1.89,.03,1.89],["l",.72,-.48],["c",.69,-.48,.69,-.51,.87,-.51],["c",.15,0,.18,.03,.27,.09],["c",.21,.15,.21,.18,.21,1.41],["c",0,1.11,-.03,1.14,-.09,1.23],["c",-.03,.03,-.48,.39,-1.02,.75],["l",-.99,.66],["l",0,2.37],["c",0,1.32,0,2.37,.03,2.37],["l",.72,-.48],["c",.69,-.48,.69,-.51,.87,-.51],["c",.15,0,.18,.03,.27,.09],["c",.21,.15,.21,.18,.21,1.41],["c",0,1.11,-.03,1.14,-.09,1.23],["c",-.03,.03,-.48,.39,-1.02,.75],["l",-.99,.66],["l",0,2.25],["c",0,1.95,0,2.28,-.06,2.37],["c",-.06,.12,-.12,.21,-.24,.27],["c",-.27,.12,-.54,.03,-.69,-.24],["c",-.06,-.12,-.06,-.21,-.06,-2.01],["c",0,-1.05,0,-1.89,-.03,-1.89],["l",-.72,.48],["c",-.69,.48,-.69,.48,-.87,.48],["c",-.15,0,-.18,0,-.27,-.06],["c",-.21,-.15,-.21,-.18,-.21,-1.41],["c",0,-1.11,.03,-1.14,.09,-1.23],["c",.03,-.03,.48,-.39,1.02,-.75],["l",.99,-.66],["l",0,-2.37],["c",0,-1.32,0,-2.37,-.03,-2.37],["l",-.72,.48],["c",-.69,.48,-.69,.48,-.87,.48],["c",-.15,0,-.18,0,-.27,-.06],["c",-.21,-.15,-.21,-.18,-.21,-1.41],["c",0,-1.11,.03,-1.14,.09,-1.23],["c",.03,-.03,.48,-.39,1.02,-.75],["l",.99,-.66],["l",0,-2.25],["c",0,-2.13,0,-2.28,.06,-2.4],["c",.06,-.12,.12,-.18,.27,-.24],["z"]],w:5.25,h:20.174},"accidentals.nat":{d:[["M",.21,-11.4],["c",.24,-.06,.78,0,.99,.15],["c",.03,.03,.03,.48,0,2.61],["c",-.03,1.44,-.03,2.61,-.03,2.61],["c",0,.03,.75,-.09,1.68,-.24],["c",.96,-.18,1.71,-.27,1.74,-.27],["c",.15,.03,.27,.15,.36,.3],["l",.06,.12],["l",.09,8.67],["c",.09,6.96,.12,8.67,.09,8.67],["c",-.03,.03,-.12,.06,-.21,.09],["c",-.24,.09,-.72,.09,-.96,0],["c",-.09,-.03,-.18,-.06,-.21,-.09],["c",-.03,-.03,-.03,-.48,0,-2.61],["c",.03,-1.44,.03,-2.61,.03,-2.61],["c",0,-.03,-.75,.09,-1.68,.24],["c",-.96,.18,-1.71,.27,-1.74,.27],["c",-.15,-.03,-.27,-.15,-.36,-.3],["l",-.06,-.15],["l",-.09,-7.53],["c",-.06,-4.14,-.09,-8.04,-.12,-8.67],["l",0,-1.11],["l",.15,-.06],["c",.09,-.03,.21,-.06,.27,-.09],["z"],["m",3.75,8.4],["c",0,-.33,0,-.42,-.03,-.42],["c",-.12,0,-2.79,.45,-2.79,.48],["c",-.03,0,-.09,6.3,-.09,6.33],["c",.03,0,2.79,-.45,2.82,-.48],["c",0,0,.09,-4.53,.09,-5.91],["z"]],w:5.4,h:22.8},"accidentals.flat":{d:[["M",-.36,-14.07],["c",.33,-.06,.87,0,1.08,.15],["c",.06,.03,.06,.36,-.03,5.25],["c",-.06,2.85,-.09,5.19,-.09,5.19],["c",0,.03,.12,-.03,.24,-.12],["c",.63,-.42,1.41,-.66,2.19,-.72],["c",.81,-.03,1.47,.21,2.04,.78],["c",.57,.54,.87,1.26,.93,2.04],["c",.03,.57,-.09,1.08,-.36,1.62],["c",-.42,.81,-1.02,1.38,-2.82,2.61],["c",-1.14,.78,-1.44,1.02,-1.8,1.44],["c",-.18,.18,-.39,.39,-.45,.42],["c",-.27,.18,-.57,.15,-.81,-.06],["c",-.06,-.09,-.12,-.18,-.15,-.27],["c",-.03,-.06,-.09,-3.27,-.18,-8.34],["c",-.09,-4.53,-.15,-8.58,-.18,-9.03],["l",0,-.78],["l",.12,-.06],["c",.06,-.03,.18,-.09,.27,-.12],["z"],["m",3.18,11.01],["c",-.21,-.12,-.54,-.15,-.81,-.06],["c",-.54,.15,-.99,.63,-1.17,1.26],["c",-.06,.3,-.12,2.88,-.06,3.87],["c",.03,.42,.03,.81,.06,.9],["l",.03,.12],["l",.45,-.39],["c",.63,-.54,1.26,-1.17,1.56,-1.59],["c",.3,-.42,.6,-.99,.72,-1.41],["c",.18,-.69,.09,-1.47,-.18,-2.07],["c",-.15,-.3,-.33,-.51,-.6,-.63],["z"]],w:6.75,h:18.801},"accidentals.halfflat":{d:[["M",4.83,-14.07],["c",.33,-.06,.87,0,1.08,.15],["c",.06,.03,.06,.6,-.12,9.06],["c",-.09,5.55,-.15,9.06,-.18,9.12],["c",-.03,.09,-.09,.18,-.15,.27],["c",-.24,.21,-.54,.24,-.81,.06],["c",-.06,-.03,-.27,-.24,-.45,-.42],["c",-.36,-.42,-.66,-.66,-1.8,-1.44],["c",-1.23,-.84,-1.83,-1.32,-2.25,-1.77],["c",-.66,-.78,-.96,-1.56,-.93,-2.46],["c",.09,-1.41,1.11,-2.58,2.4,-2.79],["c",.3,-.06,.84,-.03,1.23,.06],["c",.54,.12,1.08,.33,1.53,.63],["c",.12,.09,.24,.15,.24,.12],["c",0,0,-.12,-8.37,-.18,-9.75],["l",0,-.66],["l",.12,-.06],["c",.06,-.03,.18,-.09,.27,-.12],["z"],["m",-1.65,10.95],["c",-.6,-.18,-1.08,.09,-1.38,.69],["c",-.27,.6,-.36,1.38,-.18,2.07],["c",.12,.42,.42,.99,.72,1.41],["c",.3,.42,.93,1.05,1.56,1.59],["l",.48,.39],["l",0,-.12],["c",.03,-.09,.03,-.48,.06,-.9],["c",.03,-.57,.03,-1.08,0,-2.22],["c",-.03,-1.62,-.03,-1.62,-.24,-2.07],["c",-.21,-.42,-.6,-.75,-1.02,-.84],["z"]],w:6.728,h:18.801},"accidentals.dblflat":{d:[["M",-.36,-14.07],["c",.33,-.06,.87,0,1.08,.15],["c",.06,.03,.06,.33,-.03,4.89],["c",-.06,2.67,-.09,5.01,-.09,5.22],["l",0,.36],["l",.15,-.15],["c",.36,-.3,.75,-.51,1.2,-.63],["c",.33,-.09,.96,-.09,1.26,-.03],["c",.27,.09,.63,.27,.87,.45],["l",.21,.15],["l",0,-.27],["c",0,-.15,-.03,-2.43,-.09,-5.1],["c",-.09,-4.56,-.09,-4.86,-.03,-4.89],["c",.15,-.12,.39,-.15,.72,-.15],["c",.3,0,.54,.03,.69,.15],["c",.06,.03,.06,.33,-.03,4.95],["c",-.06,2.7,-.09,5.04,-.09,5.22],["l",.03,.3],["l",.21,-.15],["c",.69,-.48,1.44,-.69,2.28,-.69],["c",.51,0,.78,.03,1.2,.21],["c",1.32,.63,2.01,2.28,1.53,3.69],["c",-.21,.57,-.51,1.02,-1.05,1.56],["c",-.42,.42,-.81,.72,-1.92,1.5],["c",-1.26,.87,-1.5,1.08,-1.86,1.5],["c",-.39,.45,-.54,.54,-.81,.51],["c",-.18,0,-.21,0,-.33,-.06],["l",-.21,-.21],["l",-.06,-.12],["l",-.03,-.99],["c",-.03,-.54,-.03,-1.29,-.06,-1.68],["l",0,-.69],["l",-.21,.24],["c",-.36,.42,-.75,.75,-1.8,1.62],["c",-1.02,.84,-1.2,.99,-1.44,1.38],["c",-.36,.51,-.54,.6,-.9,.51],["c",-.15,-.03,-.39,-.27,-.42,-.42],["c",-.03,-.06,-.09,-3.27,-.18,-8.34],["c",-.09,-4.53,-.15,-8.58,-.18,-9.03],["l",0,-.78],["l",.12,-.06],["c",.06,-.03,.18,-.09,.27,-.12],["z"],["m",2.52,10.98],["c",-.18,-.09,-.48,-.12,-.66,-.06],["c",-.39,.15,-.69,.54,-.84,1.14],["c",-.06,.24,-.06,.39,-.09,1.74],["c",-.03,1.44,0,2.73,.06,3.18],["l",.03,.15],["l",.27,-.27],["c",.93,-.96,1.5,-1.95,1.74,-3.06],["c",.06,-.27,.06,-.39,.06,-.96],["c",0,-.54,0,-.69,-.06,-.93],["c",-.09,-.51,-.27,-.81,-.51,-.93],["z"],["m",5.43,0],["c",-.18,-.09,-.51,-.12,-.72,-.06],["c",-.54,.12,-.96,.63,-1.17,1.26],["c",-.06,.3,-.12,2.88,-.06,3.9],["c",.03,.42,.03,.81,.06,.9],["l",.03,.12],["l",.36,-.3],["c",.42,-.36,1.02,-.96,1.29,-1.29],["c",.36,-.45,.66,-.99,.81,-1.41],["c",.42,-1.23,.15,-2.76,-.6,-3.12],["z"]],w:11.613,h:18.804},"accidentals.dblsharp":{d:[["M",-.18,-3.96],["c",.06,-.03,.12,-.06,.15,-.06],["c",.09,0,2.76,.27,2.79,.3],["c",.12,.03,.15,.12,.15,.51],["c",.06,.96,.24,1.59,.57,2.1],["c",.06,.09,.15,.21,.18,.24],["l",.09,.06],["l",.09,-.06],["c",.03,-.03,.12,-.15,.18,-.24],["c",.33,-.51,.51,-1.14,.57,-2.1],["c",0,-.39,.03,-.45,.12,-.51],["c",.03,0,.66,-.09,1.44,-.15],["c",1.47,-.15,1.5,-.15,1.56,-.03],["c",.03,.06,0,.42,-.09,1.44],["c",-.09,.72,-.15,1.35,-.15,1.38],["c",0,.03,-.03,.09,-.06,.12],["c",-.06,.06,-.12,.09,-.51,.09],["c",-1.08,.06,-1.8,.3,-2.28,.75],["l",-.12,.09],["l",.09,.09],["c",.12,.15,.39,.33,.63,.45],["c",.42,.18,.96,.27,1.68,.33],["c",.39,0,.45,.03,.51,.09],["c",.03,.03,.06,.09,.06,.12],["c",0,.03,.06,.66,.15,1.38],["c",.09,1.02,.12,1.38,.09,1.44],["c",-.06,.12,-.09,.12,-1.56,-.03],["c",-.78,-.06,-1.41,-.15,-1.44,-.15],["c",-.09,-.06,-.12,-.12,-.12,-.54],["c",-.06,-.93,-.24,-1.56,-.57,-2.07],["c",-.06,-.09,-.15,-.21,-.18,-.24],["l",-.09,-.06],["l",-.09,.06],["c",-.03,.03,-.12,.15,-.18,.24],["c",-.33,.51,-.51,1.14,-.57,2.07],["c",0,.42,-.03,.48,-.12,.54],["c",-.03,0,-.66,.09,-1.44,.15],["c",-1.47,.15,-1.5,.15,-1.56,.03],["c",-.03,-.06,0,-.42,.09,-1.44],["c",.09,-.72,.15,-1.35,.15,-1.38],["c",0,-.03,.03,-.09,.06,-.12],["c",.06,-.06,.12,-.09,.51,-.09],["c",.72,-.06,1.26,-.15,1.68,-.33],["c",.24,-.12,.51,-.3,.63,-.45],["l",.09,-.09],["l",-.12,-.09],["c",-.48,-.45,-1.2,-.69,-2.28,-.75],["c",-.39,0,-.45,-.03,-.51,-.09],["c",-.03,-.03,-.06,-.09,-.06,-.12],["c",0,-.03,-.06,-.63,-.12,-1.38],["c",-.09,-.72,-.15,-1.35,-.15,-1.38],["z"]],w:7.95,h:7.977},"dots.dot":{d:[["M",1.32,-1.68],["c",.09,-.03,.27,-.06,.39,-.06],["c",.96,0,1.74,.78,1.74,1.71],["c",0,.96,-.78,1.74,-1.71,1.74],["c",-.96,0,-1.74,-.78,-1.74,-1.71],["c",0,-.78,.54,-1.5,1.32,-1.68],["z"]],w:3.45,h:3.45},"noteheads.dbl":{d:[["M",-.69,-4.02],["c",.18,-.09,.36,-.09,.54,0],["c",.18,.09,.24,.15,.33,.3],["c",.06,.15,.06,.18,.06,1.41],["l",0,1.23],["l",.12,-.18],["c",.72,-1.26,2.64,-2.31,4.86,-2.64],["c",.81,-.15,1.11,-.15,2.13,-.15],["c",.99,0,1.29,0,2.1,.15],["c",.75,.12,1.38,.27,2.04,.54],["c",1.35,.51,2.34,1.26,2.82,2.1],["l",.12,.18],["l",0,-1.23],["c",0,-1.2,0,-1.26,.06,-1.38],["c",.09,-.18,.15,-.24,.33,-.33],["c",.18,-.09,.36,-.09,.54,0],["c",.18,.09,.24,.15,.33,.3],["l",.06,.15],["l",0,3.54],["l",0,3.54],["l",-.06,.15],["c",-.09,.18,-.15,.24,-.33,.33],["c",-.18,.09,-.36,.09,-.54,0],["c",-.18,-.09,-.24,-.15,-.33,-.33],["c",-.06,-.12,-.06,-.18,-.06,-1.38],["l",0,-1.23],["l",-.12,.18],["c",-.48,.84,-1.47,1.59,-2.82,2.1],["c",-.84,.33,-1.71,.54,-2.85,.66],["c",-.45,.06,-2.16,.06,-2.61,0],["c",-1.14,-.12,-2.01,-.33,-2.85,-.66],["c",-1.35,-.51,-2.34,-1.26,-2.82,-2.1],["l",-.12,-.18],["l",0,1.23],["c",0,1.23,0,1.26,-.06,1.38],["c",-.09,.18,-.15,.24,-.33,.33],["c",-.18,.09,-.36,.09,-.54,0],["c",-.18,-.09,-.24,-.15,-.33,-.33],["l",-.06,-.15],["l",0,-3.54],["c",0,-3.48,0,-3.54,.06,-3.66],["c",.09,-.18,.15,-.24,.33,-.33],["z"],["m",7.71,.63],["c",-.36,-.06,-.9,-.06,-1.14,0],["c",-.3,.03,-.66,.24,-.87,.42],["c",-.6,.54,-.9,1.62,-.75,2.82],["c",.12,.93,.51,1.68,1.11,2.31],["c",.75,.72,1.83,1.2,2.85,1.26],["c",1.05,.06,1.83,-.54,2.1,-1.65],["c",.21,-.9,.12,-1.95,-.24,-2.82],["c",-.36,-.81,-1.08,-1.53,-1.95,-1.95],["c",-.3,-.15,-.78,-.3,-1.11,-.39],["z"]],w:16.83,h:8.145},"noteheads.whole":{d:[["M",6.51,-4.05],["c",.51,-.03,2.01,0,2.52,.03],["c",1.41,.18,2.64,.51,3.72,1.08],["c",1.2,.63,1.95,1.41,2.19,2.31],["c",.09,.33,.09,.9,0,1.23],["c",-.24,.9,-.99,1.68,-2.19,2.31],["c",-1.08,.57,-2.28,.9,-3.75,1.08],["c",-.66,.06,-2.31,.06,-2.97,0],["c",-1.47,-.18,-2.67,-.51,-3.75,-1.08],["c",-1.2,-.63,-1.95,-1.41,-2.19,-2.31],["c",-.09,-.33,-.09,-.9,0,-1.23],["c",.24,-.9,.99,-1.68,2.19,-2.31],["c",1.2,-.63,2.61,-.99,4.23,-1.11],["z"],["m",.57,.66],["c",-.87,-.15,-1.53,0,-2.04,.51],["c",-.15,.15,-.24,.27,-.33,.48],["c",-.24,.51,-.36,1.08,-.33,1.77],["c",.03,.69,.18,1.26,.42,1.77],["c",.6,1.17,1.74,1.98,3.18,2.22],["c",1.11,.21,1.95,-.15,2.34,-.99],["c",.24,-.51,.36,-1.08,.33,-1.8],["c",-.06,-1.11,-.45,-2.04,-1.17,-2.76],["c",-.63,-.63,-1.47,-1.05,-2.4,-1.2],["z"]],w:14.985,h:8.097},"noteheads.half":{d:[["M",7.44,-4.05],["c",.06,-.03,.27,-.03,.48,-.03],["c",1.05,0,1.71,.24,2.1,.81],["c",.42,.6,.45,1.35,.18,2.4],["c",-.42,1.59,-1.14,2.73,-2.16,3.39],["c",-1.41,.93,-3.18,1.44,-5.4,1.53],["c",-1.17,.03,-1.89,-.21,-2.28,-.81],["c",-.42,-.6,-.45,-1.35,-.18,-2.4],["c",.42,-1.59,1.14,-2.73,2.16,-3.39],["c",.63,-.42,1.23,-.72,1.98,-.96],["c",.9,-.3,1.65,-.42,3.12,-.54],["z"],["m",1.29,.87],["c",-.27,-.09,-.63,-.12,-.9,-.03],["c",-.72,.24,-1.53,.69,-3.27,1.8],["c",-2.34,1.5,-3.3,2.25,-3.57,2.79],["c",-.36,.72,-.06,1.5,.66,1.77],["c",.24,.12,.69,.09,.99,0],["c",.84,-.3,1.92,-.93,4.14,-2.37],["c",1.62,-1.08,2.37,-1.71,2.61,-2.19],["c",.36,-.72,.06,-1.5,-.66,-1.77],["z"]],w:10.37,h:8.132},"noteheads.quarter":{d:[["M",6.09,-4.05],["c",.36,-.03,1.2,0,1.53,.06],["c",1.17,.24,1.89,.84,2.16,1.83],["c",.06,.18,.06,.3,.06,.66],["c",0,.45,0,.63,-.15,1.08],["c",-.66,2.04,-3.06,3.93,-5.52,4.38],["c",-.54,.09,-1.44,.09,-1.83,.03],["c",-1.23,-.27,-1.98,-.87,-2.25,-1.86],["c",-.06,-.18,-.06,-.3,-.06,-.66],["c",0,-.45,0,-.63,.15,-1.08],["c",.24,-.78,.75,-1.53,1.44,-2.22],["c",1.2,-1.2,2.85,-2.01,4.47,-2.22],["z"]],w:9.81,h:8.094},"noteheads.slash.nostem":{d:[["M",9.3,-7.77],["c",.06,-.06,.18,-.06,1.71,-.06],["l",1.65,0],["l",.09,.09],["c",.06,.06,.06,.09,.06,.15],["c",-.03,.12,-9.21,15.24,-9.3,15.33],["c",-.06,.06,-.18,.06,-1.71,.06],["l",-1.65,0],["l",-.09,-.09],["c",-.06,-.06,-.06,-.09,-.06,-.15],["c",.03,-.12,9.21,-15.24,9.3,-15.33],["z"]],w:12.81,h:15.63},"noteheads.indeterminate":{d:[["M",.78,-4.05],["c",.12,-.03,.24,-.03,.36,.03],["c",.03,.03,.93,.72,1.95,1.56],["l",1.86,1.5],["l",1.86,-1.5],["c",1.02,-.84,1.92,-1.53,1.95,-1.56],["c",.21,-.12,.33,-.09,.75,.24],["c",.3,.27,.36,.36,.36,.54],["c",0,.03,-.03,.12,-.06,.18],["c",-.03,.06,-.9,.75,-1.89,1.56],["l",-1.8,1.47],["c",0,.03,.81,.69,1.8,1.5],["c",.99,.81,1.86,1.5,1.89,1.56],["c",.03,.06,.06,.15,.06,.18],["c",0,.18,-.06,.27,-.36,.54],["c",-.42,.33,-.54,.36,-.75,.24],["c",-.03,-.03,-.93,-.72,-1.95,-1.56],["l",-1.86,-1.5],["l",-1.86,1.5],["c",-1.02,.84,-1.92,1.53,-1.95,1.56],["c",-.21,.12,-.33,.09,-.75,-.24],["c",-.3,-.27,-.36,-.36,-.36,-.54],["c",0,-.03,.03,-.12,.06,-.18],["c",.03,-.06,.9,-.75,1.89,-1.56],["l",1.8,-1.47],["c",0,-.03,-.81,-.69,-1.8,-1.5],["c",-.99,-.81,-1.86,-1.5,-1.89,-1.56],["c",-.06,-.12,-.09,-.21,-.03,-.36],["c",.03,-.09,.57,-.57,.72,-.63],["z"]],w:9.843,h:8.139},"scripts.ufermata":{d:[["M",-.75,-10.77],["c",.12,0,.45,-.03,.69,-.03],["c",2.91,-.03,5.55,1.53,7.41,4.35],["c",1.17,1.71,1.95,3.72,2.43,6.03],["c",.12,.51,.12,.57,.03,.69],["c",-.12,.21,-.48,.27,-.69,.12],["c",-.12,-.09,-.18,-.24,-.27,-.69],["c",-.78,-3.63,-3.42,-6.54,-6.78,-7.38],["c",-.78,-.21,-1.2,-.24,-2.07,-.24],["c",-.63,0,-.84,0,-1.2,.06],["c",-1.83,.27,-3.42,1.08,-4.8,2.37],["c",-1.41,1.35,-2.4,3.21,-2.85,5.19],["c",-.09,.45,-.15,.6,-.27,.69],["c",-.21,.15,-.57,.09,-.69,-.12],["c",-.09,-.12,-.09,-.18,.03,-.69],["c",.33,-1.62,.78,-3,1.47,-4.38],["c",1.77,-3.54,4.44,-5.67,7.56,-5.97],["z"],["m",.33,7.47],["c",1.38,-.3,2.58,.9,2.31,2.25],["c",-.15,.72,-.78,1.35,-1.47,1.5],["c",-1.38,.27,-2.58,-.93,-2.31,-2.31],["c",.15,-.69,.78,-1.29,1.47,-1.44],["z"]],w:19.748,h:11.289},"scripts.dfermata":{d:[["M",-9.63,-.42],["c",.15,-.09,.36,-.06,.51,.03],["c",.12,.09,.18,.24,.27,.66],["c",.78,3.66,3.42,6.57,6.78,7.41],["c",.78,.21,1.2,.24,2.07,.24],["c",.63,0,.84,0,1.2,-.06],["c",1.83,-.27,3.42,-1.08,4.8,-2.37],["c",1.41,-1.35,2.4,-3.21,2.85,-5.22],["c",.09,-.42,.15,-.57,.27,-.66],["c",.21,-.15,.57,-.09,.69,.12],["c",.09,.12,.09,.18,-.03,.69],["c",-.33,1.62,-.78,3,-1.47,4.38],["c",-1.92,3.84,-4.89,6,-8.31,6],["c",-3.42,0,-6.39,-2.16,-8.31,-6],["c",-.48,-.96,-.84,-1.92,-1.14,-2.97],["c",-.18,-.69,-.42,-1.74,-.42,-1.92],["c",0,-.12,.09,-.27,.24,-.33],["z"],["m",9.21,0],["c",1.2,-.27,2.34,.63,2.34,1.86],["c",0,.9,-.66,1.68,-1.5,1.89],["c",-1.38,.27,-2.58,-.93,-2.31,-2.31],["c",.15,-.69,.78,-1.29,1.47,-1.44],["z"]],w:19.744,h:11.274},"scripts.sforzato":{d:[["M",-6.45,-3.69],["c",.06,-.03,.15,-.06,.18,-.06],["c",.06,0,2.85,.72,6.24,1.59],["l",6.33,1.65],["c",.33,.06,.45,.21,.45,.51],["c",0,.3,-.12,.45,-.45,.51],["l",-6.33,1.65],["c",-3.39,.87,-6.18,1.59,-6.21,1.59],["c",-.21,0,-.48,-.24,-.51,-.45],["c",0,-.15,.06,-.36,.18,-.45],["c",.09,-.06,.87,-.27,3.84,-1.05],["c",2.04,-.54,3.84,-.99,4.02,-1.02],["c",.15,-.06,1.14,-.24,2.22,-.42],["c",1.05,-.18,1.92,-.36,1.92,-.36],["c",0,0,-.87,-.18,-1.92,-.36],["c",-1.08,-.18,-2.07,-.36,-2.22,-.42],["c",-.18,-.03,-1.98,-.48,-4.02,-1.02],["c",-2.97,-.78,-3.75,-.99,-3.84,-1.05],["c",-.12,-.09,-.18,-.3,-.18,-.45],["c",.03,-.15,.15,-.3,.3,-.39],["z"]],w:13.5,h:7.5},"scripts.staccato":{d:[["M",-.36,-1.47],["c",.93,-.21,1.86,.51,1.86,1.47],["c",0,.93,-.87,1.65,-1.8,1.47],["c",-.54,-.12,-1.02,-.57,-1.14,-1.08],["c",-.21,-.81,.27,-1.65,1.08,-1.86],["z"]],w:2.989,h:3.004},"scripts.tenuto":{d:[["M",-4.2,-.48],["l",.12,-.06],["l",4.08,0],["l",4.08,0],["l",.12,.06],["c",.39,.21,.39,.75,0,.96],["l",-.12,.06],["l",-4.08,0],["l",-4.08,0],["l",-.12,-.06],["c",-.39,-.21,-.39,-.75,0,-.96],["z"]],w:8.985,h:1.08},"scripts.umarcato":{d:[["M",-.15,-8.19],["c",.15,-.12,.36,-.03,.45,.15],["c",.21,.42,3.45,7.65,3.45,7.71],["c",0,.12,-.12,.27,-.21,.3],["c",-.03,.03,-.51,.03,-1.14,.03],["c",-1.05,0,-1.08,0,-1.17,-.06],["c",-.09,-.06,-.24,-.36,-1.17,-2.4],["c",-.57,-1.29,-1.05,-2.34,-1.08,-2.34],["c",0,-.03,-.51,1.02,-1.08,2.34],["c",-.93,2.07,-1.08,2.34,-1.14,2.4],["c",-.06,.03,-.15,.06,-.18,.06],["c",-.15,0,-.33,-.18,-.33,-.33],["c",0,-.06,3.24,-7.32,3.45,-7.71],["c",.03,-.06,.09,-.15,.15,-.15],["z"]],w:7.5,h:8.245},"scripts.dmarcato":{d:[["M",-3.57,.03],["c",.03,0,.57,-.03,1.17,-.03],["c",1.05,0,1.08,0,1.17,.06],["c",.09,.06,.24,.36,1.17,2.4],["c",.57,1.29,1.05,2.34,1.08,2.34],["c",0,.03,.51,-1.02,1.08,-2.34],["c",.93,-2.07,1.08,-2.34,1.14,-2.4],["c",.06,-.03,.15,-.06,.18,-.06],["c",.15,0,.33,.18,.33,.33],["c",0,.09,-3.45,7.74,-3.54,7.83],["c",-.12,.12,-.3,.12,-.42,0],["c",-.09,-.09,-3.54,-7.74,-3.54,-7.83],["c",0,-.09,.12,-.27,.18,-.3],["z"]],w:7.5,h:8.25},"scripts.stopped":{d:[["M",-.27,-4.08],["c",.18,-.09,.36,-.09,.54,0],["c",.18,.09,.24,.15,.33,.3],["l",.06,.15],["l",0,1.5],["l",0,1.47],["l",1.47,0],["l",1.5,0],["l",.15,.06],["c",.15,.09,.21,.15,.3,.33],["c",.09,.18,.09,.36,0,.54],["c",-.09,.18,-.15,.24,-.33,.33],["c",-.12,.06,-.18,.06,-1.62,.06],["l",-1.47,0],["l",0,1.47],["l",0,1.47],["l",-.06,.15],["c",-.09,.18,-.15,.24,-.33,.33],["c",-.18,.09,-.36,.09,-.54,0],["c",-.18,-.09,-.24,-.15,-.33,-.33],["l",-.06,-.15],["l",0,-1.47],["l",0,-1.47],["l",-1.47,0],["c",-1.44,0,-1.5,0,-1.62,-.06],["c",-.18,-.09,-.24,-.15,-.33,-.33],["c",-.09,-.18,-.09,-.36,0,-.54],["c",.09,-.18,.15,-.24,.33,-.33],["l",.15,-.06],["l",1.47,0],["l",1.47,0],["l",0,-1.47],["c",0,-1.44,0,-1.5,.06,-1.62],["c",.09,-.18,.15,-.24,.33,-.33],["z"]],w:8.295,h:8.295},"scripts.upbow":{d:[["M",-4.65,-15.54],["c",.12,-.09,.36,-.06,.48,.03],["c",.03,.03,.09,.09,.12,.15],["c",.03,.06,.66,2.13,1.41,4.62],["c",1.35,4.41,1.38,4.56,2.01,6.96],["l",.63,2.46],["l",.63,-2.46],["c",.63,-2.4,.66,-2.55,2.01,-6.96],["c",.75,-2.49,1.38,-4.56,1.41,-4.62],["c",.06,-.15,.18,-.21,.36,-.24],["c",.15,0,.3,.06,.39,.18],["c",.15,.21,.24,-.18,-2.1,7.56],["c",-1.2,3.96,-2.22,7.32,-2.25,7.41],["c",0,.12,-.06,.27,-.09,.3],["c",-.12,.21,-.6,.21,-.72,0],["c",-.03,-.03,-.09,-.18,-.09,-.3],["c",-.03,-.09,-1.05,-3.45,-2.25,-7.41],["c",-2.34,-7.74,-2.25,-7.35,-2.1,-7.56],["c",.03,-.03,.09,-.09,.15,-.12],["z"]],w:9.73,h:15.608},"scripts.downbow":{d:[["M",-5.55,-9.93],["l",.09,-.06],["l",5.46,0],["l",5.46,0],["l",.09,.06],["l",.06,.09],["l",0,4.77],["c",0,5.28,0,4.89,-.18,5.01],["c",-.18,.12,-.42,.06,-.54,-.12],["c",-.06,-.09,-.06,-.18,-.06,-2.97],["l",0,-2.85],["l",-4.83,0],["l",-4.83,0],["l",0,2.85],["c",0,2.79,0,2.88,-.06,2.97],["c",-.15,.24,-.51,.24,-.66,0],["c",-.06,-.09,-.06,-.21,-.06,-4.89],["l",0,-4.77],["z"]],w:11.22,h:9.992},"scripts.turn":{d:[["M",-4.77,-3.9],["c",.36,-.06,1.05,-.06,1.44,.03],["c",.78,.15,1.5,.51,2.34,1.14],["c",.6,.45,1.05,.87,2.22,2.01],["c",1.11,1.08,1.62,1.5,2.22,1.86],["c",.6,.36,1.32,.57,1.92,.57],["c",.9,0,1.71,-.57,1.89,-1.35],["c",.24,-.93,-.39,-1.89,-1.35,-2.1],["l",-.15,-.06],["l",-.09,.15],["c",-.03,.09,-.15,.24,-.24,.33],["c",-.72,.72,-2.04,.54,-2.49,-.36],["c",-.48,-.93,.03,-1.86,1.17,-2.19],["c",.3,-.09,1.02,-.09,1.35,0],["c",.99,.27,1.74,.87,2.25,1.83],["c",.69,1.41,.63,3,-.21,4.26],["c",-.21,.3,-.69,.81,-.99,1.02],["c",-.3,.21,-.84,.45,-1.17,.54],["c",-1.23,.36,-2.49,.15,-3.72,-.6],["c",-.75,-.48,-1.41,-1.02,-2.85,-2.46],["c",-1.11,-1.08,-1.62,-1.5,-2.22,-1.86],["c",-.6,-.36,-1.32,-.57,-1.92,-.57],["c",-.9,0,-1.71,.57,-1.89,1.35],["c",-.24,.93,.39,1.89,1.35,2.1],["l",.15,.06],["l",.09,-.15],["c",.03,-.09,.15,-.24,.24,-.33],["c",.72,-.72,2.04,-.54,2.49,.36],["c",.48,.93,-.03,1.86,-1.17,2.19],["c",-.3,.09,-1.02,.09,-1.35,0],["c",-.99,-.27,-1.74,-.87,-2.25,-1.83],["c",-.69,-1.41,-.63,-3,.21,-4.26],["c",.21,-.3,.69,-.81,.99,-1.02],["c",.48,-.33,1.11,-.57,1.74,-.66],["z"]],w:16.366,h:7.893},"scripts.trill":{d:[["M",-.51,-16.02],["c",.12,-.09,.21,-.18,.21,-.18],["l",-.81,4.02],["l",-.81,4.02],["c",.03,0,.51,-.27,1.08,-.6],["c",.6,-.3,1.14,-.63,1.26,-.66],["c",1.14,-.54,2.31,-.6,3.09,-.18],["c",.27,.15,.54,.36,.6,.51],["l",.06,.12],["l",.21,-.21],["c",.9,-.81,2.22,-.99,3.12,-.42],["c",.6,.42,.9,1.14,.78,2.07],["c",-.15,1.29,-1.05,2.31,-1.95,2.25],["c",-.48,-.03,-.78,-.3,-.96,-.81],["c",-.09,-.27,-.09,-.9,-.03,-1.2],["c",.21,-.75,.81,-1.23,1.59,-1.32],["l",.24,-.03],["l",-.09,-.12],["c",-.51,-.66,-1.62,-.63,-2.31,.03],["c",-.39,.42,-.3,.09,-1.23,4.77],["l",-.81,4.14],["c",-.03,0,-.12,-.03,-.21,-.09],["c",-.33,-.15,-.54,-.18,-.99,-.18],["c",-.42,0,-.66,.03,-1.05,.18],["c",-.12,.06,-.21,.09,-.21,.09],["c",0,-.03,.36,-1.86,.81,-4.11],["c",.9,-4.47,.87,-4.26,.69,-4.53],["c",-.21,-.36,-.66,-.51,-1.17,-.36],["c",-.15,.06,-2.22,1.14,-2.58,1.38],["c",-.12,.09,-.12,.09,-.21,.6],["l",-.09,.51],["l",.21,.24],["c",.63,.75,1.02,1.47,1.2,2.19],["c",.06,.27,.06,.36,.06,.81],["c",0,.42,0,.54,-.06,.78],["c",-.15,.54,-.33,.93,-.63,1.35],["c",-.18,.24,-.57,.63,-.81,.78],["c",-.24,.15,-.63,.36,-.84,.42],["c",-.27,.06,-.66,.06,-.87,.03],["c",-.81,-.18,-1.32,-1.05,-1.38,-2.46],["c",-.03,-.6,.03,-.99,.33,-2.46],["c",.21,-1.08,.24,-1.32,.21,-1.29],["c",-1.2,.48,-2.4,.75,-3.21,.72],["c",-.69,-.06,-1.17,-.3,-1.41,-.72],["c",-.39,-.75,-.12,-1.8,.66,-2.46],["c",.24,-.18,.69,-.42,1.02,-.51],["c",.69,-.18,1.53,-.15,2.31,.09],["c",.3,.09,.75,.3,.99,.45],["c",.12,.09,.15,.09,.15,.03],["c",.03,-.03,.33,-1.59,.72,-3.45],["c",.36,-1.86,.66,-3.42,.69,-3.45],["c",0,-.03,.03,-.03,.21,.03],["c",.21,.06,.27,.06,.48,.06],["c",.42,-.03,.78,-.18,1.26,-.48],["c",.15,-.12,.36,-.27,.48,-.39],["z"],["m",-5.73,7.68],["c",-.27,-.03,-.96,-.06,-1.2,-.03],["c",-.81,.12,-1.35,.57,-1.5,1.2],["c",-.18,.66,.12,1.14,.75,1.29],["c",.66,.12,1.92,-.12,3.18,-.66],["l",.33,-.15],["l",.09,-.39],["c",.06,-.21,.09,-.42,.09,-.45],["c",0,-.03,-.45,-.3,-.75,-.45],["c",-.27,-.15,-.66,-.27,-.99,-.36],["z"],["m",4.29,3.63],["c",-.24,-.39,-.51,-.75,-.51,-.69],["c",-.06,.12,-.39,1.92,-.45,2.28],["c",-.09,.54,-.12,1.14,-.06,1.38],["c",.06,.42,.21,.6,.51,.57],["c",.39,-.06,.75,-.48,.93,-1.14],["c",.09,-.33,.09,-1.05,0,-1.38],["c",-.09,-.39,-.24,-.69,-.42,-1.02],["z"]],w:17.963,h:16.49},"scripts.segno":{d:[["M",-3.72,-11.22],["c",.78,-.09,1.59,.03,2.31,.42],["c",1.2,.6,2.01,1.71,2.31,3.09],["c",.09,.42,.09,1.2,.03,1.5],["c",-.15,.45,-.39,.81,-.66,.93],["c",-.33,.18,-.84,.21,-1.23,.15],["c",-.81,-.18,-1.32,-.93,-1.26,-1.89],["c",.03,-.36,.09,-.57,.24,-.9],["c",.15,-.33,.45,-.6,.72,-.75],["c",.12,-.06,.18,-.09,.18,-.12],["c",0,-.03,-.03,-.15,-.09,-.24],["c",-.18,-.45,-.54,-.87,-.96,-1.08],["c",-1.11,-.57,-2.34,-.18,-2.88,.9],["c",-.24,.51,-.33,1.11,-.24,1.83],["c",.27,1.92,1.5,3.54,3.93,5.13],["c",.48,.33,1.26,.78,1.29,.78],["c",.03,0,1.35,-2.19,2.94,-4.89],["l",2.88,-4.89],["l",.84,0],["l",.87,0],["l",-.03,.06],["c",-.15,.21,-6.15,10.41,-6.15,10.44],["c",0,0,.21,.15,.48,.27],["c",2.61,1.47,4.35,3.03,5.13,4.65],["c",1.14,2.34,.51,5.07,-1.44,6.39],["c",-.66,.42,-1.32,.63,-2.13,.69],["c",-2.01,.09,-3.81,-1.41,-4.26,-3.54],["c",-.09,-.42,-.09,-1.2,-.03,-1.5],["c",.15,-.45,.39,-.81,.66,-.93],["c",.33,-.18,.84,-.21,1.23,-.15],["c",.81,.18,1.32,.93,1.26,1.89],["c",-.03,.36,-.09,.57,-.24,.9],["c",-.15,.33,-.45,.6,-.72,.75],["c",-.12,.06,-.18,.09,-.18,.12],["c",0,.03,.03,.15,.09,.24],["c",.18,.45,.54,.87,.96,1.08],["c",1.11,.57,2.34,.18,2.88,-.9],["c",.24,-.51,.33,-1.11,.24,-1.83],["c",-.27,-1.92,-1.5,-3.54,-3.93,-5.13],["c",-.48,-.33,-1.26,-.78,-1.29,-.78],["c",-.03,0,-1.35,2.19,-2.91,4.89],["l",-2.88,4.89],["l",-.87,0],["l",-.87,0],["l",.03,-.06],["c",.15,-.21,6.15,-10.41,6.15,-10.44],["c",0,0,-.21,-.15,-.48,-.3],["c",-2.61,-1.44,-4.35,-3,-5.13,-4.62],["c",-.9,-1.89,-.72,-4.02,.48,-5.52],["c",.69,-.84,1.68,-1.41,2.73,-1.53],["z"],["m",8.76,9.09],["c",.03,-.03,.15,-.03,.27,-.03],["c",.33,.03,.57,.18,.72,.48],["c",.09,.18,.09,.57,0,.75],["c",-.09,.18,-.21,.3,-.36,.39],["c",-.15,.06,-.21,.06,-.39,.06],["c",-.21,0,-.27,0,-.39,-.06],["c",-.3,-.15,-.48,-.45,-.48,-.75],["c",0,-.39,.24,-.72,.63,-.84],["z"],["m",-10.53,2.61],["c",.03,-.03,.15,-.03,.27,-.03],["c",.33,.03,.57,.18,.72,.48],["c",.09,.18,.09,.57,0,.75],["c",-.09,.18,-.21,.3,-.36,.39],["c",-.15,.06,-.21,.06,-.39,.06],["c",-.21,0,-.27,0,-.39,-.06],["c",-.3,-.15,-.48,-.45,-.48,-.75],["c",0,-.39,.24,-.72,.63,-.84],["z"]],w:15,h:22.504},"scripts.coda":{d:[["M",-.21,-10.47],["c",.18,-.12,.42,-.06,.54,.12],["c",.06,.09,.06,.18,.06,1.5],["l",0,1.38],["l",.18,0],["c",.39,.06,.96,.24,1.38,.48],["c",1.68,.93,2.82,3.24,3.03,6.12],["c",.03,.24,.03,.45,.03,.45],["c",0,.03,.6,.03,1.35,.03],["c",1.5,0,1.47,0,1.59,.18],["c",.09,.12,.09,.3,0,.42],["c",-.12,.18,-.09,.18,-1.59,.18],["c",-.75,0,-1.35,0,-1.35,.03],["c",0,0,0,.21,-.03,.42],["c",-.24,3.15,-1.53,5.58,-3.45,6.36],["c",-.27,.12,-.72,.24,-.96,.27],["l",-.18,0],["l",0,1.38],["c",0,1.32,0,1.41,-.06,1.5],["c",-.15,.24,-.51,.24,-.66,0],["c",-.06,-.09,-.06,-.18,-.06,-1.5],["l",0,-1.38],["l",-.18,0],["c",-.39,-.06,-.96,-.24,-1.38,-.48],["c",-1.68,-.93,-2.82,-3.24,-3.03,-6.15],["c",-.03,-.21,-.03,-.42,-.03,-.42],["c",0,-.03,-.6,-.03,-1.35,-.03],["c",-1.5,0,-1.47,0,-1.59,-.18],["c",-.09,-.12,-.09,-.3,0,-.42],["c",.12,-.18,.09,-.18,1.59,-.18],["c",.75,0,1.35,0,1.35,-.03],["c",0,0,0,-.21,.03,-.45],["c",.24,-3.12,1.53,-5.55,3.45,-6.33],["c",.27,-.12,.72,-.24,.96,-.27],["l",.18,0],["l",0,-1.38],["c",0,-1.53,0,-1.5,.18,-1.62],["z"],["m",-.18,6.93],["c",0,-2.97,0,-3.15,-.06,-3.15],["c",-.09,0,-.51,.15,-.66,.21],["c",-.87,.51,-1.38,1.62,-1.56,3.51],["c",-.06,.54,-.12,1.59,-.12,2.16],["l",0,.42],["l",1.2,0],["l",1.2,0],["l",0,-3.15],["z"],["m",1.17,-3.06],["c",-.09,-.03,-.21,-.06,-.27,-.09],["l",-.12,0],["l",0,3.15],["l",0,3.15],["l",1.2,0],["l",1.2,0],["l",0,-.81],["c",-.06,-2.4,-.33,-3.69,-.93,-4.59],["c",-.27,-.39,-.66,-.69,-1.08,-.81],["z"],["m",-1.17,10.14],["l",0,-3.15],["l",-1.2,0],["l",-1.2,0],["l",0,.81],["c",.03,.96,.06,1.47,.15,2.13],["c",.24,2.04,.96,3.12,2.13,3.36],["l",.12,0],["l",0,-3.15],["z"],["m",3.18,-2.34],["l",0,-.81],["l",-1.2,0],["l",-1.2,0],["l",0,3.15],["l",0,3.15],["l",.12,0],["c",1.17,-.24,1.89,-1.32,2.13,-3.36],["c",.09,-.66,.12,-1.17,.15,-2.13],["z"]],w:16.035,h:21.062},"scripts.comma":{d:[["M",1.14,-4.62],["c",.3,-.12,.69,-.03,.93,.15],["c",.12,.12,.36,.45,.51,.78],["c",.9,1.77,.54,4.05,-1.08,6.75],["c",-.36,.63,-.87,1.38,-.96,1.44],["c",-.18,.12,-.42,.06,-.54,-.12],["c",-.09,-.18,-.09,-.3,.12,-.6],["c",.96,-1.44,1.44,-2.97,1.38,-4.35],["c",-.06,-.93,-.3,-1.68,-.78,-2.46],["c",-.27,-.39,-.33,-.63,-.24,-.96],["c",.09,-.27,.36,-.54,.66,-.63],["z"]],w:3.042,h:9.237},"scripts.roll":{d:[["M",1.95,-6],["c",.21,-.09,.36,-.09,.57,0],["c",.39,.15,.63,.39,1.47,1.35],["c",.66,.75,.78,.87,1.08,1.05],["c",.75,.45,1.65,.42,2.4,-.06],["c",.12,-.09,.27,-.27,.54,-.6],["c",.42,-.54,.51,-.63,.69,-.63],["c",.09,0,.3,.12,.36,.21],["c",.09,.12,.12,.3,.03,.42],["c",-.06,.12,-3.15,3.9,-3.3,4.08],["c",-.06,.06,-.18,.12,-.27,.18],["c",-.27,.12,-.6,.06,-.99,-.27],["c",-.27,-.21,-.42,-.39,-1.08,-1.14],["c",-.63,-.72,-.81,-.9,-1.17,-1.08],["c",-.36,-.18,-.57,-.21,-.99,-.21],["c",-.39,0,-.63,.03,-.93,.18],["c",-.36,.15,-.51,.27,-.9,.81],["c",-.24,.27,-.45,.51,-.48,.54],["c",-.12,.09,-.27,.06,-.39,0],["c",-.24,-.15,-.33,-.39,-.21,-.6],["c",.09,-.12,3.18,-3.87,3.33,-4.02],["c",.06,-.06,.18,-.15,.24,-.21],["z"]],w:10.817,h:6.125},"scripts.prall":{d:[["M",-4.38,-3.69],["c",.06,-.03,.18,-.06,.24,-.06],["c",.3,0,.27,-.03,1.89,1.95],["l",1.53,1.83],["c",.03,0,.57,-.84,1.23,-1.83],["c",1.14,-1.68,1.23,-1.83,1.35,-1.89],["c",.06,-.03,.18,-.06,.24,-.06],["c",.3,0,.27,-.03,1.89,1.95],["l",1.53,1.83],["l",.48,-.69],["c",.51,-.78,.54,-.84,.69,-.9],["c",.42,-.18,.87,.15,.81,.6],["c",-.03,.12,-.3,.51,-1.5,2.37],["c",-1.38,2.07,-1.5,2.22,-1.62,2.28],["c",-.06,.03,-.18,.06,-.24,.06],["c",-.3,0,-.27,.03,-1.89,-1.95],["l",-1.53,-1.83],["c",-.03,0,-.57,.84,-1.23,1.83],["c",-1.14,1.68,-1.23,1.83,-1.35,1.89],["c",-.06,.03,-.18,.06,-.24,.06],["c",-.3,0,-.27,.03,-1.89,-1.95],["l",-1.53,-1.83],["l",-.48,.69],["c",-.51,.78,-.54,.84,-.69,.9],["c",-.42,.18,-.87,-.15,-.81,-.6],["c",.03,-.12,.3,-.51,1.5,-2.37],["c",1.38,-2.07,1.5,-2.22,1.62,-2.28],["z"]],w:15.011,h:7.5},"scripts.arpeggio":{d:[["M",1.5,0],["c",1.5,2,1.5,3,1.5,3],["s",0,1,-2,1.5],["s",-.5,3,1,5.5],["l",1.5,0],["s",-1.75,-2,-1.9,-3.25],["s",2.15,-.6,2.95,-1.6],["s",.45,-1,.5,-1.25],["s",0,-1,-2,-3.9],["l",-1.5,0],["z"]],w:5,h:10},"scripts.mordent":{d:[["M",-.21,-4.95],["c",.27,-.15,.63,0,.75,.27],["c",.06,.12,.06,.24,.06,1.44],["l",0,1.29],["l",.57,-.84],["c",.51,-.75,.57,-.84,.69,-.9],["c",.06,-.03,.18,-.06,.24,-.06],["c",.3,0,.27,-.03,1.89,1.95],["l",1.53,1.83],["l",.48,-.69],["c",.51,-.78,.54,-.84,.69,-.9],["c",.42,-.18,.87,.15,.81,.6],["c",-.03,.12,-.3,.51,-1.5,2.37],["c",-1.38,2.07,-1.5,2.22,-1.62,2.28],["c",-.06,.03,-.18,.06,-.24,.06],["c",-.3,0,-.27,.03,-1.83,-1.89],["c",-.81,-.99,-1.5,-1.8,-1.53,-1.86],["c",-.06,-.03,-.06,-.03,-.12,.03],["c",-.06,.06,-.06,.15,-.06,2.28],["c",0,1.95,0,2.25,-.06,2.34],["c",-.18,.45,-.81,.48,-1.05,.03],["c",-.03,-.06,-.06,-.24,-.06,-1.41],["l",0,-1.35],["l",-.57,.84],["c",-.54,.78,-.6,.87,-.72,.93],["c",-.06,.03,-.18,.06,-.24,.06],["c",-.3,0,-.27,.03,-1.89,-1.95],["l",-1.53,-1.83],["l",-.48,.69],["c",-.51,.78,-.54,.84,-.69,.9],["c",-.42,.18,-.87,-.15,-.81,-.6],["c",.03,-.12,.3,-.51,1.5,-2.37],["c",1.38,-2.07,1.5,-2.22,1.62,-2.28],["c",.06,-.03,.18,-.06,.24,-.06],["c",.3,0,.27,-.03,1.89,1.95],["l",1.53,1.83],["c",.03,0,.06,-.06,.09,-.09],["c",.06,-.12,.06,-.15,.06,-2.28],["c",0,-1.92,0,-2.22,.06,-2.31],["c",.06,-.15,.15,-.24,.3,-.3],["z"]],w:15.011,h:10.012},"flags.u8th":{d:[["M",-.42,3.75],["l",0,-3.75],["l",.21,0],["l",.21,0],["l",0,.18],["c",0,.3,.06,.84,.12,1.23],["c",.24,1.53,.9,3.12,2.13,5.16],["l",.99,1.59],["c",.87,1.44,1.38,2.34,1.77,3.09],["c",.81,1.68,1.2,3.06,1.26,4.53],["c",.03,1.53,-.21,3.27,-.75,5.01],["c",-.21,.69,-.51,1.5,-.6,1.59],["c",-.09,.12,-.27,.21,-.42,.21],["c",-.15,0,-.42,-.12,-.51,-.21],["c",-.15,-.18,-.18,-.42,-.09,-.66],["c",.15,-.33,.45,-1.2,.57,-1.62],["c",.42,-1.38,.6,-2.58,.6,-3.9],["c",0,-.66,0,-.81,-.06,-1.11],["c",-.39,-2.07,-1.8,-4.26,-4.59,-7.14],["l",-.42,-.45],["l",-.21,0],["l",-.21,0],["l",0,-3.75],["z"]],w:6.692,h:22.59},"flags.u16th":{d:[["M",-.42,7.5],["l",0,-7.5],["l",.21,0],["l",.21,0],["l",0,.39],["c",.06,1.08,.39,2.19,.99,3.39],["c",.45,.9,.87,1.59,1.95,3.12],["c",1.29,1.86,1.77,2.64,2.22,3.57],["c",.45,.93,.72,1.8,.87,2.64],["c",.06,.51,.06,1.5,0,1.92],["c",-.12,.6,-.3,1.2,-.54,1.71],["l",-.09,.24],["l",.18,.45],["c",.51,1.2,.72,2.22,.69,3.42],["c",-.06,1.53,-.39,3.03,-.99,4.53],["c",-.3,.75,-.36,.81,-.57,.9],["c",-.15,.09,-.33,.06,-.48,0],["c",-.18,-.09,-.27,-.18,-.33,-.33],["c",-.09,-.18,-.06,-.3,.12,-.75],["c",.66,-1.41,1.02,-2.88,1.08,-4.32],["c",0,-.6,-.03,-1.05,-.18,-1.59],["c",-.3,-1.2,-.99,-2.4,-2.25,-3.87],["c",-.42,-.48,-1.53,-1.62,-2.19,-2.22],["l",-.45,-.42],["l",-.03,1.11],["l",0,1.11],["l",-.21,0],["l",-.21,0],["l",0,-7.5],["z"],["m",1.65,.09],["c",-.3,-.3,-.69,-.72,-.9,-.87],["l",-.33,-.33],["l",0,.15],["c",0,.3,.06,.81,.15,1.26],["c",.27,1.29,.87,2.61,2.04,4.29],["c",.15,.24,.6,.87,.96,1.38],["l",1.08,1.53],["l",.42,.63],["c",.03,0,.12,-.36,.21,-.72],["c",.06,-.33,.06,-1.2,0,-1.62],["c",-.33,-1.71,-1.44,-3.48,-3.63,-5.7],["z"]],w:6.693,h:26.337},"flags.u32nd":{d:[["M",-.42,11.25],["l",0,-11.25],["l",.21,0],["l",.21,0],["l",0,.36],["c",.09,1.68,.69,3.27,2.07,5.46],["l",.87,1.35],["c",1.02,1.62,1.47,2.37,1.86,3.18],["c",.48,1.02,.78,1.92,.93,2.88],["c",.06,.48,.06,1.5,0,1.89],["c",-.09,.42,-.21,.87,-.36,1.26],["l",-.12,.3],["l",.15,.39],["c",.69,1.56,.84,2.88,.54,4.38],["c",-.09,.45,-.27,1.08,-.45,1.47],["l",-.12,.24],["l",.18,.36],["c",.33,.72,.57,1.56,.69,2.34],["c",.12,1.02,-.06,2.52,-.42,3.84],["c",-.27,.93,-.75,2.13,-.93,2.31],["c",-.18,.15,-.45,.18,-.66,.09],["c",-.18,-.09,-.27,-.18,-.33,-.33],["c",-.09,-.18,-.06,-.3,.06,-.6],["c",.21,-.36,.42,-.9,.57,-1.38],["c",.51,-1.41,.69,-3.06,.48,-4.08],["c",-.15,-.81,-.57,-1.68,-1.2,-2.55],["c",-.72,-.99,-1.83,-2.13,-3.3,-3.33],["l",-.48,-.42],["l",-.03,1.53],["l",0,1.56],["l",-.21,0],["l",-.21,0],["l",0,-11.25],["z"],["m",1.26,-3.96],["c",-.27,-.3,-.54,-.6,-.66,-.72],["l",-.18,-.21],["l",0,.42],["c",.06,.87,.24,1.74,.66,2.67],["c",.36,.87,.96,1.86,1.92,3.18],["c",.21,.33,.63,.87,.87,1.23],["c",.27,.39,.6,.84,.75,1.08],["l",.27,.39],["l",.03,-.12],["c",.12,-.45,.15,-1.05,.09,-1.59],["c",-.27,-1.86,-1.38,-3.78,-3.75,-6.33],["z"],["m",-.27,6.09],["c",-.27,-.21,-.48,-.42,-.51,-.45],["c",-.06,-.03,-.06,-.03,-.06,.21],["c",0,.9,.3,2.04,.81,3.09],["c",.48,1.02,.96,1.77,2.37,3.63],["c",.6,.78,1.05,1.44,1.29,1.77],["c",.06,.12,.15,.21,.15,.18],["c",.03,-.03,.18,-.57,.24,-.87],["c",.06,-.45,.06,-1.32,-.03,-1.74],["c",-.09,-.48,-.24,-.9,-.51,-1.44],["c",-.66,-1.35,-1.83,-2.7,-3.75,-4.38],["z"]],w:6.697,h:32.145},"flags.u64th":{d:[["M",-.42,15],["l",0,-15],["l",.21,0],["l",.21,0],["l",0,.36],["c",.06,1.2,.39,2.37,1.02,3.66],["c",.39,.81,.84,1.56,1.8,3.09],["c",.81,1.26,1.05,1.68,1.35,2.22],["c",.87,1.5,1.35,2.79,1.56,4.08],["c",.06,.54,.06,1.56,-.03,2.04],["c",-.09,.48,-.21,.99,-.36,1.35],["l",-.12,.27],["l",.12,.27],["c",.09,.15,.21,.45,.27,.66],["c",.69,1.89,.63,3.66,-.18,5.46],["l",-.18,.39],["l",.15,.33],["c",.3,.66,.51,1.44,.63,2.1],["c",.06,.48,.06,1.35,0,1.71],["c",-.15,.57,-.42,1.2,-.78,1.68],["l",-.21,.27],["l",.18,.33],["c",.57,1.05,.93,2.13,1.02,3.18],["c",.06,.72,0,1.83,-.21,2.79],["c",-.18,1.02,-.63,2.34,-1.02,3.09],["c",-.15,.33,-.48,.45,-.78,.3],["c",-.18,-.09,-.27,-.18,-.33,-.33],["c",-.09,-.18,-.06,-.3,.03,-.54],["c",.75,-1.5,1.23,-3.45,1.17,-4.89],["c",-.06,-1.02,-.42,-2.01,-1.17,-3.15],["c",-.48,-.72,-1.02,-1.35,-1.89,-2.22],["c",-.57,-.57,-1.56,-1.5,-1.92,-1.77],["l",-.12,-.09],["l",0,1.68],["l",0,1.68],["l",-.21,0],["l",-.21,0],["l",0,-15],["z"],["m",.93,-8.07],["c",-.27,-.3,-.48,-.54,-.51,-.54],["c",0,0,0,.69,.03,1.02],["c",.15,1.47,.75,2.94,2.04,4.83],["l",1.08,1.53],["c",.39,.57,.84,1.2,.99,1.44],["c",.15,.24,.3,.45,.3,.45],["c",0,0,.03,-.09,.06,-.21],["c",.36,-1.59,-.15,-3.33,-1.47,-5.4],["c",-.63,-.93,-1.35,-1.83,-2.52,-3.12],["z"],["m",.06,6.72],["c",-.24,-.21,-.48,-.42,-.51,-.45],["l",-.06,-.06],["l",0,.33],["c",0,1.2,.3,2.34,.93,3.6],["c",.45,.9,.96,1.68,2.25,3.51],["c",.39,.54,.84,1.17,1.02,1.44],["c",.21,.33,.33,.51,.33,.48],["c",.06,-.09,.21,-.63,.3,-.99],["c",.06,-.33,.06,-.45,.06,-.96],["c",0,-.6,-.03,-.84,-.18,-1.35],["c",-.3,-1.08,-1.02,-2.28,-2.13,-3.57],["c",-.39,-.45,-1.44,-1.47,-2.01,-1.98],["z"],["m",0,6.72],["c",-.24,-.21,-.48,-.39,-.51,-.42],["l",-.06,-.06],["l",0,.33],["c",0,1.41,.45,2.82,1.38,4.35],["c",.42,.72,.72,1.14,1.86,2.73],["c",.36,.45,.75,.99,.87,1.2],["c",.15,.21,.3,.36,.3,.36],["c",.06,0,.3,-.48,.39,-.75],["c",.09,-.36,.12,-.63,.12,-1.05],["c",-.06,-1.05,-.45,-2.04,-1.2,-3.18],["c",-.57,-.87,-1.11,-1.53,-2.07,-2.49],["c",-.36,-.33,-.84,-.78,-1.08,-1.02],["z"]],w:6.682,h:39.694},"flags.d8th":{d:[["M",5.67,-21.63],["c",.24,-.12,.54,-.06,.69,.15],["c",.06,.06,.21,.36,.39,.66],["c",.84,1.77,1.26,3.36,1.32,5.1],["c",.03,1.29,-.21,2.37,-.81,3.63],["c",-.6,1.23,-1.26,2.13,-3.21,4.38],["c",-1.35,1.53,-1.86,2.19,-2.4,2.97],["c",-.63,.93,-1.11,1.92,-1.38,2.79],["c",-.15,.54,-.27,1.35,-.27,1.8],["l",0,.15],["l",-.21,0],["l",-.21,0],["l",0,-3.75],["l",0,-3.75],["l",.21,0],["l",.21,0],["l",.48,-.3],["c",1.83,-1.11,3.12,-2.1,4.17,-3.12],["c",.78,-.81,1.32,-1.53,1.71,-2.31],["c",.45,-.93,.6,-1.74,.51,-2.88],["c",-.12,-1.56,-.63,-3.18,-1.47,-4.68],["c",-.12,-.21,-.15,-.33,-.06,-.51],["c",.06,-.15,.15,-.24,.33,-.33],["z"]],w:8.492,h:21.691},"flags.ugrace":{d:[["M",6.03,6.93],["c",.15,-.09,.33,-.06,.51,0],["c",.15,.09,.21,.15,.3,.33],["c",.09,.18,.06,.39,-.03,.54],["c",-.06,.15,-10.89,8.88,-11.07,8.97],["c",-.15,.09,-.33,.06,-.48,0],["c",-.18,-.09,-.24,-.15,-.33,-.33],["c",-.09,-.18,-.06,-.39,.03,-.54],["c",.06,-.15,10.89,-8.88,11.07,-8.97],["z"]],w:12.019,h:9.954},"flags.dgrace":{d:[["M",-6.06,-15.93],["c",.18,-.09,.33,-.12,.48,-.06],["c",.18,.09,14.01,8.04,14.1,8.1],["c",.12,.12,.18,.33,.18,.51],["c",-.03,.21,-.15,.39,-.36,.48],["c",-.18,.09,-.33,.12,-.48,.06],["c",-.18,-.09,-14.01,-8.04,-14.1,-8.1],["c",-.12,-.12,-.18,-.33,-.18,-.51],["c",.03,-.21,.15,-.39,.36,-.48],["z"]],w:15.12,h:9.212},"flags.d16th":{d:[["M",6.84,-22.53],["c",.27,-.12,.57,-.06,.72,.15],["c",.15,.15,.33,.87,.45,1.56],["c",.06,.33,.06,1.35,0,1.65],["c",-.06,.33,-.15,.78,-.27,1.11],["c",-.12,.33,-.45,.96,-.66,1.32],["l",-.18,.27],["l",.09,.18],["c",.48,1.02,.72,2.25,.69,3.3],["c",-.06,1.23,-.42,2.28,-1.26,3.45],["c",-.57,.87,-.99,1.32,-3,3.39],["c",-1.56,1.56,-2.22,2.4,-2.76,3.45],["c",-.42,.84,-.66,1.8,-.66,2.55],["l",0,.15],["l",-.21,0],["l",-.21,0],["l",0,-7.5],["l",0,-7.5],["l",.21,0],["l",.21,0],["l",0,1.14],["l",0,1.11],["l",.27,-.15],["c",1.11,-.57,1.77,-.99,2.52,-1.47],["c",2.37,-1.56,3.69,-3.15,4.05,-4.83],["c",.03,-.18,.03,-.39,.03,-.78],["c",0,-.6,-.03,-.93,-.24,-1.5],["c",-.06,-.18,-.12,-.39,-.15,-.45],["c",-.03,-.24,.12,-.48,.36,-.6],["z"],["m",-.63,7.5],["c",-.06,-.18,-.15,-.36,-.15,-.36],["c",-.03,0,-.03,.03,-.06,.06],["c",-.06,.12,-.96,1.02,-1.95,1.98],["c",-.63,.57,-1.26,1.17,-1.44,1.35],["c",-1.53,1.62,-2.28,2.85,-2.55,4.32],["c",-.03,.18,-.03,.54,-.06,.99],["l",0,.69],["l",.18,-.09],["c",.93,-.54,2.1,-1.29,2.82,-1.83],["c",.69,-.51,1.02,-.81,1.53,-1.29],["c",1.86,-1.89,2.37,-3.66,1.68,-5.82],["z"]],w:8.475,h:22.591},"flags.d32nd":{d:[["M",6.84,-29.13],["c",.27,-.12,.57,-.06,.72,.15],["c",.12,.12,.27,.63,.36,1.11],["c",.33,1.59,.06,3.06,-.81,4.47],["l",-.18,.27],["l",.09,.15],["c",.12,.24,.33,.69,.45,1.05],["c",.63,1.83,.45,3.57,-.57,5.22],["l",-.18,.3],["l",.15,.27],["c",.42,.87,.6,1.71,.57,2.61],["c",-.06,1.29,-.48,2.46,-1.35,3.78],["c",-.54,.81,-.93,1.29,-2.46,3],["c",-.51,.54,-1.05,1.17,-1.26,1.41],["c",-1.56,1.86,-2.25,3.36,-2.37,5.01],["l",0,.33],["l",-.21,0],["l",-.21,0],["l",0,-11.25],["l",0,-11.25],["l",.21,0],["l",.21,0],["l",0,1.35],["l",.03,1.35],["l",.78,-.39],["c",1.38,-.69,2.34,-1.26,3.24,-1.92],["c",1.38,-1.02,2.28,-2.13,2.64,-3.21],["c",.15,-.48,.18,-.72,.18,-1.29],["c",0,-.57,-.06,-.9,-.24,-1.47],["c",-.06,-.18,-.12,-.39,-.15,-.45],["c",-.03,-.24,.12,-.48,.36,-.6],["z"],["m",-.63,7.2],["c",-.09,-.18,-.12,-.21,-.12,-.15],["c",-.03,.09,-1.02,1.08,-2.04,2.04],["c",-1.17,1.08,-1.65,1.56,-2.07,2.04],["c",-.84,.96,-1.38,1.86,-1.68,2.76],["c",-.21,.57,-.27,.99,-.3,1.65],["l",0,.54],["l",.66,-.33],["c",3.57,-1.86,5.49,-3.69,5.94,-5.7],["c",.06,-.39,.06,-1.2,-.03,-1.65],["c",-.06,-.39,-.24,-.9,-.36,-1.2],["z"],["m",-.06,7.2],["c",-.06,-.15,-.12,-.33,-.15,-.45],["l",-.06,-.18],["l",-.18,.21],["l",-1.83,1.83],["c",-.87,.9,-1.77,1.8,-1.95,2.01],["c",-1.08,1.29,-1.62,2.31,-1.89,3.51],["c",-.06,.3,-.06,.51,-.09,.93],["l",0,.57],["l",.09,-.06],["c",.75,-.45,1.89,-1.26,2.52,-1.74],["c",.81,-.66,1.74,-1.53,2.22,-2.16],["c",1.26,-1.53,1.68,-3.06,1.32,-4.47],["z"]],w:8.385,h:29.191},"flags.d64th":{d:[["M",7.08,-32.88],["c",.3,-.12,.66,-.03,.78,.24],["c",.18,.33,.27,2.1,.15,2.64],["c",-.09,.39,-.21,.78,-.39,1.08],["l",-.15,.3],["l",.09,.27],["c",.03,.12,.09,.45,.12,.69],["c",.27,1.44,.18,2.55,-.3,3.6],["l",-.12,.33],["l",.06,.42],["c",.27,1.35,.33,2.82,.21,3.63],["c",-.12,.6,-.3,1.23,-.57,1.8],["l",-.15,.27],["l",.03,.42],["c",.06,1.02,.06,2.7,.03,3.06],["c",-.15,1.47,-.66,2.76,-1.74,4.41],["c",-.45,.69,-.75,1.11,-1.74,2.37],["c",-1.05,1.38,-1.5,1.98,-1.95,2.73],["c",-.93,1.5,-1.38,2.82,-1.44,4.2],["l",0,.42],["l",-.21,0],["l",-.21,0],["l",0,-15],["l",0,-15],["l",.21,0],["l",.21,0],["l",0,1.86],["l",0,1.89],["c",0,0,.21,-.03,.45,-.09],["c",2.22,-.39,4.08,-1.11,5.19,-2.01],["c",.63,-.54,1.02,-1.14,1.2,-1.8],["c",.06,-.3,.06,-1.14,-.03,-1.65],["c",-.03,-.18,-.06,-.39,-.09,-.48],["c",-.03,-.24,.12,-.48,.36,-.6],["z"],["m",-.45,6.15],["c",-.03,-.18,-.06,-.42,-.06,-.54],["l",-.03,-.18],["l",-.33,.3],["c",-.42,.36,-.87,.72,-1.68,1.29],["c",-1.98,1.38,-2.25,1.59,-2.85,2.16],["c",-.75,.69,-1.23,1.44,-1.47,2.19],["c",-.15,.45,-.18,.63,-.21,1.35],["l",0,.66],["l",.39,-.18],["c",1.83,-.9,3.45,-1.95,4.47,-2.91],["c",.93,-.9,1.53,-1.83,1.74,-2.82],["c",.06,-.33,.06,-.87,.03,-1.32],["z"],["m",-.27,4.86],["c",-.03,-.21,-.06,-.36,-.06,-.36],["c",0,-.03,-.12,.09,-.24,.24],["c",-.39,.48,-.99,1.08,-2.16,2.19],["c",-1.47,1.38,-1.92,1.83,-2.46,2.49],["c",-.66,.87,-1.08,1.74,-1.29,2.58],["c",-.09,.42,-.15,.87,-.15,1.44],["l",0,.54],["l",.48,-.33],["c",1.5,-1.02,2.58,-1.89,3.51,-2.82],["c",1.47,-1.47,2.25,-2.85,2.4,-4.26],["c",.03,-.39,.03,-1.17,-.03,-1.71],["z"],["m",-.66,7.68],["c",.03,-.15,.03,-.6,.03,-.99],["l",0,-.72],["l",-.27,.33],["l",-1.74,1.98],["c",-1.77,1.92,-2.43,2.76,-2.97,3.9],["c",-.51,1.02,-.72,1.77,-.75,2.91],["c",0,.63,0,.63,.06,.6],["c",.03,-.03,.3,-.27,.63,-.54],["c",.66,-.6,1.86,-1.8,2.31,-2.31],["c",1.65,-1.89,2.52,-3.54,2.7,-5.16],["z"]],w:8.485,h:32.932},"clefs.C":{d:[["M",.06,-14.94],["l",.09,-.06],["l",1.92,0],["l",1.92,0],["l",.09,.06],["l",.06,.09],["l",0,14.85],["l",0,14.82],["l",-.06,.09],["l",-.09,.06],["l",-1.92,0],["l",-1.92,0],["l",-.09,-.06],["l",-.06,-.09],["l",0,-14.82],["l",0,-14.85],["z"],["m",5.37,0],["c",.09,-.06,.09,-.06,.57,-.06],["c",.45,0,.45,0,.54,.06],["l",.06,.09],["l",0,7.14],["l",0,7.11],["l",.09,-.06],["c",.18,-.18,.72,-.84,.96,-1.2],["c",.3,-.45,.66,-1.17,.84,-1.65],["c",.36,-.9,.57,-1.83,.6,-2.79],["c",.03,-.48,.03,-.54,.09,-.63],["c",.12,-.18,.36,-.21,.54,-.12],["c",.18,.09,.21,.15,.24,.66],["c",.06,.87,.21,1.56,.57,2.22],["c",.51,1.02,1.26,1.68,2.22,1.92],["c",.21,.06,.33,.06,.78,.06],["c",.45,0,.57,0,.84,-.06],["c",.45,-.12,.81,-.33,1.08,-.6],["c",.57,-.57,.87,-1.41,.99,-2.88],["c",.06,-.54,.06,-3,0,-3.57],["c",-.21,-2.58,-.84,-3.87,-2.16,-4.5],["c",-.48,-.21,-1.17,-.36,-1.77,-.36],["c",-.69,0,-1.29,.27,-1.5,.72],["c",-.06,.15,-.06,.21,-.06,.42],["c",0,.24,0,.3,.06,.45],["c",.12,.24,.24,.39,.63,.66],["c",.42,.3,.57,.48,.69,.72],["c",.06,.15,.06,.21,.06,.48],["c",0,.39,-.03,.63,-.21,.96],["c",-.3,.6,-.87,1.08,-1.5,1.26],["c",-.27,.06,-.87,.06,-1.14,0],["c",-.78,-.24,-1.44,-.87,-1.65,-1.68],["c",-.12,-.42,-.09,-1.17,.09,-1.71],["c",.51,-1.65,1.98,-2.82,3.81,-3.09],["c",.84,-.09,2.46,.03,3.51,.27],["c",2.22,.57,3.69,1.8,4.44,3.75],["c",.36,.93,.57,2.13,.57,3.36],["c",0,1.44,-.48,2.73,-1.38,3.81],["c",-1.26,1.5,-3.27,2.43,-5.28,2.43],["c",-.48,0,-.51,0,-.75,-.09],["c",-.15,-.03,-.48,-.21,-.78,-.36],["c",-.69,-.36,-.87,-.42,-1.26,-.42],["c",-.27,0,-.3,0,-.51,.09],["c",-.57,.3,-.81,.9,-.81,2.1],["c",0,1.23,.24,1.83,.81,2.13],["c",.21,.09,.24,.09,.51,.09],["c",.39,0,.57,-.06,1.26,-.42],["c",.3,-.15,.63,-.33,.78,-.36],["c",.24,-.09,.27,-.09,.75,-.09],["c",2.01,0,4.02,.93,5.28,2.4],["c",.9,1.11,1.38,2.4,1.38,3.84],["c",0,1.5,-.3,2.88,-.84,3.96],["c",-.78,1.59,-2.19,2.64,-4.17,3.15],["c",-1.05,.24,-2.67,.36,-3.51,.27],["c",-1.83,-.27,-3.3,-1.44,-3.81,-3.09],["c",-.18,-.54,-.21,-1.29,-.09,-1.74],["c",.15,-.6,.63,-1.2,1.23,-1.47],["c",.36,-.18,.57,-.21,.99,-.21],["c",.42,0,.63,.03,1.02,.21],["c",.42,.21,.84,.63,1.05,1.05],["c",.18,.36,.21,.6,.21,.96],["c",0,.3,0,.36,-.06,.51],["c",-.12,.24,-.27,.42,-.69,.72],["c",-.57,.42,-.69,.63,-.69,1.08],["c",0,.24,0,.3,.06,.45],["c",.12,.21,.3,.39,.57,.54],["c",.42,.18,.87,.21,1.53,.15],["c",1.08,-.15,1.8,-.57,2.34,-1.32],["c",.54,-.75,.84,-1.83,.99,-3.51],["c",.06,-.57,.06,-3.03,0,-3.57],["c",-.12,-1.47,-.42,-2.31,-.99,-2.88],["c",-.27,-.27,-.63,-.48,-1.08,-.6],["c",-.27,-.06,-.39,-.06,-.84,-.06],["c",-.45,0,-.57,0,-.78,.06],["c",-1.14,.27,-2.01,1.17,-2.46,2.49],["c",-.21,.57,-.3,.99,-.33,1.65],["c",-.03,.51,-.06,.57,-.24,.66],["c",-.12,.06,-.27,.06,-.39,0],["c",-.21,-.09,-.21,-.15,-.24,-.75],["c",-.09,-1.92,-.78,-3.72,-2.01,-5.19],["c",-.18,-.21,-.36,-.42,-.39,-.45],["l",-.09,-.06],["l",0,7.11],["l",0,7.14],["l",-.06,.09],["c",-.09,.06,-.09,.06,-.54,.06],["c",-.48,0,-.48,0,-.57,-.06],["l",-.06,-.09],["l",0,-14.82],["l",0,-14.85],["z"]],w:20.31,h:29.97},"clefs.F":{d:[["M",6.3,-7.8],["c",.36,-.03,1.65,0,2.13,.03],["c",3.6,.42,6.03,2.1,6.93,4.86],["c",.27,.84,.36,1.5,.36,2.58],["c",0,.9,-.03,1.35,-.18,2.16],["c",-.78,3.78,-3.54,7.08,-8.37,9.96],["c",-1.74,1.05,-3.87,2.13,-6.18,3.12],["c",-.39,.18,-.75,.33,-.81,.36],["c",-.06,.03,-.15,.06,-.18,.06],["c",-.15,0,-.33,-.18,-.33,-.33],["c",0,-.15,.06,-.21,.51,-.48],["c",3,-1.77,5.13,-3.21,6.84,-4.74],["c",.51,-.45,1.59,-1.5,1.95,-1.95],["c",1.89,-2.19,2.88,-4.32,3.15,-6.78],["c",.06,-.42,.06,-1.77,0,-2.19],["c",-.24,-2.01,-.93,-3.63,-2.04,-4.71],["c",-.63,-.63,-1.29,-1.02,-2.07,-1.2],["c",-1.62,-.39,-3.36,.15,-4.56,1.44],["c",-.54,.6,-1.05,1.47,-1.32,2.22],["l",-.09,.21],["l",.24,-.12],["c",.39,-.21,.63,-.24,1.11,-.24],["c",.3,0,.45,0,.66,.06],["c",1.92,.48,2.85,2.55,1.95,4.38],["c",-.45,.99,-1.41,1.62,-2.46,1.71],["c",-1.47,.09,-2.91,-.87,-3.39,-2.25],["c",-.18,-.57,-.21,-1.32,-.03,-2.28],["c",.39,-2.25,1.83,-4.2,3.81,-5.19],["c",.69,-.36,1.59,-.6,2.37,-.69],["z"],["m",11.58,2.52],["c",.84,-.21,1.71,.3,1.89,1.14],["c",.3,1.17,-.72,2.19,-1.89,1.89],["c",-.99,-.21,-1.5,-1.32,-1.02,-2.25],["c",.18,-.39,.6,-.69,1.02,-.78],["z"],["m",0,7.5],["c",.84,-.21,1.71,.3,1.89,1.14],["c",.21,.87,-.3,1.71,-1.14,1.89],["c",-.87,.21,-1.71,-.3,-1.89,-1.14],["c",-.21,-.84,.3,-1.71,1.14,-1.89],["z"]],w:20.153,h:23.142},"clefs.G":{d:[["M",9.69,-37.41],["c",.09,-.09,.24,-.06,.36,0],["c",.12,.09,.57,.6,.96,1.11],["c",1.77,2.34,3.21,5.85,3.57,8.73],["c",.21,1.56,.03,3.27,-.45,4.86],["c",-.69,2.31,-1.92,4.47,-4.23,7.44],["c",-.3,.39,-.57,.72,-.6,.75],["c",-.03,.06,0,.15,.18,.78],["c",.54,1.68,1.38,4.44,1.68,5.49],["l",.09,.42],["l",.39,0],["c",1.47,.09,2.76,.51,3.96,1.29],["c",1.83,1.23,3.06,3.21,3.39,5.52],["c",.09,.45,.12,1.29,.06,1.74],["c",-.09,1.02,-.33,1.83,-.75,2.73],["c",-.84,1.71,-2.28,3.06,-4.02,3.72],["l",-.33,.12],["l",.03,1.26],["c",0,1.74,-.06,3.63,-.21,4.62],["c",-.45,3.06,-2.19,5.49,-4.47,6.21],["c",-.57,.18,-.9,.21,-1.59,.21],["c",-.69,0,-1.02,-.03,-1.65,-.21],["c",-1.14,-.27,-2.13,-.84,-2.94,-1.65],["c",-.99,-.99,-1.56,-2.16,-1.71,-3.54],["c",-.09,-.81,.06,-1.53,.45,-2.13],["c",.63,-.99,1.83,-1.56,3,-1.53],["c",1.5,.09,2.64,1.32,2.73,2.94],["c",.06,1.47,-.93,2.7,-2.37,2.97],["c",-.45,.06,-.84,.03,-1.29,-.09],["l",-.21,-.09],["l",.09,.12],["c",.39,.54,.78,.93,1.32,1.26],["c",1.35,.87,3.06,1.02,4.35,.36],["c",1.44,-.72,2.52,-2.28,2.97,-4.35],["c",.15,-.66,.24,-1.5,.3,-3.03],["c",.03,-.84,.03,-2.94,0,-3],["c",-.03,0,-.18,0,-.36,.03],["c",-.66,.12,-.99,.12,-1.83,.12],["c",-1.05,0,-1.71,-.06,-2.61,-.3],["c",-4.02,-.99,-7.11,-4.35,-7.8,-8.46],["c",-.12,-.66,-.12,-.99,-.12,-1.83],["c",0,-.84,0,-1.14,.15,-1.92],["c",.36,-2.28,1.41,-4.62,3.3,-7.29],["l",2.79,-3.6],["c",.54,-.66,.96,-1.2,.96,-1.23],["c",0,-.03,-.09,-.33,-.18,-.69],["c",-.96,-3.21,-1.41,-5.28,-1.59,-7.68],["c",-.12,-1.38,-.15,-3.09,-.06,-3.96],["c",.33,-2.67,1.38,-5.07,3.12,-7.08],["c",.36,-.42,.99,-1.05,1.17,-1.14],["z"],["m",2.01,4.71],["c",-.15,-.3,-.3,-.54,-.3,-.54],["c",-.03,0,-.18,.09,-.3,.21],["c",-2.4,1.74,-3.87,4.2,-4.26,7.11],["c",-.06,.54,-.06,1.41,-.03,1.89],["c",.09,1.29,.48,3.12,1.08,5.22],["c",.15,.42,.24,.78,.24,.81],["c",0,.03,.84,-1.11,1.23,-1.68],["c",1.89,-2.73,2.88,-5.07,3.15,-7.53],["c",.09,-.57,.12,-1.74,.06,-2.37],["c",-.09,-1.23,-.27,-1.92,-.87,-3.12],["z"],["m",-2.94,20.7],["c",-.21,-.72,-.39,-1.32,-.42,-1.32],["c",0,0,-1.2,1.47,-1.86,2.37],["c",-2.79,3.63,-4.02,6.3,-4.35,9.3],["c",-.03,.21,-.03,.69,-.03,1.08],["c",0,.69,0,.75,.06,1.11],["c",.12,.54,.27,.99,.51,1.47],["c",.69,1.38,1.83,2.55,3.42,3.42],["c",.96,.54,2.07,.9,3.21,1.08],["c",.78,.12,2.04,.12,2.94,-.03],["c",.51,-.06,.45,-.03,.42,-.3],["c",-.24,-3.33,-.72,-6.33,-1.62,-10.08],["c",-.09,-.39,-.18,-.75,-.18,-.78],["c",-.03,-.03,-.42,0,-.81,.09],["c",-.9,.18,-1.65,.57,-2.22,1.14],["c",-.72,.72,-1.08,1.65,-1.05,2.64],["c",.06,.96,.48,1.83,1.23,2.58],["c",.36,.36,.72,.63,1.17,.9],["c",.33,.18,.36,.21,.42,.33],["c",.18,.42,-.18,.9,-.6,.87],["c",-.18,-.03,-.84,-.36,-1.26,-.63],["c",-.78,-.51,-1.38,-1.11,-1.86,-1.83],["c",-1.77,-2.7,-.99,-6.42,1.71,-8.19],["c",.3,-.21,.81,-.48,1.17,-.63],["c",.3,-.09,1.02,-.3,1.14,-.3],["c",.06,0,.09,0,.09,-.03],["c",.03,-.03,-.51,-1.92,-1.23,-4.26],["z"],["m",3.78,7.41],["c",-.18,-.03,-.36,-.06,-.39,-.06],["c",-.03,0,0,.21,.18,1.02],["c",.75,3.18,1.26,6.3,1.5,9.09],["c",.06,.72,0,.69,.51,.42],["c",.78,-.36,1.44,-.96,1.98,-1.77],["c",1.08,-1.62,1.2,-3.69,.3,-5.55],["c",-.81,-1.62,-2.31,-2.79,-4.08,-3.15],["z"]],w:19.051,h:57.057},"clefs.perc":{d:[["M",5.07,-7.44],["l",.09,-.06],["l",1.53,0],["l",1.53,0],["l",.09,.06],["l",.06,.09],["l",0,7.35],["l",0,7.32],["l",-.06,.09],["l",-.09,.06],["l",-1.53,0],["l",-1.53,0],["l",-.09,-.06],["l",-.06,-.09],["l",0,-7.32],["l",0,-7.35],["z"],["m",6.63,0],["l",.09,-.06],["l",1.53,0],["l",1.53,0],["l",.09,.06],["l",.06,.09],["l",0,7.35],["l",0,7.32],["l",-.06,.09],["l",-.09,.06],["l",-1.53,0],["l",-1.53,0],["l",-.09,-.06],["l",-.06,-.09],["l",0,-7.32],["l",0,-7.35],["z"]],w:9.99,h:14.97},"timesig.common":{d:[["M",6.66,-7.83],["c",.72,-.06,1.41,-.03,1.98,.09],["c",1.2,.27,2.34,.96,3.09,1.92],["c",.63,.81,1.08,1.86,1.14,2.73],["c",.06,1.02,-.51,1.92,-1.44,2.22],["c",-.24,.09,-.3,.09,-.63,.09],["c",-.33,0,-.42,0,-.63,-.06],["c",-.66,-.24,-1.14,-.63,-1.41,-1.2],["c",-.15,-.3,-.21,-.51,-.24,-.9],["c",-.06,-1.08,.57,-2.04,1.56,-2.37],["c",.18,-.06,.27,-.06,.63,-.06],["l",.45,0],["c",.06,.03,.09,.03,.09,0],["c",0,0,-.09,-.12,-.24,-.27],["c",-1.02,-1.11,-2.55,-1.68,-4.08,-1.5],["c",-1.29,.15,-2.04,.69,-2.4,1.74],["c",-.36,.93,-.42,1.89,-.42,5.37],["c",0,2.97,.06,3.96,.24,4.77],["c",.24,1.08,.63,1.68,1.41,2.07],["c",.81,.39,2.16,.45,3.18,.09],["c",1.29,-.45,2.37,-1.53,3.03,-2.97],["c",.15,-.33,.33,-.87,.39,-1.17],["c",.09,-.24,.15,-.36,.3,-.39],["c",.21,-.03,.42,.15,.39,.36],["c",-.06,.39,-.42,1.38,-.69,1.89],["c",-.96,1.8,-2.49,2.94,-4.23,3.18],["c",-.99,.12,-2.58,-.06,-3.63,-.45],["c",-.96,-.36,-1.71,-.84,-2.4,-1.5],["c",-1.11,-1.11,-1.8,-2.61,-2.04,-4.56],["c",-.06,-.6,-.06,-2.01,0,-2.61],["c",.24,-1.95,.9,-3.45,2.01,-4.56],["c",.69,-.66,1.44,-1.11,2.37,-1.47],["c",.63,-.24,1.47,-.42,2.22,-.48],["z"]],w:13.038,h:15.689},"timesig.cut":{d:[["M",6.24,-10.44],["c",.09,-.06,.09,-.06,.48,-.06],["c",.36,0,.36,0,.45,.06],["l",.06,.09],["l",0,1.23],["l",0,1.26],["l",.27,0],["c",1.26,0,2.49,.45,3.48,1.29],["c",1.05,.87,1.8,2.28,1.89,3.48],["c",.06,1.02,-.51,1.92,-1.44,2.22],["c",-.24,.09,-.3,.09,-.63,.09],["c",-.33,0,-.42,0,-.63,-.06],["c",-.66,-.24,-1.14,-.63,-1.41,-1.2],["c",-.15,-.3,-.21,-.51,-.24,-.9],["c",-.06,-1.08,.57,-2.04,1.56,-2.37],["c",.18,-.06,.27,-.06,.63,-.06],["l",.45,0],["c",.06,.03,.09,.03,.09,0],["c",0,-.03,-.45,-.51,-.66,-.69],["c",-.87,-.69,-1.83,-1.05,-2.94,-1.11],["l",-.42,0],["l",0,7.17],["l",0,7.14],["l",.42,0],["c",.69,-.03,1.23,-.18,1.86,-.51],["c",1.05,-.51,1.89,-1.47,2.46,-2.7],["c",.15,-.33,.33,-.87,.39,-1.17],["c",.09,-.24,.15,-.36,.3,-.39],["c",.21,-.03,.42,.15,.39,.36],["c",-.03,.24,-.21,.78,-.39,1.2],["c",-.96,2.37,-2.94,3.9,-5.13,3.9],["l",-.3,0],["l",0,1.26],["l",0,1.23],["l",-.06,.09],["c",-.09,.06,-.09,.06,-.45,.06],["c",-.39,0,-.39,0,-.48,-.06],["l",-.06,-.09],["l",0,-1.29],["l",0,-1.29],["l",-.21,-.03],["c",-1.23,-.21,-2.31,-.63,-3.21,-1.29],["c",-.15,-.09,-.45,-.36,-.66,-.57],["c",-1.11,-1.11,-1.8,-2.61,-2.04,-4.56],["c",-.06,-.6,-.06,-2.01,0,-2.61],["c",.24,-1.95,.93,-3.45,2.04,-4.59],["c",.42,-.39,.78,-.66,1.26,-.93],["c",.75,-.45,1.65,-.75,2.61,-.9],["l",.21,-.03],["l",0,-1.29],["l",0,-1.29],["z"],["m",-.06,10.44],["c",0,-5.58,0,-6.99,-.03,-6.99],["c",-.15,0,-.63,.27,-.87,.45],["c",-.45,.36,-.75,.93,-.93,1.77],["c",-.18,.81,-.24,1.8,-.24,4.74],["c",0,2.97,.06,3.96,.24,4.77],["c",.24,1.08,.66,1.68,1.41,2.07],["c",.12,.06,.3,.12,.33,.15],["l",.09,0],["l",0,-6.96],["z"]],w:13.038,h:20.97},"timesig.imperfectum":{d:[["M",13,-5],["a",8,8,0,1,0,0,10]],w:13.038,h:20.97},"timesig.imperfectum2":{d:[["M",13,-5],["a",8,8,0,1,0,0,10]],w:13.038,h:20.97},"timesig.perfectum":{d:[["M",13,-5],["a",8,8,0,1,0,0,10]],w:13.038,h:20.97},"timesig.perfectum2":{d:[["M",13,-5],["a",8,8,0,1,0,0,10]],w:13.038,h:20.97},f:{d:[["M",9.93,-14.28],["c",1.53,-.18,2.88,.45,3.12,1.5],["c",.12,.51,0,1.32,-.27,1.86],["c",-.15,.3,-.42,.57,-.63,.69],["c",-.69,.36,-1.56,.03,-1.83,-.69],["c",-.09,-.24,-.09,-.69,0,-.87],["c",.06,-.12,.21,-.24,.45,-.42],["c",.42,-.24,.57,-.45,.6,-.72],["c",.03,-.33,-.09,-.39,-.63,-.42],["c",-.3,0,-.45,0,-.6,.03],["c",-.81,.21,-1.35,.93,-1.74,2.46],["c",-.06,.27,-.48,2.25,-.48,2.31],["c",0,.03,.39,.03,.9,.03],["c",.72,0,.9,0,.99,.06],["c",.42,.15,.45,.72,.03,.9],["c",-.12,.06,-.24,.06,-1.17,.06],["l",-1.05,0],["l",-.78,2.55],["c",-.45,1.41,-.87,2.79,-.96,3.06],["c",-.87,2.37,-2.37,4.74,-3.78,5.91],["c",-1.05,.9,-2.04,1.23,-3.09,1.08],["c",-1.11,-.18,-1.89,-.78,-2.04,-1.59],["c",-.12,-.66,.15,-1.71,.54,-2.19],["c",.69,-.75,1.86,-.54,2.22,.39],["c",.06,.15,.09,.27,.09,.48],["c",0,.24,-.03,.27,-.12,.42],["c",-.03,.09,-.15,.18,-.27,.27],["c",-.09,.06,-.27,.21,-.36,.27],["c",-.24,.18,-.36,.36,-.39,.6],["c",-.03,.33,.09,.39,.63,.42],["c",.42,0,.63,-.03,.9,-.15],["c",.6,-.3,.96,-.96,1.38,-2.64],["c",.09,-.42,.63,-2.55,1.17,-4.77],["l",1.02,-4.08],["c",0,-.03,-.36,-.03,-.81,-.03],["c",-.72,0,-.81,0,-.93,-.06],["c",-.42,-.18,-.39,-.75,.03,-.9],["c",.09,-.06,.27,-.06,1.05,-.06],["l",.96,0],["l",0,-.09],["c",.06,-.18,.3,-.72,.51,-1.17],["c",1.2,-2.46,3.3,-4.23,5.34,-4.5],["z"]],w:16.155,h:19.445},m:{d:[["M",2.79,-8.91],["c",.09,0,.3,-.03,.45,-.03],["c",.24,.03,.3,.03,.45,.12],["c",.36,.15,.63,.54,.75,1.02],["l",.03,.21],["l",.33,-.3],["c",.69,-.69,1.38,-1.02,2.07,-1.02],["c",.27,0,.33,0,.48,.06],["c",.21,.09,.48,.36,.63,.6],["c",.03,.09,.12,.27,.18,.42],["c",.03,.15,.09,.27,.12,.27],["c",0,0,.09,-.09,.18,-.21],["c",.33,-.39,.87,-.81,1.29,-.99],["c",.78,-.33,1.47,-.21,2.01,.33],["c",.3,.33,.48,.69,.6,1.14],["c",.09,.42,.06,.54,-.54,3.06],["c",-.33,1.29,-.57,2.4,-.57,2.43],["c",0,.12,.09,.21,.21,.21],["c",.24,0,.75,-.3,1.2,-.72],["c",.45,-.39,.6,-.45,.78,-.27],["c",.18,.18,.09,.36,-.45,.87],["c",-1.05,.96,-1.83,1.47,-2.58,1.71],["c",-.93,.33,-1.53,.21,-1.8,-.33],["c",-.06,-.15,-.06,-.21,-.06,-.45],["c",0,-.24,.03,-.48,.6,-2.82],["c",.42,-1.71,.6,-2.64,.63,-2.79],["c",.03,-.57,-.3,-.75,-.84,-.48],["c",-.24,.12,-.54,.39,-.66,.63],["c",-.03,.09,-.42,1.38,-.9,3],["c",-.9,3.15,-.84,3,-1.14,3.15],["l",-.15,.09],["l",-.78,0],["c",-.6,0,-.78,0,-.84,-.06],["c",-.09,-.03,-.18,-.18,-.18,-.27],["c",0,-.03,.36,-1.38,.84,-2.97],["c",.57,-2.04,.81,-2.97,.84,-3.12],["c",.03,-.54,-.3,-.72,-.84,-.45],["c",-.24,.12,-.57,.42,-.66,.63],["c",-.06,.09,-.51,1.44,-1.05,2.97],["c",-.51,1.56,-.99,2.85,-.99,2.91],["c",-.06,.12,-.21,.24,-.36,.3],["c",-.12,.06,-.21,.06,-.9,.06],["c",-.6,0,-.78,0,-.84,-.06],["c",-.09,-.03,-.18,-.18,-.18,-.27],["c",0,-.03,.45,-1.38,.99,-2.97],["c",1.05,-3.18,1.05,-3.18,.93,-3.45],["c",-.12,-.27,-.39,-.3,-.72,-.15],["c",-.54,.27,-1.14,1.17,-1.56,2.4],["c",-.06,.15,-.15,.3,-.18,.36],["c",-.21,.21,-.57,.27,-.72,.09],["c",-.09,-.09,-.06,-.21,.06,-.63],["c",.48,-1.26,1.26,-2.46,2.01,-3.21],["c",.57,-.54,1.2,-.87,1.83,-1.02],["z"]],w:14.687,h:9.126},p:{d:[["M",1.92,-8.7],["c",.27,-.09,.81,-.06,1.11,.03],["c",.54,.18,.93,.51,1.17,.99],["c",.09,.15,.15,.33,.18,.36],["l",0,.12],["l",.3,-.27],["c",.66,-.6,1.35,-1.02,2.13,-1.2],["c",.21,-.06,.33,-.06,.78,-.06],["c",.45,0,.51,0,.84,.09],["c",1.29,.33,2.07,1.32,2.25,2.79],["c",.09,.81,-.09,2.01,-.45,2.79],["c",-.54,1.26,-1.86,2.55,-3.18,3.03],["c",-.45,.18,-.81,.24,-1.29,.24],["c",-.69,-.03,-1.35,-.18,-1.86,-.45],["c",-.3,-.15,-.51,-.18,-.69,-.09],["c",-.09,.03,-.18,.09,-.18,.12],["c",-.09,.12,-1.05,2.94,-1.05,3.06],["c",0,.24,.18,.48,.51,.63],["c",.18,.06,.54,.15,.75,.15],["c",.21,0,.36,.06,.42,.18],["c",.12,.18,.06,.42,-.12,.54],["c",-.09,.03,-.15,.03,-.78,0],["c",-1.98,-.15,-3.81,-.15,-5.79,0],["c",-.63,.03,-.69,.03,-.78,0],["c",-.24,-.15,-.24,-.57,.03,-.66],["c",.06,-.03,.48,-.09,.99,-.12],["c",.87,-.06,1.11,-.09,1.35,-.21],["c",.18,-.06,.33,-.18,.39,-.3],["c",.06,-.12,3.24,-9.42,3.27,-9.6],["c",.06,-.33,.03,-.57,-.15,-.69],["c",-.09,-.06,-.12,-.06,-.3,-.06],["c",-.69,.06,-1.53,1.02,-2.28,2.61],["c",-.09,.21,-.21,.45,-.27,.51],["c",-.09,.12,-.33,.24,-.48,.24],["c",-.18,0,-.36,-.15,-.36,-.3],["c",0,-.24,.78,-1.83,1.26,-2.55],["c",.72,-1.11,1.47,-1.74,2.28,-1.92],["z"],["m",5.37,1.47],["c",-.27,-.12,-.75,-.03,-1.14,.21],["c",-.75,.48,-1.47,1.68,-1.89,3.15],["c",-.45,1.47,-.42,2.34,0,2.7],["c",.45,.39,1.26,.21,1.83,-.36],["c",.51,-.51,.99,-1.68,1.38,-3.27],["c",.3,-1.17,.33,-1.74,.15,-2.13],["c",-.09,-.15,-.15,-.21,-.33,-.3],["z"]],w:14.689,h:13.127},r:{d:[["M",6.33,-9.12],["c",.27,-.03,.93,0,1.2,.06],["c",.84,.21,1.23,.81,1.02,1.53],["c",-.24,.75,-.9,1.17,-1.56,.96],["c",-.33,-.09,-.51,-.3,-.66,-.75],["c",-.03,-.12,-.09,-.24,-.12,-.3],["c",-.09,-.15,-.3,-.24,-.48,-.24],["c",-.57,0,-1.38,.54,-1.65,1.08],["c",-.06,.15,-.33,1.17,-.9,3.27],["c",-.57,2.31,-.81,3.12,-.87,3.21],["c",-.03,.06,-.12,.15,-.18,.21],["l",-.12,.06],["l",-.81,.03],["c",-.69,0,-.81,0,-.9,-.03],["c",-.09,-.06,-.18,-.21,-.18,-.3],["c",0,-.06,.39,-1.62,.9,-3.51],["c",.84,-3.24,.87,-3.45,.87,-3.72],["c",0,-.21,0,-.27,-.03,-.36],["c",-.12,-.15,-.21,-.24,-.42,-.24],["c",-.24,0,-.45,.15,-.78,.42],["c",-.33,.36,-.45,.54,-.72,1.14],["c",-.03,.12,-.21,.24,-.36,.27],["c",-.12,0,-.15,0,-.24,-.06],["c",-.18,-.12,-.18,-.21,-.06,-.54],["c",.21,-.57,.42,-.93,.78,-1.32],["c",.54,-.51,1.2,-.81,1.95,-.87],["c",.81,-.03,1.53,.3,1.92,.87],["l",.12,.18],["l",.09,-.09],["c",.57,-.45,1.41,-.84,2.19,-.96],["z"]],w:9.41,h:9.132},s:{d:[["M",4.47,-8.73],["c",.09,0,.36,-.03,.57,-.03],["c",.75,.03,1.29,.24,1.71,.63],["c",.51,.54,.66,1.26,.36,1.83],["c",-.24,.42,-.63,.57,-1.11,.42],["c",-.33,-.09,-.6,-.36,-.6,-.57],["c",0,-.03,.06,-.21,.15,-.39],["c",.12,-.21,.15,-.33,.18,-.48],["c",0,-.24,-.06,-.48,-.15,-.6],["c",-.15,-.21,-.42,-.24,-.75,-.15],["c",-.27,.06,-.48,.18,-.69,.36],["c",-.39,.39,-.51,.96,-.33,1.38],["c",.09,.21,.42,.51,.78,.72],["c",1.11,.69,1.59,1.11,1.89,1.68],["c",.21,.39,.24,.78,.15,1.29],["c",-.18,1.2,-1.17,2.16,-2.52,2.52],["c",-1.02,.24,-1.95,.12,-2.7,-.42],["c",-.72,-.51,-.99,-1.47,-.6,-2.19],["c",.24,-.48,.72,-.63,1.17,-.42],["c",.33,.18,.54,.45,.57,.81],["c",0,.21,-.03,.3,-.33,.51],["c",-.33,.24,-.39,.42,-.27,.69],["c",.06,.15,.21,.27,.45,.33],["c",.3,.09,.87,.09,1.2,0],["c",.75,-.21,1.23,-.72,1.29,-1.35],["c",.03,-.42,-.15,-.81,-.54,-1.2],["c",-.24,-.24,-.48,-.42,-1.41,-1.02],["c",-.69,-.42,-1.05,-.93,-1.05,-1.47],["c",0,-.39,.12,-.87,.3,-1.23],["c",.27,-.57,.78,-1.05,1.38,-1.35],["c",.24,-.12,.63,-.27,.9,-.3],["z"]],w:6.632,h:8.758},z:{d:[["M",2.64,-7.95],["c",.36,-.09,.81,-.03,1.71,.27],["c",.78,.21,.96,.27,1.74,.3],["c",.87,.06,1.02,.03,1.38,-.21],["c",.21,-.15,.33,-.15,.48,-.06],["c",.15,.09,.21,.3,.15,.45],["c",-.03,.06,-1.26,1.26,-2.76,2.67],["l",-2.73,2.55],["l",.54,.03],["c",.54,.03,.72,.03,2.01,.15],["c",.36,.03,.9,.06,1.2,.09],["c",.66,0,.81,-.03,1.02,-.24],["c",.3,-.3,.39,-.72,.27,-1.23],["c",-.06,-.27,-.06,-.27,-.03,-.39],["c",.15,-.3,.54,-.27,.69,.03],["c",.15,.33,.27,1.02,.27,1.5],["c",0,1.47,-1.11,2.7,-2.52,2.79],["c",-.57,.03,-1.02,-.09,-2.01,-.51],["c",-1.02,-.42,-1.23,-.48,-2.13,-.54],["c",-.81,-.06,-.96,-.03,-1.26,.18],["c",-.12,.06,-.24,.12,-.27,.12],["c",-.27,0,-.45,-.3,-.36,-.51],["c",.03,-.06,1.32,-1.32,2.91,-2.79],["l",2.88,-2.73],["c",-.03,0,-.21,.03,-.42,.06],["c",-.21,.03,-.78,.09,-1.23,.12],["c",-1.11,.12,-1.23,.15,-1.95,.27],["c",-.72,.15,-1.17,.18,-1.29,.09],["c",-.27,-.18,-.21,-.75,.12,-1.26],["c",.39,-.6,.93,-1.02,1.59,-1.2],["z"]],w:8.573,h:8.743},"+":{d:[["M",3.48,-9.3],["c",.18,-.09,.36,-.09,.54,0],["c",.18,.09,.24,.15,.33,.3],["l",.06,.15],["l",0,1.29],["l",0,1.29],["l",1.29,0],["c",1.23,0,1.29,0,1.41,.06],["c",.06,.03,.15,.09,.18,.12],["c",.12,.09,.21,.33,.21,.48],["c",0,.15,-.09,.39,-.21,.48],["c",-.03,.03,-.12,.09,-.18,.12],["c",-.12,.06,-.18,.06,-1.41,.06],["l",-1.29,0],["l",0,1.29],["c",0,1.23,0,1.29,-.06,1.41],["c",-.09,.18,-.15,.24,-.3,.33],["c",-.21,.09,-.39,.09,-.57,0],["c",-.18,-.09,-.24,-.15,-.33,-.33],["c",-.06,-.12,-.06,-.18,-.06,-1.41],["l",0,-1.29],["l",-1.29,0],["c",-1.23,0,-1.29,0,-1.41,-.06],["c",-.18,-.09,-.24,-.15,-.33,-.33],["c",-.09,-.18,-.09,-.36,0,-.54],["c",.09,-.18,.15,-.24,.33,-.33],["l",.15,-.06],["l",1.26,0],["l",1.29,0],["l",0,-1.29],["c",0,-1.23,0,-1.29,.06,-1.41],["c",.09,-.18,.15,-.24,.33,-.33],["z"]],w:7.507,h:7.515},",":{d:[["M",1.32,-3.36],["c",.57,-.15,1.17,.03,1.59,.45],["c",.45,.45,.6,.96,.51,1.89],["c",-.09,1.23,-.42,2.46,-.99,3.93],["c",-.3,.72,-.72,1.62,-.78,1.68],["c",-.18,.21,-.51,.18,-.66,-.06],["c",-.03,-.06,-.06,-.15,-.06,-.18],["c",0,-.06,.12,-.33,.24,-.63],["c",.84,-1.8,1.02,-2.61,.69,-3.24],["c",-.12,-.24,-.27,-.36,-.75,-.6],["c",-.36,-.15,-.42,-.21,-.6,-.39],["c",-.69,-.69,-.69,-1.71,0,-2.4],["c",.21,-.21,.51,-.39,.81,-.45],["z"]],w:3.452,h:8.143},"-":{d:[["M",.18,-5.34],["c",.09,-.06,.15,-.06,2.31,-.06],["c",2.46,0,2.37,0,2.46,.21],["c",.12,.21,.03,.42,-.15,.54],["c",-.09,.06,-.15,.06,-2.28,.06],["c",-2.16,0,-2.22,0,-2.31,-.06],["c",-.27,-.15,-.27,-.54,-.03,-.69],["z"]],w:5.001,h:.81},".":{d:[["M",1.32,-3.36],["c",1.05,-.27,2.1,.57,2.1,1.65],["c",0,1.08,-1.05,1.92,-2.1,1.65],["c",-.9,-.21,-1.5,-1.14,-1.26,-2.04],["c",.12,-.63,.63,-1.11,1.26,-1.26],["z"]],w:3.413,h:3.402},"scripts.wedge":{d:[["M",-3.66,-7.44],["c",.06,-.09,0,-.09,.81,.03],["c",1.86,.3,3.84,.3,5.73,0],["c",.78,-.12,.72,-.12,.78,-.03],["c",.15,.15,.12,.24,-.24,.6],["c",-.93,.93,-1.98,2.76,-2.67,4.62],["c",-.3,.78,-.51,1.71,-.51,2.13],["c",0,.15,0,.18,-.06,.27],["c",-.12,.09,-.24,.09,-.36,0],["c",-.06,-.09,-.06,-.12,-.06,-.27],["c",0,-.42,-.21,-1.35,-.51,-2.13],["c",-.69,-1.86,-1.74,-3.69,-2.67,-4.62],["c",-.36,-.36,-.39,-.45,-.24,-.6],["z"]],w:7.49,h:7.752},"scripts.thumb":{d:[["M",-.54,-3.69],["c",.15,-.03,.36,-.06,.51,-.06],["c",1.44,0,2.58,1.11,2.94,2.85],["c",.09,.48,.09,1.32,0,1.8],["c",-.27,1.41,-1.08,2.43,-2.16,2.73],["l",-.18,.06],["l",0,.12],["c",.03,.06,.06,.45,.09,.87],["c",.03,.57,.03,.78,0,.84],["c",-.09,.27,-.39,.48,-.66,.48],["c",-.27,0,-.57,-.21,-.66,-.48],["c",-.03,-.06,-.03,-.27,0,-.84],["c",.03,-.42,.06,-.81,.09,-.87],["l",0,-.12],["l",-.18,-.06],["c",-1.08,-.3,-1.89,-1.32,-2.16,-2.73],["c",-.09,-.48,-.09,-1.32,0,-1.8],["c",.15,-.84,.51,-1.53,1.02,-2.04],["c",.39,-.39,.84,-.63,1.35,-.75],["z"],["m",1.05,.9],["c",-.15,-.09,-.21,-.09,-.45,-.12],["c",-.15,0,-.3,.03,-.39,.03],["c",-.57,.18,-.9,.72,-1.08,1.74],["c",-.06,.48,-.06,1.8,0,2.28],["c",.15,.9,.42,1.44,.9,1.65],["c",.18,.09,.21,.09,.51,.09],["c",.3,0,.33,0,.51,-.09],["c",.48,-.21,.75,-.75,.9,-1.65],["c",.03,-.27,.03,-.54,.03,-1.14],["c",0,-.6,0,-.87,-.03,-1.14],["c",-.15,-.9,-.45,-1.44,-.9,-1.65],["z"]],w:5.955,h:9.75},"scripts.open":{d:[["M",-.54,-3.69],["c",.15,-.03,.36,-.06,.51,-.06],["c",1.44,0,2.58,1.11,2.94,2.85],["c",.09,.48,.09,1.32,0,1.8],["c",-.33,1.74,-1.47,2.85,-2.91,2.85],["c",-1.44,0,-2.58,-1.11,-2.91,-2.85],["c",-.09,-.48,-.09,-1.32,0,-1.8],["c",.15,-.84,.51,-1.53,1.02,-2.04],["c",.39,-.39,.84,-.63,1.35,-.75],["z"],["m",1.11,.9],["c",-.21,-.09,-.27,-.09,-.51,-.12],["c",-.3,0,-.42,.03,-.66,.15],["c",-.24,.12,-.51,.39,-.66,.63],["c",-.54,.93,-.63,2.64,-.21,3.81],["c",.21,.54,.51,.9,.93,1.11],["c",.21,.09,.24,.09,.54,.09],["c",.3,0,.33,0,.54,-.09],["c",.42,-.21,.72,-.57,.93,-1.11],["c",.36,-.99,.36,-2.37,0,-3.36],["c",-.21,-.54,-.51,-.9,-.9,-1.11],["z"]],w:5.955,h:7.5},"scripts.longphrase":{d:[["M",1.47,-15.09],["c",.36,-.09,.66,-.18,.69,-.18],["c",.06,0,.06,.54,.06,11.25],["l",0,11.25],["l",-.63,.15],["c",-.66,.18,-1.44,.39,-1.5,.39],["c",-.03,0,-.03,-3.39,-.03,-11.25],["l",0,-11.25],["l",.36,-.09],["c",.21,-.06,.66,-.18,1.05,-.27],["z"]],w:2.16,h:23.04},"scripts.mediumphrase":{d:[["M",1.47,-7.59],["c",.36,-.09,.66,-.18,.69,-.18],["c",.06,0,.06,.39,.06,7.5],["l",0,7.5],["l",-.63,.15],["c",-.66,.18,-1.44,.39,-1.5,.39],["c",-.03,0,-.03,-2.28,-.03,-7.5],["l",0,-7.5],["l",.36,-.09],["c",.21,-.06,.66,-.18,1.05,-.27],["z"]],w:2.16,h:15.54},"scripts.shortphrase":{d:[["M",1.47,-7.59],["c",.36,-.09,.66,-.18,.69,-.18],["c",.06,0,.06,.21,.06,3.75],["l",0,3.75],["l",-.42,.09],["c",-.57,.18,-1.65,.45,-1.71,.45],["c",-.03,0,-.03,-.72,-.03,-3.75],["l",0,-3.75],["l",.36,-.09],["c",.21,-.06,.66,-.18,1.05,-.27],["z"]],w:2.16,h:8.04},"scripts.snap":{d:[["M",4.5,-3.39],["c",.36,-.03,.96,-.03,1.35,0],["c",1.56,.15,3.15,.9,4.2,2.01],["c",.24,.27,.33,.42,.33,.6],["c",0,.27,.03,.24,-2.46,2.22],["c",-1.29,1.02,-2.4,1.86,-2.49,1.92],["c",-.18,.09,-.3,.09,-.48,0],["c",-.09,-.06,-1.2,-.9,-2.49,-1.92],["c",-2.49,-1.98,-2.46,-1.95,-2.46,-2.22],["c",0,-.18,.09,-.33,.33,-.6],["c",1.05,-1.08,2.64,-1.86,4.17,-2.01],["z"],["m",1.29,1.17],["c",-1.47,-.15,-2.97,.3,-4.14,1.2],["l",-.18,.15],["l",.06,.09],["c",.15,.12,3.63,2.85,3.66,2.85],["c",.03,0,3.51,-2.73,3.66,-2.85],["l",.06,-.09],["l",-.18,-.15],["c",-.84,-.66,-1.89,-1.08,-2.94,-1.2],["z"]],w:10.38,h:6.84},"noteheads.slash.whole":{d:[["M",5,-5],["l",1,1],["l",-5,5],["l",-1,-1],["z"],["m",4,6],["l",-5,-5],["l",2,-2],["l",5,5],["z"],["m",0,-2],["l",1,1],["l",-5,5],["l",-1,-1],["z"],["m",-4,6],["l",-5,-5],["l",2,-2],["l",5,5],["z"]],w:10.81,h:15.63},"noteheads.slash.quarter":{d:[["M",9,-6],["l",0,4],["l",-9,9],["l",0,-4],["z"]],w:9,h:9},"noteheads.harmonic.quarter":{d:[["M",3.63,-4.02],["c",.09,-.06,.18,-.09,.24,-.03],["c",.03,.03,.87,.93,1.83,2.01],["c",1.5,1.65,1.8,1.98,1.8,2.04],["c",0,.06,-.3,.39,-1.8,2.04],["c",-.96,1.08,-1.8,1.98,-1.83,2.01],["c",-.06,.06,-.15,.03,-.24,-.03],["c",-.12,-.09,-3.54,-3.84,-3.6,-3.93],["c",-.03,-.03,-.03,-.09,-.03,-.15],["c",.03,-.06,3.45,-3.84,3.63,-3.96],["z"]],w:7.5,h:8.165}},eo=function(t){for(var e=[],n=0,i=t.length;n<i;n++){e[n]=[];for(var s=0,r=t[n].length;s<r;s++)e[n][s]=t[n][s]}return e},no={printSymbol:function(t,e,n,i,s){if(!to[n])return null;var r=eo(to[n].d);r[0][1]+=t,r[0][2]+=e;for(var a="",o=0;o<r.length;o++)a+=r[o].join(" ");return i.path({path:a,stroke:"none",fill:"#000000",class:s})},getPathForSymbol:function(t,e,n,i,s){if(i=i||1,s=s||1,!to[n])return null;var r=eo(to[n].d);return 1===i&&1===s||function(t,e,n){for(var i=0,s=t.length;i<s;i++){var r,a,o=t[i];for(r=1,a=o.length;r<a;r++)o[r]*=r%2?e:n}}(r,i,s),r[0][1]+=t,r[0][2]+=e,r},getSymbolWidth:function(t){return to[t]?to[t].w:0},symbolHeightInPitches:function(t){return(to[t]?to[t].h:0)/ha.STEP},getSymbolAlign:function(t){return"scripts"===t.substring(0,7)&&"scripts.roll"!==t?"center":"left"},getYCorr:function(t){switch(t){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":return-2;case"timesig.common":case"timesig.cut":return 0;case"flags.d32nd":return-1;case"flags.d64th":return-2;case"flags.u32nd":return 1;case"flags.u64th":return 3;case"rests.whole":return 1;case"rests.half":case"rests.8th":case"rests.quarter":case"rests.16th":case"rests.32nd":case"rests.64th":return-1;case"f":case"m":case"p":case"s":case"z":return-4;case"scripts.trill":case"scripts.upbow":case"scripts.downbow":return-2;case"scripts.ufermata":case"scripts.wedge":case"scripts.roll":case"scripts.shortphrase":case"scripts.longphrase":return-1;case"scripts.dfermata":return 1;default:return 0}},setSymbol:function(t,e){to[t]=e}},io=function(t,e){var n,i=0,s=new Ya(t,0,10,"staff-extra",e);switch(s.isClef=!0,t.type){case"treble":n="clefs.G";break;case"tenor":case"alto":n="clefs.C";break;case"bass":n="clefs.F";break;case"treble+8":n="clefs.G",i=1;break;case"tenor+8":n="clefs.C",i=1;break;case"bass+8":n="clefs.F",i=1;break;case"alto+8":n="clefs.C",i=1;break;case"treble-8":n="clefs.G",i=-1;break;case"tenor-8":n="clefs.C",i=-1;break;case"bass-8":n="clefs.F",i=-1;break;case"alto-8":n="clefs.C",i=-1;break;case"none":return null;case"perc":n="clefs.perc";break;default:s.addChild(new $a("clef="+t.type,0,0,void 0,{type:"debug"}))}if(n&&(s.addRight(new $a(n,5,no.getSymbolWidth(n),t.clefPos)),"clefs.G"===n?(s.top=13,s.bottom=-1):(s.top=10,s.bottom=2),0!==i)){var r=2/3,a=(no.getSymbolWidth(n)-no.getSymbolWidth("8")*r)/2;s.addRight(new $a("8",5+a,no.getSymbolWidth("8")*r,i>0?s.top+3:s.bottom-1,{scalex:r,scaley:r})),s.top+=2}return s},so=function(t,e){if(!t.accidentals||0===t.accidentals.length)return null;var n=new Ya(t,0,10,"staff-extra",e);n.isKeySig=!0;var i=0;return da.each(t.accidentals,(function(t){var e;switch(t.acc){case"sharp":e="accidentals.sharp";break;case"natural":e="accidentals.nat";break;case"flat":e="accidentals.flat";break;case"quartersharp":e="accidentals.halfsharp";break;case"quarterflat":e="accidentals.halfflat";break;default:e="accidentals.flat"}n.addRight(new $a(e,i,no.getSymbolWidth(e),t.verticalPos,{thickness:no.symbolHeightInPitches(e)})),i+=no.getSymbolWidth(e)+2}),this),n},ro=function(t,e){var n=new Ya(t,0,10,"staff-extra",e);if("specified"===t.type)for(var i=0,s=0;s<t.value.length;s++)if(0!==s&&(n.addRight(new $a("+",i+1,no.getSymbolWidth("+"),6,{thickness:no.symbolHeightInPitches("+")})),i+=no.getSymbolWidth("+")+2),t.value[s].den){for(var r=0,a=0;a<t.value[s].num.length;a++)r+=no.getSymbolWidth(t.value[s].num.charAt(a));var o=0;for(a=0;a<t.value[s].num.length;a++)o+=no.getSymbolWidth(t.value[s].den.charAt(a));var c=Math.max(r,o);n.addRight(new $a(t.value[s].num,i+(c-r)/2,r,8,{thickness:no.symbolHeightInPitches(t.value[s].num.charAt(0))})),n.addRight(new $a(t.value[s].den,i+(c-o)/2,o,4,{thickness:no.symbolHeightInPitches(t.value[s].den.charAt(0))})),i+=c}else{for(var l=0,h=0;h<t.value[s].num.length;h++)l+=no.getSymbolWidth(t.value[s].num.charAt(h));n.addRight(new $a(t.value[s].num,i,l,6,{thickness:no.symbolHeightInPitches(t.value[s].num.charAt(0))})),i+=l}else"common_time"===t.type?n.addRight(new $a("timesig.common",0,no.getSymbolWidth("timesig.common"),6,{thickness:no.symbolHeightInPitches("timesig.common")})):"cut_time"===t.type?n.addRight(new $a("timesig.cut",0,no.getSymbolWidth("timesig.cut"),6,{thickness:no.symbolHeightInPitches("timesig.cut")})):"tempus_imperfectum"===t.type?n.addRight(new $a("timesig.imperfectum",0,no.getSymbolWidth("timesig.imperfectum"),6,{thickness:no.symbolHeightInPitches("timesig.imperfectum")})):"tempus_imperfectum_prolatio"===t.type?n.addRight(new $a("timesig.imperfectum2",0,no.getSymbolWidth("timesig.imperfectum2"),6,{thickness:no.symbolHeightInPitches("timesig.imperfectum2")})):"tempus_perfectum"===t.type?n.addRight(new $a("timesig.perfectum",0,no.getSymbolWidth("timesig.perfectum"),6,{thickness:no.symbolHeightInPitches("timesig.perfectum")})):"tempus_perfectum_prolatio"===t.type?n.addRight(new $a("timesig.perfectum2",0,no.getSymbolWidth("timesig.perfectum2"),6,{thickness:no.symbolHeightInPitches("timesig.perfectum2")})):console.log("time signature:",t);return n},ao=function(t,e,n){this.anchor=t,this.dec=e,"below"===n?this.volumeHeightBelow=5:this.volumeHeightAbove=5,this.pitch=void 0};ao.prototype.setUpperAndLowerElements=function(t){this.volumeHeightAbove?this.pitch=t.volumeHeightAbove:this.pitch=t.volumeHeightBelow},ao.prototype.draw=function(t,e,n){void 0===this.pitch&&window.console.error("Dynamic Element y-coordinate not set.");t.printSymbol(this.anchor.x,this.pitch,this.dec,1,1,t.addClasses("decoration"))};var oo=ao,co=function(){for(var t,e,n,i,s,r=0,a=arguments[r++],o=[];a;){if(e=/^[^\x25]+/.exec(a))o.push(e[0]);else if(e=/^\x25{2}/.exec(a))o.push("%");else{if(!(e=/^\x25(?:(\d+)\$)?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(a)))throw"Huh ?!";if(null==(t=arguments[e[1]||r++])||null==t)throw"Too few arguments.";if(/[^s]/.test(e[7])&&"number"!=typeof t)throw"Expecting number but found "+typeof t;switch(e[7]){case"b":t=t.toString(2);break;case"c":t=String.fromCharCode(t);break;case"d":t=parseInt(t);break;case"e":t=e[6]?t.toExponential(e[6]):t.toExponential();break;case"f":t=e[6]?parseFloat(t).toFixed(e[6]):parseFloat(t);break;case"o":t=t.toString(8);break;case"s":t=(t=String(t))&&e[6]?t.substring(0,e[6]):t;break;case"u":t=Math.abs(t);break;case"x":t=t.toString(16);break;case"X":t=t.toString(16).toUpperCase()}t=/[def]/.test(e[7])&&e[2]&&t>0?"+"+t:t,i=e[3]?"0"==e[3]?"0":e[3].charAt(1):" ",s=e[5]-String(t).length,n=e[5]?str_repeat(i,s):"",o.push(e[4]?t+n:n+t)}a=a.substring(e[0].length)}return o.join("")},lo=function(t,e,n,i){this.anchor1=t,this.anchor2=e,this.dir=n,"above"===i?this.dynamicHeightAbove=4:this.dynamicHeightBelow=4,this.pitch=void 0};lo.prototype.setUpperAndLowerElements=function(t){this.dynamicHeightAbove?this.pitch=t.dynamicHeightAbove:this.pitch=t.dynamicHeightBelow},lo.prototype.draw=function(t){void 0===this.pitch&&window.console.error("Crescendo Element y-coordinate not set.");var e=t.calcY(this.pitch)+4;"<"===this.dir?(this.drawLine(t,e+4,e),this.drawLine(t,e+4,e+8)):(this.drawLine(t,e,e+4),this.drawLine(t,e+8,e+4))},lo.prototype.drawLine=function(t,e,n){var i=this.anchor1?this.anchor1.x:0,s=this.anchor2?this.anchor2.x:800,r=co("M %f %f L %f %f",i,e,s,n);t.printPath({path:r,stroke:"#000000",class:t.addClasses("decoration")})};var ho=lo,uo=function(t){this.anchor1=t.anchor1,this.anchor2=t.anchor2,t.isGrace&&(this.isGrace=!0),t.fixedY&&(this.fixedY=!0),t.stemDir&&(this.stemDir=t.stemDir),void 0!==t.voiceNumber&&(this.voiceNumber=t.voiceNumber),this.internalNotes=[]};uo.prototype.addInternalNote=function(t){this.internalNotes.push(t)},uo.prototype.setEndAnchor=function(t){this.anchor2=t},uo.prototype.setStartX=function(t){this.startLimitX=t},uo.prototype.setEndX=function(t){this.endLimitX=t},uo.prototype.setHint=function(){this.hint=!0},uo.prototype.setUpperAndLowerElements=function(t){},uo.prototype.calcTieDirection=function(){if(this.isGrace)this.above=!1;else if(0===this.voiceNumber)this.above=!0;else if(this.voiceNumber>0)this.above=!1;else{var t;t=this.anchor1?this.anchor1.pitch:this.anchor2?this.anchor2.pitch:14,this.anchor1&&"down"===this.anchor1.stemDir&&this.anchor2&&"down"===this.anchor2.stemDir?this.above=!0:this.anchor1&&"up"===this.anchor1.stemDir&&this.anchor2&&"up"===this.anchor2.stemDir?this.above=!1:this.anchor1&&this.anchor2?this.above=t>=6:this.anchor1?this.above="down"===this.anchor1.stemDir:this.anchor2?this.above="down"===this.anchor2.stemDir:this.above=t>=6}},uo.prototype.calcSlurDirection=function(){if(this.isGrace)this.above=!1;else if(0===this.voiceNumber)this.above=!0;else if(this.voiceNumber>0)this.above=!1;else{var t=!1;this.anchor1&&"down"===this.anchor1.stemDir&&(t=!0),this.anchor2&&"down"===this.anchor2.stemDir&&(t=!0);for(var e=0;e<this.internalNotes.length;e++){"down"===this.internalNotes[e].stemDir&&(t=!0)}this.above=t}},uo.prototype.calcX=function(t,e){this.anchor1?(this.startX=this.anchor1.x,this.anchor1.scalex<1&&(this.startX-=3)):this.startLimitX?this.startX=this.startLimitX.x+this.startLimitX.w:this.startX=t,this.anchor2?this.endX=this.anchor2.x:this.endLimitX?this.endX=this.endLimitX.x:this.endX=e},uo.prototype.calcTieY=function(){this.anchor1?this.startY=this.anchor1.pitch:this.anchor2?this.startY=this.anchor2.pitch:this.startY=this.above?14:0,this.anchor2?this.endY=this.anchor2.pitch:this.anchor1?this.endY=this.anchor1.pitch:this.endY=this.above?14:0},uo.prototype.calcSlurY=function(){if(this.anchor1&&this.anchor2){this.above&&"up"===this.anchor1.stemDir&&!this.fixedY?(this.startY=(this.anchor1.highestVert+this.anchor1.pitch)/2,this.startX+=this.anchor1.w/2):this.startY=this.anchor1.pitch;var t=this.anchor2.parent.beam&&this.anchor2.parent.beam.stemsUp&&this.anchor2.parent.beam.elems[0]!==this.anchor2.parent,e=(this.anchor2.highestVert+this.anchor2.pitch)/2;this.above&&"up"===this.anchor2.stemDir&&!this.fixedY&&!t&&e<this.startY?(this.endY=e,this.endX+=this.anchor2.w/2):this.endY=this.above&&t?this.anchor2.highestVert:this.anchor2.pitch}else this.anchor1?this.startY=this.endY=this.anchor1.pitch:this.anchor2?this.startY=this.endY=this.anchor2.pitch:(this.startY=this.above?14:0,this.endY=this.above?14:0)},uo.prototype.avoidCollisionAbove=function(){if(this.above){for(var t=-50,e=0;e<this.internalNotes.length;e++)this.internalNotes[e].highestVert>t&&(t=this.internalNotes[e].highestVert);t>this.startY&&t>this.endY&&(this.startY=this.endY=t-1)}},uo.prototype.layout=function(t,e){this.anchor1&&this.anchor2?this.anchor1.pitch===this.anchor2.pitch&&0===this.internalNotes.length?this.isTie=!0:this.isTie=!1:this.isTie=!0,this.isTie?(this.calcTieDirection(),this.calcX(t,e),this.calcTieY()):(this.calcSlurDirection(),this.calcX(t,e),this.calcSlurY()),this.avoidCollisionAbove()},uo.prototype.draw=function(t,e,n){var i;this.layout(e,n),this.hint&&(i="abcjs-hint");var s=this.fixedY?1.5:0;t.drawArc(this.startX,this.endX,this.startY+s,this.endY+s,this.above,i,this.isTie)};var po,fo,mo=uo;fo=function(t,e,n,i,s){function r(t,e){var r="down"===s?function(){if(0===i.heads.length)return 2;for(var t=i.heads[0].pitch,e=1;e<i.heads.length;e++)t=Math.min(t,i.heads[e].pitch);return t}()+1:function(){if(0===i.heads.length)return 10;for(var t=i.heads[0].pitch,e=1;e<i.heads.length;e++)t=Math.max(t,i.heads[e].pitch);return t}()+9;"down"!==s&&1===e&&r--;var a=n/2;a+="down"===s?-5:3;for(var o=0;o<e;o++)r-=1,i.addChild(new $a(t,a,no.getSymbolWidth(t),r))}for(var a=0;a<t.length;a++)switch(t[a]){case"/":r("flags.ugrace",1);break;case"//":r("flags.ugrace",2);break;case"///":r("flags.ugrace",3);break;case"////":r("flags.ugrace",4)}},(po=function(){this.startDiminuendoX=void 0,this.startCrescendoX=void 0,this.minTop=12,this.minBottom=0}).prototype.dynamicDecoration=function(t,e,n,i){for(var s,r,a=0;a<e.length;a++)switch(e[a]){case"diminuendo(":this.startDiminuendoX=n,s=void 0;break;case"diminuendo)":s={start:this.startDiminuendoX,stop:n},this.startDiminuendoX=void 0;break;case"crescendo(":this.startCrescendoX=n,r=void 0;break;case"crescendo)":r={start:this.startCrescendoX,stop:n},this.startCrescendoX=void 0}s&&t.addOther(new ho(s.start,s.stop,">",i)),r&&t.addOther(new ho(r.start,r.stop,"<",i))},po.prototype.createDecoration=function(t,e,n,i,s,r,a,o,c,l){c||(c={ornamentPosition:"above",volumePosition:l?"above":"below",dynamicPosition:l?"above":"below"}),function(t,e,n,i){for(var s=0;s<e.length;s++)switch(e[s]){case"p":case"mp":case"pp":case"ppp":case"pppp":case"f":case"ff":case"fff":case"ffff":case"sfz":case"mf":var r=new oo(n,e[s],i);t.addOther(r)}}(t,e,s,c.volumePosition),this.dynamicDecoration(t,e,s,c.dynamicPosition),fo(e,0,i,s,a);var h=function(t,e,n,i,s,r,a,o){for(var c,l=0;l<e.length;l++){if("staccato"===e[l]||"tenuto"===e[l]||"accent"===e[l]){var h="scripts."+e[l];if("accent"===e[l]&&(h="scripts.sforzato"),c=void 0===c?"down"===a?n+2:o-2:"down"===a?c+2:c-2,"accent"===e[l])"up"===a?c--:c++;else switch(c){case 2:case 4:case 6:case 8:case 10:"up"===a?c--:c++}n>9&&c++;var u=i/2;"center"!==no.getSymbolAlign(h)&&(u-=no.getSymbolWidth(h)/2),s.addChild(new $a(h,u,no.getSymbolWidth(h),c))}if("slide"===e[l]&&s.heads[0]){var d=s.heads[0].pitch,p=new $a("",-r-15,0,(d-=2)-1),f=new $a("",-r-5,0,d+1);s.addChild(p),s.addChild(f),t.addOther(new mo({anchor1:p,anchor2:f,fixedY:!0}))}}return void 0===c&&(c=n),{above:c,below:s.bottom}}(t,e,n,i,s,r,a,o);h.above=Math.max(h.above,this.minTop),function(t,e,n,i,s,r,a){function o(t,e){"above"===t?i.above+=e:i.below-=e}function c(t){var e;return"above"===t?(e=i.above)<r&&(e=r):(e=i.below)>a&&(e=a),e}function l(t,i){var s=c(i);n.addChild(new $a(t,e/2,0,s+2,{type:"decoration",klass:"ornament",thickness:3})),o(i,5)}function h(t,i){var s=e/2;"center"!==no.getSymbolAlign(t)&&(s-=no.getSymbolWidth(t)/2);var r=no.symbolHeightInPitches(t)+1,a=c(i);a="above"===i?a+r/2:a-r/2,n.addChild(new $a(t,s,no.getSymbolWidth(t),a,{klass:"ornament",thickness:no.symbolHeightInPitches(t)})),o(i,r)}for(var u={"+":"scripts.stopped",open:"scripts.open",snap:"scripts.snap",wedge:"scripts.wedge",thumb:"scripts.thumb",shortphrase:"scripts.shortphrase",mediumphrase:"scripts.mediumphrase",longphrase:"scripts.longphrase",trill:"scripts.trill",roll:"scripts.roll",irishroll:"scripts.roll",marcato:"scripts.umarcato",dmarcato:"scripts.dmarcato",umarcato:"scripts.umarcato",turn:"scripts.turn",uppermordent:"scripts.prall",pralltriller:"scripts.prall",mordent:"scripts.mordent",lowermordent:"scripts.mordent",downbow:"scripts.downbow",upbow:"scripts.upbow",fermata:"scripts.ufermata",invertedfermata:"scripts.dfermata",breath:",",coda:"scripts.coda",segno:"scripts.segno"},d=0;d<t.length;d++)switch(t[d]){case"0":case"1":case"2":case"3":case"4":case"5":case"D.C.":case"D.S.":l(t[d],s),!0;break;case"fine":l("FINE",s),!0;break;case"+":case"open":case"snap":case"wedge":case"thumb":case"shortphrase":case"mediumphrase":case"longphrase":case"trill":case"roll":case"irishroll":case"marcato":case"dmarcato":case"turn":case"uppermordent":case"pralltriller":case"mordent":case"lowermordent":case"downbow":case"upbow":case"fermata":case"breath":case"umarcato":case"coda":case"segno":h(u[t[d]],s),!0;break;case"invertedfermata":h(u[t[d]],"below"),!0;break;case"mark":n.klass="mark"}}(e,i,s,h,c.ornamentPosition,this.minTop,this.minBottom),function(t,e,n){for(var i=0;i<t.length;i++)switch(t[i]){case"arpeggio":for(var s=e.abcelem.minpitch-1;s<=e.abcelem.maxpitch;s+=2)e.addExtra(new $a("scripts.arpeggio",2*-no.getSymbolWidth("scripts.arpeggio")-n,0,s+2,{klass:"ornament",thickness:no.symbolHeightInPitches("scripts.arpeggio")}))}}(e,s,r)};var go=po,vo=function(t,e,n){this.text=t,this.anchor1=e,this.anchor2=n,this.endingHeightAbove=5,this.pitch=void 0};vo.prototype.setUpperAndLowerElements=function(t){this.pitch=t.endingHeightAbove-2},vo.prototype.draw=function(t,e,n){void 0===this.pitch&&window.console.error("Ending Element y-coordinate not set.");var i,s=t.calcY(this.pitch);this.anchor1&&(e=this.anchor1.x+this.anchor1.w,i=co("M %f %f L %f %f",e,s,e,s+20),t.printPath({path:i,stroke:"#000000",fill:"#000000",class:t.addClasses("ending")}),t.renderText(e+5,t.calcY(this.pitch-.5),this.text,"repeatfont","ending","start")),this.anchor2&&(n=this.anchor2.x,i=co("M %f %f L %f %f",n,s,n,s+20),t.printPath({path:i,stroke:"#000000",fill:"#000000",class:t.addClasses("ending")})),i=co("M %f %f L %f %f",e,s,n,s),t.printPath({path:i,stroke:"#000000",fill:"#000000",class:t.addClasses("ending")})};var bo=vo,_o=function(){this.voices=[],this.staffs=[],this.brace=void 0};_o.prototype.setLimit=function(t,e){e.specialY[t]&&(e.staff.specialY[t]?e.staff.specialY[t]=Math.max(e.staff.specialY[t],e.specialY[t]):e.staff.specialY[t]=e.specialY[t])},_o.prototype.addVoice=function(t,e,n){var i=this.voices.length;this.voices[i]=t,this.staffs[e]?this.staffs[e].voices.push(i):this.staffs[this.staffs.length]={top:10,bottom:2,lines:n,voices:[i],specialY:{tempoHeightAbove:0,partHeightAbove:0,volumeHeightAbove:0,dynamicHeightAbove:0,endingHeightAbove:0,chordHeightAbove:0,lyricHeightAbove:0,lyricHeightBelow:0,chordHeightBelow:0,volumeHeightBelow:0,dynamicHeightBelow:0}},t.staff=this.staffs[e]},_o.prototype.setStaffLimits=function(t){t.staff.top=Math.max(t.staff.top,t.top),t.staff.bottom=Math.min(t.staff.bottom,t.bottom),this.setLimit("tempoHeightAbove",t),this.setLimit("partHeightAbove",t),this.setLimit("volumeHeightAbove",t),this.setLimit("dynamicHeightAbove",t),this.setLimit("endingHeightAbove",t),this.setLimit("chordHeightAbove",t),this.setLimit("lyricHeightAbove",t),this.setLimit("lyricHeightBelow",t),this.setLimit("chordHeightBelow",t),this.setLimit("volumeHeightBelow",t),this.setLimit("dynamicHeightBelow",t)},_o.prototype.setUpperAndLowerElements=function(t){for(var e,n=0;n<this.staffs.length;n++){var i=this.staffs[n],s={tempoHeightAbove:0,partHeightAbove:0,volumeHeightAbove:0,dynamicHeightAbove:0,endingHeightAbove:0,chordHeightAbove:0,lyricHeightAbove:0,lyricHeightBelow:0,chordHeightBelow:0,volumeHeightBelow:0,dynamicHeightBelow:0};i.specialY.lyricHeightAbove&&(i.top+=i.specialY.lyricHeightAbove,s.lyricHeightAbove=i.top),i.specialY.chordHeightAbove&&(i.top+=i.specialY.chordHeightAbove,s.chordHeightAbove=i.top),i.specialY.endingHeightAbove&&(i.specialY.chordHeightAbove?i.top+=2:i.top+=i.specialY.endingHeightAbove,s.endingHeightAbove=i.top),i.specialY.dynamicHeightAbove&&i.specialY.volumeHeightAbove?(i.top+=Math.max(i.specialY.dynamicHeightAbove,i.specialY.volumeHeightAbove),s.dynamicHeightAbove=i.top,s.volumeHeightAbove=i.top):i.specialY.dynamicHeightAbove?(i.top+=i.specialY.dynamicHeightAbove,s.dynamicHeightAbove=i.top):i.specialY.volumeHeightAbove&&(i.top+=i.specialY.volumeHeightAbove,s.volumeHeightAbove=i.top),i.specialY.partHeightAbove&&(i.top+=i.specialY.partHeightAbove,s.partHeightAbove=i.top),i.specialY.tempoHeightAbove&&(i.top+=i.specialY.tempoHeightAbove,s.tempoHeightAbove=i.top),i.specialY.lyricHeightBelow&&(s.lyricHeightBelow=i.bottom,i.bottom-=i.specialY.lyricHeightBelow),i.specialY.chordHeightBelow&&(s.chordHeightBelow=i.bottom,i.bottom-=i.specialY.chordHeightBelow),i.specialY.volumeHeightBelow&&i.specialY.dynamicHeightBelow?(s.volumeHeightBelow=i.bottom,s.dynamicHeightBelow=i.bottom,i.bottom-=Math.max(i.specialY.volumeHeightBelow,i.specialY.dynamicHeightBelow)):i.specialY.volumeHeightBelow?(s.volumeHeightBelow=i.bottom,i.bottom-=i.specialY.volumeHeightBelow):i.specialY.dynamicHeightBelow&&(s.dynamicHeightBelow=i.bottom,i.bottom-=i.specialY.dynamicHeightBelow);for(var r=0;r<i.voices.length;r++){this.voices[i.voices[r]].setUpperAndLowerElements(s)}if(void 0!==e){var a=e+(i.top-10),o=t.spacing.systemStaffSeparation/ha.STEP-a;o>0&&(i.top+=o)}e=2-i.bottom}},_o.prototype.finished=function(){for(var t=0;t<this.voices.length;t++)if(!this.voices[t].layoutEnded())return!1;return!0},_o.prototype.layout=function(t,e,n){var i,s=0,r=1e3,a=function(t,e,n){for(var i=t.padding.left,s=0,r=0;r<e.length;r++)if(e[r].header){var a=t.getTextSize(e[r].header,"voicefont","");s=Math.max(s,a.width)}return s&&(s+=t.getTextSize("A","voicefont","").width),i+=s,n&&(n.setLocation(i),i+=n.getWidth()),i}(e,this.voices,this.brace);this.startx=a;var o=0;for(n&&console.log("init layout",t),i=0;i<this.voices.length;i++)this.voices[i].beginLayout(a);for(var c=0;!this.finished();){for(o=null,i=0;i<this.voices.length;i++)this.voices[i].layoutEnded()||o&&!(this.voices[i].getDurationIndex()<o)||(o=this.voices[i].getDurationIndex());var l=[],h=[];for(i=0;i<this.voices.length;i++){this.voices[i].getDurationIndex()-o>1e-7?h.push(this.voices[i]):l.push(this.voices[i])}c=0;var u=0;for(i=0;i<l.length;i++)l[i].getNextX()>a&&(a=l[i].getNextX(),c=l[i].getSpacingUnits(),u=l[i].spacingduration);for(s+=c,r=Math.min(r,c),n&&console.log("currentduration: ",o,s,r),i=0;i<l.length;i++){var d=l[i].layoutOneItem(a,t),p=d-a;if(p>0){a=d;for(var f=0;f<i;f++)l[f].shiftRight(p)}}for(i=0;i<h.length;i++)h[i].spacingduration-=u,h[i].updateNextX(a,t);for(i=0;i<l.length;i++){l[i].updateIndices()}}for(i=0;i<this.voices.length;i++)this.voices[i].getNextX()>a&&(a=this.voices[i].getNextX(),c=this.voices[i].getSpacingUnits());for(s+=c,this.w=a,i=0;i<this.voices.length;i++)this.voices[i].w=this.w;return{spacingUnits:s,minSpace:r}},_o.prototype.calcHeight=function(){for(var t=0,e=0;e<this.voices.length;e++){var n=this.voices[e].staff;this.voices[e].duplicate||(t+=n.top,n.bottom<0&&(t+=-n.bottom))}return t},_o.prototype.draw=function(t){t.addInvisibleMarker("abcjs-top-of-system");for(var e,n,i=t.y,s=0;s<this.staffs.length;s++){var r=this.staffs[s];t.moveY(ha.STEP,r.top),r.absoluteY=t.y,r.bottom<0&&t.moveY(ha.STEP,-r.bottom)}var a=0;t.measureNumber=null,t.noteNumber=null;for(var o=0;o<this.voices.length;o++){var c=this.voices[o].staff;t.y=c.absoluteY,t.voiceNumber=o,this.voices[o].duplicate||(e||(e=t.calcY(10)),n=t.calcY(2),0!==c.lines&&(t.measureNumber=null,t.noteNumber=null,t.printStave(this.startx,this.w,c.lines))),this.voices[o].draw(t,a),t.measureNumber=null,t.noteNumber=null,this.voices[o].duplicate||(a=t.calcY(2)),this.brace&&o===this.brace.length-1&&this.brace&&this.brace.draw(t,e,n)}t.measureNumber=null,t.noteNumber=null,this.staffs.length>1&&t.printStem(this.startx,.6,e,n),t.y=i};var yo,wo=_o;(yo=function(t,e,n){this.tempo=t,this.tuneNumber=e,this.tempoHeightAbove=5,this.pitch=void 0,this.tempo.duration&&!this.tempo.suppressBpm&&(this.note=this.createNote(n,t,e))}).prototype.setUpperAndLowerElements=function(t){if(this.pitch=t.tempoHeightAbove,this.top=t.tempoHeightAbove,this.bottom=t.tempoHeightAbove,this.note){var e=this.pitch-5+1;this.note.top=e,this.note.bottom=e;for(var n=0;n<this.note.children.length;n++){var i=this.note.children[n];i.top+=e,i.bottom+=e,i.pitch+=e,void 0!==i.pitch2&&(i.pitch2+=e)}}},yo.prototype.setX=function(t){this.x=t},yo.prototype.createNote=function(t,e,n){var i,s,r,a=.75,o=e.duration[0],c=new Ya(e,o,1,"tempo",n);o<=1/32?(r="noteheads.quarter",s="flags.u32nd",i=0):o<=1/16?(r="noteheads.quarter",s="flags.u16th",i=0):o<=3/32?(r="noteheads.quarter",s="flags.u16nd",i=1):o<=1/8?(r="noteheads.quarter",s="flags.u8th",i=0):o<=3/16?(r="noteheads.quarter",s="flags.u8th",i=1):o<=1/4?(r="noteheads.quarter",i=0):o<=3/8?(r="noteheads.quarter",i=1):o<=.5?(r="noteheads.half",i=0):o<=3/4?(r="noteheads.half",i=1):o<=1?(r="noteheads.whole",i=0):o<=1.5?(r="noteheads.whole",i=1):o<=2?(r="noteheads.dbl",i=0):(r="noteheads.dbl",i=1);var l,h=t(c,r,{verticalPos:0},"up",0,0,s,i,0,a,[],!1).notehead;if(c.addHead(h),"noteheads.whole"!==r&&"noteheads.dbl"!==r){var u=h.dx+h.w;l=new $a(null,u,0,.25,{type:"stem",pitch2:5.25,linewidth:-.6}),c.addExtra(l)}return c},yo.prototype.draw=function(t){var e=this.x;void 0===this.pitch&&window.console.error("Tempo Element y-coordinate not set.");var n,i=t.calcY(this.pitch);if(this.tempo.preString){n=t.renderText(e,i,this.tempo.preString,"tempofont","tempo","start");var s=t.getTextSize(this.tempo.preString,"tempofont","tempo",n),r=s.width;e+=r+r/this.tempo.preString.length}if(this.note){this.note&&this.note.setX(e);for(var a=0;a<this.note.children.length;a++)this.note.children[a].draw(t,e);e+=this.note.w+5;var o="= "+this.tempo.bpm;n=t.renderText(e,i,o,"tempofont","tempo","start");var c=(s=t.getTextSize(o,"tempofont","tempo",n)).width;e+=c+c/o.length}this.tempo.postString&&t.renderText(e,i,this.tempo.postString,"tempofont","tempo","start")};var xo,ko=yo;!function(){function t(t,e,n,i,s,r){var a=co("M %f %f L %f %f",e,n,i,s);t.printPath({path:a,stroke:"#000000",class:t.addClasses("triplet d"+r)})}(xo=function(t,e,n){this.anchor1=e,this.number=t,this.duration=(""+e.parent.durationClass).replace(/\./,"-"),this.middleElems=[],this.flatBeams=n.flatBeams}).prototype.isClosed=function(){return this.anchor2},xo.prototype.middleNote=function(t){this.middleElems.push(t)},xo.prototype.setCloseAnchor=function(t){this.anchor2=t,this.anchor1.parent.beam&&(this.endingHeightAbove=4)},xo.prototype.setUpperAndLowerElements=function(){},xo.prototype.layout=function(){if(this.anchor1&&this.anchor2)if(this.hasBeam=this.anchor1.parent.beam&&this.anchor1.parent.beam===this.anchor2.parent.beam,this.hasBeam){var t=this.anchor1.parent.beam,e=t.isAbove()?this.anchor1.x+this.anchor1.w:this.anchor1.x;this.yTextPos=t.heightAtMidpoint(e,this.anchor2.x),this.yTextPos+=t.isAbove()?3:-2,this.top=this.yTextPos+1,this.bottom=this.yTextPos-2,t.isAbove()&&(this.endingHeightAbove=4)}else{this.startNote=Math.max(this.anchor1.parent.top,9)+4,this.endNote=Math.max(this.anchor2.parent.top,9)+4,"rest"===this.anchor1.parent.type&&"rest"!==this.anchor2.parent.type?this.startNote=this.endNote:"rest"===this.anchor2.parent.type&&"rest"!==this.anchor1.parent.type&&(this.endNote=this.startNote);for(var n=0,i=0;i<this.middleElems.length;i++)n=Math.max(n,this.middleElems[i].top);((n+=4)>this.startNote||n>this.endNote)&&(this.startNote=n,this.endNote=n),this.flatBeams&&(this.startNote=Math.max(this.startNote,this.endNote),this.endNote=Math.max(this.startNote,this.endNote)),this.yTextPos=this.startNote+(this.endNote-this.startNote)/2,this.top=this.yTextPos+1}delete this.middleElems,delete this.flatBeams},xo.prototype.draw=function(e){var n;if(this.hasBeam){var i=this.anchor1.parent.beam.isAbove()?this.anchor1.x+this.anchor1.w:this.anchor1.x;n=this.anchor1.parent.beam.xAtMidpoint(i,this.anchor2.x)}else n=this.anchor1.x+(this.anchor2.x+this.anchor2.w-this.anchor1.x)/2,function(e,n,i,s,r,a){i=e.calcY(i),r=e.calcY(r);var o=5;t(e,n,i,n,i+o,a),t(e,s,r,s,r+o,a);var c=n+(s-n)/2,l=8,h=(r-i)/(s-n),u=c-l;t(e,n,i,u,i+(u-n)*h,a);var d=c+l;t(e,d,i+(d-n)*h,s,r,a)}(e,this.anchor1.x,this.startNote,this.anchor2.x+this.anchor2.w,this.endNote,this.duration);e.renderText(n,e.calcY(this.yTextPos),""+this.number,"tripletfont",e.addClasses("triplet d"+this.duration),"middle",!0)}}();var To=xo,So=function(t,e){this.children=[],this.beams=[],this.otherchildren=[],this.w=0,this.duplicate=!1,this.voicenumber=t,this.voicetotal=e,this.bottom=7,this.top=7,this.specialY={tempoHeightAbove:0,partHeightAbove:0,volumeHeightAbove:0,dynamicHeightAbove:0,endingHeightAbove:0,chordHeightAbove:0,lyricHeightAbove:0,lyricHeightBelow:0,chordHeightBelow:0,volumeHeightBelow:0,dynamicHeightBelow:0}};So.prototype.addChild=function(t){if("bar"===t.type){for(var e=!0,n=0;e&&n<this.children.length;n++)"staff-extra"!==this.children[n].type&&"tempo"!==this.children[n].type&&(e=!1);e||(this.beams.push("bar"),this.otherchildren.push("bar"))}this.children[this.children.length]=t,this.setRange(t)},So.prototype.setLimit=function(t,e){var n=e.specialY;n||(n=e),n[t]&&(this.specialY[t]?this.specialY[t]=Math.max(this.specialY[t],n[t]):this.specialY[t]=n[t])},So.prototype.moveDecorations=function(t){for(var e=0;e<t.elems.length;e++){var n=t.elems[e];if(n.top)for(var i=t.yAtNote(n),s=0;s<n.children.length;s++){var r=n.children[s];if("ornament"===r.klass&&r.bottom-1.5<i){var a=i-r.bottom+1.5;r.bottom+=a,r.top+=a,r.pitch+=a,i=n.top=r.top}}}},So.prototype.adjustRange=function(t){void 0!==t.bottom&&(this.bottom=Math.min(this.bottom,t.bottom)),void 0!==t.top&&(this.top=Math.max(this.top,t.top))},So.prototype.setRange=function(t){this.adjustRange(t),this.setLimit("tempoHeightAbove",t),this.setLimit("partHeightAbove",t),this.setLimit("volumeHeightAbove",t),this.setLimit("dynamicHeightAbove",t),this.setLimit("endingHeightAbove",t),this.setLimit("chordHeightAbove",t),this.setLimit("lyricHeightAbove",t),this.setLimit("lyricHeightBelow",t),this.setLimit("chordHeightBelow",t),this.setLimit("volumeHeightBelow",t),this.setLimit("dynamicHeightBelow",t)},So.prototype.setUpperAndLowerElements=function(t){var e;for(e=0;e<this.children.length;e++){(n=this.children[e]).setUpperAndLowerElements(t)}for(e=0;e<this.otherchildren.length;e++){var n;"string"!=typeof(n=this.otherchildren[e])&&n.setUpperAndLowerElements(t)}},So.prototype.addOther=function(t){this.otherchildren.push(t),this.setRange(t)},So.prototype.addBeam=function(t){this.beams.push(t)},So.prototype.updateIndices=function(){this.layoutEnded()||(this.durationindex+=this.children[this.i].duration,"bar"===this.children[this.i].type&&(this.durationindex=Math.round(64*this.durationindex)/64),this.i++)},So.prototype.layoutEnded=function(){return this.i>=this.children.length},So.prototype.getDurationIndex=function(){return this.durationindex-(this.children[this.i]&&this.children[this.i].duration>0?0:5e-7)},So.prototype.getSpacingUnits=function(){return Math.sqrt(8*this.spacingduration)},So.prototype.getNextX=function(){return Math.max(this.minx,this.nextx)},So.prototype.beginLayout=function(t){this.i=0,this.durationindex=0,this.startx=t,this.minx=t,this.nextx=t,this.spacingduration=0},So.prototype.layoutOneItem=function(t,e){var n=this.children[this.i];if(!n)return 0;var i=t-this.minx,s=n.getExtraWidth();return i<s&&(0===this.i||"bar"!==n.type||"part"!==this.children[this.i-1].type&&"tempo"!==this.children[this.i-1].type)&&(t+=s-i),n.setX(t),this.spacingduration=n.duration,this.minx=t+n.getMinWidth(),this.i!==this.children.length-1&&(this.minx+=n.minspacing),this.updateNextX(t,e),t},So.prototype.updateNextX=function(t,e){this.nextx=t+e*Math.sqrt(8*this.spacingduration)},So.prototype.shiftRight=function(t){var e=this.children[this.i];e&&(e.setX(e.x+t),this.minx+=t,this.nextx+=t)},So.prototype.draw=function(t,e){var n,i=this.w-1;if(t.staffbottom=this.staff.bottom,t.measureNumber=null,t.noteNumber=null,this.header){var s=14-(this.voicenumber+1)*(12/(this.voicetotal+1));t.renderText(t.padding.left,t.calcY(s),this.header,"voicefont","staff-extra voice-name","start")}for(var r=0,a=this.children.length;r<a;r++){var o=this.children[r],c=!1;"staff-extra"!==o.type&&null===t.measureNumber&&(t.measureNumber=0,t.noteNumber=0,c=!0),o.draw(t,this.barto||r===a-1?e:0),("note"===o.type||"rest"===(n=o).type&&n.abcelem&&n.abcelem.rest&&"spacer"!==n.abcelem.rest.type)&&t.noteNumber++,"bar"!==o.type||c||(t.measureNumber++,t.noteNumber=0)}t.measureNumber=0,t.noteNumber=0,da.each(this.beams,(function(e){"bar"===e?(t.measureNumber++,t.noteNumber=0):e.draw(t)})),t.measureNumber=0,t.noteNumber=0;var l=this;da.each(this.otherchildren,(function(e){"bar"===e?(t.measureNumber++,t.noteNumber=0):e.draw(t,l.startx+10,i)}))},So.prototype.layoutBeams=function(){for(var t=0;t<this.beams.length;t++)if(this.beams[t].layout){this.beams[t].layout(),this.moveDecorations(this.beams[t]);for(var e=0;e<this.beams[t].elems.length;e++)this.adjustRange(this.beams[t].elems[e])}for(t=0;t<this.otherchildren.length;t++){var n=this.otherchildren[t];n.layout&&(n.layout(),this.adjustRange(n))}this.staff.top=Math.max(this.staff.top,this.top),this.staff.bottom=Math.min(this.staff.bottom,this.bottom)};var Co,Ao=So;!function(){var t=function(t){var e=0;return t.duration&&(e=t.duration),e},e=!1,n={rest:{0:"rests.whole",1:"rests.half",2:"rests.quarter",3:"rests.8th",4:"rests.16th",5:"rests.32nd",6:"rests.64th",7:"rests.128th",multi:"rests.multimeasure"},note:{"-1":"noteheads.dbl",0:"noteheads.whole",1:"noteheads.half",2:"noteheads.quarter",3:"noteheads.quarter",4:"noteheads.quarter",5:"noteheads.quarter",6:"noteheads.quarter",7:"noteheads.quarter",nostem:"noteheads.quarter"},rhythm:{"-1":"noteheads.slash.whole",0:"noteheads.slash.whole",1:"noteheads.slash.whole",2:"noteheads.slash.quarter",3:"noteheads.slash.quarter",4:"noteheads.slash.quarter",5:"noteheads.slash.quarter",6:"noteheads.slash.quarter",7:"noteheads.slash.quarter",nostem:"noteheads.slash.nostem"},x:{"-1":"noteheads.indeterminate",0:"noteheads.indeterminate",1:"noteheads.indeterminate",2:"noteheads.indeterminate",3:"noteheads.indeterminate",4:"noteheads.indeterminate",5:"noteheads.indeterminate",6:"noteheads.indeterminate",7:"noteheads.indeterminate",nostem:"noteheads.indeterminate"},harmonic:{"-1":"noteheads.harmonic.quarter",0:"noteheads.harmonic.quarter",1:"noteheads.harmonic.quarter",2:"noteheads.harmonic.quarter",3:"noteheads.harmonic.quarter",4:"noteheads.harmonic.quarter",5:"noteheads.harmonic.quarter",6:"noteheads.harmonic.quarter",7:"noteheads.harmonic.quarter",nostem:"noteheads.harmonic.quarter"},uflags:{3:"flags.u8th",4:"flags.u16th",5:"flags.u32nd",6:"flags.u64th"},dflags:{3:"flags.d8th",4:"flags.d16th",5:"flags.d32nd",6:"flags.d64th"}};function i(t,e){var n=t[e];if("note"!==n.el_type||!n.startBeam||n.endBeam)return{count:1,elem:n};for(var i=[];e<t.length&&"note"===t[e].el_type&&(i.push(t[e]),!t[e].endBeam);)e++;return{count:i.length,elem:i}}function s(t){if(t.pitches){r(t);for(var e=0,n=0;n<t.pitches.length;n++)e+=t.pitches[n].verticalPos;t.averagepitch=e/t.pitches.length,t.minpitch=t.pitches[0].verticalPos,t.maxpitch=t.pitches[t.pitches.length-1].verticalPos}}(Co=function(t,e,n){this.decoration=new go,this.renderer=t,this.tuneNumber=e,this.isBagpipes=n.bagpipes,this.flatBeams=n.flatbeams,this.reset()}).prototype.reset=function(){this.slurs={},this.ties=[],this.voiceScale=1,this.slursbyvoice={},this.tiesbyvoice={},this.endingsbyvoice={},this.scaleByVoice={},this.tripletmultiplier=1,this.abcline=void 0,this.accidentalSlot=void 0,this.accidentalshiftx=void 0,this.dotshiftx=void 0,this.hasVocals=!1,this.minY=void 0,this.partstartelem=void 0,this.startlimitelem=void 0,this.stemdir=void 0},Co.prototype.setStemHeight=function(t){this.stemHeight=t/ha.STEP},Co.prototype.getCurrentVoiceId=function(t,e){return"s"+t+"v"+e},Co.prototype.pushCrossLineElems=function(t,e){this.slursbyvoice[this.getCurrentVoiceId(t,e)]=this.slurs,this.tiesbyvoice[this.getCurrentVoiceId(t,e)]=this.ties,this.endingsbyvoice[this.getCurrentVoiceId(t,e)]=this.partstartelem,this.scaleByVoice[this.getCurrentVoiceId(t,e)]=this.voiceScale},Co.prototype.popCrossLineElems=function(t,e){this.slurs=this.slursbyvoice[this.getCurrentVoiceId(t,e)]||{},this.ties=this.tiesbyvoice[this.getCurrentVoiceId(t,e)]||[],this.partstartelem=this.endingsbyvoice[this.getCurrentVoiceId(t,e)],this.voiceScale=this.scaleByVoice[this.getCurrentVoiceId(t,e)],void 0===this.voiceScale&&(this.voiceScale=1)},Co.prototype.containsLyrics=function(t){for(var e=0;e<t.length;e++)for(var n=0;n<t[e].voices.length;n++)for(var i=0;i<t[e].voices[n].length;i++){var s=t[e].voices[n][i];if(s.lyric)return void(s.positioning&&"below"!==s.positioning.vocalPosition||(this.hasVocals=!0))}},Co.prototype.createABCLine=function(t,n){this.minY=2,this.containsLyrics(t);var i=new wo;this.tempoSet=!1;for(var s=0;s<t.length;s++)e&&this.restoreState(),e=!1,this.createABCStaff(i,t[s],n,s);return i},Co.prototype.createABCStaff=function(t,e,n,i){for(var s=0;s<e.voices.length;s++){var r=new Ao(s,e.voices.length);0===s?(r.barfrom="start"===e.connectBarLines||"continue"===e.connectBarLines,r.barto="continue"===e.connectBarLines||"end"===e.connectBarLines):r.duplicate=!0,e.title&&e.title[s]&&(r.header=e.title[s]);var a=io(e.clef,this.tuneNumber);a&&(0===s&&e.barNumber&&this.addMeasureNumber(e.barNumber,a),r.addChild(a));var o=so(e.key,this.tuneNumber);if(o&&(r.addChild(o),this.startlimitelem=o),e.meter){"specified"===e.meter.type?this.measureLength=e.meter.value[0].num/e.meter.value[0].den:this.measureLength=1;var c=ro(e.meter,this.tuneNumber);r.addChild(c),this.startlimitelem=c}r.duplicate&&(r.children=[]);var l=e.clef.stafflines||0===e.clef.stafflines?e.clef.stafflines:5;t.addVoice(r,i,l);var h=1===l;this.createABCVoice(e.voices[s],n,i,s,h,r),t.setStaffLimits(r),"start"===e.brace?t.brace=new Ja(1,!0):("end"===e.brace&&t.brace||"continue"===e.brace&&t.brace)&&t.brace.increaseStavesIncluded()}},Co.prototype.createABCVoice=function(t,n,r,a,o,l){this.popCrossLineElems(r,a),this.stemdir=this.isBagpipes?"down":null,this.abcline=t,this.partstartelem&&(this.partstartelem=new bo("",null,null),l.addOther(this.partstartelem));var h=l.voicetotal<2?-1:l.voicenumber;for(var u in this.slurs)this.slurs.hasOwnProperty(u)&&(this.slurs[u]=new mo({force:this.slurs[u].force,voiceNumber:h,stemDir:this.slurs[u].stemDir}),e&&this.slurs[u].setHint(),l.addOther(this.slurs[u]));for(var d=0;d<this.ties.length;d++)this.ties[d]=new mo({force:this.ties[d].force,stemDir:this.ties[d].stemDir,voiceNumber:h}),e&&this.ties[d].setHint(),l.addOther(this.ties[d]);for(var p=0;p<this.abcline.length;p++)s(this.abcline[p]),this.minY=Math.min(this.abcline[p].minpitch,this.minY);for(var f=0===r,m=0;m<this.abcline.length;){var g=i(this.abcline,m),v=this.createABCElement(f,o,l,g.elem);if(v)for(d=0;d<v.length;d++){if(!this.tempoSet&&n&&!n.suppress){this.tempoSet=!0;var b=new Ya(g.elem,0,0,"tempo",this.tuneNumber,{});b.addChild(new ko(n,this.tuneNumber,c)),l.addChild(b)}l.addChild(v[d])}m+=g.count}this.pushCrossLineElems(r,a)},Co.prototype.saveState=function(){this.tiesSave=da.cloneArray(this.ties),this.slursSave=da.cloneHashOfHash(this.slurs),this.slursbyvoiceSave=da.cloneHashOfHash(this.slursbyvoice),this.tiesbyvoiceSave=da.cloneHashOfArrayOfHash(this.tiesbyvoice)},Co.prototype.restoreState=function(){this.ties=da.cloneArray(this.tiesSave),this.slurs=da.cloneHashOfHash(this.slursSave),this.slursbyvoice=da.cloneHashOfHash(this.slursbyvoiceSave),this.tiesbyvoice=da.cloneHashOfArrayOfHash(this.tiesbyvoiceSave)},Co.prototype.createABCElement=function(t,n,i,s){var r=[];switch(s.el_type){case void 0:r=this.createBeam(n,i,s);break;case"note":r[0]=this.createNote(s,!1,n,i),this.triplet&&this.triplet.isClosed()&&(i.addOther(this.triplet),this.triplet=null,this.tripletmultiplier=1);break;case"bar":r[0]=this.createBarLine(i,s,t),i.duplicate&&r.length>0&&(r[0].invisible=!0);break;case"meter":r[0]=ro(s,this.tuneNumber),this.startlimitelem=r[0],i.duplicate&&r.length>0&&(r[0].invisible=!0);break;case"clef":if(r[0]=io(s,this.tuneNumber),!r[0])return null;i.duplicate&&r.length>0&&(r[0].invisible=!0);break;case"key":var a=so(s,this.tuneNumber);a&&(r[0]=a,this.startlimitelem=r[0]),i.duplicate&&r.length>0&&(r[0].invisible=!0);break;case"stem":this.stemdir=s.direction;break;case"part":var o=new Ya(s,0,0,"part",this.tuneNumber),l=this.renderer.getTextSize(s.title,"partsfont","part");o.addChild(new $a(s.title,0,0,void 0,{type:"part",height:l.height/ha.STEP})),r[0]=o;break;case"tempo":var h=new Ya(s,0,0,"tempo",this.tuneNumber);h.addChild(new ko(s,this.tuneNumber,c)),r[0]=h;break;case"style":"normal"===s.head?delete this.style:this.style=s.head;break;case"hint":e=!0,this.saveState();break;case"midi":break;case"scale":this.voiceScale=s.size;break;default:var u=new Ya(s,0,0,"unsupported",this.tuneNumber);u.addChild(new $a("element type "+s.el_type,0,0,void 0,{type:"debug"})),r[0]=u}return r},Co.prototype.calcBeamDir=function(t,e,n){if(this.stemdir)return this.stemdir;for(var i=new Ka(this.stemHeight*this.voiceScale,this.stemdir,this.flatBeams),s=0;s<n.length;s++)i.add({abcelem:n[s]});return i.calcDir()?"up":"down"},Co.prototype.createBeam=function(t,n,i){var s=[],r=this.calcBeamDir(t,n,i),a=new Ka(this.stemHeight*this.voiceScale,r,this.flatBeams);e&&a.setHint();var o=this.stemdir;this.stemdir=r;for(var c=0;c<i.length;c++){var l=i[c],h=this.createNote(l,!0,t,n);s.push(h),a.add(h),this.triplet&&this.triplet.isClosed()&&(n.addOther(this.triplet),this.triplet=null,this.tripletmultiplier=1)}return this.stemdir=o,n.addBeam(a),s};var r=function(t){var e;do{e=!0;for(var n=0;n<t.pitches.length-1;n++)if(t.pitches[n].pitch>t.pitches[n+1].pitch){e=!1;var i=t.pitches[n];t.pitches[n]=t.pitches[n+1],t.pitches[n+1]=i}}while(!e)},a=function(t,e,n,i,s,r,a,o,c){for(var l=n;l>11;l--)l%2!=0||i||t.addChild(new $a(null,o,(s+4)*c,l,{type:"ledger"}));for(l=e;l<1;l++)l%2!=0||i||t.addChild(new $a(null,o,(s+4)*c,l,{type:"ledger"}));for(l=0;l<r.length;l++){var h=s;"down"===a&&(h=-h),t.addChild(new $a(null,h+o,(s+4)*c,r[l],{type:"ledger"}))}};function o(t,e){for(var n=0;n<t.length;n++)if(JSON.stringify(t[n])===JSON.stringify(e))return;t.push(e)}Co.prototype.addGraceNotes=function(t,i,s,r,o,l,h){var u,d=.6,p=null;t.gracenotes.length>1&&(p=new Ka(.7*o,"grace",l),e&&p.setHint(),p.mainNote=s);var f,m=[];for(f=t.gracenotes.length-1;f>=0;f--)h+=10,m[f]=h,t.gracenotes[f].accidental&&(h+=7);for(f=0;f<t.gracenotes.length;f++){var g=t.gracenotes[f].verticalPos;u=p?null:n.uflags[l?5:3];var v=c(s,"noteheads.quarter",t.gracenotes[f],"up",-m[f],-m[f],u,0,0,d*this.voiceScale,[],!1);v.notehead.highestVert=v.notehead.pitch+.7*o;var b=v.notehead;if(this.addSlursAndTies(s,t.gracenotes[f],b,i,"up",!0),s.addExtra(b),t.gracenotes[f].acciaccatura){var _=t.gracenotes[f].verticalPos+4.2,y=p?5:6;s.addRight(new $a("flags.ugrace",-m[f]+y,0,_,{scalex:d,scaley:d}))}if(p){var w=t.gracenotes[f].duration/2;l&&(w/=2);var x={heads:[b],abcelem:{averagepitch:g,minpitch:g,maxpitch:g,duration:w}};p.add(x)}else{var k=g+1/3*d,T=g+4.2,S=b.dx+b.w;s.addExtra(new $a(null,S,0,k,{type:"stem",pitch2:T,linewidth:-.6}))}if(a(s,g,g,!1,no.getSymbolWidth("noteheads.quarter"),[],!0,b.dx-1,.6),0===f&&!l&&(!t.rest||"spacer"!==t.rest.type&&"invisible"!==t.rest.type)){1===t.gracenotes.length&&(b.pitch,r.pitch);i.addOther(new mo({anchor1:b,anchor2:r,isGrace:!0}))}}return p&&i.addBeam(p),h},Co.prototype.addNoteToAbcElement=function(e,i,s,r,a,l,h,u,d){var p,f,m,g,v,b=0,_=0,y=0,w=[],x=[],k=0,T=i.averagepitch>=6?"down":"up";for(r&&(T=r),(a=i.style?i.style:a)&&"normal"!==a||(a="note"),(g=l?n[a].nostem:n[a][-h])||console.log("noteSymbol:",a,h,l),v="down"===T?i.pitches.length-2:1;"down"===T?v>=0:v<i.pitches.length;v="down"===T?v-1:v+1){var S=i.pitches["down"===T?v+1:v-1],C=i.pitches[v],A="down"===T?S.pitch-C.pitch:C.pitch-S.pitch;A<=1&&!S.printer_shift&&(C.printer_shift=A?"different":"same",(C.verticalPos>11||C.verticalPos<1)&&w.push(C.verticalPos-C.verticalPos%2),"down"===T?_=no.getSymbolWidth(g)+2:b=no.getSymbolWidth(g)+2)}var E=i.pitches.length;for(v=0;v<i.pitches.length;v++){var M,N;if(!u)M="down"===T&&0!==v||"up"===T&&v!==E-1?null:n["down"===T?"dflags":"uflags"][-h];if(N=i.pitches[v].style?n[i.pitches[v].style][-h]:g,i.pitches[v].highestVert=i.pitches[v].verticalPos,("up"===r||"up"===T)&&0===v||("down"===r||"down"===T)&&v===E-1){if((i.startSlur||1===E)&&(i.pitches[v].highestVert=i.pitches[E-1].verticalPos,t(i)<1&&("up"===r||"up"===T)&&(i.pitches[v].highestVert+=6)),i.startSlur)for(i.pitches[v].startSlur||(i.pitches[v].startSlur=[]),m=0;m<i.startSlur.length;m++)o(i.pitches[v].startSlur,i.startSlur[m]);if(i.endSlur)for(i.pitches[v].highestVert=i.pitches[E-1].verticalPos,t(i)<1&&("up"===r||"up"===T)&&(i.pitches[v].highestVert+=6),i.pitches[v].endSlur||(i.pitches[v].endSlur=[]),m=0;m<i.endSlur.length;m++)o(i.pitches[v].endSlur,i.endSlur[m])}var I=!u&&h<=-1,O=c(e,N,i.pitches[v],T,0,-_,M,s,b,this.voiceScale,x,!r);k=Math.max(no.getSymbolWidth(N),k),e.extraw-=O.extraLeft,(p=O.notehead)&&(this.addSlursAndTies(e,i.pitches[v],p,d,I?T:null,!1),i.gracenotes&&i.gracenotes.length>0&&(p.bottom=p.bottom-1),e.addHead(p)),_+=O.accidentalshiftx,y=Math.max(y,O.dotshiftx)}if(I){var P=7*this.voiceScale,D="down"===T?i.minpitch-P:i.minpitch+1/3;D>6&&!r&&(D=6);var B="down"===T?i.maxpitch-1/3:i.maxpitch+P;B<6&&!r&&(B=6);var R="down"===T||0===e.heads.length?0:e.heads[0].w,L="down"===T?1:-1;"noteheads.slash.quarter"===p.c&&("down"===T?B-=1:D+=1),e.addExtra(new $a(null,R,0,D,{type:"stem",pitch2:B,linewidth:L})),f=Math.min(D,B)}return{noteHead:p,roomTaken:_,roomTakenRight:y,min:f,additionalLedgers:w,dir:T,symbolWidth:k}},Co.prototype.addLyric=function(t,e){var n="";da.each(e.lyric,(function(t){var e=" "===t.divider?"":t.divider;n+=t.syllable+e+"\n"}));var i=this.renderer.getTextSize(n,"vocalfont","lyric"),s=e.positioning?e.positioning.vocalPosition:"below";t.addCentered(new $a(n,0,i.width,void 0,{type:"lyric",position:s,height:i.height/ha.STEP}))},Co.prototype.addChord=function(t,e,n,i){for(var s=0;s<e.chord.length;s++){var r,a=0,o=this.renderer.getTextSize(e.chord[s].name,"annotationfont","annotation"),c=o.width,l=o.height/ha.STEP;switch(e.chord[s].position){case"left":a=-(n+=c+7),r=e.averagepitch,t.addExtra(new $a(e.chord[s].name,a,c+4,r,{type:"text",height:l}));break;case"right":a=i+=4,r=e.averagepitch,t.addRight(new $a(e.chord[s].name,a,c+4,r,{type:"text",height:l}));break;case"below":t.addRight(new $a(e.chord[s].name,0,c+8,void 0,{type:"text",position:"below",height:l}));break;case"above":t.addRight(new $a(e.chord[s].name,0,c+8,void 0,{type:"text",height:l}));break;default:if(e.chord[s].rel_position){var h=e.chord[s].rel_position.y+3*ha.STEP;t.addChild(new $a(e.chord[s].name,a+e.chord[s].rel_position.x,0,e.minpitch+h/ha.STEP,{type:"text",height:l}))}else{var u="above";e.positioning&&e.positioning.chordPosition&&(u=e.positioning.chordPosition),l=(o=this.renderer.getTextSize(e.chord[s].name,"gchordfont","chord")).height/ha.STEP,c=o.width,t.addCentered(new $a(e.chord[s].name,a,c,void 0,{type:"chord",position:u,height:l}))}}}return{roomTaken:n,roomTakenRight:i}},Co.prototype.createNote=function(i,s,r,o){var l,h=null,u=0,d=0,p=0,f=[],m=t(i),g=!1;0===m&&(g=!0,m=.25,s=!0);for(var v=Math.floor(Math.log(m)/Math.log(2)),b=0,_=Math.pow(2,v),y=_/2;_<m;b++,_+=y,y/=2);i.startTriplet&&(this.tripletmultiplier=i.tripletMultiplier);var w=m*this.tripletmultiplier;i.rest&&"multimeasure"===i.rest.type&&(w=1);var x=i.rest?"rest":"note",k=new Ya(i,w,1,x,this.tuneNumber,{durationClassOveride:i.duration*this.tripletmultiplier});if(e&&k.setHint(),i.rest){this.measureLength===m&&"invisible"!==i.rest.type&&"spacer"!==i.rest.type&&(i.rest.type="whole");var T=function(t,e,i,s,r,a,o,l,h){var u,d,p,f,m=7;switch(r&&("down"===a&&(m=3),"up"===a&&(m=11)),o&&(m=i<.5||i<1?7:5),e.rest.type){case"whole":u=n.rest[0],e.averagepitch=m,e.minpitch=m,e.maxpitch=m,s=0;break;case"rest":u="rhythm"===e.style?n.rhythm[-l]:n.rest[-l],e.averagepitch=m,e.minpitch=m,e.maxpitch=m;break;case"invisible":case"spacer":u="",e.averagepitch=m,e.minpitch=m,e.maxpitch=m;break;case"multimeasure":u=n.rest.multi,e.averagepitch=m,e.minpitch=m,e.maxpitch=m,s=0;var g=no.getSymbolWidth(u);t.addHead(new $a(u,-g,2*g,7));var v=new $a(""+e.duration,0,g,16,{type:"multimeasure-text"});t.addExtra(v)}if("multimeasure"!==e.rest.type){var b=c(t,u,{verticalPos:m},null,0,0,null,s,0,h,[],!1);(d=b.notehead)&&(t.addHead(d),p=b.accidentalshiftx,f=b.dotshiftx)}return{noteHead:d,roomTaken:p,roomTakenRight:f}}(k,i,m,b,o.voicetotal>1,this.stemdir,r,v,this.voiceScale);h=T.noteHead,u=T.roomTaken,d=T.roomTakenRight}else{var S=this.addNoteToAbcElement(k,i,b,this.stemdir,this.style,g,v,s,o);void 0!==S.min&&(this.minY=Math.min(S.min,this.minY)),h=S.noteHead,u=S.roomTaken,d=S.roomTakenRight,f=S.additionalLedgers,l=S.dir,p=S.symbolWidth}if(void 0!==i.lyric&&this.addLyric(k,i),void 0!==i.gracenotes&&(u+=this.addGraceNotes(i,o,k,h,this.stemHeight*this.voiceScale,this.isBagpipes,u)),i.decoration&&this.decoration.createDecoration(o,i.decoration,k.top,h?h.w:0,k,u,l,k.bottom,i.positioning,this.hasVocals),i.barNumber&&k.addChild(new $a(i.barNumber,-10,0,0,{type:"barNumber"})),a(k,i.minpitch,i.maxpitch,i.rest,p,f,l,-2,1),void 0!==i.chord){var C=this.addChord(k,i,u,d);u=C.roomTaken,d=C.roomTakenRight}return i.startTriplet&&(this.triplet=new To(i.startTriplet,h,{flatBeams:this.flatBeams})),i.endTriplet&&this.triplet&&this.triplet.setCloseAnchor(h),!this.triplet||i.startTriplet||i.endTriplet||this.triplet.middleNote(h),k};var c=function(t,e,n,i,s,r,a,o,c,l,h,u){var d,p=n.verticalPos,f=0,m=0,g=0;if(void 0===e)t.addChild(new $a("pitch is undefined",0,0,0,{type:"debug"}));else if(""===e)d=new $a(null,0,0,p);else{var v=s;if(n.printer_shift){var b="same"===n.printer_shift?1:0;v="down"===i?-no.getSymbolWidth(e)*l+b:no.getSymbolWidth(e)*l-b}var _={scalex:l,scaley:l,thickness:no.symbolHeightInPitches(e)*l};if((d=new $a(e,v,no.getSymbolWidth(e)*l,p,_)).stemDir=i,a){var y=p+("down"===i?-7:7)*l;u&&("down"===i&&y>6&&(y=6),"up"===i&&y<6&&(y=6));var w="down"===i?s:s+d.w-.6;t.addRight(new $a(a,w,no.getSymbolWidth(a)*l,y,{scalex:l,scaley:l}))}for(m=d.w+c-2+5*o;o>0;o--){var x=1-Math.abs(p)%2;t.addRight(new $a("dots.dot",d.w+c-2+5*o,no.getSymbolWidth("dots.dot"),p+x))}}if(d&&(d.highestVert=n.highestVert),n.accidental){var k;switch(n.accidental){case"quartersharp":k="accidentals.halfsharp";break;case"dblsharp":k="accidentals.dblsharp";break;case"sharp":k="accidentals.sharp";break;case"quarterflat":k="accidentals.halfflat";break;case"flat":k="accidentals.flat";break;case"dblflat":k="accidentals.dblflat";break;case"natural":k="accidentals.nat"}for(var T=!1,S=r,C=0;C<h.length;C++)if(p-h[C][0]>=6){h[C][0]=p,S=h[C][1],T=!0;break}!1===T&&(S-=no.getSymbolWidth(k)*l+2,h.push([p,S]),f=no.getSymbolWidth(k)*l+2),t.addExtra(new $a(k,S,no.getSymbolWidth(k),p,{scalex:l,scaley:l})),g=no.getSymbolWidth(k)/2}return{notehead:d,accidentalshiftx:f,dotshiftx:m,extraLeft:g}};Co.prototype.addSlursAndTies=function(t,n,i,s,r,a){if(n.endTie&&this.ties.length>0){for(var o=!1,c=0;c<this.ties.length;c++)if(this.ties[c].anchor1&&this.ties[c].anchor1.pitch===i.pitch){this.ties[c].setEndAnchor(i),this.ties.splice(c,1),o=!0;break}o||(this.ties[0].setEndAnchor(i),this.ties.splice(0,1))}var l=s.voicetotal<2?-1:s.voicenumber;if(n.startTie){var h=new mo({anchor1:i,force:"down"===this.stemdir||"up"===this.stemdir,stemDir:this.stemdir,isGrace:a,voiceNumber:l});e&&h.setHint(),this.ties[this.ties.length]=h,s.addOther(h),t.startTie=!0}if(n.endSlur)for(var u=0;u<n.endSlur.length;u++){var d=n.endSlur[u];this.slurs[d]?((f=this.slurs[d]).setEndAnchor(i),delete this.slurs[d]):(f=new mo({anchor2:i,stemDir:this.stemdir,voiceNumber:l}),e&&f.setHint(),s.addOther(f)),this.startlimitelem&&f.setStartX(this.startlimitelem)}else if(!a)for(var p in this.slurs)this.slurs.hasOwnProperty(p)&&this.slurs[p].addInternalNote(i);if(n.startSlur)for(u=0;u<n.startSlur.length;u++){d=n.startSlur[u].label;var f=new mo({anchor1:i,stemDir:this.stemdir,voiceNumber:l});e&&f.setHint(),this.slurs[d]=f,s.addOther(f)}},Co.prototype.addMeasureNumber=function(t,e){var n=this.renderer.getTextSize(t,"measurefont","bar-number");e.addChild(new $a(t,0,0,11+n.height/ha.STEP,{type:"barNumber"}))},Co.prototype.createBarLine=function(t,e,n){var i=new Ya(e,0,10,"bar",this.tuneNumber),s=null,r=0;e.barNumber&&this.addMeasureNumber(e.barNumber,i);var a="bar_right_repeat"===e.type||"bar_dbl_repeat"===e.type,o="bar_left_repeat"!==e.type&&"bar_thick_thin"!==e.type&&"bar_invisible"!==e.type,c="bar_right_repeat"===e.type||"bar_dbl_repeat"===e.type||"bar_left_repeat"===e.type||"bar_thin_thick"===e.type||"bar_thick_thin"===e.type,l="bar_left_repeat"===e.type||"bar_thick_thin"===e.type||"bar_thin_thin"===e.type||"bar_dbl_repeat"===e.type,h="bar_left_repeat"===e.type||"bar_dbl_repeat"===e.type;if(a||h){for(var u in this.slurs)this.slurs.hasOwnProperty(u)&&this.slurs[u].setEndX(i);this.startlimitelem=i}if(a&&(i.addRight(new $a("dots.dot",r,1,7)),i.addRight(new $a("dots.dot",r,1,5)),r+=6),o&&(s=new $a(null,r,1,2,{type:"bar",pitch2:10,linewidth:.6}),i.addRight(s)),"bar_invisible"===e.type&&(s=new $a(null,r,1,2,{type:"none",pitch2:10,linewidth:.6}),i.addRight(s)),e.decoration&&this.decoration.createDecoration(t,e.decoration,12,c?3:1,i,0,"down",2,e.positioning,this.hasVocals),c&&(s=new $a(null,r+=4,4,2,{type:"bar",pitch2:10,linewidth:4}),i.addRight(s),r+=5),this.partstartelem&&e.endEnding&&(this.partstartelem.anchor2=s,this.partstartelem=null),l&&(s=new $a(null,r+=3,1,2,{type:"bar",pitch2:10,linewidth:.6}),i.addRight(s)),h&&(r+=3,i.addRight(new $a("dots.dot",r,1,7)),i.addRight(new $a("dots.dot",r,1,5))),e.startEnding&&n){var d=this.renderer.getTextSize(e.startEnding,"repeatfont","").width;i.minspacing+=d+10,this.partstartelem=new bo(e.startEnding,s,null),t.addOther(this.partstartelem)}return i.extraw-=5,i}}();var Eo=Co,Mo="http://www.w3.org/2000/svg";function No(t){this.svg=Io(),t.appendChild(this.svg)}function Io(){var t=document.createElementNS(Mo,"svg");return t.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),t.setAttribute("role","img"),t}No.prototype.clear=function(){if(this.svg){var t=this.svg.parentNode;this.svg=Io(),t&&(t.innerHTML="",t.appendChild(this.svg))}},No.prototype.setTitle=function(t){var e=document.createElement("title"),n=document.createTextNode(t);e.appendChild(n),this.svg.insertBefore(e,this.svg.firstChild)},No.prototype.setResponsiveWidth=function(t,e){if(this.svg.setAttribute("viewBox","0 0 "+t+" "+e),this.svg.setAttribute("preserveAspectRatio","xMinYMin meet"),this.svg.removeAttribute("height"),this.svg.removeAttribute("width"),this.svg.style.display="inline-block",this.svg.style.position="absolute",this.svg.style.top="0",this.svg.style.left="0",this.svg.parentNode){var n=this.svg.parentNode.getAttribute("class");n?n.indexOf("abcjs-container")<0&&this.svg.parentNode.setAttribute("class",n+" abcjs-container"):this.svg.parentNode.setAttribute("class","abcjs-container"),this.svg.parentNode.style.display="inline-block",this.svg.parentNode.style.position="relative",this.svg.parentNode.style.width="100%";var i=e/t*100;this.svg.parentNode.style["padding-bottom"]=i+"%",this.svg.parentNode.style["vertical-align"]="middle",this.svg.parentNode.style.overflow="hidden"}},No.prototype.setSize=function(t,e){this.svg.setAttribute("width",t),this.svg.setAttribute("height",e)},No.prototype.setScale=function(t){1!==t?(this.svg.style.transform="scale("+t+","+t+")",this.svg.style["-ms-transform"]="scale("+t+","+t+")",this.svg.style["-webkit-transform"]="scale("+t+","+t+")",this.svg.style["transform-origin"]="0 0",this.svg.style["-ms-transform-origin-x"]="0",this.svg.style["-ms-transform-origin-y"]="0",this.svg.style["-webkit-transform-origin-x"]="0",this.svg.style["-webkit-transform-origin-y"]="0"):(this.svg.style.transform="",this.svg.style["-ms-transform"]="",this.svg.style["-webkit-transform"]="")},No.prototype.setParentStyles=function(t){for(var e in t)t.hasOwnProperty(e)&&this.svg.parentNode&&(this.svg.parentNode.style[e]=t[e]);this.dummySvg&&(document.querySelector("body").removeChild(this.dummySvg),this.dummySvg=null)},No.prototype.rect=function(t){var e=document.createElementNS(Mo,"rect");for(var n in t){if(t.hasOwnProperty(n))(""+t[n]).indexOf("NaN"),e.setAttributeNS(null,n,t[n])}return this.append(e),e},No.prototype.text=function(t,e,n){var i=document.createElementNS(Mo,"text");for(var s in e)e.hasOwnProperty(s)&&i.setAttribute(s,e[s]);for(var r=(""+t).split("\n"),a=0;a<r.length;a++){var o=document.createElementNS(Mo,"tspan");o.textContent=r[a],o.setAttribute("x",e.x?e.x:0),0!==a&&o.setAttribute("dy","1.2em"),i.appendChild(o)}return n?n.appendChild(i):this.append(i),i},No.prototype.guessWidth=function(t,e){var n,i=this.createDummySvg(),s=this.text(t,e,i);try{n=s.getBBox(),n=isNaN(n.height)||!n.height?{width:e["font-size"]/2,height:e["font-size"]+2}:{width:n.width,height:n.height}}catch(t){n={width:e["font-size"]/2,height:e["font-size"]+2}}return i.removeChild(s),n},No.prototype.createDummySvg=function(){if(!this.dummySvg){this.dummySvg=Io();this.dummySvg.setAttribute("style",["display: block !important;","height: 1px;","width: 1px;","position: absolute;"].join("")),document.querySelector("body").appendChild(this.dummySvg)}return this.dummySvg},No.prototype.getTextSize=function(t,e,n){if("number"==typeof t&&(t=""+t),!t||t.match(/^\s+$/))return{width:0,height:0};var i,s=!n;n||(n=this.text(t,e));try{i=n.getBBox(),i=isNaN(i.height)||!i.height?this.guessWidth(t,e):{width:i.width,height:i.height}}catch(n){i=this.guessWidth(t,e)}return s&&(this.currentGroup?this.currentGroup.removeChild(n):this.svg.removeChild(n)),i},No.prototype.openGroup=function(t){t=t||{};var e=document.createElementNS(Mo,"g");return t.prepend?this.svg.insertBefore(e,this.svg.firstChild):this.svg.appendChild(e),this.currentGroup=e,e},No.prototype.closeGroup=function(){var t=this.currentGroup;return this.currentGroup=null,t},No.prototype.path=function(t){var e=document.createElementNS(Mo,"path");for(var n in t)t.hasOwnProperty(n)&&("path"===n?e.setAttributeNS(null,"d",t.path):e.setAttributeNS(null,n,t[n]));return this.append(e),e},No.prototype.pathToBack=function(t){var e=document.createElementNS(Mo,"path");for(var n in t)t.hasOwnProperty(n)&&("path"===n?e.setAttributeNS(null,"d",t.path):e.setAttributeNS(null,n,t[n]));return this.prepend(e),e},No.prototype.append=function(t){this.currentGroup?this.currentGroup.appendChild(t):this.svg.appendChild(t)},No.prototype.prepend=function(t){this.currentGroup?this.currentGroup.appendChild(t):this.svg.insertBefore(t,this.svg.firstChild)},No.prototype.setAttributeOnElement=function(t,e){for(var n in e)e.hasOwnProperty(n)&&t.setAttributeNS(null,n,e[n])};var Oo=No,Po=function(t,e,n){this.paper=new Oo(t),this.controller=null,this.space=3*ha.SPACE,this.padding={},this.doRegression=e,this.shouldAddClasses=n,this.doRegression&&(this.regressionLines=[]),this.reset()};Po.prototype.reset=function(){this.paper.clear(),this.y=0,this.abctune=null,this.lastM=null,this.ingroup=!1,this.path=null,this.isPrint=!1,this.initVerticalSpace(),this.doRegression&&(this.regressionLines=[])},Po.prototype.newTune=function(t){this.abctune=t,this.setVerticalSpace(t.formatting),this.measureNumber=null,this.noteNumber=null,this.setPrintMode("print"===t.media),this.setPadding(t)},Po.prototype.createElemSet=function(){return this.paper.openGroup()},Po.prototype.closeElemSet=function(){return this.paper.closeGroup()},Po.prototype.setPrintMode=function(t){this.isPrint=t},Po.prototype.setPaperSize=function(t,e,n){var i=(t+this.padding.right)*e,s=(this.y+this.padding.bottom)*e;this.isPrint&&(s=Math.max(s,1056)),this.doRegression&&this.regressionLines.push("PAPER SIZE: ("+i+","+s+")");var r="Sheet Music";this.abctune&&this.abctune.metaText&&this.abctune.metaText.title&&(r+=' for "'+this.abctune.metaText.title+'"'),this.paper.setTitle(r);var a={overflow:"hidden"};"resize"===n?this.paper.setResponsiveWidth(i,s):(a.width="",a.height=s+"px",e<1?(a.width=i+"px",this.paper.setSize(i/e,s/e)):this.paper.setSize(i,s)),this.paper.setScale(e),this.paper.setParentStyles(a)},Po.prototype.setPaddingOverride=function(t){this.paddingOverride={top:t.paddingtop,bottom:t.paddingbottom,right:t.paddingright,left:t.paddingleft}},Po.prototype.setPadding=function(t){function e(e,n,i,s,r){void 0!==t.formatting[i]?e.padding[n]=t.formatting[i]:void 0!==e.paddingOverride[n]?e.padding[n]=e.paddingOverride[n]:e.isPrint?e.padding[n]=s:e.padding[n]=r}e(this,"top","topmargin",38,15),e(this,"bottom","botmargin",38,15),e(this,"left","leftmargin",68,15),e(this,"right","rightmargin",68,15)},Po.prototype.adjustNonScaledItems=function(t){this.padding.top/=t,this.padding.bottom/=t,this.padding.left/=t,this.padding.right/=t,this.abctune.formatting.headerfont.size/=t,this.abctune.formatting.footerfont.size/=t},Po.prototype.initVerticalSpace=function(){this.spacing={composer:7.56,graceBefore:8.67,graceInside:10.67,graceAfter:16,info:0,lineSkipFactor:1.1,music:7.56,paragraphSkipFactor:.4,parts:11.33,slurHeight:1,staffSeparation:61.33,stemHeight:36.67,subtitle:3.78,systemStaffSeparation:48,text:18.9,title:7.56,top:30.24,vocal:30.67,words:0}},Po.prototype.setVerticalSpace=function(t){void 0!==t.staffsep&&(this.spacing.staffSeparation=4*t.staffsep/3),void 0!==t.composerspace&&(this.spacing.composer=4*t.composerspace/3),void 0!==t.partsspace&&(this.spacing.parts=4*t.partsspace/3),void 0!==t.textspace&&(this.spacing.text=4*t.textspace/3),void 0!==t.musicspace&&(this.spacing.music=4*t.musicspace/3),void 0!==t.titlespace&&(this.spacing.title=4*t.titlespace/3),void 0!==t.sysstaffsep&&(this.spacing.systemStaffSeparation=4*t.sysstaffsep/3),void 0!==t.subtitlespace&&(this.spacing.subtitle=4*t.subtitlespace/3),void 0!==t.topspace&&(this.spacing.top=4*t.topspace/3),void 0!==t.vocalspace&&(this.spacing.vocal=4*t.vocalspace/3),void 0!==t.wordsspace&&(this.spacing.words=4*t.wordsspace/3)},Po.prototype.topMargin=function(t){this.moveY(this.padding.top)},Po.prototype.addMusicPadding=function(){this.moveY(this.spacing.music)},Po.prototype.addStaffPadding=function(t,e){var n=-(t.staffs[t.staffs.length-1].bottom-2),i=(e.staffs[0].top-10+n)*ha.STEP;i<this.spacing.staffSeparation&&this.moveY(this.spacing.staffSeparation-i)},Po.prototype.engraveTopText=function(t,e){if(e.metaText.header&&this.isPrint){var n=this.getTextSize("XXXX","headerfont","abcjs-header abcjs-meta-top").height;this.y-=n,this.outputTextIf(this.padding.left,e.metaText.header.left,"headerfont","header meta-top",0,null,"start"),this.outputTextIf(this.padding.left+t/2,e.metaText.header.center,"headerfont","header meta-top",0,null,"middle"),this.outputTextIf(this.padding.left+t,e.metaText.header.right,"headerfont","header meta-top",0,null,"end"),this.y+=n}if(this.isPrint&&this.moveY(this.spacing.top),this.outputTextIf(this.padding.left+t/2,e.metaText.title,"titlefont","title meta-top",this.spacing.title,0,"middle"),e.lines[0]&&this.outputTextIf(this.padding.left+t/2,e.lines[0].subtitle,"subtitlefont","text meta-top",this.spacing.subtitle,0,"middle"),e.metaText.rhythm||e.metaText.origin||e.metaText.composer){this.moveY(this.spacing.composer);var i=this.outputTextIf(this.padding.left,e.metaText.rhythm,"infofont","meta-top",0,null,"start"),s="";if(e.metaText.composer&&(s+=e.metaText.composer),e.metaText.origin&&(s+=" ("+e.metaText.origin+")"),s.length>0){var r=this.outputTextIf(this.padding.left+t,s,"composerfont","meta-top",0,null,"end");this.moveY(r[1])}else this.moveY(i[1]);this.moveY(-6)}this.outputTextIf(this.padding.left+t,e.metaText.author,"composerfont","meta-top",0,0,"end"),this.outputTextIf(this.padding.left,e.metaText.partOrder,"partsfont","meta-bottom",0,0,"start")},Po.prototype.engraveExtraText=function(t,e){if(this.lineNumber=null,this.measureNumber=null,this.noteNumber=null,this.voiceNumber=null,e.metaText.unalignedWords){var n=this.getFontAndAttr("wordsfont","meta-bottom"),i=this.getTextSize("i","wordsfont","meta-bottom");e.metaText.unalignedWords.length>0&&this.moveY(this.spacing.words,1);for(var s=0;s<e.metaText.unalignedWords.length;s++)if(""===e.metaText.unalignedWords[s])this.moveY(n.font.size,1);else if("string"==typeof e.metaText.unalignedWords[s])this.outputTextIf(this.padding.left+ha.INDENT,e.metaText.unalignedWords[s],"wordsfont","meta-bottom",0,0,"start");else{for(var r=0,a=0,o=0;o<e.metaText.unalignedWords[s].length;o++){var c=e.metaText.unalignedWords[s][o],l=c.font?c.font:"wordsfont",h=(this.renderText(this.padding.left+ha.INDENT+a,this.y,c.text,l,"meta-bottom",!1),this.getTextSize(c.text,l,"meta-bottom"));r=Math.max(r,h.height),a+=h.width," "===c.text[c.text.length-1]&&(a+=i.width)}this.moveY(r,1)}e.metaText.unalignedWords.length>0&&this.moveY(n.font.size,2)}var u="";e.metaText.book&&(u+="Book: "+e.metaText.book+"\n"),e.metaText.source&&(u+="Source: "+e.metaText.source+"\n"),e.metaText.discography&&(u+="Discography: "+e.metaText.discography+"\n"),e.metaText.notes&&(u+="Notes: "+e.metaText.notes+"\n"),e.metaText.transcription&&(u+="Transcription: "+e.metaText.transcription+"\n"),e.metaText.history&&(u+="History: "+e.metaText.history+"\n"),e.metaText["abc-copyright"]&&(u+="Copyright: "+e.metaText["abc-copyright"]+"\n"),e.metaText["abc-creator"]&&(u+="Creator: "+e.metaText["abc-creator"]+"\n"),e.metaText["abc-edited-by"]&&(u+="Edited By: "+e.metaText["abc-edited-by"]+"\n"),this.outputTextIf(this.padding.left,u,"historyfont","meta-bottom",this.spacing.info,0,"start"),e.metaText.footer&&this.isPrint&&(this.outputTextIf(this.padding.left,e.metaText.footer.left,"footerfont","header meta-bottom",0,null,"start"),this.outputTextIf(this.padding.left+t/2,e.metaText.footer.center,"footerfont","header meta-bottom",0,null,"middle"),this.outputTextIf(this.padding.left+t,e.metaText.footer.right,"footerfont","header meta-bottom",0,null,"end"))},Po.prototype.outputFreeText=function(t,e){e&&this.moveY(e);var n=this.getFontAndAttr("textfont","defined-text");if(""===t)this.moveY(2*n.attr["font-size"]);else if("string"==typeof t)this.moveY(n.attr["font-size"]/2),this.outputTextIf(this.padding.left,t,"textfont","defined-text",0,0,"start");else{for(var i="",s=!1,r=0;r<t.length;r++)t[r].font&&(i+="FONT("+t[r].font+")"),i+=t[r].text,t[r].center&&(s=!0);var a=s?"middle":"start",o=s?this.controller.width/2:this.padding.left;this.outputTextIf(o,i,"textfont","defined-text",0,1,a)}},Po.prototype.outputSeparator=function(t){t.lineLength&&(this.moveY(t.spaceAbove),this.printSeparator(t.lineLength),this.moveY(t.spaceBelow))},Po.prototype.outputSubtitle=function(t,e){this.outputTextIf(this.padding.left+t/2,e,"subtitlefont","text meta-top",this.spacing.subtitle,0,"middle")},Po.prototype.beginGroup=function(){this.path=[],this.lastM=[0,0],this.ingroup=!0},Po.prototype.addPath=function(t){if(0!==(t=t||[]).length){t[0][0]="m",t[0][1]-=this.lastM[0],t[0][2]-=this.lastM[1],this.lastM[0]+=t[0][1],this.lastM[1]+=t[0][2],this.path.push(t[0]);for(var e=1,n=t.length;e<n;e++)"m"===t[e][0]&&(this.lastM[0]+=t[e][1],this.lastM[1]+=t[e][2]),this.path.push(t[e])}},Po.prototype.endGroup=function(t){if(this.ingroup=!1,0===this.path.length)return null;for(var e="",n=0;n<this.path.length;n++)e+=this.path[n].join(" ");var i=this.paper.path({path:e,stroke:"none",fill:"#000000",class:this.addClasses(t)});return this.path=[],this.doRegression&&this.addToRegression(i),i},Po.prototype.printStaveLine=function(t,e,n,i){var s="staff";void 0!==i&&(s+=" "+i);var r=.35,a=this.calcY(n),o=co("M %f %f L %f %f L %f %f L %f %f z",t,a-r,e,a-r,e,a+r,t,a+r),c=this.paper.pathToBack({path:o,stroke:"none",fill:"#000000",class:this.addClasses(s)});return this.doRegression&&this.addToRegression(c),c},Po.prototype.printStem=function(t,e,n,i){if(e<0){var s=i;i=n,n=s}~~t===t&&(t+=.05);var r=[["M",t,n],["L",t,i],["L",t+e,i],["L",t+e,n],["z"]];if(!this.ingroup){for(var a="",o=0;o<r.length;o++)a+=r[o].join(" ");var c=this.paper.pathToBack({path:a,stroke:"none",fill:"#000000",class:this.addClasses("stem")});return this.doRegression&&this.addToRegression(c),c}this.addPath(r)},Po.prototype.printSymbol=function(t,e,n,i,s,r){var a,o,c,l,h,u;if(!n)return null;if(n.length>1&&n.indexOf(".")<0){this.paper.openGroup();for(var d=0,p=0;p<n.length;p++){var f=n.charAt(p);o=no.getYCorr(f),(a=no.printSymbol(t+d,this.calcY(e+o),f,this.paper,r))?(this.doRegression&&this.addToRegression(a),p<n.length-1&&(d+=(c=f,l=n.charAt(p+1),h=no.getSymbolWidth(f),u=void 0,u=h,"f"===c&&"f"===l&&(u=2*u/3),"p"===c&&"p"===l&&(u=5*u/6),"f"===c&&"z"===l&&(u=5*u/8),u))):this.renderText(t,this.y,"no symbol:"+n,"debugfont","debug-msg","start")}return this.paper.closeGroup()}if(o=no.getYCorr(n),this.ingroup)this.addPath(no.getPathForSymbol(t,this.calcY(e+o),n,i,s));else{if(a=no.printSymbol(t,this.calcY(e+o),n,this.paper,r))return this.doRegression&&this.addToRegression(a),a;this.renderText(t,this.y,"no symbol:"+n,"debugfont","debug-msg","start")}return null},Po.prototype.scaleExistingElem=function(t,e,n,i,s){this.paper.setAttributeOnElement(t,{style:"transform:scale("+e+","+n+");transform-origin:"+i+"px "+s+"px;"})},Po.prototype.printPath=function(t){var e=this.paper.path(t);return this.doRegression&&this.addToRegression(e),e},Po.prototype.drawBrace=function(t,e,n){var i=n-e,s=[7.5,-8,21,0,18.5,-10.5,7.5],r=[0,i/5.5,i/3.14,i/2,i/2.93,i/4.88,0],a=co("M %f %f C %f %f %f %f %f %f C %f %f %f %f %f %f z",t+s[0],e+r[0],t+s[1],e+r[1],t+s[2],e+r[2],t+s[3],e+r[3],t+s[4],e+r[4],t+s[5],e+r[5],t+s[6],e+r[6]),o=this.paper.path({path:a,stroke:"#000000",fill:"#000000",class:this.addClasses("brace")});a=co("M %f %f C %f %f %f %f %f %f C %f %f %f %f %f %f z",t+(s=[0,17.5,-7.5,6.6,-5,20,0])[0],e+(r=[i/2,i/1.46,i/1.22,i,i/1.19,i/1.42,i/2])[0],t+s[1],e+r[1],t+s[2],e+r[2],t+s[3],e+r[3],t+s[4],e+r[4],t+s[5],e+r[5],t+s[6],e+r[6]);var c=this.paper.path({path:a,stroke:"#000000",fill:"#000000",class:this.addClasses("brace")});return this.doRegression&&(this.addToRegression(o),this.addToRegression(c)),o+c},Po.prototype.drawArc=function(t,e,n,i,s,r,a){var o=a?1.2:1.5;t+=6,e+=4,n+=s?o:-o,i+=s?o:-o;var c=this.calcY(n),l=this.calcY(i),h=e-t,u=l-c,d=Math.sqrt(h*h+u*u),p=h/d,f=u/d,m=d/3.5,g=a?10:25,v=(s?-1:1)*Math.min(g,Math.max(4,m)),b=t+m*p-v*f,_=c+m*f+v*p,y=e-m*p-v*f,w=l-m*f+v*p,x=co("M %f %f C %f %f %f %f %f %f C %f %f %f %f %f %f z",t,c,b,_,y,w,e,l,y-2*f,w+2*p,b-2*f,_+2*p,t,c);r?r+=" slur":r="slur";var k=this.paper.path({path:x,stroke:"none",fill:"#000000",class:this.addClasses(r)});return this.doRegression&&this.addToRegression(k),k},Po.prototype.calcY=function(t){return this.y-t*ha.STEP},Po.prototype.printStave=function(t,e,n){var i="top-line";if(this.paper.openGroup({prepend:!0}),1!==n){for(var s=n-1;s>=0;s--)this.printStaveLine(t,e,2*(s+1),i),i=void 0;this.paper.closeGroup()}else this.printStaveLine(t,e,6,i)},Po.prototype.addClasses=function(t,e){if(!this.shouldAddClasses)return"";var n=[];if(t.length>0&&n.push(t),null!==this.lineNumber&&void 0!==this.lineNumber&&n.push("l"+this.lineNumber),null!==this.measureNumber&&void 0!==this.measureNumber&&n.push("m"+this.measureNumber),null!==this.voiceNumber&&void 0!==this.voiceNumber&&n.push("v"+this.voiceNumber),(t.indexOf("note")>=0||t.indexOf("rest")>=0||t.indexOf("lyric")>=0)&&null!==this.noteNumber&&void 0!==this.noteNumber&&n.push("n"+this.noteNumber),n.length>0){n=(n=n.join(" ")).split(" ");for(var i=0;i<n.length;i++)0!==n[i].indexOf("abcjs-")&&n[i].length>0&&(n[i]="abcjs-"+n[i])}return n.join(" ")},Po.prototype.getFontAndAttr=function(t,e){var n,i={"font-size":(n="string"==typeof t?(n=this.abctune.formatting[t])?{face:n.face,size:4*n.size/3,decoration:n.decoration,style:n.style,weight:n.weight,box:n.box}:{face:"Arial",size:16,decoration:"underline",style:"normal",weight:"normal"}:{face:t.face,size:4*t.size/3,decoration:t.decoration,style:t.style,weight:t.weight,box:t.box}).size,"font-style":n.style,"font-family":n.face,"font-weight":n.weight,"text-decoration":n.decoration,class:this.addClasses(e),font:""};return{font:n,attr:i}},Po.prototype.getTextSize=function(t,e,n,i){var s=this.getFontAndAttr(e,n),r=this.paper.getTextSize(t,s.attr,i);return s.font.box&&(r.height+=8,r.width+=8),r},Po.prototype.renderText=function(t,e,n,i,s,r,a){var o=this.getFontAndAttr(i,s);r&&(o.attr["text-anchor"]=r),o.attr.x=t,o.attr.y=e+7,a||(o.attr.dy="0.5em"),"debugfont"===i&&(console.log("Debug msg: "+n),o.attr.stroke="#ff0000"),n=(n=n.replace(/\n\n/g,"\n \n")).replace(/^\n/," \n"),o.font.box&&(o.attr.x+=2,o.attr.y+=4);var c=this.paper.text(n,o.attr);if(o.font.box){var l=this.getTextSize(n,i,s);this.paper.rect({x:t-2,y:e,width:l.width+4,height:l.height+4-2,stroke:"#888888",fill:"transparent"})}return this.doRegression&&this.addToRegression(c),c},Po.prototype.moveY=function(t,e){void 0===e&&(e=1),this.y+=t*e},Po.prototype.skipSpaceY=function(){this.y+=this.space},Po.prototype.outputTextIf=function(t,e,n,i,s,r,a){if(e){s&&this.moveY(s);this.renderText(t,this.y,e,n,i,a);var o=this.getTextSize(e,n,i),c=isNaN(o.width)?0:o.width,l=isNaN(o.height)?0:o.height;if(this.getFontAndAttr(n,i).font.box&&(c+=8,l+=8),null!==r){var h=e.split("\n").length;isNaN(o.height)||this.moveY(l/h,h+r)}return[c,l]}return[0,0]},Po.prototype.addInvisibleMarker=function(t){var e=.35,n=this.y;n=Math.round(n);var i=co("M %f %f L %f %f L %f %f L %f %f z",0,n-e,100,n-e,100,n+e,0,n+e);this.paper.pathToBack({path:i,stroke:"none",fill:"rgba(0,0,0,0)","fill-opacity":0,class:this.addClasses(t),"data-vertical":n})},Po.prototype.printSeparator=function(t){var e=Math.round(this.y),n=(this.controller.width-t)/2,i=n+t,s="M "+n+" "+e+" L "+i+" "+e+" L "+i+" "+(e+1)+" L "+n+" "+(e+1)+" L "+n+" "+e+" z";this.paper.pathToBack({path:s,stroke:"rgba(0,0,0,0)",fill:"rgba(0,0,0,255)",class:this.addClasses("defined-text")})},Po.prototype.printHorizontalLine=function(t,e,n){var i=.35,s="rgba(0,0,255,.4)",r=this.y;e&&(r=e),r=Math.round(r),this.paper.text(""+Math.round(r),{x:10,y:r,"text-anchor":"start","font-size":"18px",fill:s,stroke:s});var a=co("M %f %f L %f %f L %f %f L %f %f z",50,r-i,50+t,r-i,t,r+i,50,r+i);this.paper.pathToBack({path:a,stroke:"none",fill:s,class:this.addClasses("staff")});for(var o=1;o<t/100;o++)a=co("M %f %f L %f %f L %f %f L %f %f z",100*o-i,r-5,100*o-i,r+5,100*o+i,r-5,100*o+i,r+5),this.paper.pathToBack({path:a,stroke:"none",fill:s,class:this.addClasses("staff")});n&&this.paper.text(n,{x:t+70,y:r,"text-anchor":"start","font-size":"18px",fill:s,stroke:s})},Po.prototype.printShadedBox=function(t,e,n,i,s,r,a){var o=this.paper.rect({x:t,y:e,width:n,height:i,fill:s,stroke:s,"fill-opacity":r,"stroke-opacity":r});return a&&this.paper.text(a,{x:0,y:e+7,"text-anchor":"start","font-size":"14px",fill:"rgba(0,0,255,.4)",stroke:"rgba(0,0,255,.4)"}),o},Po.prototype.printVerticalLine=function(t,e,n){var i=.35,s="#00aaaa",r=co("M %f %f L %f %f L %f %f L %f %f z",t-i,e,t-i,n,t+i,e,t+i,n);this.paper.pathToBack({path:r,stroke:"none",fill:s,class:this.addClasses("staff")}),r=co("M %f %f L %f %f L %f %f L %f %f z",t-20,e,t-20,e+3,t,e,t,e+3),this.paper.pathToBack({path:r,stroke:"none",fill:s,class:this.addClasses("staff")}),r=co("M %f %f L %f %f L %f %f L %f %f z",t+20,n,t+20,n+3,t,n,t,n+3),this.paper.pathToBack({path:r,stroke:"none",fill:s,class:this.addClasses("staff")})},Po.prototype.addToRegression=function(t){var e;try{e=t.getBBox()}catch(t){e={width:0,height:0}}var n=t.type+" "+e.toString()+" ",i=[];for(var s in t.attrs)t.attrs.hasOwnProperty(s)&&("class"===s?n=t.attrs[s]+" "+n:i.push(s+": "+t.attrs[s]));i.sort(),n+="{ "+i.join(" ")+" }",this.regressionLines.push(n)};var Do=Po,Bo=ha,Ro=function(t,e){e=e||{},this.responsive=e.responsive,this.space=3*Bo.SPACE,this.scale=e.scale?parseFloat(e.scale):0,this.scale>.1||(this.scale=void 0),e.staffwidth?(this.staffwidthScreen=e.staffwidth,this.staffwidthPrint=e.staffwidth):(this.staffwidthScreen=740,this.staffwidthPrint=680),this.editable=e.editable||!1,this.listeners=[],e.clickListener&&this.addSelectListener(e.clickListener),this.renderer=new Do(t,e.regression,e.add_classes),this.renderer.setPaddingOverride(e),this.renderer.controller=this,this.reset()};function Lo(t,e,n,i,s,r,a){return t&&i/n<.66&&!e||Math.abs(n-i)<2?null:r>0?((s=(n-(i-r*s))/r)*a>50&&(s=50/a),s):null}Ro.prototype.reset=function(){this.selected=[],this.ingroup=!1,this.staffgroups=[],this.lastStaffGroupIndex=-1,this.engraver&&this.engraver.reset(),this.engraver=null,this.renderer.reset()},Ro.prototype.engraveABC=function(t,e){void 0===t[0]&&(t=[t]),this.reset();for(var n=0;n<t.length;n++)void 0===e&&(e=n),this.engraveTune(t[n],e);if(this.renderer.doRegression)return this.renderer.regressionLines.join("\n")},Ro.prototype.adjustNonScaledItems=function(t){this.width/=t,this.renderer.adjustNonScaledItems(t)},Ro.prototype.getMeasureWidths=function(t){this.reset(),this.renderer.lineNumber=null,this.renderer.newTune(t),this.engraver=new Eo(this.renderer,0,{bagpipes:t.formatting.bagpipes,flatbeams:t.formatting.flatbeams}),this.engraver.setStemHeight(this.renderer.spacing.stemHeight),t.formatting.staffwidth?this.width=1.33*t.formatting.staffwidth:this.width=this.renderer.isPrint?this.staffwidthPrint:this.staffwidthScreen;var e=t.formatting.scale?t.formatting.scale:this.scale;"resize"===this.responsive&&(e=void 0),void 0===e&&(e=this.renderer.isPrint?.75:1),this.adjustNonScaledItems(e);var n={left:0,measureWidths:[],height:0,total:0};n.height=this.renderer.padding.top+this.renderer.spacing.music+this.renderer.padding.bottom+24;for(var i=!1,s=0;s<t.lines.length;s++){var r=t.lines[s];if(r.staff){if(r.staffGroup=this.engraver.createABCLine(r.staff,i?null:t.metaText.tempo),r.staffGroup.layout(0,this.renderer,false),r.staffGroup.voices.length>0)for(var a=r.staffGroup.voices[0],o=!1,c=0,l=0;l<a.children.length;l++){var h=a.children[l];o||h.isClef||h.isKeySig||(o=!0,n.left=h.x,c=h.x),"bar"===h.type&&(n.measureWidths.push(h.x-c),n.total+=h.x-c,c=h.x)}i=!0,n.height+=r.staffGroup.calcHeight()*Bo.STEP}}return n},Ro.prototype.engraveTune=function(t,e){this.renderer.lineNumber=null,this.renderer.newTune(t),this.engraver=new Eo(this.renderer,e,{bagpipes:t.formatting.bagpipes,flatbeams:t.formatting.flatbeams}),this.engraver.setStemHeight(this.renderer.spacing.stemHeight),this.engraver.measureLength=t.getMeterFraction().num/t.getMeterFraction().den,t.formatting.staffwidth?this.width=1.33*t.formatting.staffwidth:this.width=this.renderer.isPrint?this.staffwidthPrint:this.staffwidthScreen;var n,i,s=t.formatting.scale?t.formatting.scale:this.scale;"resize"===this.responsive&&(s=void 0),void 0===s&&(s=this.renderer.isPrint?.75:1),this.adjustNonScaledItems(s);var r=!1;for(n=0;n<t.lines.length;n++)(i=t.lines[n]).staff&&(i.staffGroup=this.engraver.createABCLine(i.staff,r?null:t.metaText.tempo),r=!0);var a=this.width;for(n=0;n<t.lines.length;n++)(i=t.lines[n]).staff&&(this.setXSpacing(i.staffGroup,t.formatting,n===t.lines.length-1,!1),i.staffGroup.w>a&&(a=i.staffGroup.w));for(n=0;n<t.lines.length;n++)if((i=t.lines[n]).staffGroup&&i.staffGroup.voices){for(var o=0;o<i.staffGroup.voices.length;o++)i.staffGroup.voices[o].layoutBeams();i.staffGroup.setUpperAndLowerElements(this.renderer)}for(n=0;n<t.lines.length;n++)(i=t.lines[n]).staffGroup&&(i.staffGroup.height=i.staffGroup.calcHeight());this.renderer.topMargin(t),this.renderer.engraveTopText(this.width,t),this.renderer.addMusicPadding(),this.staffgroups=[],this.lastStaffGroupIndex=-1;for(var c=0;c<t.lines.length;c++)this.renderer.lineNumber=c,(i=t.lines[c]).staff?this.engraveStaffLine(i.staffGroup):i.subtitle&&0!==c?this.renderer.outputSubtitle(this.width,i.subtitle):void 0!==i.text?this.renderer.outputFreeText(i.text,i.vskip):void 0!==i.separator&&this.renderer.outputSeparator(i.separator);this.renderer.moveY(24),this.renderer.engraveExtraText(this.width,t),this.renderer.setPaperSize(a,s,this.responsive)},Ro.prototype.setXSpacing=function(t,e,n,i){for(var s=this.space,r=0;r<8;r++){var a=t.layout(s,this.renderer,i);if(s=Lo(n,!!e.stretchlast&&e.stretchlast,this.width+this.renderer.padding.left,t.w,s,a.spacingUnits,a.minSpace),i&&console.log("setXSpace",r,t.w,s,t.minspace),null===s)break}!function(t){for(var e=0;e<t.length;e++)for(var n=t[e],i=1;i<n.children.length-1;i++){var s=n.children[i];if(s.abcelem.rest&&("whole"===s.abcelem.rest.type||"multimeasure"===s.abcelem.rest.type)){var r=n.children[i-1],a=(n.children[i+1].x-r.x)/2+r.x;s.x=a-s.w/2;for(var o=0;o<s.children.length;o++)s.children[o].x=s.x}}}(t.voices)},Ro.prototype.engraveStaffLine=function(t){this.lastStaffGroupIndex>-1&&this.renderer.addStaffPadding(this.staffgroups[this.lastStaffGroupIndex],t),this.renderer.voiceNumber=null,t.draw(this.renderer);var e=t.height*Bo.STEP;this.staffgroups[this.staffgroups.length]=t,this.lastStaffGroupIndex=this.staffgroups.length-1,this.renderer.y+=e},Ro.prototype.notifySelect=function(t,e,n){this.clearSelection(),t.highlight&&(this.selected=[t],t.highlight());for(var i=t.abcelem||{},s=0;s<this.listeners.length;s++)this.listeners[s](i,e,n)},Ro.prototype.clearSelection=function(){for(var t=0;t<this.selected.length;t++)this.selected[t].unhighlight();this.selected=[]},Ro.prototype.addSelectListener=function(t){this.listeners[this.listeners.length]=t},Ro.prototype.rangeHighlight=function(t,e){this.clearSelection();for(var n=0;n<this.staffgroups.length;n++)for(var i=this.staffgroups[n].voices,s=0;s<i.length;s++)for(var r=i[s].children,a=0;a<r.length;a++){var o=r[a].abcelem.startChar,c=r[a].abcelem.endChar;(e>o&&t<c||e===t&&e===c)&&(this.selected[this.selected.length]=r[a],r[a].highlight())}};var Vo=Ro,Ho={};function Fo(){var t=window.innerWidth;for(var e in Ho)if(Ho.hasOwnProperty(e)){var n=Ho[e];t-=2*n.offsetLeft,n.style.width=t+"px"}}function qo(t,e,n,i){n.viewportHorizontal?(t.innerHTML='<div class="abcjs-inner"></div>',n.scrollHorizontal?(t.style.overflowX="auto",t.style.overflowY="hidden"):t.style.overflow="hidden",Ho[t.id]=t,t=t.children[0]):n.viewportVertical?(t.innerHTML='<div class="abcjs-inner scroll-amount"></div>',t.style.overflowX="hidden",t.style.overflowY="auto",t=t.children[0]):t.innerHTML="";var s=new Vo(t,n);(s.engraveABC(e,i),e.engraver=s,n.viewportVertical||n.viewportHorizontal)&&(t.parentNode.style.width=t.style.width)}function zo(t,e,n,i){function s(t){var e=new qa;return e.formatting=t.formatting,e.media=t.media,e.version=t.version,e.metaText={},e.lines=[],e}for(var r,a=[],o=0;o<e.lines.length;o++){var c=e.lines[o];r||(r=s(e)),0===o&&(r.metaText.tempo=e.metaText.tempo,r.metaText.title=e.metaText.title,r.metaText.header=e.metaText.header,r.metaText.rhythm=e.metaText.rhythm,r.metaText.origin=e.metaText.origin,r.metaText.composer=e.metaText.composer,r.metaText.author=e.metaText.author,r.metaText.partOrder=e.metaText.partOrder),r.lines.push(c),c.staff&&(a.push(r),r=void 0)}if(r)for(var l=a[a.length-1],h=0;h<r.lines.length;h++)l.lines.push(r.lines[h]);(r=a[a.length-1]).metaText.unalignedWords=e.metaText.unalignedWords,r.metaText.book=e.metaText.book,r.metaText.source=e.metaText.source,r.metaText.discography=e.metaText.discography,r.metaText.notes=e.metaText.notes,r.metaText.transcription=e.metaText.transcription,r.metaText.history=e.metaText.history,r.metaText["abc-copyright"]=e.metaText["abc-copyright"],r.metaText["abc-creator"]=e.metaText["abc-creator"],r.metaText["abc-edited-by"]=e.metaText["abc-edited-by"],r.metaText.footer=e.metaText.footer;var u={};for(var d in n)n.hasOwnProperty(d)&&(u[d]=n[d]);var p=u.paddingtop,f=u.paddingbottom;t.innerHTML="";for(var m=0;m<a.length;m++){var g=document.createElement("div");t.appendChild(g),0===m?(u.paddingtop=p,u.paddingbottom=-20):m===a.length-1?(u.paddingtop=10,u.paddingbottom=f):(u.paddingtop=10,u.paddingbottom=-20),qo(g,a[m],u,i),0===m?e.engraver=a[m].engraver:e.engraver.staffgroups?a[m].engraver.staffgroups.length>0&&e.engraver.staffgroups.push(a[m].engraver.staffgroups[0]):e.engraver.staffgroups=a[m].engraver.staffgroups}}window.addEventListener("resize",Fo),window.addEventListener("orientationChange",Fo);var Go=function(t,e,n,i,s){var r,a={};if(n)for(r in n)n.hasOwnProperty(r)&&(a[r]=n[r]);if(i)for(r in i)i.hasOwnProperty(r)&&("listener"===r?i[r].highlight&&(a.clickListener=i[r].highlight):a[r]=i[r]);if(s)for(r in s)s.hasOwnProperty(r)&&(a[r]=s[r]);return ja.renderEngine((function(t,e,n,i){var s=!1;return"*"===t&&(s=!0,(t=document.createElement("div")).setAttribute("style","display:none;"),document.body.appendChild(t)),a.afterParsing&&a.afterParsing(e,n,i),!s&&a.wrap&&a.staffwidth?e=function(t,e,n,i,s){var r=new Vo(t,s),a=r.getMeasureWidths(e),o=Fa.calcLineWraps(e,a,i,s,za,r);!s.oneSvgPerLine||o.tune.lines.length<2?qo(t,o.tune,o.revisedParams,n):zo(t,o.tune,o.revisedParams,n);return o.tune.explanation=o.explanation,o.tune}(t,e,n,i,a):(s||!a.oneSvgPerLine||e.lines.length<2?qo(t,e,a,n):zo(t,e,a,n),s&&t.parentNode.removeChild(t),null)}),t,e,a)},jo={},Wo=function(t,e,n,i){return new Promise((function(s,r){jo[e]||(jo[e]={});var a=jo[e];if("error"===a[n])return r(new Error("Unable to load sound font "+t+" "+e+" "+n));if(a[n])return s({instrument:e,name:n});a[n]="pending";var o=new XMLHttpRequest;o.open("GET",t+e+"-mp3/"+n+".mp3",!0),o.responseType="arraybuffer";var c=this;function l(t){a[n]=t,s({instrument:e,name:n})}function h(t){c.debugCallback&&c.debugCallback(t),console.log(t),r(t)}o.onload=function(e){if(200!==this.status){a[n]="error";var s="Onload error loading sound: "+n+" "+t+" "+e.currentTarget.status+" "+e.currentTarget.statusText;return c.debugCallback&&c.debugCallback(s),r(new Error(s))}i.decodeAudioData(this.response,l,h)},o.addEventListener("error",(function(){a[n]="error";var e="Error in loading sound:  "+t;return c.debugCallback&&c.debugCallback(e),r(new Error(e))}),!1),o.send()}))},Yo=["acoustic_grand_piano","bright_acoustic_piano","electric_grand_piano","honkytonk_piano","electric_piano_1","electric_piano_2","harpsichord","clavinet","celesta","glockenspiel","music_box","vibraphone","marimba","xylophone","tubular_bells","dulcimer","drawbar_organ","percussive_organ","rock_organ","church_organ","reed_organ","accordion","harmonica","tango_accordion","acoustic_guitar_nylon","acoustic_guitar_steel","electric_guitar_jazz","electric_guitar_clean","electric_guitar_muted","overdriven_guitar","distortion_guitar","guitar_harmonics","acoustic_bass","electric_bass_finger","electric_bass_pick","fretless_bass","slap_bass_1","slap_bass_2","synth_bass_1","synth_bass_2","violin","viola","cello","contrabass","tremolo_strings","pizzicato_strings","orchestral_harp","timpani","string_ensemble_1","string_ensemble_2","synth_strings_1","synth_strings_2","choir_aahs","voice_oohs","synth_choir","orchestra_hit","trumpet","trombone","tuba","muted_trumpet","french_horn","brass_section","synth_brass_1","synth_brass_2","soprano_sax","alto_sax","tenor_sax","baritone_sax","oboe","english_horn","bassoon","clarinet","piccolo","flute","recorder","pan_flute","blown_bottle","shakuhachi","whistle","ocarina","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","sitar","banjo","shamisen","koto","kalimba","bagpipe","fiddle","shanai","tinkle_bell","agogo","steel_drums","woodblock","taiko_drum","melodic_tom","synth_drum","reverse_cymbal","guitar_fret_noise","breath_noise","seashore","bird_tweet","telephone_ring","helicopter","applause","gunshot","percussion"],Uo=function(t){for(var e=[],n=0;n<t.tracks.length;n++)e.push([]);var i={},s=Yo[0];return t.tracks.forEach((function(t,n){var r=0;t.forEach((function(t){switch(t.cmd){case"start":i[t.pitch]={time:r,instrument:s,volume:t.volume};break;case"move":r+=t.duration;break;case"stop":e[n].push({pitch:t.pitch,instrument:i[t.pitch].instrument,start:i[t.pitch].time,end:r,volume:i[t.pitch].volume}),delete i[t.pitch];break;case"program":s=Yo[t.instrument];break;default:console.log("Unhanded midi event",t)}}))})),e};var Xo=function(t){return window.abcjsAudioContext||(t||(t=new(t=window.AudioContext||window.webkitAudioContext||navigator.mozAudioContext||navigator.msAudioContext)),window.abcjsAudioContext=t),"suspended"!==window.abcjsAudioContext.state};var $o=function(){return window.abcjsAudioContext};var Zo=function(){var t=$o();return t?void 0!==t.resume:!!window.Promise&&(window.AudioContext||window.webkitAudioContext||navigator.mozAudioContext||navigator.msAudioContext)},Ko={21:"A0",22:"Bb0",23:"B0",24:"C1",25:"Db1",26:"D1",27:"Eb1",28:"E1",29:"F1",30:"Gb1",31:"G1",32:"Ab1",33:"A1",34:"Bb1",35:"B1",36:"C2",37:"Db2",38:"D2",39:"Eb2",40:"E2",41:"F2",42:"Gb2",43:"G2",44:"Ab2",45:"A2",46:"Bb2",47:"B2",48:"C3",49:"Db3",50:"D3",51:"Eb3",52:"E3",53:"F3",54:"Gb3",55:"G3",56:"Ab3",57:"A3",58:"Bb3",59:"B3",60:"C4",61:"Db4",62:"D4",63:"Eb4",64:"E4",65:"F4",66:"Gb4",67:"G4",68:"Ab4",69:"A4",70:"Bb4",71:"B4",72:"C5",73:"Db5",74:"D5",75:"Eb5",76:"E5",77:"F5",78:"Gb5",79:"G5",80:"Ab5",81:"A5",82:"Bb5",83:"B5",84:"C6",85:"Db6",86:"D6",87:"Eb6",88:"E6",89:"F6",90:"Gb6",91:"G6",92:"Ab6",93:"A6",94:"Bb6",95:"B6",96:"C7",97:"Db7",98:"D7",99:"Eb7",100:"E7",101:"F7",102:"Gb7",103:"G7",104:"Ab7",105:"A7",106:"Bb7",107:"B7",108:"C8",109:"Db8",110:"D8",111:"Eb8",112:"E8",113:"F8",114:"Gb8",115:"G8",116:"Ab8",117:"A8",118:"Bb8",119:"B8",120:"C9",121:"Db9"};var Qo,Jo=function(t){return window.URL.createObjectURL(function(t){var e,n,i=t.length,s=t[0].length*i*2+44,r=new ArrayBuffer(s),a=new DataView(r),o=[],c=0,l=0;for(u(1179011410),u(s-8),u(1163280727),u(544501094),u(16),h(1),h(i),u(t[0].sampleRate),u(2*t[0].sampleRate*i),h(2*i),h(16),u(1635017060),u(s-l-4),e=0;e<t.length;e++)o.push(t[e].getChannelData(0));for(;l<s;){for(e=0;e<o.length;e++)n=0|(.5+(n=Math.max(-1,Math.min(1,o[e][c])))<0?32768*n:32767*n),a.setInt16(l,n,!0),l+=2;c++}return new Blob([r],{type:"audio/wav"});function h(t){a.setUint16(l,t,!0),l+=2}function u(t){a.setUint32(l,t,!0),l+=4}}(t.audioBuffers))};!function(){var t;function e(t){var e=1/4;t.duration&&(e=t.duration[0]);var n=60;return t.bpm&&(n=t.bpm),e*n/.25}function n(e){var n;switch(e.type){case"common_time":n={el_type:"meter",num:4,den:4};break;case"cut_time":n={el_type:"meter",num:2,den:2};break;case"specified":n={el_type:"meter",num:e.value[0].num,den:e.value[0].den};break;default:n={el_type:"meter"}}return t=n.num/n.den,n}Qo=function(i,s){var r=void 0,a=(s=s||{}).program||0,o=s.midiTranspose||0,c=s.channel||0,l=s.drum||"",h=s.drumBars||1,u=s.drumIntro||0,d=""!==l;a=parseInt(a,10),o=parseInt(o,10),10===(c=parseInt(c,10))&&(a=128),l=l.split(" "),h=parseInt(h,10),u=parseInt(u,10);var p=i.formatting.bagpipes;p&&(a=71);var f=[];if(i.formatting.midi){var m=i.formatting.midi;m.program&&m.program.length>0&&(a=m.program[0],m.program.length>1&&(a=m.program[1],c=m.program[0])),m.transpose&&(o=m.transpose[0]),m.channel&&(c=m.channel[0]),m.drum&&(l=m.drum),m.drumbars&&(h=m.drumbars[0]),m.drumon&&(d=!0),10===c&&(a=128),m.beat&&f.push({el_type:"beat",beats:m.beat}),m.nobeataccents&&f.push({el_type:"beataccents",value:!1})}r=s.qpm?parseInt(s.qpm,10):i.metaText.tempo?e(i.metaText.tempo):s.defaultQpm?s.defaultQpm:180;var g=[];p&&g.push({el_type:"bagpipes"}),g.push({el_type:"instrument",program:a}),c&&g.push({el_type:"channel",channel:c}),o&&g.push({el_type:"transpose",transpose:o}),g.push({el_type:"tempo",qpm:r});for(var v=0;v<f.length;v++)g.push(f[v]);for(var b=[],_=[],y=[],w=!1,x=0;x<i.lines.length;x++){var k=i.lines[x];if(k.staff)for(var T=k.staff,S=0,C=0;C<T.length;C++)for(var A=T[C],E=0;E<A.voices.length;E++){var M=A.voices[E];if(b[S]||(b[S]=[].concat(JSON.parse(JSON.stringify(g)))),A.clef&&"perc"===A.clef.type)for(var N=0;N<b[S].length;N++)"instrument"===b[S][N].el_type&&(b[S][N].program=128);else A.key&&("HP"===A.key.root?b[S].push({el_type:"key",accidentals:[{acc:"natural",note:"g"},{acc:"sharp",note:"f"},{acc:"sharp",note:"c"}]}):b[S].push({el_type:"key",accidentals:A.key.accidentals}));A.meter&&b[S].push(n(A.meter)),!w&&d&&(b[S].push({el_type:"drum",params:{pattern:l,bars:h,on:d,intro:u}}),w=!0),A.clef&&A.clef.transpose&&(A.clef.el_type="clef",b[S].push({el_type:"transpose",transpose:A.clef.transpose})),i.formatting.midi&&i.formatting.midi.drumoff&&(b[S].push({el_type:"bar"}),b[S].push({el_type:"drum",params:{pattern:"",on:!1}}));for(var I=0,O=0;O<M.length;O++){var P=M[O];switch(P.el_type){case"note":P.rest&&"spacer"===P.rest.type||(P.decoration&&(P.decoration.indexOf("ppp")>=0?b[S].push({el_type:"beat",beats:[30,20,10,1]}):P.decoration.indexOf("pp")>=0?b[S].push({el_type:"beat",beats:[45,35,20,1]}):P.decoration.indexOf("p")>=0?b[S].push({el_type:"beat",beats:[60,50,35,1]}):P.decoration.indexOf("mp")>=0?b[S].push({el_type:"beat",beats:[75,65,50,1]}):P.decoration.indexOf("mf")>=0?b[S].push({el_type:"beat",beats:[90,80,65,1]}):P.decoration.indexOf("f")>=0?b[S].push({el_type:"beat",beats:[105,95,80,1]}):P.decoration.indexOf("ff")>=0?b[S].push({el_type:"beat",beats:[120,110,95,1]}):P.decoration.indexOf("fff")>=0&&b[S].push({el_type:"beat",beats:[127,125,110,1]})),b[S].push(P),I++);break;case"key":"HP"===P.root?b[S].push({el_type:"key",accidentals:[{acc:"natural",note:"g"},{acc:"sharp",note:"f"},{acc:"sharp",note:"c"}]}):b[S].push({el_type:"key",accidentals:P.accidentals});break;case"meter":b[S].push(n(P));break;case"clef":P.transpose&&b[S].push({el_type:"transpose",transpose:P.transpose});break;case"tempo":r=e(P),b[S].push({el_type:"tempo",qpm:r});break;case"bar":I>0&&b[S].push({el_type:"bar"}),I=0;var D="bar_right_repeat"===P.type||"bar_dbl_repeat"===P.type,B="1"===P.startEnding,R="bar_left_repeat"===P.type||"bar_dbl_repeat"===P.type||"bar_right_repeat"===P.type;if(D){var L=_[S];L||(L=0);var V=y[S];V||(V=b[S].length),b[S]=b[S].concat(b[S].slice(L,V)),y[S]=void 0,_[S]=void 0}B&&(y[S]=b[S].length),R&&(_[S]=b[S].length);break;case"style":case"part":break;case"stem":case"scale":break;case"midi":var H=!1;switch(P.cmd){case"drumon":d=!0,H=!0;break;case"drumoff":d=!1,H=!0;break;case"drum":l=P.params,H=!0;break;case"drumbars":h=P.params[0],H=!0;break;case"drummap":break;case"program":b[S].push({el_type:"instrument",program:P.params[0]});break;case"transpose":b[S].push({el_type:"transpose",transpose:P.params[0]});break;case"gchordoff":b[S].push({el_type:"gchord",tacet:!0});break;case"gchordon":b[S].push({el_type:"gchord",tacet:!1});break;case"beat":b[S].push({el_type:"beat",beats:P.params});break;case"nobeataccents":b[S].push({el_type:"beataccents",value:!1});break;case"beataccents":b[S].push({el_type:"beataccents",value:!0});break;case"vol":b[S].push({el_type:"vol",volume:P.params[0]});break;case"volinc":b[S].push({el_type:"volinc",volume:P.params[0]});break;default:console.log("MIDI seq: midi cmd not handled: ",P.cmd,P)}H&&(b[0].push({el_type:"drum",params:{pattern:l,bars:h,intro:u,on:d}}),w=!0);break;default:console.log("MIDI: element type "+P.el_type+" not handled.")}}S++}}if(u)for(var F=i.getPickupLength(),q=0;q<b.length;q++){for(var z=0;"note"!==b[q][z].el_type&&b[q].length>z;)z++;if(b[q].length>z)for(var G=0;G<u;G++)0===F||G<u-1?b[q].splice(z,0,{el_type:"note",rest:{type:"rest"},duration:t},{el_type:"bar"}):b[q].splice(z,0,{el_type:"note",rest:{type:"rest"},duration:t-F})}return b}}();var tc,ec=Qo;!function(){var t,e,n,i,s,r,a,o,c,l,h,u,d,p,f,m,g,v,b,_,y,w,x=1,k={num:4,den:4},T=!1,S=!0,C=105,A=95,E=85,M=.25,N={},I=1/128;function O(t){for(var e=0,n=0;n<t.length;n++){for(var i=t[n],s=0,r=0;r<i.length;r++){var a=i[r];a.duration&&(s+=a.duration)}e=Math.max(e,s)}return e}function P(t){switch(t.den){case 2:return.5;case 4:return.25;case 8:return.375;case 16:return.125}return.25}tc=function(I,D){D||(D={}),t=[],e=[0,0,0,0,0,0,0],i=!1,s=1,r=[],a=void 0,x=1,o=void 0,c=void 0,l=void 0,d=void 0,h={},k={num:4,den:4},p=[],m=I.length,f=!1,g=[],v=void 0,b=0,T=!!D.chordsOff,S=!0,C=105,A=95,E=85,M=.25,_=void 0,y=void 0,w=[],N={},function(t){for(var e=0;e<t.length;e++)for(var n=t[e],i=0;i<n.length;i++){delete n[i].currentTrackMilliseconds}}(I);for(var B=0;B<I.length;B++){n=0,u=-1;var L=I[B];l=[{cmd:"program",channel:B,instrument:o}],d=0,h={};for(var V=0;V<L.length;V++){var F=L[V];switch(F.el_type){case"note":R(F,D.voicesOff);break;case"key":e=H(F);break;case"meter":M=P(k=F);break;case"tempo":a?x=F.qpm?a/F.qpm:1:a=F.qpm;break;case"transpose":n=F.transpose;break;case"bar":p.length>0&&0===B&&(X(),g=[]),b=0,t=[],0===B&&Z(I.length+1);break;case"bagpipes":i=!0;break;case"instrument":if(void 0===o&&(o=F.program),c=F.program,l.length>0&&"program"===l[l.length-1].cmd)l[l.length-1].instrument=F.program;else{var q;for(q=l.length-1;q>=0&&"program"!==l[q].cmd;q--);(q<0||l[q].instrument!==F.program)&&l.push({cmd:"program",channel:B,instrument:F.program})}break;case"channel":break;case"drum":N=$(F.params);break;case"gchord":D.chordsOff||(T=F.tacet);break;case"beat":C=F.beats[0],A=F.beats[1],E=F.beats[2];break;case"vol":_=F.volume;break;case"volinc":y=F.volume;break;case"beataccents":S=F.value;break;default:console.log("MIDI creation. Unknown el_type: "+F.el_type+"\n")}}void 0===l[0].instrument&&(l[0].instrument=o||0),r.push(l),p.length>0&&(f=!0),w.length}return p.length>0&&r.push(p),w.length>0&&r.push(w),{tempo:a,instrument:o,tracks:r,totalDuration:O(r)}};var D=["break","(break)","no chord","n.c.","tacet"];function B(){for(var t=0,e=0;e<l.length;e++)"move"===l[e].cmd&&(t+=l[e].duration);return t}function R(t,e){var r;_?(r=_,_=void 0):r=S?0===b?C:b%M<.001?A:E:A,y&&(r+=y,y=void 0),r<0&&(r=0),r>127&&(r=127);var o=e?0:r,w=function(t){if(T)return"break";if(f||!t.chord||0===t.chord.length)return null;for(var e=0;e<t.chord.length;e++){var n=t.chord[e];if("default"===n.position)return n.name;if(D.indexOf(n.name.toLowerCase())>=0)return"break"}return null}(t);if(w){var k=function(t){if(0===t.length)return;if("break"===t)return{chick:[]};var e=t.substring(0,1);if("("===e){if(0===(t=t.substring(1,t.length-2)).length)return;e=t.substring(0,1)}var i=z[e];if(!i)return;var s,r=(i+=n)-5;1===t.length&&(s=j(i,""));var a=t.substring(1),o=a.substring(0,1);"b"===o||"♭"===o?(i--,r--,a=a.substring(1)):"#"!==o&&"♯"!==o||(i++,r++,a=a.substring(1));var c=a.split("/");if(s=j(i,c[0]),2===c.length){if(z[c[1].substring(0,1)]){var l={"#":1,"♯":1,b:-1,"♭":-1}[c[1].substring(1)]||0;r=i=z[c[1].substring(0,1)]+l+n}}return{boom:i,boom2:r,chick:s}}(w);if(k){if(0===p.length){p.push({cmd:"program",channel:m,instrument:0});var N=B();N>0&&p.push({cmd:"move",duration:N*x})}v=k,g.push({chord:v,beat:b})}}t.startTriplet&&(s=t.tripletMultiplier);var O,P=(t.durationClass?t.durationClass:t.duration)*s;if(b+=P,t.gracenotes){var R=i||u<0||0===l.length,L=R?P:l[u].duration;O=function(t,e){for(var n,i=0,s=[],r=0;r<t.length;r++)i+=(n=t[r]).duration;var a=2*(i/=8)>e?e/(2*i):1;for(r=0;r<t.length;r++){var o=(n=t[r]).midipitch?n.midipitch-60:n.pitch;s.push({pitch:o,duration:n.duration/8*a})}return s}(t.gracenotes,L),i||(P=F(O,R,P,null,o))}if(t.currentTrackMilliseconds||(t.currentTrackMilliseconds=[]),t.currentTrackMilliseconds.push(d/M/a*60*1e3),t.pitches){O&&i&&(P=F(O,!0,P,null,o));var H=[];t.midiPitches=[];for(var q=0;q<t.pitches.length;q++){var G=t.pitches[q],W=V(G);if(H.push({pitch:W,startTie:G.startTie}),t.midiPitches.push({pitch:W+60,durationInMeasures:P*x,volume:r,instrument:c}),h[""+W]){for(var Y=l.length-1;Y>=0;Y--)if("start"===l[Y].cmd&&l[Y].pitch===W&&l[Y].elem){for(var U=l[Y].elem.midiPitches,X=0;X<U.length;X++)U[X].pitch-60===W&&(U[X].durationInMeasures+=P*x);break}}else l.push({cmd:"start",pitch:W,volume:o});G.startTie?(h[""+W]=!0,l[l.length-1].elem=t):G.endTie&&(h[""+W]=!1)}if(t.gracenotes)for(var $=0;$<t.gracenotes.length;$++){t.midiGraceNotePitches=[];var Z=t.gracenotes[$];t.midiGraceNotePitches.push({pitch:V(Z)+60,durationInMeasures:0,volume:r,instrument:c})}var K=I,Q=P-I;Q<0&&(Q=0,K=0),l.push({cmd:"move",duration:Q*x}),u=l.length-1,d+=Q*x;for(var J=0;J<H.length;J++)h[""+H[J].pitch]||l.push({cmd:"stop",pitch:H[J].pitch});l.push({cmd:"move",duration:K*x}),d+=K*x}else t.rest&&(l.push({cmd:"move",duration:P*x}),d+=P*x);t.endTriplet&&(s=1)}var L=[0,2,4,5,7,9,11];function V(i){if(i.midipitch)return i.midipitch-60;var s=i.pitch;if(i.accidental)switch(i.accidental){case"sharp":t[s]=1;break;case"flat":t[s]=-1;break;case"natural":t[s]=0;break;case"dblsharp":t[s]=2;break;case"dblflat":t[s]=-2}var r=12*function(t){return Math.floor(t/7)}(s)+L[q(s)];return void 0!==t[s]?r+=t[s]:r+=e[q(s)],r+=n}function H(t){var e=[0,0,0,0,0,0,0];if(!t.accidentals)return e;for(var n=0;n<t.accidentals.length;n++){var i=t.accidentals[n],s="sharp"===i.acc?1:"natural"===i.acc?0:-1;e[q(i.note.toLowerCase().charCodeAt(0)-"c".charCodeAt(0))]+=s}return e}function F(t,e,n,i,s){for(var r=0;r<t.length;r++){var a=t[r];a!==i&&l.push({cmd:"start",pitch:a.pitch,volume:s}),l.push({cmd:"move",duration:t[r].duration*x}),a!==i&&l.push({cmd:"stop",pitch:a.pitch}),e||(l[u].duration-=t[r].duration),n-=t[r].duration}return n}function q(t){return(t%=7)<0&&(t+=7),t}var z={A:-27,B:-25,C:-24,D:-22,E:-20,F:-19,G:-17};var G={dim:[0,3,6],"°":[0,3,6],"˚":[0,3,6],dim7:[0,3,6,9],"°7":[0,3,6,9],"˚7":[0,3,6,9],"ø7":[0,3,6,10],"m7(b5)":[0,3,6,10],m7b5:[0,3,6,10],"-7(b5)":[0,3,6,10],"-7b5":[0,3,6,10],"7b5":[0,4,6,10],"7(b5)":[0,4,6,10],"7♭5":[0,4,6,10],"7(b9,b5)":[0,4,6,10,13],"7b9,b5":[0,4,6,10,13],"7(#9,b5)":[0,4,6,10,15],"7#9b5":[0,4,6,10,15],"maj7(b5)":[0,3,6,11],maj7b5:[0,3,6,11],"13(b5)":[0,4,6,10,14,18],"13b5":[0,4,6,10,14,18],m:[0,3,7],"-":[0,3,7],m6:[0,3,7,9],"-6":[0,3,7,9],m7:[0,3,7,10],"-7":[0,3,7,10],"-(b6)":[0,3,7,8],"-b6":[0,3,7,8],"-6/9":[0,3,7,9,14],"-7(b9)":[0,3,7,10,13],"-7b9":[0,3,7,10,13],"-maj7":[0,3,7,11],"-9+7":[0,3,7,11,13],"-11":[0,3,7,11,14,16],M:[0,4,7],6:[0,4,7,9],"6/9":[0,4,7,9,14],7:[0,4,7,10],9:[0,4,7,10,14],11:[0,4,7,10,14,16],13:[0,4,7,10,14,18],"7b9":[0,4,7,10,13],"7♭9":[0,4,7,10,13],"7(b9)":[0,4,7,10,13],"7(#9)":[0,4,7,10,15],"7#9":[0,4,7,10,15],"(13)":[0,4,7,10,14,18],"7(9,13)":[0,4,7,10,14,18],"7(#9,b13)":[0,4,7,10,15,17],"7(#11)":[0,4,7,10,14,17],"7#11":[0,4,7,10,14,17],"7(b13)":[0,4,7,10,17],"7b13":[0,4,7,10,17],"9(#11)":[0,4,7,10,14,17],"9#11":[0,4,7,10,14,17],"13(#11)":[0,4,7,10,15,18],"13#11":[0,4,7,10,15,18],maj7:[0,4,7,11],"∆7":[0,4,7,11],"Δ7":[0,4,7,11],maj9:[0,4,7,11,14],"maj7(9)":[0,4,7,11,14],"maj7(11)":[0,4,7,11,16],"maj7(#11)":[0,4,7,11,17],"maj7(13)":[0,4,7,11,18],"maj7(9,13)":[0,4,7,11,14,18],"7sus4":[0,5,7,10],m7sus4:[0,5,7,10],sus4:[0,5,7],sus2:[0,2,7],"7sus2":[0,2,7,10],"9sus4":[0,5,7,14],"13sus4":[0,5,7,18],aug7:[0,4,8,10],"+7":[0,4,8,10],"+":[0,4,8],"7#5":[0,4,8,10],"7♯5":[0,4,8,10],"7+5":[0,4,8,10],"9#5":[0,4,8,10,14],"9♯5":[0,4,8,10,14],"9+5":[0,4,8,10,14],"-7(#5)":[0,3,8,10],"-7#5":[0,3,8,10],"7(#5)":[0,4,8,10],"7(b9,#5)":[0,4,8,10,13],"7b9#5":[0,4,8,10,13],"maj7(#5)":[0,4,8,11],"maj7#5":[0,4,8,11],"maj7(#5,#11)":[0,4,8,11,14],"maj7#5#11":[0,4,8,11,14],"9(#5)":[0,4,8,10,14],"13(#5)":[0,4,8,10,14,18],"13#5":[0,4,8,10,14,18]};function j(t,e){var n=G[e];n||(n=G.M),t+=12;for(var i=[],s=0;s<n.length;s++)i.push(t+n[s]);return i}function W(t,e){void 0!==t&&p.push({cmd:"start",pitch:t,volume:64}),p.push({cmd:"move",duration:e/2*x}),void 0!==t&&p.push({cmd:"stop",pitch:t}),p.push({cmd:"move",duration:e/2*x})}function Y(t,e){for(var n=0;n<t.length;n++)p.push({cmd:"start",pitch:t[n],volume:48});for(p.push({cmd:"move",duration:e/2*x}),n=0;n<t.length;n++)p.push({cmd:"stop",pitch:t[n]});p.push({cmd:"move",duration:e/2*x})}var U={"2/2":["boom","chick"],"2/4":["boom","chick"],"3/4":["boom","chick","chick"],"4/4":["boom","chick","boom2","chick"],"5/4":["boom","chick","chick","boom2","chick"],"6/8":["boom","","chick","boom2","","chick"],"9/8":["boom","","chick","boom2","","chick","boom2","","chick"],"12/8":["boom","","chick","boom2","","chick","boom2","","chick","boom2","","chick"]};function X(){var t=k.num,e=k.den,n=1/e,i=U[t+"/"+e],s=parseInt(t,10)/parseInt(e,10),r=Math.abs(s-b);if(!i||r>.0078125){i=[];for(var a=b/n,o=0;o<a;o++)i.push("chick")}if(0===g.length&&g.push({beat:0,chord:v}),0!==g[0].beat&&v&&g.unshift({beat:0,chord:v}),1!==g.length){for(var c={},l=0;l<g.length;l++){var h=g[l];c[""+Math.floor(h.beat/n)]=h}for(var u=0;u<i.length;u++){var d;switch(c[""+u]&&(d=c[""+u]),i[u]){case"boom":c[""+(u+1)]?Y(d.chord.chick,n):W(d.chord.boom,n);break;case"boom2":c[""+(u+1)]?Y(d.chord.chick,n):W(d.chord.boom2,n);break;case"chick":Y(d.chord.chick,n);break;case"":c[""+u]?Y(d.chord.chick,n):p.push({cmd:"move",duration:n*x})}}}else for(var f=0;f<i.length;f++)switch(i[f]){case"boom":W(g[0].chord.boom,n);break;case"boom2":W(g[0].chord.boom2,n);break;case"chick":Y(g[0].chord.chick,n);break;case"":p.push({cmd:"move",duration:n*x})}}function $(t){if(0===t.pattern.length||!1===t.on)return{on:!1};for(var e=t.pattern[0],n=[],i="",s=0,r=0;r<e.length;r++)if("d"===e[r]&&s++,"d"===e[r]||"z"===e[r])0!==i.length?(n.push(i),i=e[r]):i+=e[r];else{if(0===i.length)return{on:!1};i+=e[r]}if(0!==i.length&&n.push(i),t.pattern.length!==2*s+1)return{on:!1};for(var a={on:!0,bars:t.bars,pattern:[]},o=1/k.den,c=0,l=0;l<n.length;l++){i=n[l];for(var h=1,u=!1,d=0,p=1;p<i.length;p++)switch(i[p]){case"/":0!==d&&(h*=d),d=0,u=!0;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":d=10*d+i[p];break;default:return{on:!1}}u?(0===d&&(d=2),h/=d):d&&(h*=d),"d"===i[0]?(a.pattern.push({len:h*o,pitch:t.pattern[1+c],velocity:t.pattern[1+c+s]}),c++):a.pattern.push({len:h*o,pitch:null})}for(var f=0,m=k.num/k.den,g=0;g<a.pattern.length;g++)f+=a.pattern[g].len;var v=f/(t.bars?t.bars:1)/m;for(g=0;g<a.pattern.length;g++)a.pattern[g].len=a.pattern[g].len/v;return a}function Z(t){if(0!==w.length||N.on){var e,n,i,s=k.num/k.den;if(0===w.length){w.push({cmd:"program",channel:t,instrument:128});var r=B();if(r>0&&r<s-.01)return void w.push({cmd:"move",duration:r*x})}if(N.on)for(var a=0;a<N.pattern.length;a++){var o=N.pattern[a].len*x;N.pattern[a].pitch?(e=N.pattern[a].pitch,n=o,i=N.pattern[a].velocity,w.push({cmd:"start",pitch:e-60,volume:i}),w.push({cmd:"move",duration:n}),w.push({cmd:"stop",pitch:e-60})):w.push({cmd:"move",duration:o})}else w.push({cmd:"move",duration:s*x})}}}();var nc=tc,ic="MIDI is not supported in this browser.";var sc=function(){var t=this;t.audioBufferPossible=void 0,t.directSource=[],t.startTimeSec=void 0,t.pausedTimeSec=void 0,t.audioBuffers=[],t.duration=void 0,t.isRunning=!1,t.init=function(e){e||(e={}),Xo(e.audioContext);var n=$o().currentTime;if(t.debugCallback=e.debugCallback,t.debugCallback&&t.debugCallback("init called"),t.audioBufferPossible=t._deviceCapable(),!t.audioBufferPossible)return Promise.reject({status:"NotSupported",message:ic});t.soundFontUrl=e.soundFontUrl?e.soundFontUrl:"https://paulrosen.github.io/midi-js-soundfonts/FluidR3_GM/",t.millisecondsPerMeasure=e.millisecondsPerMeasure?e.millisecondsPerMeasure:e.visualObj?e.visualObj.millisecondsPerMeasure():1e3;var i=e.options?e.options:{};if(t.meterSize=1,e.visualObj){var s=ec(e.visualObj,i);t.flattened=nc(s,i),t.meterSize=e.visualObj.getMeterFraction().num/e.visualObj.getMeterFraction().den}else{if(!e.sequence)return Promise.reject(new Error("Must pass in either a visualObj or a sequence"));t.flattened=e.sequence}t.sequenceCallback=i.sequenceCallback,t.callbackContext=i.callbackContext,t.onEnded=e.onEnded;var r={},a=Yo[0];t.flattened.tracks.forEach((function(t){t.forEach((function(t){if("program"===t.cmd&&Yo[t.instrument]&&(a=Yo[t.instrument]),void 0!==t.pitch){var e=t.pitch+60;Ko[e]?(r[a]||(r[a]={}),r[a][Ko[e]]=!0):console.log("Can't find note: ",e)}}))})),t.debugCallback&&t.debugCallback("note gathering time = "+Math.floor(1e3*($o().currentTime-n))+"ms"),n=$o().currentTime;var o=[];Object.keys(r).forEach((function(t){Object.keys(r[t]).forEach((function(e){o.push({instrument:t,note:e})}))}));for(var c=[],l=0;l<o.length;l+=256)c.push(o.slice(l,l+256));return new Promise((function(e,i){var s=[],r=0,a=function(){r<c.length?t._loadBatch(c[r],t.soundFontUrl,n).then((function(t){n=$o().currentTime,s.push(t),r++,a()}),i):e(s)};a()}))},t._loadBatch=function(e,n,i){var s=[];return e.forEach((function(t){s.push(Wo(n,t.instrument,t.note,$o()))})),Promise.all(s).then((function(e){return t.debugCallback&&t.debugCallback("mp3 load time = "+Math.floor(1e3*($o().currentTime-i))+"ms"),Promise.resolve(e)}))},t.prime=function(){return t.isRunning=!1,t.audioBufferPossible?(t.debugCallback&&t.debugCallback("prime called"),new Promise((function(e){var n=$o().currentTime,i=t.millisecondsPerMeasure/1e3/t.meterSize;t.duration=t.flattened.totalDuration*i;var s=Math.floor($o().sampleRate*t.duration);t.stop();var r=Uo(t.flattened);t.sequenceCallback&&t.sequenceCallback(r,t.callbackContext),t.audioBuffers=[],r.forEach((function(e){var n=$o().createBuffer(1,s,$o().sampleRate),r=n.getChannelData(0);e.forEach((function(e){t._placeNote(r,e,i,jo)})),t.audioBuffers.push(n)})),t.debugCallback&&(t.debugCallback("sampleRate = "+$o().sampleRate),t.debugCallback("totalSamples = "+s),t.debugCallback("creationTime = "+Math.floor(1e3*($o().currentTime-n))+"ms")),e({status:"ok",seconds:0})}))):Promise.reject(new Error(ic))},t.start=function(){if(t.pausedTimeSec)t.resume();else{if(!t.audioBufferPossible)throw new Error(ic);t.debugCallback&&t.debugCallback("start called"),t._kickOffSound(0),t.startTimeSec=$o().currentTime,t.pausedTimeSec=void 0,t.debugCallback&&t.debugCallback("MIDI STARTED",t.startTimeSec)}},t.pause=function(){if(!t.audioBufferPossible)throw new Error(ic);t.debugCallback&&t.debugCallback("pause called"),t.pausedTimeSec||(t.stop(),t.pausedTimeSec=$o().currentTime)},t.resume=function(){if(!t.audioBufferPossible)throw new Error(ic);t.debugCallback&&t.debugCallback("resume called");var e=t.pausedTimeSec-t.startTimeSec;t.startTimeSec=$o().currentTime-e,t.pausedTimeSec=void 0,t._kickOffSound(e)},t.seek=function(e){var n=t.duration*e;if(!t.audioBufferPossible)throw new Error(ic);t.debugCallback&&t.debugCallback("seek called sec="+n),t.isRunning&&(t.stop(),t._kickOffSound(n));var i=t.pausedTimeSec?t.pausedTimeSec-t.startTimeSec:void 0;t.startTimeSec=$o().currentTime-n,t.pausedTimeSec&&(t.pausedTimeSec=t.startTimeSec+i)},t.stop=function(){t.isRunning=!1,t.pausedTimeSec=void 0,t.directSource.forEach((function(t){try{t.stop()}catch(t){console.log("direct source didn't stop:",t)}})),t.directSource=[]},t.download=function(){return Jo(t)},t._deviceCapable=function(){return!!Zo()||(console.warn(ic),t.debugCallback&&t.debugCallback(ic),!1)},t._kickOffSound=function(e){t.isRunning=!0,t.directSource=[],t.audioBuffers.forEach((function(e,n){t.directSource[n]=$o().createBufferSource(),t.directSource[n].buffer=e,t.directSource[n].connect($o().destination)})),t.directSource.forEach((function(t){t.start(0,e)})),t.onEnded&&(t.directSource[0].onended=function(){t.onEnded(t.callbackContext)})},t._placeNote=function(t,e,n,i){var s=Math.floor(e.start*$o().sampleRate*n),r=(e.end-e.start)*n,a=Ko[e.pitch+60];if(a)for(var o=i[e.instrument][a].getChannelData(0),c=Math.min(o.length,Math.floor(r*$o().sampleRate)),l=0;l<c;l++){var h=o[l]*e.volume/128;t[s+l]?t[s+l]=.75*(t[s+l]+h):t[s+l]=h}}},rc=function(){var t=this;t.tracks=[],t.totalDuration=0,t.addTrack=function(){return t.tracks.push([]),t.tracks.length-1},t.setInstrument=function(e,n){t.tracks[e].push({channel:0,cmd:"program",instrument:n})},t.appendNote=function(e,n,i,s){t.tracks[e].push({cmd:"start",pitch:n-60,volume:s}),t.tracks[e].push({cmd:"move",duration:i}),t.tracks[e].push({cmd:"stop",pitch:n-60});var r=0;t.tracks[e].forEach((function(t){t.duration&&(r+=t.duration)})),t.totalDuration=Math.max(t.totalDuration,r)}},ac='<svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 700" preserveAspectRatio="xMidYMid meet">\n<g transform="translate(0,700) scale(0.1,-0.1)" >\n<path d="M3111 6981 c-20 -37 -90 -55 -364 -96 -120 -18 -190 -33 -244 -55 -42 -17 -124 -42 -182 -56 -78 -18 -119 -34 -157 -60 -28 -19 -86 -46 -128 -60 -43 -13 -107 -42 -144 -64 -37 -23 -84 -46 -106 -52 -21 -7 -56 -29 -79 -50 -22 -22 -61 -50 -86 -63 -26 -13 -67 -40 -91 -60 -24 -20 -65 -47 -90 -60 -25 -13 -53 -31 -61 -41 -8 -9 -32 -30 -54 -46 -75 -54 -486 -460 -512 -507 -15 -25 -48 -69 -75 -98 -26 -28 -48 -57 -48 -63 0 -6 -18 -29 -39 -53 -21 -23 -56 -71 -77 -107 -20 -36 -50 -80 -65 -97 -16 -18 -33 -52 -40 -75 -12 -47 -47 -115 -84 -166 -13 -18 -30 -56 -38 -83 -8 -27 -34 -80 -56 -118 -33 -53 -46 -91 -62 -167 -12 -63 -34 -127 -59 -179 -42 -84 -60 -166 -60 -270 0 -90 26 -122 125 -154 54 -17 96 -19 430 -20 305 -1 381 2 430 14 82 22 140 51 153 78 6 12 22 47 37 77 14 30 38 77 54 103 15 27 34 73 40 103 7 30 28 78 48 107 19 28 44 74 55 101 10 28 34 67 53 87 18 20 49 61 68 90 19 30 44 63 57 74 13 11 36 40 52 65 59 94 232 270 306 313 20 11 57 37 82 58 25 20 70 52 100 72 30 19 66 47 79 61 13 14 49 35 80 46 30 12 80 37 111 56 31 19 95 45 143 58 48 12 110 37 139 55 63 40 127 55 323 76 83 9 208 28 279 41 156 29 165 29 330 4 453 -71 514 -84 606 -130 31 -16 83 -36 116 -45 32 -9 84 -34 115 -56 31 -21 82 -48 113 -60 32 -11 72 -33 89 -48 18 -16 59 -45 92 -65 33 -21 74 -51 90 -66 17 -15 49 -40 73 -54 52 -32 65 -61 50 -113 -8 -31 -61 -90 -277 -308 -300 -303 -361 -382 -369 -481 -2 -29 0 -66 6 -81 13 -40 88 -138 115 -151 12 -6 54 -26 92 -44 l70 -33 945 -2 c520 -1 975 2 1012 7 64 8 191 50 231 76 11 7 33 34 50 60 22 34 42 51 65 58 l32 9 0 1101 0 1102 -32 9 c-21 7 -44 26 -64 55 -60 84 -77 97 -140 110 -44 9 -76 10 -127 2 -59 -9 -77 -17 -134 -62 -37 -28 -172 -155 -301 -281 -129 -127 -249 -237 -267 -245 -25 -10 -41 -11 -71 -2 -58 15 -112 45 -124 69 -6 11 -35 35 -64 54 -28 18 -58 41 -66 50 -8 9 -41 35 -75 58 -33 22 -77 56 -99 75 -21 18 -64 46 -95 61 -31 14 -73 39 -93 55 -20 15 -70 40 -110 55 -40 15 -97 44 -127 64 -29 21 -78 44 -107 53 -30 8 -77 31 -105 51 -42 28 -73 39 -173 60 -68 14 -154 39 -196 58 -95 43 -131 51 -343 76 -209 24 -242 32 -279 70 l-30 29 -328 0 c-312 0 -330 -1 -339 -19z"></path>\n<path d="M254 2875 c-89 -16 -107 -26 -145 -78 -32 -44 -62 -66 -91 -67 -17 0 -18 -61 -18 -1140 l0 -1140 24 0 c16 0 41 -17 72 -50 40 -42 61 -55 117 -72 l69 -21 82 23 c44 12 96 30 114 39 18 9 148 132 290 272 141 141 267 261 279 268 51 26 86 14 176 -61 32 -26 62 -48 66 -48 5 0 36 -25 70 -55 34 -30 74 -61 89 -69 15 -8 37 -28 50 -45 12 -17 50 -45 84 -62 34 -17 78 -44 98 -60 19 -16 61 -37 93 -48 32 -11 81 -37 107 -56 27 -20 76 -45 109 -56 33 -12 75 -31 93 -44 62 -45 93 -58 191 -82 54 -12 130 -37 168 -54 68 -29 180 -58 226 -59 62 0 183 -64 183 -96 0 -12 88 -14 639 -14 l639 0 12 30 c18 44 76 66 233 89 89 14 160 30 200 47 34 15 106 42 159 60 54 18 112 44 130 57 47 35 85 52 146 67 29 7 76 28 105 48 29 20 77 48 107 63 30 15 66 39 80 54 14 15 50 40 81 56 31 15 78 46 104 69 26 22 61 46 79 54 17 7 43 26 56 42 14 16 41 41 60 56 64 48 380 362 408 405 15 23 40 51 55 63 15 12 36 38 46 58 11 21 37 57 58 82 22 25 49 62 62 83 13 20 38 56 57 78 19 23 50 74 69 113 19 39 46 86 59 104 14 18 34 62 46 98 12 36 32 77 45 92 31 38 60 97 80 167 9 33 26 76 37 95 29 50 47 103 68 206 10 52 32 117 51 155 29 56 33 74 34 140 0 94 -10 108 -101 138 -61 20 -83 21 -463 21 -226 0 -421 -4 -451 -10 -63 -12 -86 -30 -110 -85 -10 -22 -33 -63 -52 -92 -21 -31 -42 -80 -53 -123 -11 -44 -32 -93 -56 -128 -20 -32 -47 -83 -59 -115 -12 -32 -37 -77 -56 -100 -19 -23 -50 -65 -69 -94 -19 -29 -44 -57 -54 -63 -11 -5 -29 -27 -42 -47 -52 -85 -234 -277 -300 -315 -25 -15 -53 -38 -62 -51 -9 -14 -42 -39 -74 -57 -32 -18 -75 -48 -95 -66 -21 -18 -59 -44 -85 -58 -26 -13 -72 -40 -100 -59 -35 -24 -78 -41 -128 -52 -47 -11 -99 -31 -139 -56 -69 -42 -94 -49 -391 -110 -245 -51 -425 -66 -595 -50 -168 16 -230 27 -330 61 -47 16 -123 35 -170 44 -98 17 -123 25 -172 58 -20 14 -71 37 -114 53 -44 15 -95 40 -115 56 -20 16 -70 42 -110 59 -40 16 -88 45 -108 63 -20 19 -55 46 -78 61 -24 14 -49 35 -55 47 -7 11 -34 33 -60 49 -50 31 -65 61 -53 102 4 13 130 147 281 298 236 238 277 283 299 335 15 32 35 71 46 86 12 18 19 44 19 76 0 42 -8 63 -53 138 -92 151 11 139 -1207 141 -798 2 -1030 0 -1086 -11z"></path>\n</g>\n</svg>\n',oc='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" class="abcjs-play-svg">\n    <g>\n    <polygon points="4 0 23 12.5 4 25"/>\n    </g>\n</svg>',cc='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" class="abcjs-pause-svg">\n  <g>\n    <rect width="8.23" height="25"/>\n    <rect width="8.23" height="25" x="17"/>\n  </g>\n</svg>',lc='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" class="abcjs-loading-svg">\n    <circle cx="50" cy="50" fill="none" stroke-width="20" r="35" stroke-dasharray="160 55"></circle>\n</svg>',hc='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25">\n  <g>\n    <polygon points="5 12.5 24 0 24 25"/>\n    <rect width="3" height="25" x="0" y="0"/>\n  </g>\n</svg>';function uc(t,e,n,i,s){var r=!0;if($o()?r="suspended"===$o().state:Xo(),!Zo())throw{status:"NotSupported",message:"This browser does not support audio."};(r||s)&&n&&n.classList.add("abcjs-loading"),r?$o().resume().then((function(){i?i().then((function(i){dc(t,e,n,s)})):dc(t,e,n,s)})):dc(t,e,n,s)}function dc(t,e,n,i){i?t(e).then((function(){n&&n.classList.remove("abcjs-loading")})):(t(e),n&&n.classList.remove("abcjs-loading"))}var pc=function(t,e){var n=this;if("string"==typeof t){var i=t;if(!(t=document.querySelector(i)))throw new Error('Cannot find element "'+i+'" in the DOM.')}else if(!(t instanceof HTMLElement))throw new Error("The first parameter must be a valid element or selector in the DOM.");if(n.parent=t,n.options={},e&&(n.options=da.clone(e)),n.options.ac&&Xo(n.options.ac),function(t,e){var n=!!e.loopHandler,i=!!e.restartHandler,s=!!e.playHandler||!!e.playPromiseHandler,r=!!e.progressHandler,a=!!e.warpHandler,o=!1!==e.hasClock,c='<div class="abcjs-inline-audio">\n';if(n){var l=e.repeatTitle?e.repeatTitle:"Click to toggle play once/repeat.";c+='<button type="button" class="abcjs-midi-loop abcjs-btn" title="'+l+'" aria-label="'+(e.repeatAria?e.repeatAria:l)+'">'+ac+"</button>\n"}if(i){var h=e.restartTitle?e.restartTitle:"Click to go to beginning.";c+='<button type="button" class="abcjs-midi-reset abcjs-btn" title="'+h+'" aria-label="'+(e.restartAria?e.restartAria:h)+'">'+hc+"</button>\n"}if(s){var u=e.playTitle?e.playTitle:"Click to play/pause.";c+='<button type="button" class="abcjs-midi-start abcjs-btn" title="'+u+'" aria-label="'+(e.playAria?e.playAria:u)+'">'+oc+cc+lc+"</button>\n"}if(r){var d=e.randomTitle?e.randomTitle:"Click to change the playback position.";c+='<button type="button" class="abcjs-midi-progress-background" title="'+d+'" aria-label="'+(e.randomAria?e.randomAria:d)+'"><span class="abcjs-midi-progress-indicator"></span></button>\n'}o&&(c+='<span class="abcjs-midi-clock"></span>\n');if(a){var p=e.warpTitle?e.warpTitle:"Change the playback speed.";c+='<span class="abcjs-tempo-wrapper"><label><input class="abcjs-midi-tempo" type="number" min="1" max="300" value="100" title="'+p+'" aria-label="'+(e.warpAria?e.warpAria:p)+'">%</label><span>&nbsp;(<span class="abcjs-midi-current-tempo"></span> '+(e.bpm?e.bpm:"BPM")+")</span></span>\n"}c+="</div>\n",t.innerHTML=c}(n.parent,n.options),function(t){var e=!!t.options.loopHandler,n=!!t.options.restartHandler,i=!!t.options.playHandler||!!t.options.playPromiseHandler,s=!!t.options.progressHandler,r=!!t.options.warpHandler,a=t.parent.querySelector(".abcjs-midi-start");e&&t.parent.querySelector(".abcjs-midi-loop").addEventListener("click",(function(e){uc(t.options.loopHandler,e,a,t.options.afterResume)}));n&&t.parent.querySelector(".abcjs-midi-reset").addEventListener("click",(function(e){uc(t.options.restartHandler,e,a,t.options.afterResume)}));i&&a.addEventListener("click",(function(e){uc(t.options.playPromiseHandler||t.options.playHandler,e,a,t.options.afterResume,!!t.options.playPromiseHandler)}));s&&t.parent.querySelector(".abcjs-midi-progress-background").addEventListener("click",(function(e){uc(t.options.progressHandler,e,a,t.options.afterResume)}));r&&t.parent.querySelector(".abcjs-midi-tempo").addEventListener("change",(function(e){uc(t.options.warpHandler,e,a,t.options.afterResume)}))}(n),n.setTempo=function(t){var e=n.parent.querySelector(".abcjs-midi-current-tempo");e&&(e.innerHTML=t)},n.resetAll=function(){for(var t=n.parent.querySelectorAll(".abcjs-pushed"),e=0;e<t.length;e++){t[e].classList.remove("abcjs-pushed")}},n.pushPlay=function(t){var e=n.parent.querySelector(".abcjs-midi-start");e&&(t?e.classList.add("abcjs-pushed"):e.classList.remove("abcjs-pushed"))},n.pushLoop=function(t){var e=n.parent.querySelector(".abcjs-midi-loop");e&&(t?e.classList.add("abcjs-pushed"):e.classList.remove("abcjs-pushed"))},n.setProgress=function(t,e){var i=n.parent.querySelector(".abcjs-midi-progress-background"),s=n.parent.querySelector(".abcjs-midi-progress-indicator");if(i&&s){var r=i.clientWidth*t;s.style.left=r+"px";var a=n.parent.querySelector(".abcjs-midi-clock");if(a){var o=e*t/1e3,c=Math.floor(o/60),l=Math.floor(o%60),h=l<10?"0"+l:l;a.innerHTML=c+":"+h}}},n.options.afterResume){var s=!1;n.options.ac?s="suspended"!==n.options.ac.state:$o()&&(s="suspended"!==$o().state),s&&n.options.afterResume()}};var fc=function(t,e,n){for(var i=new rc,s=0;s<t.length;s++){var r=t[s],a=i.addTrack();if(i.setInstrument(a,r.instrument),0===s&&e)for(var o=0;o<e.length;o++){var c=e[o];i.appendNote(a,c.pitch,1/64,c.volume)}i.appendNote(a,r.pitch,r.durationInMeasures,r.volume)}var l=new sc;return l.init({sequence:i,millisecondsPerMeasure:n}).then((function(){return l.prime()})).then((function(){return l.start()}))};var mc=function(){var t=this;t.warp=100,t.cursorControl=null,t.visualObj=null,t.timer=null,t.midiBuffer=null,t.options=null,t.currentTempo=null,t.control=null,t.isLooping=!1,t.isStarted=!1,t.isLoaded=!1,t.load=function(e,n,i){i||(i={}),t.control=new pc(e,{loopHandler:i.displayLoop?t.toggleLoop:void 0,restartHandler:i.displayRestart?t.restart:void 0,playPromiseHandler:i.displayPlay?t.play:void 0,progressHandler:i.displayProgress?t.randomAccess:void 0,warpHandler:i.displayWarp?t.onWarp:void 0,afterResume:t.init}),t.cursorControl=n},t.setTune=function(e,n,i){return t.isLoaded=!1,t.visualObj=e,t.options=i,t.control&&(t.pause(),t.setProgress(0,1),t.control.resetAll(),t.restart(),t.isStarted=!1),t.isLooping=!1,n?t.go():Promise.resolve({status:"no-audio-context"})},t.go=function(){var e=100*t.visualObj.millisecondsPerMeasure()/t.warp;return t.currentTempo=Math.round(t.visualObj.getBeatsPerMeasure()/e*6e4),t.control&&t.control.setTempo(t.currentTempo),t.percent=0,t.midiBuffer||(t.midiBuffer=new sc),t.midiBuffer.init({visualObj:t.visualObj,options:t.options,millisecondsPerMeasure:e}).then((function(){return t.midiBuffer.prime()})).then((function(){var e=16;return t.cursorControl&&void 0!==t.cursorControl.beatSubdivisions&&parseInt(t.cursorControl.beatSubdivisions,10)>=1&&parseInt(t.cursorControl.beatSubdivisions,10)<=64&&(e=parseInt(t.cursorControl.beatSubdivisions,10)),t.timer=new ga(t.visualObj,{beatCallback:t.beatCallback,eventCallback:t.eventCallback,lineEndCallback:t.lineEndCallback,qpm:t.currentTempo,extraMeasuresAtBeginning:t.cursorControl?t.cursorControl.extraMeasuresAtBeginning:void 0,lineEndAnticipation:t.cursorControl?t.cursorControl.lineEndAnticipation:void 0,beatSubdivisions:e}),t.cursorControl&&t.cursorControl.onReady&&"function"==typeof t.cursorControl.onReady&&t.cursorControl.onReady(t),t.isLoaded=!0,Promise.resolve({status:"created"})}))},t.destroy=function(){t.timer&&(t.timer.reset(),t.timer.stop(),t.timer=null),t.midiBuffer&&(t.midiBuffer.stop(),t.midiBuffer=null),t.setProgress(0,1),t.control&&t.control.resetAll()},t.play=function(){return t.isLoaded?t._play():t.go().then((function(){return t._play()}))},t._play=function(){return t.isStarted=!t.isStarted,t.isStarted?(t.cursorControl&&t.cursorControl.onStart&&"function"==typeof t.cursorControl.onStart&&t.cursorControl.onStart(),t.midiBuffer.start(),t.timer.start(),t.control&&t.control.pushPlay(!0)):t.pause(),Promise.resolve({status:"ok"})},t.pause=function(){t.timer&&(t.timer.pause(),t.midiBuffer.pause(),t.control&&t.control.pushPlay(!1))},t.toggleLoop=function(){t.isLooping=!t.isLooping,t.control&&t.control.pushLoop(t.isLooping)},t.restart=function(){t.timer&&(t.timer.setProgress(0),t.midiBuffer.seek(0))},t.randomAccess=function(e){return t.isLoaded?t._randomAccess(e):t.go().then((function(){return t._randomAccess(e)}))},t._randomAccess=function(e){var n=e.target.classList.contains("abcjs-midi-progress-indicator")?e.target.parentNode:e.target,i=(e.x-n.offsetLeft)/n.offsetWidth;i<0&&(i=0),i>100&&(i=100),t.timer.setProgress(i),t.midiBuffer.seek(i)},t.onWarp=function(e){var n=e.target.value;if(parseInt(n,10)>0){t.warp=parseInt(n,10);var i=t.isStarted,s=t.percent;t.destroy(),t.isStarted=!1,t.go().then((function(){t.setProgress(s,1e3*t.midiBuffer.duration),i&&t.play(),t.timer.setProgress(s),t.midiBuffer.seek(s)}))}},t.setProgress=function(e,n){t.percent=e,t.control&&t.control.setProgress(e,n)},t.finished=function(){t.timer.reset(),t.isLooping?(t.timer.start(),t.midiBuffer.start()):(t.timer.stop(),t.isStarted&&(t.control&&t.control.pushPlay(!1),t.isStarted=!1,t.cursorControl&&t.cursorControl.onFinished&&"function"==typeof t.cursorControl.onFinished&&t.cursorControl.onFinished(),t.setProgress(0,1)))},t.beatCallback=function(e,n,i){var s=e/n;t.setProgress(s,i),t.cursorControl&&t.cursorControl.onBeat&&"function"==typeof t.cursorControl.onBeat&&t.cursorControl.onBeat(e,n,i)},t.eventCallback=function(e){e?t.cursorControl&&t.cursorControl.onEvent&&"function"==typeof t.cursorControl.onEvent&&t.cursorControl.onEvent(e):t.finished()},t.lineEndCallback=function(e){t.cursorControl&&t.cursorControl.onLineEnd&&"function"==typeof t.cursorControl.onLineEnd&&t.cursorControl.onLineEnd(e)},t.getUrl=function(){return t.midiBuffer.download()},t.download=function(e){var n=t.getUrl(),i=document.createElement("a");document.body.appendChild(i),i.setAttribute("style","display: none;"),i.href=n,i.download=e||"output.wav",i.click(),window.URL.revokeObjectURL(n),document.body.removeChild(i)}},gc=function(t,e){this.elem=t,this.text="",this.l=1/8,this.reposition=e||!1};gc.prototype.printString=function(t,e){this.reposition&&e&&(e.startChar=this.text.length),this.text+=t,this.reposition&&e&&(e.endChar=this.text.length)},gc.prototype.printNewLine=function(){this.text+="\n"},gc.prototype.printSpace=function(){this.text[this.text.length-1].match(/\s/)||(this.text+=" ")},gc.prototype.printABC=function(t){this.text="",this.abctune=t,this.printHeader(),this.printBody(),this.elem.value=this.text},gc.prototype.printHeader=function(){this.printHeaderLine("x","X","1"),this.printHeaderLine("title","T"),this.printHeaderLine("composer","C"),this.printHeaderLine("history","H"),this.printHeaderLine("author","A"),this.printHeaderLine("book","B"),this.printHeaderLine("discography","D"),this.printHeaderLine("url","F"),this.printHeaderLine("group","G"),this.printHeaderLine("instruction","I"),this.printHeaderLine("notes","N"),this.printHeaderLine("origin","O"),this.printHeaderLine("rhythm","R"),this.printHeaderLine("source","S"),this.printHeaderLine("unalignedwords","W"),this.printHeaderLine("transcription","Z"),this.printHeaderLine("NULL","L","1/8"),this.printHeaderLine("NULL","M",this.getMeterString(this.abctune.lines[0].staff[0].meter)),this.printHeaderLine("NULL","K",this.getKeyString(this.abctune.lines[0].staff[0].key))},gc.prototype.getKeyString=function(t){return t.root+t.acc+t.mode},gc.prototype.getMeterString=function(t){switch(t.type){case"cut_time":return"C|";case"common_time":return"C";case"specified":return t.value[0].den?t.value[0].num+"/"+t.value[0].den:t.value[0].num}return""},gc.prototype.printHeaderLine=function(t,e,n){var i=this.abctune.metaText[t]||n;if(void 0!==i)for(var s=i.split("\n"),r=0;r<s.length;r++)this.printString(e+": "+s[r]),this.printNewLine()},gc.prototype.getElem=function(){return this.abcline.length<=this.pos?null:this.abcline[this.pos]},gc.prototype.getNextElem=function(){return this.abcline.length<=this.pos+1?null:this.abcline[this.pos+1]},gc.prototype.printBody=function(){for(var t=0;t<this.abctune.lines.length;t++){var e=this.abctune.lines[t];e.staff?this.printABCLine(e.staff):e.subtitle&&0!==t||e.text}},gc.prototype.printABCLine=function(t){for(this.s=0;this.s<t.length;this.s++)this.printABCStaff(t[this.s])},gc.prototype.printABCStaff=function(t){for(this.v=0;this.v<t.voices.length;this.v++)this.printABCVoice(t.voices[this.v])},gc.prototype.printABCVoice=function(t){for(this.abcline=t,this.pos=0;this.pos<this.abcline.length;this.pos++)this.printABCElement();this.printNewLine()},gc.prototype.printABCElement=function(){var t=this.getElem();switch(t.el_type){case"note":this.printBeam();break;case"bar":this.printBarLine(t)}},gc.prototype.printBeam=function(){if(this.printSpace(),this.getElem().startBeam&&!this.getElem().endBeam)for(;this.getElem()&&(this.printNote(this.getElem()),!this.getElem().endBeam);)this.pos++;else this.printNote(this.getElem());this.printSpace()},gc.prototype.printNote=function(t){var e,n="";if(void 0!==t.chord)for(e=0;e<t.chord.length;e++)n+='"'+t.chord[e].name+'"';var i={staccato:".",upbow:"u",downbow:"v",roll:"~",fermata:"H",slide:"J",accent:"L",mordent:"M",pralltriller:"P",trill:"T",lower:"."};if(void 0!==t.decoration)for(e=0;e<t.decoration.length;e++){var s=t.decoration[e];i[s]?n+=i[s]:(n+="!",n+=s,n+="!")}if(void 0!==t.gracenotes){for(n+="{",e=0;e<t.gracenotes.length;e++)n+=this.getNoteString(t.gracenotes[e]);n+="}"}var r=!1;if(1===t.pitches.length&&t.pitches[0].startSlur&&(r=!0,n+=this.multiplyString("(",t.pitches[0].startSlur.length)),t.startSlur&&(n+=this.multiplyString("(",t.startSlur.length)),(1===t.pitches.length&&t.pitches[0].endSlur||t.endSlur)&&(r=!0),t.startTriplet&&(n+="(3"),t.pitches){for(t.pitches.length>1&&(n+="["),e=0;e<t.pitches.length;e++)t.pitches[e].duration=t.duration,n+=this.getNoteString(t.pitches[e],r);t.pitches.length>1&&(n+="]")}1===t.pitches.length&&t.pitches[0].endSlur&&(n+=this.multiplyString(")",t.pitches[0].endSlur.length)),t.endSlur&&(n+=this.multiplyString(")",t.endSlur.length)),this.printString(n,t)},gc.prototype.getNoteString=function(t,e){var n="";!e&&t.startSlur&&(n+="(");var i="";switch(t.accidental){case"quartersharp":i="^/";break;case"dblsharp":i="^^";break;case"sharp":i="^";break;case"quarterflat":i="_/";break;case"flat":i="_";break;case"dblflat":i="__";break;case"natural":i="="}n+=i;var s=["C","D","E","F","G","A","B"][this.extractNote(t.pitch)],r=this.extractOctave(t.pitch);if(r>0)for(s=s.toLowerCase(),r--;r>0;)s+="'",r--;else for(;r<0;)s+=",",r++;return n+=s,t.duration&&(n+=this.getDurationString(t.duration)),!e&&t.endSlur&&(n+=")"),t.startTie&&(n+="-"),n},gc.prototype.getDurationString=function(t){if(t/this.l>1)return t/this.l;var e="";return this.l/t>1&&(e+="/",this.l/t>2&&(e+=this.l/t)),e},gc.prototype.extractNote=function(t){var e=t%7;return e<0&&(e+=7),e},gc.prototype.extractOctave=function(t){return Math.floor(t/7)},gc.prototype.printBarLine=function(t){var e="";switch(t.type){case"bar_thin":e+="|";break;case"bar_thin_thick":e+="|]";break;case"bar_thin_thin":e+="||";break;case"bar_thick_thin":e+="[|";break;case"bar_dbl_repeat":e+=":||:";break;case"bar_left_repeat":e+="|:";break;case"bar_right_repeat":e+=":|";break;case"bar_invisible":e+=""}this.printString(e,t)},gc.prototype.multiplyString=function(t,e){for(var n="";e>0;e--)n+=t;return n};var vc=gc,bc=ja.TuneBook;if("function"!=typeof window.CustomEvent){var _c=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n};_c.prototype=window.Event.prototype,window.CustomEvent=_c}var yc=function(t){this.textarea=document.getElementById(t),this.initialText=this.textarea.value,this.isDragging=!1};yc.prototype.addSelectionListener=function(t){this.textarea.onmousemove=function(e){this.isDragging&&t.fireSelectionChanged()}},yc.prototype.addChangeListener=function(t){this.changelistener=t,this.textarea.onkeyup=function(){t.fireChanged()},this.textarea.onmousedown=function(){this.isDragging=!0,t.fireSelectionChanged()},this.textarea.onmouseup=function(){this.isDragging=!1,t.fireChanged()},this.textarea.onchange=function(){t.fireChanged()}},yc.prototype.getSelection=function(){return{start:this.textarea.selectionStart,end:this.textarea.selectionEnd}},yc.prototype.setSelection=function(t,e){if(this.textarea.setSelectionRange)this.textarea.setSelectionRange(t,e);else if(this.textarea.createTextRange){var n=this.textarea.createTextRange();n.collapse(!0),n.moveEnd("character",e),n.moveStart("character",t),n.select()}this.textarea.focus()},yc.prototype.getString=function(){return this.textarea.value},yc.prototype.setString=function(t){this.textarea.value=t,this.initialText=this.getString(),this.changelistener&&this.changelistener.fireChanged()},yc.prototype.getElem=function(){return this.textarea};var wc=function(t,e){var n;if(this.abcjsParams={},e.abcjsParams)for(n in e.abcjsParams)e.abcjsParams.hasOwnProperty(n)&&(this.abcjsParams[n]=e.abcjsParams[n]);if(e.midi_options)for(n in e.midi_options)e.midi_options.hasOwnProperty(n)&&(this.abcjsParams[n]=e.midi_options[n]);if(e.parser_options)for(n in e.parser_options)e.parser_options.hasOwnProperty(n)&&(this.abcjsParams[n]=e.parser_options[n]);if(e.render_options)for(n in e.render_options)e.render_options.hasOwnProperty(n)&&(this.abcjsParams[n]=e.render_options[n]);e.indicate_changed&&(this.indicate_changed=!0),this.editarea="string"==typeof t?new yc(t):t,this.editarea.addSelectionListener(this),this.editarea.addChangeListener(this),e.canvas_id?this.div=document.getElementById(e.canvas_id):e.paper_id?this.div=document.getElementById(e.paper_id):(this.div=document.createElement("DIV"),this.editarea.getElem().parentNode.insertBefore(this.div,this.editarea.getElem())),e.selectionChangeCallback&&(this.selectionChangeCallback=e.selectionChangeCallback),e.synth&&Zo()&&(this.synth={el:e.synth.el,cursorControl:e.synth.cursorControl,options:e.synth.options}),e.generate_midi&&(this.generate_midi=e.generate_midi,this.abcjsParams.generateDownload&&("string"==typeof e.midi_download_id?this.downloadMidi=document.getElementById(e.midi_download_id):e.midi_download_id&&(this.downloadMidi=e.midi_download_id)),!1!==this.abcjsParams.generateInline&&("string"==typeof e.midi_id?this.inlineMidi=document.getElementById(e.midi_id):e.midi_id&&(this.inlineMidi=e.midi_id))),(e.generate_warnings||e.warnings_id)&&(e.warnings_id?this.warningsdiv=document.getElementById(e.warnings_id):this.warningsdiv=this.div),this.onchangeCallback=e.onchange,e.gui&&(this.target=document.getElementById(t),this.abcjsParams.editable=!0),this.oldt="",this.bReentry=!1,this.parseABC(),this.modelChanged(),this.addClassName=function(t,e){return function(t,e){var n=t.className;return n.length>0&&(n===e||new RegExp("(^|\\s)"+e+"(\\s|$)").test(n))}(t,e)||(t.className+=(t.className?" ":"")+e),t},this.removeClassName=function(t,e){return t.className=da.strip(t.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ")),t},this.setReadOnly=function(t){var e="abc_textarea_readonly",n=this.editarea.getElem();t?(n.setAttribute("readonly","yes"),this.addClassName(n,e)):(n.removeAttribute("readonly"),this.removeClassName(n,e))}};wc.prototype.renderTune=function(t,e,n){var i=new bc(t),s=za();s.parse(i.tunes[0].abc,e,i.tunes[0].startPos-i.header.length);var r=s.getTune();new Vo(n,this.abcjsParams).engraveABC(r)},wc.prototype.redrawMidi=function(){if(this.generate_midi&&!this.midiPause){var t=new window.CustomEvent("generateMidi",{detail:{tunes:this.tunes,abcjsParams:this.abcjsParams,downloadMidiEl:this.downloadMidi,inlineMidiEl:this.inlineMidi,engravingEl:this.div}});window.dispatchEvent(t)}this.synth&&(this.synth.synthControl||(this.synth.synthControl=new mc,this.synth.synthControl.load(this.synth.el,this.synth.cursorControl,this.synth.options)),this.synth.synthControl.setTune(this.tunes[0],!1))},wc.prototype.modelChanged=function(){if(void 0===this.tunes)return void 0!==this.downloadMidi&&(this.downloadMidi.innerHTML=""),void 0!==this.inlineMidi&&(this.inlineMidi.innerHTML=""),void(this.div.innerHTML="");if(!this.bReentry){if(this.bReentry=!0,this.timerId=null,this.div.innerHTML="",this.engraver_controller=new Vo(this.div,this.abcjsParams),this.engraver_controller.engraveABC(this.tunes),this.tunes[0].engraver=this.engraver_controller,this.redrawMidi(),this.warningsdiv&&(this.warningsdiv.innerHTML=this.warnings?this.warnings.join("<br />"):"No errors"),this.target)new vc(this.target,!0).printABC(this.tunes[0]);this.engraver_controller.addSelectListener(this.highlight.bind(this)),this.updateSelection(),this.bReentry=!1}},wc.prototype.paramChanged=function(t){if(t)for(var e in t)t.hasOwnProperty(e)&&(this.abcjsParams[e]=t[e]);this.oldt="",this.fireChanged()},wc.prototype.parseABC=function(){var t=this.editarea.getString();if(t===this.oldt)return this.updateSelection(),!1;if(this.oldt=t,""===t)return this.tunes=void 0,this.warnings="",!0;var e=new bc(t);this.tunes=[],this.startPos=[],this.warnings=[];for(var n=0;n<e.tunes.length;n++){var i=new za;i.parse(e.tunes[n].abc,this.abcjsParams,e.tunes[n].startPos-e.header.length),this.tunes[n]=i.getTune(),this.startPos[n]=e.tunes[n].startPos;for(var s=i.getWarnings()||[],r=0;r<s.length;r++)this.warnings.push(s[r])}return!0},wc.prototype.updateSelection=function(){var t=this.editarea.getSelection();try{this.engraver_controller.rangeHighlight(t.start,t.end)}catch(t){}this.selectionChangeCallback&&this.selectionChangeCallback(t.start,t.end)},wc.prototype.fireSelectionChanged=function(){this.updateSelection()},wc.prototype.setDirtyStyle=function(t){if(void 0!==this.indicate_changed){var e="abc_textarea_dirty",n=this.editarea.getElem();t?function(t,e){(function(t,e){var n=t.className;return n.length>0&&(n===e||new RegExp("(^|\\s)"+e+"(\\s|$)").test(n))})(t,e)||(t.className+=(t.className?" ":"")+e)}(n,e):function(t,e){t.className=da.strip(t.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," "))}(n,e)}},wc.prototype.fireChanged=function(){if(!this.bIsPaused&&this.parseABC()){var t=this;this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout((function(){t.modelChanged()}),300);var e=this.isDirty();this.wasDirty!==e&&(this.wasDirty=e,this.setDirtyStyle(e)),this.onchangeCallback&&this.onchangeCallback(this)}},wc.prototype.setNotDirty=function(){this.editarea.initialText=this.editarea.getString(),this.wasDirty=!1,this.setDirtyStyle(!1)},wc.prototype.isDirty=function(){return void 0!==this.indicate_changed&&this.editarea.initialText!==this.editarea.getString()},wc.prototype.highlight=function(t,e,n){this.editarea.setSelection(t.startChar,t.endChar),this.selectionChangeCallback&&this.selectionChangeCallback(t.startChar,t.endChar)},wc.prototype.pause=function(t){this.bIsPaused=t,t||this.fireChanged()},wc.prototype.millisecondsPerMeasure=function(){return this.synth.synthControl.visualObj.millisecondsPerMeasure()},wc.prototype.pauseMidi=function(t){this.midiPause=t,t||this.redrawMidi()};var xc=wc,kc={signature:"abcjs-basic v5.12.0"};Object.keys(ba).forEach((function(t){kc[t]=ba[t]})),Object.keys(ja).forEach((function(t){kc[t]=ja[t]})),kc.renderAbc=Go,kc.TimingCallbacks=ga,kc.setGlyph=no.setSymbol,kc.synth={CreateSynth:sc,instrumentIndexToName:Yo,pitchToNoteName:Ko,SynthController:mc,SynthSequence:rc,CreateSynthControl:pc,registerAudioContext:Xo,activeAudioContext:$o,supportsAudio:Zo,playEvent:fc},kc.Editor=xc;var Tc=kc,Sc=O((function(t){!function(e){function n(){if(n.prototype._singleton)throw new Error("WebMidi is a singleton, it cannot be instantiated directly.");(n.prototype._singleton=this)._inputs=[],this._outputs=[],this._userHandlers={},this._stateChangeQueue=[],this._processingStateChange=!1,this._midiInterfaceEvents=["connected","disconnected"],this._nrpnBuffer=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],this._nrpnEventsEnabled=!0,this._nrpnTypes=["entry","increment","decrement"],this._notes=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],this._semitones={C:0,D:2,E:4,F:5,G:7,A:9,B:11},Object.defineProperties(this,{MIDI_SYSTEM_MESSAGES:{value:{sysex:240,timecode:241,songposition:242,songselect:243,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1},writable:!1,enumerable:!0,configurable:!1},MIDI_CHANNEL_MESSAGES:{value:{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,channelmode:11,nrpn:11,programchange:12,channelaftertouch:13,pitchbend:14},writable:!1,enumerable:!0,configurable:!1},MIDI_REGISTERED_PARAMETER:{value:{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]},writable:!1,enumerable:!0,configurable:!1},MIDI_CONTROL_CHANGE_MESSAGES:{value:{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101},writable:!1,enumerable:!0,configurable:!1},MIDI_NRPN_MESSAGES:{value:{entrymsb:6,entrylsb:38,increment:96,decrement:97,paramlsb:98,parammsb:99,nullactiveparameter:127},writable:!1,enumerable:!0,configurable:!1},MIDI_CHANNEL_MODE_MESSAGES:{value:{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127},writable:!1,enumerable:!0,configurable:!1},octaveOffset:{value:0,writable:!0,enumerable:!0,configurable:!1}}),Object.defineProperties(this,{supported:{enumerable:!0,get:function(){return"requestMIDIAccess"in navigator}},enabled:{enumerable:!0,get:function(){return void 0!==this.interface}.bind(this)},inputs:{enumerable:!0,get:function(){return this._inputs}.bind(this)},outputs:{enumerable:!0,get:function(){return this._outputs}.bind(this)},sysexEnabled:{enumerable:!0,get:function(){return!(!this.interface||!this.interface.sysexEnabled)}.bind(this)},nrpnEventsEnabled:{enumerable:!0,get:function(){return!!this._nrpnEventsEnabled}.bind(this),set:function(t){return this._nrpnEventsEnabled=t,this._nrpnEventsEnabled}},nrpnTypes:{enumerable:!0,get:function(){return this._nrpnTypes}.bind(this)},time:{enumerable:!0,get:function(){return performance.now()}}})}var i=new n;function s(t){var e=this;this._userHandlers={channel:{},system:{}},this._midiInput=t,Object.defineProperties(this,{connection:{enumerable:!0,get:function(){return e._midiInput.connection}},id:{enumerable:!0,get:function(){return e._midiInput.id}},manufacturer:{enumerable:!0,get:function(){return e._midiInput.manufacturer}},name:{enumerable:!0,get:function(){return e._midiInput.name}},state:{enumerable:!0,get:function(){return e._midiInput.state}},type:{enumerable:!0,get:function(){return e._midiInput.type}}}),this._initializeUserHandlers(),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}function r(t){var e=this;this._midiOutput=t,Object.defineProperties(this,{connection:{enumerable:!0,get:function(){return e._midiOutput.connection}},id:{enumerable:!0,get:function(){return e._midiOutput.id}},manufacturer:{enumerable:!0,get:function(){return e._midiOutput.manufacturer}},name:{enumerable:!0,get:function(){return e._midiOutput.name}},state:{enumerable:!0,get:function(){return e._midiOutput.state}},type:{enumerable:!0,get:function(){return e._midiOutput.type}}})}n.prototype.enable=function(t,e){this.enabled||(this.supported?navigator.requestMIDIAccess({sysex:e}).then(function(e){var n,i=[],s=[];this.interface=e,this._resetInterfaceUserHandlers(),this.interface.onstatechange=function(t){i.push(t)};for(var r=e.inputs.values(),a=r.next();a&&!a.done;a=r.next())s.push(a.value.open());for(var o=e.outputs.values(),c=o.next();c&&!c.done;c=o.next())s.push(c.value.open());function l(){clearTimeout(n),this._updateInputsAndOutputs(),this.interface.onstatechange=this._onInterfaceStateChange.bind(this),"function"==typeof t&&t.call(this),i.forEach(function(t){this._onInterfaceStateChange(t)}.bind(this))}n=setTimeout(l.bind(this),200),Promise&&Promise.all(s).catch((function(t){})).then(l.bind(this))}.bind(this),function(e){"function"==typeof t&&t.call(this,e)}.bind(this)):"function"==typeof t&&t(new Error("The Web MIDI API is not supported by your browser.")))},n.prototype.disable=function(){if(!this.supported)throw new Error("The Web MIDI API is not supported by your browser.");this.interface&&(this.interface.onstatechange=void 0),this.interface=void 0,this._inputs=[],this._outputs=[],this._nrpnEventsEnabled=!0,this._resetInterfaceUserHandlers()},n.prototype.addListener=function(t,e){if(!this.enabled)throw new Error("WebMidi must be enabled before adding event listeners.");if("function"!=typeof e)throw new TypeError("The 'listener' parameter must be a function.");if(!(0<=this._midiInterfaceEvents.indexOf(t)))throw new TypeError("The specified event type is not supported.");return this._userHandlers[t].push(e),this},n.prototype.hasListener=function(t,e){if(!this.enabled)throw new Error("WebMidi must be enabled before checking event listeners.");if("function"!=typeof e)throw new TypeError("The 'listener' parameter must be a function.");if(!(0<=this._midiInterfaceEvents.indexOf(t)))throw new TypeError("The specified event type is not supported.");for(var n=0;n<this._userHandlers[t].length;n++)if(this._userHandlers[t][n]===e)return!0;return!1},n.prototype.removeListener=function(t,e){if(!this.enabled)throw new Error("WebMidi must be enabled before removing event listeners.");if(void 0!==e&&"function"!=typeof e)throw new TypeError("The 'listener' parameter must be a function.");if(0<=this._midiInterfaceEvents.indexOf(t))if(e)for(var n=0;n<this._userHandlers[t].length;n++)this._userHandlers[t][n]===e&&this._userHandlers[t].splice(n,1);else this._userHandlers[t]=[];else{if(void 0!==t)throw new TypeError("The specified event type is not supported.");this._resetInterfaceUserHandlers()}return this},n.prototype.toMIDIChannels=function(t){var e;if("all"===t||void 0===t)e=["all"];else{if("none"===t)return[];e=Array.isArray(t)?t:[t]}return-1<e.indexOf("all")&&(e=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),e.map((function(t){return parseInt(t)})).filter((function(t){return 1<=t&&t<=16}))},n.prototype.getInputById=function(t){if(!this.enabled)throw new Error("WebMidi is not enabled.");t=String(t);for(var e=0;e<this.inputs.length;e++)if(this.inputs[e].id===t)return this.inputs[e];return!1},n.prototype.getOutputById=function(t){if(!this.enabled)throw new Error("WebMidi is not enabled.");t=String(t);for(var e=0;e<this.outputs.length;e++)if(this.outputs[e].id===t)return this.outputs[e];return!1},n.prototype.getInputByName=function(t){if(!this.enabled)throw new Error("WebMidi is not enabled.");for(var e=0;e<this.inputs.length;e++)if(~this.inputs[e].name.indexOf(t))return this.inputs[e];return!1},n.prototype.getOctave=function(t){if(null!=t&&0<=t&&t<=127)return Math.floor(Math.floor(t)/12-1)+Math.floor(i.octaveOffset)},n.prototype.getOutputByName=function(t){if(!this.enabled)throw new Error("WebMidi is not enabled.");for(var e=0;e<this.outputs.length;e++)if(~this.outputs[e].name.indexOf(t))return this.outputs[e];return!1},n.prototype.guessNoteNumber=function(t){var e=!1;if(t&&t.toFixed&&0<=t&&t<=127?e=Math.round(t):0<=parseInt(t)&&parseInt(t)<=127?e=parseInt(t):("string"==typeof t||t instanceof String)&&(e=this.noteNameToNumber(t)),!1===e)throw new Error("Invalid input value ("+t+").");return e},n.prototype.noteNameToNumber=function(t){"string"!=typeof t&&(t="");var e=t.match(/([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)/i);if(!e)throw new RangeError("Invalid note name.");var n=i._semitones[e[1].toUpperCase()],s=12*(parseInt(e[3])+1-Math.floor(i.octaveOffset))+n;if(-1<e[2].toLowerCase().indexOf("b")?s-=e[2].length:-1<e[2].toLowerCase().indexOf("#")&&(s+=e[2].length),s<0||127<s)throw new RangeError("Invalid note name or note outside valid range.");return s},n.prototype._updateInputsAndOutputs=function(){this._updateInputs(),this._updateOutputs()},n.prototype._updateInputs=function(){for(var t=0;t<this._inputs.length;t++){for(var e=!0,n=this.interface.inputs.values(),i=n.next();i&&!i.done;i=n.next())if(this._inputs[t]._midiInput===i.value){e=!1;break}e&&this._inputs.splice(t,1)}this.interface&&this.interface.inputs.forEach(function(t){for(var e=!0,n=0;n<this._inputs.length;n++)this._inputs[n]._midiInput===t&&(e=!1);e&&this._inputs.push(new s(t))}.bind(this))},n.prototype._updateOutputs=function(){for(var t=0;t<this._outputs.length;t++){for(var e=!0,n=this.interface.outputs.values(),i=n.next();i&&!i.done;i=n.next())if(this._outputs[t]._midiOutput===i.value){e=!1;break}e&&this._outputs.splice(t,1)}this.interface&&this.interface.outputs.forEach(function(t){for(var e=!0,n=0;n<this._outputs.length;n++)this._outputs[n]._midiOutput===t&&(e=!1);e&&this._outputs.push(new r(t))}.bind(this))},n.prototype._onInterfaceStateChange=function(t){this._updateInputsAndOutputs();var e={timestamp:t.timeStamp,type:t.port.state};this.interface&&"connected"===t.port.state?"output"===t.port.type?e.port=this.getOutputById(t.port.id):"input"===t.port.type&&(e.port=this.getInputById(t.port.id)):e.port={connection:"closed",id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this._userHandlers[t.port.state].forEach((function(t){t(e)}))},n.prototype._resetInterfaceUserHandlers=function(){for(var t=0;t<this._midiInterfaceEvents.length;t++)this._userHandlers[this._midiInterfaceEvents[t]]=[]},s.prototype.on=s.prototype.addListener=function(t,e,n){var s=this;if(void 0===e&&(e="all"),Array.isArray(e)||(e=[e]),e.forEach((function(t){if("all"!==t&&!(1<=t&&t<=16))throw new RangeError("The 'channel' parameter is invalid.")})),"function"!=typeof n)throw new TypeError("The 'listener' parameter must be a function.");if(void 0!==i.MIDI_SYSTEM_MESSAGES[t])this._userHandlers.system[t]||(this._userHandlers.system[t]=[]),this._userHandlers.system[t].push(n);else{if(void 0===i.MIDI_CHANNEL_MESSAGES[t])throw new TypeError("The specified event type is not supported.");if(-1<e.indexOf("all")){e=[];for(var r=1;r<=16;r++)e.push(r)}this._userHandlers.channel[t]||(this._userHandlers.channel[t]=[]),e.forEach((function(e){s._userHandlers.channel[t][e]||(s._userHandlers.channel[t][e]=[]),s._userHandlers.channel[t][e].push(n)}))}return this},s.prototype.hasListener=function(t,e,n){var s=this;if("function"!=typeof n)throw new TypeError("The 'listener' parameter must be a function.");if(void 0===e&&(e="all"),e.constructor!==Array&&(e=[e]),void 0!==i.MIDI_SYSTEM_MESSAGES[t]){for(var r=0;r<this._userHandlers.system[t].length;r++)if(this._userHandlers.system[t][r]===n)return!0}else if(void 0!==i.MIDI_CHANNEL_MESSAGES[t]){if(-1<e.indexOf("all")){e=[];for(var a=1;a<=16;a++)e.push(a)}return!!this._userHandlers.channel[t]&&e.every((function(e){var i=s._userHandlers.channel[t][e];return i&&-1<i.indexOf(n)}))}return!1},s.prototype.removeListener=function(t,e,n){var s=this;if(void 0!==n&&"function"!=typeof n)throw new TypeError("The 'listener' parameter must be a function.");if(void 0===e&&(e="all"),e.constructor!==Array&&(e=[e]),void 0!==i.MIDI_SYSTEM_MESSAGES[t])if(void 0===n)this._userHandlers.system[t]=[];else for(var r=0;r<this._userHandlers.system[t].length;r++)this._userHandlers.system[t][r]===n&&this._userHandlers.system[t].splice(r,1);else if(void 0!==i.MIDI_CHANNEL_MESSAGES[t]){if(-1<e.indexOf("all")){e=[];for(var a=1;a<=16;a++)e.push(a)}if(!this._userHandlers.channel[t])return this;e.forEach((function(e){var i=s._userHandlers.channel[t][e];if(i)if(void 0===n)s._userHandlers.channel[t][e]=[];else for(var r=0;r<i.length;r++)i[r]===n&&i.splice(r,1)}))}else{if(void 0!==t)throw new TypeError("The specified event type is not supported.");this._initializeUserHandlers()}return this},s.prototype._initializeUserHandlers=function(){for(var t in i.MIDI_CHANNEL_MESSAGES)i.MIDI_CHANNEL_MESSAGES.hasOwnProperty(t)&&(this._userHandlers.channel[t]={});for(var e in i.MIDI_SYSTEM_MESSAGES)i.MIDI_SYSTEM_MESSAGES.hasOwnProperty(e)&&(this._userHandlers.system[e]=[])},s.prototype._onMidiMessage=function(t){if(0<this._userHandlers.system.midimessage.length){var e={target:this,data:t.data,timestamp:t.timeStamp,type:"midimessage"};this._userHandlers.system.midimessage.forEach((function(t){t(e)}))}t.data[0]<240?(this._parseChannelEvent(t),this._parseNrpnEvent(t)):t.data[0]<=255&&this._parseSystemEvent(t)},s.prototype._parseNrpnEvent=function(t){var e,n,s=t.data[0]>>4,r=15&t.data[0],a=1+r;if(1<t.data.length&&(e=t.data[1],n=2<t.data.length?t.data[2]:void 0),i.nrpnEventsEnabled&&s===i.MIDI_CHANNEL_MESSAGES.controlchange&&(e>=i.MIDI_NRPN_MESSAGES.increment&&e<=i.MIDI_NRPN_MESSAGES.parammsb||e===i.MIDI_NRPN_MESSAGES.entrymsb||e===i.MIDI_NRPN_MESSAGES.entrylsb)){var o={target:this,type:"controlchange",data:t.data,timestamp:t.timeStamp,channel:a,controller:{number:e,name:this.getCcNameByNumber(e)},value:n};if(o.controller.number===i.MIDI_NRPN_MESSAGES.parammsb&&o.value!=i.MIDI_NRPN_MESSAGES.nullactiveparameter)i._nrpnBuffer[r]=[],i._nrpnBuffer[r][0]=o;else if(1===i._nrpnBuffer[r].length&&o.controller.number===i.MIDI_NRPN_MESSAGES.paramlsb)i._nrpnBuffer[r].push(o);else if(2!==i._nrpnBuffer[r].length||o.controller.number!==i.MIDI_NRPN_MESSAGES.increment&&o.controller.number!==i.MIDI_NRPN_MESSAGES.decrement&&o.controller.number!==i.MIDI_NRPN_MESSAGES.entrymsb)if(3===i._nrpnBuffer[r].length&&i._nrpnBuffer[r][2].number===i.MIDI_NRPN_MESSAGES.entrymsb&&o.controller.number===i.MIDI_NRPN_MESSAGES.entrylsb)i._nrpnBuffer[r].push(o);else if(3<=i._nrpnBuffer[r].length&&i._nrpnBuffer[r].length<=4&&o.controller.number===i.MIDI_NRPN_MESSAGES.parammsb&&o.value===i.MIDI_NRPN_MESSAGES.nullactiveparameter)i._nrpnBuffer[r].push(o);else if(4<=i._nrpnBuffer[r].length&&i._nrpnBuffer[r].length<=5&&o.controller.number===i.MIDI_NRPN_MESSAGES.paramlsb&&o.value===i.MIDI_NRPN_MESSAGES.nullactiveparameter){i._nrpnBuffer[r].push(o);var c=[];i._nrpnBuffer[r].forEach((function(t){c.push(t.data)}));var l=i._nrpnBuffer[r][0].value<<7|i._nrpnBuffer[r][1].value,h=i._nrpnBuffer[r][2].value;6===i._nrpnBuffer[r].length&&(h=i._nrpnBuffer[r][2].value<<7|i._nrpnBuffer[r][3].value);var u="";switch(i._nrpnBuffer[r][2].controller.number){case i.MIDI_NRPN_MESSAGES.entrymsb:u=i._nrpnTypes[0];break;case i.MIDI_NRPN_MESSAGES.increment:u=i._nrpnTypes[1];break;case i.MIDI_NRPN_MESSAGES.decrement:u=i._nrpnTypes[2];break;default:throw new Error("The NPRN type was unidentifiable.")}var d={timestamp:o.timestamp,channel:o.channel,type:"nrpn",data:c,controller:{number:l,type:u,name:"Non-Registered Parameter "+l},value:h};i._nrpnBuffer[r]=[],this._userHandlers.channel[d.type]&&this._userHandlers.channel[d.type][d.channel]&&this._userHandlers.channel[d.type][d.channel].forEach((function(t){t(d)}))}else i._nrpnBuffer[r]=[];else i._nrpnBuffer[r].push(o)}},s.prototype._parseChannelEvent=function(t){var e,n,s=t.data[0]>>4,r=1+(15&t.data[0]);1<t.data.length&&(e=t.data[1],n=2<t.data.length?t.data[2]:void 0);var a={target:this,data:t.data,timestamp:t.timeStamp,channel:r};s===i.MIDI_CHANNEL_MESSAGES.noteoff||s===i.MIDI_CHANNEL_MESSAGES.noteon&&0===n?(a.type="noteoff",a.note={number:e,name:i._notes[e%12],octave:i.getOctave(e)},a.velocity=n/127,a.rawVelocity=n):s===i.MIDI_CHANNEL_MESSAGES.noteon?(a.type="noteon",a.note={number:e,name:i._notes[e%12],octave:i.getOctave(e)},a.velocity=n/127,a.rawVelocity=n):s===i.MIDI_CHANNEL_MESSAGES.keyaftertouch?(a.type="keyaftertouch",a.note={number:e,name:i._notes[e%12],octave:i.getOctave(e)},a.value=n/127):s===i.MIDI_CHANNEL_MESSAGES.controlchange&&0<=e&&e<=119?(a.type="controlchange",a.controller={number:e,name:this.getCcNameByNumber(e)},a.value=n):s===i.MIDI_CHANNEL_MESSAGES.channelmode&&120<=e&&e<=127?(a.type="channelmode",a.controller={number:e,name:this.getChannelModeByNumber(e)},a.value=n):s===i.MIDI_CHANNEL_MESSAGES.programchange?(a.type="programchange",a.value=e):s===i.MIDI_CHANNEL_MESSAGES.channelaftertouch?(a.type="channelaftertouch",a.value=e/127):s===i.MIDI_CHANNEL_MESSAGES.pitchbend?(a.type="pitchbend",a.value=((n<<7)+e-8192)/8192):a.type="unknownchannelmessage",this._userHandlers.channel[a.type]&&this._userHandlers.channel[a.type][r]&&this._userHandlers.channel[a.type][r].forEach((function(t){t(a)}))},s.prototype.getCcNameByNumber=function(t){if(!(0<=(t=Math.floor(t))&&t<=119))throw new RangeError("The control change number must be between 0 and 119.");for(var e in i.MIDI_CONTROL_CHANGE_MESSAGES)if(i.MIDI_CONTROL_CHANGE_MESSAGES.hasOwnProperty(e)&&t===i.MIDI_CONTROL_CHANGE_MESSAGES[e])return e},s.prototype.getChannelModeByNumber=function(t){if(!(120<=(t=Math.floor(t))&&status<=127))throw new RangeError("The control change number must be between 120 and 127.");for(var e in i.MIDI_CHANNEL_MODE_MESSAGES)if(i.MIDI_CHANNEL_MODE_MESSAGES.hasOwnProperty(e)&&t===i.MIDI_CHANNEL_MODE_MESSAGES[e])return e},s.prototype._parseSystemEvent=function(t){var e=t.data[0],n={target:this,data:t.data,timestamp:t.timeStamp};e===i.MIDI_SYSTEM_MESSAGES.sysex?n.type="sysex":e===i.MIDI_SYSTEM_MESSAGES.timecode?n.type="timecode":e===i.MIDI_SYSTEM_MESSAGES.songposition?n.type="songposition":e===i.MIDI_SYSTEM_MESSAGES.songselect?(n.type="songselect",n.song=t.data[1]):e===i.MIDI_SYSTEM_MESSAGES.tuningrequest?n.type="tuningrequest":e===i.MIDI_SYSTEM_MESSAGES.clock?n.type="clock":e===i.MIDI_SYSTEM_MESSAGES.start?n.type="start":e===i.MIDI_SYSTEM_MESSAGES.continue?n.type="continue":e===i.MIDI_SYSTEM_MESSAGES.stop?n.type="stop":e===i.MIDI_SYSTEM_MESSAGES.activesensing?n.type="activesensing":e===i.MIDI_SYSTEM_MESSAGES.reset?n.type="reset":n.type="unknownsystemmessage",this._userHandlers.system[n.type]&&this._userHandlers.system[n.type].forEach((function(t){t(n)}))},r.prototype.send=function(t,e,n){if(!(128<=t&&t<=255))throw new RangeError("The status byte must be an integer between 128 (0x80) and 255 (0xFF).");void 0===e&&(e=[]),Array.isArray(e)||(e=[e]);var i=[];return e.forEach((function(t){var e=Math.floor(t);if(!(0<=e&&e<=255))throw new RangeError("Data bytes must be integers between 0 (0x00) and 255 (0xFF).");i.push(e)})),this._midiOutput.send([t].concat(i),parseFloat(n)||0),this},r.prototype.sendSysex=function(t,e,n){if(!i.sysexEnabled)throw new Error("Sysex message support must first be activated.");return n=n||{},t=[].concat(t),e.forEach((function(t){if(t<0||127<t)throw new RangeError("The data bytes of a sysex message must be integers between 0 (0x00) and 127 (0x7F).")})),e=t.concat(e,i.MIDI_SYSTEM_MESSAGES.sysexend),this.send(i.MIDI_SYSTEM_MESSAGES.sysex,e,this._parseTimeParameter(n.time)),this},r.prototype.sendTimecodeQuarterFrame=function(t,e){return e=e||{},this.send(i.MIDI_SYSTEM_MESSAGES.timecode,t,this._parseTimeParameter(e.time)),this},r.prototype.sendSongPosition=function(t,e){e=e||{};var n=(t=Math.floor(t)||0)>>7&127,s=127&t;return this.send(i.MIDI_SYSTEM_MESSAGES.songposition,[n,s],this._parseTimeParameter(e.time)),this},r.prototype.sendSongSelect=function(t,e){if(e=e||{},!(0<=(t=Math.floor(t))&&t<=127))throw new RangeError("The song number must be between 0 and 127.");return this.send(i.MIDI_SYSTEM_MESSAGES.songselect,[t],this._parseTimeParameter(e.time)),this},r.prototype.sendTuningRequest=function(t){return t=t||{},this.send(i.MIDI_SYSTEM_MESSAGES.tuningrequest,void 0,this._parseTimeParameter(t.time)),this},r.prototype.sendClock=function(t){return t=t||{},this.send(i.MIDI_SYSTEM_MESSAGES.clock,void 0,this._parseTimeParameter(t.time)),this},r.prototype.sendStart=function(t){return t=t||{},this.send(i.MIDI_SYSTEM_MESSAGES.start,void 0,this._parseTimeParameter(t.time)),this},r.prototype.sendContinue=function(t){return t=t||{},this.send(i.MIDI_SYSTEM_MESSAGES.continue,void 0,this._parseTimeParameter(t.time)),this},r.prototype.sendStop=function(t){return t=t||{},this.send(i.MIDI_SYSTEM_MESSAGES.stop,void 0,this._parseTimeParameter(t.time)),this},r.prototype.sendActiveSensing=function(t){return t=t||{},this.send(i.MIDI_SYSTEM_MESSAGES.activesensing,[],this._parseTimeParameter(t.time)),this},r.prototype.sendReset=function(t){return t=t||{},this.send(i.MIDI_SYSTEM_MESSAGES.reset,void 0,this._parseTimeParameter(t.time)),this},r.prototype.stopNote=function(t,e,n){if("all"===t)return this.sendChannelMode("allnotesoff",0,e,n);var s=64;return(n=n||{}).rawVelocity?!isNaN(n.velocity)&&0<=n.velocity&&n.velocity<=127&&(s=n.velocity):!isNaN(n.velocity)&&0<=n.velocity&&n.velocity<=1&&(s=127*n.velocity),this._convertNoteToArray(t).forEach(function(t){i.toMIDIChannels(e).forEach(function(e){this.send((i.MIDI_CHANNEL_MESSAGES.noteoff<<4)+(e-1),[t,Math.round(s)],this._parseTimeParameter(n.time))}.bind(this))}.bind(this)),this},r.prototype.playNote=function(t,e,n){var s,r=64;if((n=n||{}).rawVelocity?!isNaN(n.velocity)&&0<=n.velocity&&n.velocity<=127&&(r=n.velocity):!isNaN(n.velocity)&&0<=n.velocity&&n.velocity<=1&&(r=127*n.velocity),s=this._parseTimeParameter(n.time),this._convertNoteToArray(t).forEach(function(t){i.toMIDIChannels(e).forEach(function(e){this.send((i.MIDI_CHANNEL_MESSAGES.noteon<<4)+(e-1),[t,Math.round(r)],s)}.bind(this))}.bind(this)),!isNaN(n.duration)){n.duration<=0&&(n.duration=0);var a=64;n.rawVelocity?!isNaN(n.release)&&0<=n.release&&n.release<=127&&(a=n.release):!isNaN(n.release)&&0<=n.release&&n.release<=1&&(a=127*n.release),this._convertNoteToArray(t).forEach(function(t){i.toMIDIChannels(e).forEach(function(e){this.send((i.MIDI_CHANNEL_MESSAGES.noteoff<<4)+(e-1),[t,Math.round(a)],(s||i.time)+n.duration)}.bind(this))}.bind(this))}return this},r.prototype.sendKeyAftertouch=function(t,e,n,s){var r=this;if(s=s||{},e<1||16<e)throw new RangeError("The channel must be between 1 and 16.");(isNaN(n)||n<0||1<n)&&(n=.5);var a=Math.round(127*n);return this._convertNoteToArray(t).forEach((function(t){i.toMIDIChannels(e).forEach((function(e){r.send((i.MIDI_CHANNEL_MESSAGES.keyaftertouch<<4)+(e-1),[t,a],r._parseTimeParameter(s.time))}))})),this},r.prototype.sendControlChange=function(t,e,n,s){if(s=s||{},"string"==typeof t){if(void 0===(t=i.MIDI_CONTROL_CHANGE_MESSAGES[t]))throw new TypeError("Invalid controller name.")}else if(!(0<=(t=Math.floor(t))&&t<=119))throw new RangeError("Controller numbers must be between 0 and 119.");if(!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("Controller value must be between 0 and 127.");return i.toMIDIChannels(n).forEach(function(n){this.send((i.MIDI_CHANNEL_MESSAGES.controlchange<<4)+(n-1),[t,e],this._parseTimeParameter(s.time))}.bind(this)),this},r.prototype._selectRegisteredParameter=function(t,e,n){var s=this;if(t[0]=Math.floor(t[0]),!(0<=t[0]&&t[0]<=127))throw new RangeError("The control65 value must be between 0 and 127");if(t[1]=Math.floor(t[1]),!(0<=t[1]&&t[1]<=127))throw new RangeError("The control64 value must be between 0 and 127");return i.toMIDIChannels(e).forEach((function(){s.sendControlChange(101,t[0],e,{time:n}),s.sendControlChange(100,t[1],e,{time:n})})),this},r.prototype._selectNonRegisteredParameter=function(t,e,n){var s=this;if(t[0]=Math.floor(t[0]),!(0<=t[0]&&t[0]<=127))throw new RangeError("The control63 value must be between 0 and 127");if(t[1]=Math.floor(t[1]),!(0<=t[1]&&t[1]<=127))throw new RangeError("The control62 value must be between 0 and 127");return i.toMIDIChannels(e).forEach((function(){s.sendControlChange(99,t[0],e,{time:n}),s.sendControlChange(98,t[1],e,{time:n})})),this},r.prototype._setCurrentRegisteredParameter=function(t,e,n){var s=this;if((t=[].concat(t))[0]=Math.floor(t[0]),!(0<=t[0]&&t[0]<=127))throw new RangeError("The msb value must be between 0 and 127");return i.toMIDIChannels(e).forEach((function(){s.sendControlChange(6,t[0],e,{time:n})})),t[1]=Math.floor(t[1]),0<=t[1]&&t[1]<=127&&i.toMIDIChannels(e).forEach((function(){s.sendControlChange(38,t[1],e,{time:n})})),this},r.prototype._deselectRegisteredParameter=function(t,e){var n=this;return i.toMIDIChannels(t).forEach((function(){n.sendControlChange(101,127,t,{time:e}),n.sendControlChange(100,127,t,{time:e})})),this},r.prototype.setRegisteredParameter=function(t,e,n,s){var r=this;if(s=s||{},!Array.isArray(t)){if(!i.MIDI_REGISTERED_PARAMETER[t])throw new Error("The specified parameter is not available.");t=i.MIDI_REGISTERED_PARAMETER[t]}return i.toMIDIChannels(n).forEach((function(){r._selectRegisteredParameter(t,n,s.time),r._setCurrentRegisteredParameter(e,n,s.time),r._deselectRegisteredParameter(n,s.time)})),this},r.prototype.setNonRegisteredParameter=function(t,e,n,s){var r=this;if(s=s||{},!(0<=t[0]&&t[0]<=127&&0<=t[1]&&t[1]<=127))throw new Error("Position 0 and 1 of the 2-position parameter array must both be between 0 and 127.");return e=[].concat(e),i.toMIDIChannels(n).forEach((function(){r._selectNonRegisteredParameter(t,n,s.time),r._setCurrentRegisteredParameter(e,n,s.time),r._deselectRegisteredParameter(n,s.time)})),this},r.prototype.incrementRegisteredParameter=function(t,e,n){var s=this;if(n=n||{},!Array.isArray(t)){if(!i.MIDI_REGISTERED_PARAMETER[t])throw new Error("The specified parameter is not available.");t=i.MIDI_REGISTERED_PARAMETER[t]}return i.toMIDIChannels(e).forEach((function(){s._selectRegisteredParameter(t,e,n.time),s.sendControlChange(96,0,e,{time:n.time}),s._deselectRegisteredParameter(e,n.time)})),this},r.prototype.decrementRegisteredParameter=function(t,e,n){if(n=n||{},!Array.isArray(t)){if(!i.MIDI_REGISTERED_PARAMETER[t])throw new TypeError("The specified parameter is not available.");t=i.MIDI_REGISTERED_PARAMETER[t]}return i.toMIDIChannels(e).forEach(function(){this._selectRegisteredParameter(t,e,n.time),this.sendControlChange(97,0,e,{time:n.time}),this._deselectRegisteredParameter(e,n.time)}.bind(this)),this},r.prototype.setPitchBendRange=function(t,e,n,s){var r=this;if(s=s||{},!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("The semitones value must be between 0 and 127");if(!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The cents value must be between 0 and 127");return i.toMIDIChannels(n).forEach((function(){r.setRegisteredParameter("pitchbendrange",[t,e],n,{time:s.time})})),this},r.prototype.setModulationRange=function(t,e,n,s){var r=this;if(s=s||{},!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("The semitones value must be between 0 and 127");if(!(0<=(e=Math.floor(e)||0)&&e<=127))throw new RangeError("The cents value must be between 0 and 127");return i.toMIDIChannels(n).forEach((function(){r.setRegisteredParameter("modulationrange",[t,e],n,{time:s.time})})),this},r.prototype.setMasterTuning=function(t,e,n){var s=this;if(n=n||{},(t=parseFloat(t)||0)<=-65||64<=t)throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");var r=Math.floor(t)+64,a=t-Math.floor(t),o=(a=Math.round((a+1)/2*16383))>>7&127,c=127&a;return i.toMIDIChannels(e).forEach((function(){s.setRegisteredParameter("channelcoarsetuning",r,e,{time:n.time}),s.setRegisteredParameter("channelfinetuning",[o,c],e,{time:n.time})})),this},r.prototype.setTuningProgram=function(t,e,n){var s=this;if(n=n||{},!(0<=(t=Math.floor(t))&&t<=127))throw new RangeError("The program value must be between 0 and 127");return i.toMIDIChannels(e).forEach((function(){s.setRegisteredParameter("tuningprogram",t,e,{time:n.time})})),this},r.prototype.setTuningBank=function(t,e,n){var s=this;if(n=n||{},!(0<=(t=Math.floor(t)||0)&&t<=127))throw new RangeError("The bank value must be between 0 and 127");return i.toMIDIChannels(e).forEach((function(){s.setRegisteredParameter("tuningbank",t,e,{time:n.time})})),this},r.prototype.sendChannelMode=function(t,e,n,s){if(s=s||{},"string"==typeof t){if(!(t=i.MIDI_CHANNEL_MODE_MESSAGES[t]))throw new TypeError("Invalid channel mode message name.")}else if(!(120<=(t=Math.floor(t))&&t<=127))throw new RangeError("Channel mode numerical identifiers must be between 120 and 127.");if((e=Math.floor(e)||0)<0||127<e)throw new RangeError("Value must be an integer between 0 and 127.");return i.toMIDIChannels(n).forEach(function(n){this.send((i.MIDI_CHANNEL_MESSAGES.channelmode<<4)+(n-1),[t,e],this._parseTimeParameter(s.time))}.bind(this)),this},r.prototype.sendProgramChange=function(t,e,n){var s=this;if(n=n||{},t=Math.floor(t),isNaN(t)||t<0||127<t)throw new RangeError("Program numbers must be between 0 and 127.");return i.toMIDIChannels(e).forEach((function(e){s.send((i.MIDI_CHANNEL_MESSAGES.programchange<<4)+(e-1),[t],s._parseTimeParameter(n.time))})),this},r.prototype.sendChannelAftertouch=function(t,e,n){var s=this;n=n||{},t=parseFloat(t),(isNaN(t)||t<0||1<t)&&(t=.5);var r=Math.round(127*t);return i.toMIDIChannels(e).forEach((function(t){s.send((i.MIDI_CHANNEL_MESSAGES.channelaftertouch<<4)+(t-1),[r],s._parseTimeParameter(n.time))})),this},r.prototype.sendPitchBend=function(t,e,n){var s=this;if(n=n||{},isNaN(t)||t<-1||1<t)throw new RangeError("Pitch bend value must be between -1 and 1.");var r=Math.round((t+1)/2*16383),a=r>>7&127,o=127&r;return i.toMIDIChannels(e).forEach((function(t){s.send((i.MIDI_CHANNEL_MESSAGES.pitchbend<<4)+(t-1),[o,a],s._parseTimeParameter(n.time))})),this},r.prototype._parseTimeParameter=function(t){var e,n=parseFloat(t);return"string"==typeof t&&"+"===t.substring(0,1)?n&&0<n&&(e=i.time+n):n>i.time&&(e=n),e},r.prototype._convertNoteToArray=function(t){var e=[];return Array.isArray(t)||(t=[t]),t.forEach((function(t){e.push(i.guessNoteNumber(t))})),e},t.exports?t.exports=i:e.WebMidi||(e.WebMidi=i)}(I)}));function Cc(e){let n,i,s,r,p,f,m,g,v,b,_,y,w,x,k,T,S,C,A,E,M;return{c(){n=c("main"),i=c("section"),s=c("h2"),r=l(e[1]),p=h(),f=c("div"),m=h(),g=c("div"),v=c("p"),b=l("Points: "),_=l(e[2]),y=h(),w=c("p"),x=l("High Score: "),k=l(e[3]),T=h(),S=c("p"),C=l("Note Hint: "),A=l(e[0]),E=h(),M=c("p"),M.textContent="Keep learning.",u(s,"class","text-center"),u(f,"id","paper"),u(v,"class","text-center"),u(w,"class","text-center"),u(S,"class","text-center"),u(g,"class","d-flex justify-content-around"),u(M,"class","text-center"),u(i,"class","h-100 d-flex")},m(t,e){!function(t,e,n){t.insertBefore(e,n||null)}(t,n,e),a(n,i),a(i,s),a(s,r),a(i,p),a(i,f),a(i,m),a(i,g),a(g,v),a(v,b),a(v,_),a(g,y),a(g,w),a(w,x),a(w,k),a(g,T),a(g,S),a(S,C),a(S,A),a(i,E),a(i,M)},p(t,[e]){2&e&&d(r,t[1]),4&e&&d(_,t[2]),8&e&&d(k,t[3]),1&e&&d(A,t[0])},i:t,o:t,d(t){t&&o(n)}}}function Ac(t){return`X:1\n      M:C\n      L:1/4\n      K:C\n      |:${function(t){let e="";if(!t.includes("#"))return t;e=`^${t.split("#").join("")}`,console.log(e);return e}(t)},|]|`}function Ec(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}function Mc(t){var e=t%12;return["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][e]+((t-60-e)/12+4)}function Nc(t,e,n){const i=(new aa).toDestination();let s=null,r="Press any midi keyboard key to start the game",a=0,o=0,c=!1;function l(){Tc.renderAbc("paper",Ac(s),{responsive:"resize",add_classes:!0})}return m((async()=>{Sc.enable((function(t){if(t)console.log("WebMidi could not be enabled.",t);else{console.log("WebMidi enabled!");var e=Sc.inputs[1];e.addListener("noteon","all",(function(t){var e,h;e=t.note.number,function(t){if(console.log("target note",s),console.log("note played",t),t===s){const t=Ec(60,72);n(0,s=Mc(t)),console.log(s),l(),console.log("correct note!"),c&&n(2,a+=1)}else console.log("WRONG note!")}(h=Mc(e)),console.log(`${h} on`),i.triggerAttack(h),c||(n(2,a=0),function(){c=!0,n(1,r=10);const t=setInterval((()=>{n(1,r--,r),r<=0&&(clearInterval(t),c=!1,a>o&&n(3,o=a))}),1e3)}())})),e.addListener("noteoff","all",(function(t){var e,n;e=t.note.number,n=Mc(e),console.log(`${n} off`),i.triggerRelease(n)}))}}));const t=Ec(60,72);n(0,s=Mc(t)),l(),console.log(s)})),[s,r,a,o]}return new class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),M(this,t,Nc,Cc,r,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
